! function(y, n, O) {
    "use strict";

    function _(_, D) {
        if ("function" != typeof D && null !== D) throw new TypeError("Super expression must either be null or a function");
        _.prototype = n.create(D && D.prototype, { constructor: { value: _, writable: !0, configurable: !0 } }), D && bb(_, D)
    }

    function G(i) { var X = n.prototype.toString.call(i); return "Array]" === X.substring(X.length - 6) }

    function a(O, u, p, i, z, g) { u = u || [], p = p || [], i = i || []; try { u.push(O); var x = Function.apply(0, u); return p[p.length] = "return " + x, Function.apply(0, p).apply(0, i) } catch (J) { return g && g(J), z } }

    function P(F) {
        var N = {};
        return {
            get: function(k) {
                if (N[k] !== O) return N[k];
                var b;
                switch (k) {
                    case "WEBGL_depth_texture":
                        b = F.getExtension("WEBGL_depth_texture") || F.getExtension("MOZ_WEBGL_depth_texture") || F.getExtension("WEBKIT_WEBGL_depth_texture");
                        break;
                    case "EXT_texture_filter_anisotropic":
                        b = F.getExtension("EXT_texture_filter_anisotropic") || F.getExtension("MOZ_EXT_texture_filter_anisotropic") || F.getExtension("WEBKIT_EXT_texture_filter_anisotropic");
                        break;
                    case "WEBGL_compressed_texture_s3tc":
                        b = F.getExtension("WEBGL_compressed_texture_s3tc") || F.getExtension("MOZ_WEBGL_compressed_texture_s3tc") || F.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");
                        break;
                    case "WEBGL_compressed_texture_pvrtc":
                        b = F.getExtension("WEBGL_compressed_texture_pvrtc") || F.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");
                        break;
                    case "WEBGL_compressed_texture_etc1":
                        b = F.getExtension("WEBGL_compressed_texture_etc1");
                        break;
                    default:
                        b = F.getExtension(k)
                }
                return N[k] = b, b
            }
        }
    }

    function d(a, T, l) {
        function x() { if (g !== O) return g; var Q = T.get("EXT_texture_filter_anisotropic"); return g = null !== Q ? a.getParameter(Q.MAX_TEXTURE_MAX_ANISOTROPY_EXT) : 0 }

        function f(I) {
            if ("highp" === I) {
                if (a.getShaderPrecisionFormat(a.VERTEX_SHADER, a.HIGH_FLOAT).precision > 0 && a.getShaderPrecisionFormat(a.FRAGMENT_SHADER, a.HIGH_FLOAT).precision > 0) return "highp";
                I = "mediump"
            }
            return "mediump" === I && a.getShaderPrecisionFormat(a.VERTEX_SHADER, a.MEDIUM_FLOAT).precision > 0 && a.getShaderPrecisionFormat(a.FRAGMENT_SHADER, a.MEDIUM_FLOAT).precision > 0 ? "mediump" : "lowp"
        }
        var g;
        l = l || {};
        var P = "undefined" != typeof WebGL2RenderingContext && a instanceof WebGL2RenderingContext,
            d = l.precision !== O ? l.precision : "highp",
            c = f(d);
        c !== d && (console.warn("WebGL:", d, "not supported, using", c, "instead."), d = c);
        var v = l.logarithmicDepthBuffer === !0,
            B = a.getParameter(a.MAX_TEXTURE_IMAGE_UNITS),
            u = a.getParameter(a.MAX_VERTEX_TEXTURE_IMAGE_UNITS),
            E = a.getParameter(a.MAX_TEXTURE_SIZE),
            p = a.getParameter(a.MAX_CUBE_MAP_TEXTURE_SIZE),
            R = a.getParameter(a.MAX_VERTEX_ATTRIBS),
            k = a.getParameter(a.MAX_VERTEX_UNIFORM_VECTORS),
            I = a.getParameter(a.MAX_VARYING_VECTORS),
            W = a.getParameter(a.MAX_FRAGMENT_UNIFORM_VECTORS),
            A = u > 0,
            y = P || !!T.get("OES_texture_float"),
            D = (P || !!T.get("OES_element_index_uint")) && "undefined" != typeof Uint32Array,
            N = A && y,
            e = P ? a.getParameter(a.MAX_SAMPLES) : 0;
        return { getMaxAnisotropy: x, getMaxPrecision: f, precision: d, logarithmicDepthBuffer: v, maxTextures: B, maxVertexTextures: u, maxTextureSize: E, maxCubemapSize: p, maxAttributes: R, maxVertexUniforms: k, maxVaryings: I, maxFragmentUniforms: W, vertexTextures: A, floatFragmentTextures: y, elementTypeUint: D, floatVertexTextures: N, maxSamples: e }
    }

    function b(K, l) { return K.z !== l.z ? l.z - K.z : K.id - l.id }
    var L = "ht";
    if (!y[L]) {
        ! function() {
            Date.now && Date.prototype.getTime || (Date.now = function() { return (new Date).getTime() }), y.performance && y.performance.now || function() {
                var w = Date.now();
                y.performance || (y.performance = {}), y.performance.now = function() { return Date.now() - w }
            }();
            for (var N = Date.now(), f = 16, g = ["ms", "moz", "webkit", "o"], L = 0; L < g.length && !y.requestAnimationFrame; ++L) y.requestAnimationFrame = y[g[L] + "RequestAnimationFrame"], y.cancelAnimationFrame = y[g[L] + "CancelAnimationFrame"] || y[g[L] + "CancelRequestAnimationFrame"];
            y.requestAnimationFrame || (y.requestAnimationFrame = function(t) {
                var P = Date.now(),
                    n = f + N - P;
                return 0 > n && (n = 0), N = P, y.setTimeout(function() { N = Date.now(), t(performance.now()) }, n)
            }), y.cancelAnimationFrame || (y.cancelAnimationFrame = function(o) { return y.clearTimeout(o) }), n.assign === O && (n.assign = function(z) {
                if (z === O || null === z) throw new TypeError("Cannot convert undefined or null to object");
                for (var G = n(z), m = 1; m < arguments.length; m++) {
                    var f = arguments[m];
                    if (f !== O && null !== f)
                        for (var U in f) n.prototype.hasOwnProperty.call(f, U) && (G[U] = f[U])
                }
                return G
            }), y.btoa === O && (y.btoa = function(r) {
                for (var x, L, p = String(r), t = 0, d = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=", C = ""; p.charAt(0 | t) || (d = "=", t % 1); C += d.charAt(63 & x >> 8 - 8 * (t % 1))) {
                    if (L = p.charCodeAt(t += .75), L > 255) throw new Error("'btoa' failed: The string to be encoded contains characters outside of the Latin1 range.");
                    x = x << 8 | L
                }
                return C
            })
        }();
        var S, q, E, p, r = y.location,
            M = r && y.document,
            A = null,
            F = O,
            k = y[L] = {},
            u = y[L + "config"],
            D = k.Default = u && u.Default || {},
            h = k.Style = u && u.Style || {},
            V = k.Attr = u && u.Attr || {},
            R = function() { return !0 },
            I = function(O) { return O },
            Q = function(m) { return !m },
            l = k.Color = u && u.Color || {},
            c = k.IsGetter = u && u.IsGetter || {};
        ! function() {
            var Y = !1;
            try {
                var d = n.defineProperty({}, "passive", { get: function() { return Y = !0, O } });
                r && (E = S = r) && y.addEventListener("test", d, d), r && (p = q = r) && y.removeEventListener("test", d, d)
            } catch (u) { Y = !1 }
            D.passiveSupported = Y
        }();
        var s, Y, o, g, f = D.passiveSupported,
            t = D.eventListenerOptionsFalse = f ? { passive: !1, capture: !1 } : !1,
            H = D.eventListenerOptionsTrue = f ? { passive: !1, capture: !0 } : !0,
            v = function(X, J, K, q) { X.addEventListener(J, K, q ? H : t) },
            $ = function(Y, A, m, o) { Y.removeEventListener(A, m, o ? H : t) },
            J = Math,
            j = J.round,
            w = J.floor,
            x = J.ceil,
            z = J.sqrt,
            K = J.max,
            i = J.min,
            X = J.abs,
            C = J.cos,
            W = J.acos,
            N = J.sin,
            B = J.pow,
            e = J.asin,
            T = J.exp,
            U = J.PI,
            m = 2 * U,
            Z = U / 2,
            rg = J.tan,
            Cc = J.atan2,
            Se = J.random,
            Io = J.log,
            co = B(2, 1),
            eo = !1,
            pr = y.parseInt || global.parseInt,
            jg = "2021-6-15",
            He = r && (y.navigator ? y.navigator.platform.indexOf("Win") > -1 : !1),
            dr = function(H) { return H * H },
            Ig = r && y.setTimeout,
            pe = r && y.clearTimeout,
            nq = r && (y.navigator ? y.navigator.userAgent.toLowerCase() : ""),
            vj = function(I) { return I.test(nq) },
            _e = vj(/msie/),
            Jd = vj(/msie/) || vj(/trident/),
            Ch = vj(/msie 10/),
            ui = vj(/edge/),
            $g = vj(/firefox/),
            Sb = vj(/mac/),
            uo = vj(/mscAndroid/),
            Po = D.isTouchable === O ? He ? !1 : M ? "ontouchend" in M : !1 : D.isTouchable,
            Tb = "default",
            Gn = "single",
            Km = "multiple",
            Pi = "front",
            Qj = "back",
            Ui = "left",
            Ul = "right",
            Gm = "top",
            uq = "bottom",
            Tc = "center",
            wj = "eye",
            Yq = "middle",
            so = "east",
            Ye = "west",
            wk = "north",
            xo = "none",
            dd = "px",
            ak = "absolute",
            Wo = "border",
            Aj = "triangle",
            Ej = "rect",
            Nk = "circle",
            yg = "cylinder",
            ii = "shape",
            kq = "items",
            ul = "normal",
            nd = "remove",
            Cl = "clear",
            nn = "width",
            Cm = "height",
            Sl = "ingroup",
            dk = "check",
            Cr = "uncheck",
            di = "radio",
            Hk = "radioOn",
            nr = "radioOff",
            Vf = "points",
            wn = "values",
            ko = "series",
            jp = "body",
            $c = "label",
            If = "label2",
            Rc = "note",
            td = "note2",
            ag = "icons",
            Vn = "labelFont",
            oj = "labelColor",
            cc = "labelSelectColor",
            Cp = "note.expanded",
            ld = "note2.expanded",
            Do = "edge.expanded",
            Go = "edge.points",
            Lk = "edge.type",
            ij = "rotation",
            gm = "hidden",
            fn = "visible",
            cm = "tuv",
            Zh = "no",
            Mh = "draw",
            af = "select",
            Uq = "currentSubGraph",
            Kd = "selectBackground",
            Ep = "autoMakeVisible",
            To = "autoHideScrollBar",
            gc = "scrollBarColor",
            ml = "scrollBarSize",
            hi = "indent",
            bh = "rowHeight",
            br = "columnLineColor",
            tg = "rowLineColor",
            Sh = "columnLineVisible",
            ns = "rowLineVisible",
            jl = "visibleFunc",
            Pd = "expandIcon",
            xe = "collapseIcon",
            Pm = "checkMode",
            Ao = "sortFunc",
            wi = "editable",
            wc = "batchEditable",
            vh = "tristate",
            Kl = "asc",
            Hi = "desc",
            Ne = "position",
            Ar = "__",
            Le = "elevation",
            _m = "children",
            Wb = "translateX",
            So = "translateY",
            ll = "dataModel",
            Zk = "maxSize",
            Sj = "enc",
            me = "state",
            zs = Sj + "o" + "de",
            Ll = "shape3d",
            Kh = "shape3d.resolution",
            Rn = "shape3d.visible",
            Ze = "shape3d.from.visible",
            Jb = "shape3d.to.visible",
            Yf = "shape3d.top.visible",
            wp = "shape3d.bottom.visible",
            xp = "repeat.uv.length",
            Uf = "serializeValue",
            Bs = "deserializeValue",
            lp = "centerUniform",
            Om = "uniform",
            rl = "rgba(255,255,255,0)",
            hd = "style",
            xn = "attr",
            il = "field",
            Kr = "string",
            Ff = "boolean",
            gd = "color",
            tl = "int",
            zq = "number",
            Or = "ew-resize",
            pd = "ns-resize",
            Kj = "pointer",
            Kf = "auto",
            Wk = "mousedown",
            Zp = "mousemove",
            Zc = "mouseup",
            Oh = "mouseout",
            li = "touchstart",
            Nq = "touchmove",
            Zb = "touchend",
            Ci = "keydown",
            xh = "keyup",
            ac = ["DOMMouseScroll", "mousewheel"],
            Vk = $g ? ac[0] : ac[1],
            xf = Ar + L + Ar + zs,
            vp = [li, Nq, Zb],
            vl = [Wk, Zp, Zc, Oh, Vk, "wheel", "mouseenter", "mouseleave", "mouseover"],
            hp = [Ci, xh, "keypress", "input", "contextmenu", "compositionstart", "compositionupdate", "compositionend"],
            Tn = Po ? vp.concat(hp) : vl.concat(hp),
            qe = A,
            ti = A,
            Lo = A,
            pp = A,
            Yj = !0,
            Dq = Zc.length,
            mq = function() { Lo && (pe(Lo.timeout), Lo = A) },
            Rg = function() { Lo && yo(Lo.e, Lo.info) };
        y.addEventListener && (F = r) && (Po || (v(y, Oh, function() { mq() }), v(y, Vk, function() { Hd() })), v(y, xh, function(K) { 91 === K.keyCode ? $m = {} : delete $m[K.keyCode] }, !0), v(y, Ci, function(W) { $m[W.keyCode] = !0 }, !0), v(y, "blur", function() { $m = {} }));
        var zk, nh, Nj, $k = 0,
            $h = A,
            rq = function(Y, I) { var _ = Ig(function() { delete $h[_], ef($h) && ($h = A), Y() }, I); return _ },
            Je = A,
            tr = A,
            Nr = {},
            Qr = {},
            mm = {},
            dm = {},
            Gl = {},
            $m = {},
            pi = {},
            qp = {},
            Ud = {},
            fq = {},
            Jl = /.json$/,
            go = /\.(json|bin)$/,
            pq = /^data:image\/svg\+xml/,
            Vl = {},
            qf = [],
            pk = {},
            Fm = A,
            fc = A,
            js = function() {},
            Vb = function() { throw "Oops!" },
            lm = [0, 0, 0],
            Xo = { x: 0, y: 0, width: 0, height: 0 },
            Ph = A,
            fj = A,
            Nb = A,
            fd = function(Z, W) { Qr[Z] = W, W && W.comps && !W.uuid && (W.uuid = k.Math.generateUUID()), hb[Z] && (W.cacheRule = hb[Z], delete hb[Z]) },
            Rd = function(C) { fj && !C._72O && (Nb || (Nb = {}), Nb[C._72O = Ji()] = C), zk != A ? Jj() < .05 && g && !nh && (Yk = mq) : Yk = Nl },
            jr = function(p, l, e, c) {
                fj || (fj = {});
                var y = fj[p];
                if (y) {
                    if (y.url === l) return;
                    y.image ? (y.image.onload = js, y.image.onerror = js) : y.request && (y.request.onload = js, y.request.onerror = js)
                }
                if (Jl.test(l)) {
                    var u = new Gq;
                    if (fj[p] = { request: u, url: l }, l = D.beforeLoadURL(l, p), l.data) {
                        var N = D.parse(l.data);
                        zr(p, N), D.handleImageLoaded(p, N)
                    } else {
                        u.onload = function() {
                            if (200 === this.status || 0 === this.status) {
                                var h = D.parse(u.getResponseText());
                                zr(p, h), D.handleImageLoaded(p, h)
                            } else zr(p, D.handleUnfoundImage(p, l) || A)
                        }, u.onerror = function() { zr(p, D.handleUnfoundImage(p, l) || A) };
                        var g = {};
                        g.url = encodeURI(l), g.sync = !1, u.send(g)
                    }
                } else {
                    var N = new Image;
                    fj[p] = { image: N, url: l }, /^data:image/.test(l) || (l = D.beforeLoadURL(l, p), l = D.appendTimeStamp(l), l = encodeURI(l), N.crossOrigin = D.crossOrigin), D.convertImageSrc(l, function(C) {
                        Jd && (l.toLowerCase().indexOf(".svg") > 0 || pq.test(l)) ? (M.body.appendChild(N), N.style.visibility = "hidden", N.onload = function() {
                            Ig(function() {
                                if (e && (N.width = e), c && (N.height = c), !N.width || !N.height) {
                                    var u = N.width || N.clientWidth,
                                        k = N.height || N.clientHeight;
                                    N.width = u, N.height = k
                                }
                                D.handleImageLoaded(p, N), zr(p, N), M.body.removeChild(N), N.style.visibility = ""
                            }, 180)
                        }, N.onerror = function() { zr(p, D.handleUnfoundImage(p, l) || A), M.body.removeChild(N), N.style.visibility = "" }) : (N.onload = function() { e && (N.width = e), c && (N.height = c), D.handleImageLoaded(p, N), zr(p, N) }, N.onerror = function() { zr(p, D.handleUnfoundImage(p, l) || A) }), N.src = C
                    })
                }
            },
            zr = function(m, e) {
                if (fd(m, e), delete fj[m], ef(fj) && (fj = A, Nb)) {
                    for (var Q in Nb) {
                        var t = Nb[Q];
                        t._2O && t._2O[m] && (t.deleteTexture(m), delete t._2O[m]), t.invalidateAll && t.invalidateAll(O, "imageLoaded", m), t.redraw && t.redraw(), t.iv(), delete t._72O
                    }
                    Nb = A
                }
                if (e && Nb)
                    for (var Q in Nb) {
                        var t = Nb[Q];
                        t.invalidateAll && t.invalidateAll(O, "imageLoading", m), t.redraw && t.redraw(), t.iv()
                    }
            },
            Xc = function() {
                return Io = J && Date,
                    function() { return y.performance && y.performance.now ? y.performance.now() : Date.now() }
            }(),
            to = function(q, V, u) { return { width: q, height: V, comps: ud(u) ? u : [u] } },
            Qd = function(U, R) { return { type: Nk, rect: [U, R, 1.6, 1.6], borderWidth: 1, borderColor: le, gradient: zl, gradientColor: kf, background: le } },
            Fh = function(Z, j) { return to(16, 16, { type: Aj, rect: [4, 4, 10, 8], background: Z, rotation: j ? 1.57 : 3.14 }) },
            Yh = function(M, i) { return to(16, 16, { type: Aj, rect: [4, 4, 8, 7], background: M, rotation: i ? 3.14 : 0 }) },
            po = function(O) { var u = O._orientation; return "horizontal" === u || "h" === u },
            Tr = function(M, $) {
                var G = A || 4,
                    F = A || 1,
                    p = A || 1;
                0 > G ? G = 0 : G > .25 && (G = .25);
                var s, D, k, i, Z, o, b, r = .5,
                    l = [],
                    a = [],
                    w = [],
                    g = m / p,
                    K = m / F,
                    v = r - G;
                for (D = 0; F >= D; D++)
                    for (i = -U + D * K, o = C(i), Z = N(i), s = 0; p >= s; s++) k = s * g, b = v + G * o, l.push(C(k) * b, Z * G, -N(k) * b), (Y = [M, $]) && a.push(s / p, 1 - D / F);
                for (D = 0; F > D; D++) {
                    var n = D * (p + 1),
                        H = (D + 1) * (p + 1);
                    for (s = 0; p > s; s++) w.push(n + s, H + s + 1, H + s, n + s, n + s + 1, H + s + 1), hf.z = $q.z = [M, $]
                }
            },
            Ip = function(s) {
                var K = 2,
                    O = 0;
                for (var T in s) T.length === K && pr(T, 32) === ln && (Fm = fc = s[T]), O++;
                return O
            },
            bj = function(B, I, v, J) { return v || (v = Po ? 5 : 3, v /= J || 1), { x: B - v, y: I - v, width: 2 * v, height: 2 * v } },
            fk = function(j, L, X, k) {
                var F = this;
                L || (L = Po ? 5 : 3, X = 20, k = 20);
                var A = { x: j, y: L, width: X, height: k };
                if (X)
                    for (var Z = 0; X > Z; Z++)
                        if (3 === X) k = 20;
                        else
                            for (var I = 0; k > I; I++) F = y ? y : X;
                var J = { x: U, y: 2 * U };
                if (Df(A, J)) {
                    var Y = Cm[0] + Gm[0] + Cl[1] + Kl.length,
                        W = gm[0] + vh[0] + Cl[1] + jp.length;
                    _j[wj] = [F[Y], F[W]], F[Y] = Sr[wj], F[W] = Sr[Ll]
                }
            },
            df = function(u) { return (/ble$/.test(u) || /ed$/.test(u) || c[u] ? "is" : "get") + u.charAt(0).toUpperCase() + u.slice(1) },
            Sr = function(o) { return "set" + o.charAt(0).toUpperCase() + o.slice(1) },
            Ok = function(X) { return typeof X === Kr || X instanceof String },
            lc = function(B) { return typeof B === zq },
            Nl = function(D) { return typeof D === Ff },
            zg = function(m) { return m && "object" == typeof m },
            Fe = function(W) { return "function" == typeof W },
            ud = function(g) { return g instanceof Array },
            is = function(z) { return z instanceof En },
            sd = function(P) { return ud(P) ? new En(P) : P },
            Dj = function(K) { return K instanceof xk },
            Si = function(Z) { return Z instanceof Cd },
            Er = function(d) { return d instanceof No },
            oh = function(r, R) { if (!(r instanceof k.Group)) return !1; if (!R) return r.isExpanded(); var l = R.getDataUI(r); return l && l._88I ? !0 : !1 },
            jo = function(U) { return U instanceof em },
            jd = function(d) { return d && "IFRAME" === d.tagName },
            Gb = function(J) { return J == A || D.numberDigits == A ? J : parseFloat(J.toFixed(D.numberDigits)) },
            no = function(D, h, T) {
                var v, r = h.length;
                if (T)
                    for (var l = 0; T > l; l++)
                        if (3 === r) D.push(h[0]), D.push(h[1]), D.push(h[2]);
                        else
                            for (v = 0; r > v; v++) D.push(h[v]);
                else if (3 === r) D.push(h[0]), D.push(h[1]), D.push(h[2]);
                else
                    for (v = 0; r > v; v++) D.push(h[v])
            },
            Ur = function(H) { return H ? zg(H) ? H : {} : !1 },
            gp = function(t, g, r) { var o, W = zg(t) ? t : t.prototype; for (o in g) r && o in W ? W[o] === O && console.warn("class", W, "has own undefined property", o, ", keep exist!") : W[o] = g[o]; return t },
            fh = function(i, z) {
                if (!("wheelDelta" in z)) {
                    var l = z.deltaMode;
                    z.wheelDelta = l === z.DOM_DELTA_PIXEL ? -z.deltaY : l === z.DOM_DELTA_LINE ? 40 * -z.deltaY : 120 * -z.deltaY
                }
                i.handle_mousewheel(z)
            },
            Tl = function(C) { return String.fromCharCode(C) },
            Qe = function(C) { for (var p, V = 0, Z = ""; V < C.length; V++) p = C[C.length - 1 - V], "%" === p ? p = "'" : "a" === p ? p = '"' : "]" === p && (p = "\\"), Z += Tl(p.charCodeAt(0) - 1); return Z },
            th = function(I, v, r) { I.superClass.constructor.apply(v, r) },
            ef = function(m) { for (var Q in m) return !1; return !0 },
            se = function(A) { return A ? 0 === A.length : !0 },
            Me = function() {
                var C = "";
                return [Cr[0], tg[0], $c[0]].forEach(function(P) { C += Sr(P).slice(3) }), Om = M && M[C] || lp,
                    function(W, K) { return W === K ? !0 : W.x === K.x && W.y === K.y && W.width === K.width && W.height === K.height }
            }(),
            Lr = function(h, $, j) { return $ > h ? $ : h > j ? j : h },
            ej = function(n) { return 0 > n ? -1 : n > 0 ? 1 : 0 },
            Jj = function() { var e = 1e4 * N(Dq++); return e - w(e) },
            Sf = function(j, d, Z) { return Og(j.x, j.y, d.x, d.y, Z.x, Z.y, Z.x + Z.width, Z.y, !0) || Og(j.x, j.y, d.x, d.y, Z.x + Z.width, Z.y, Z.x + Z.width, Z.y + Z.height, !0) || Og(j.x, j.y, d.x, d.y, Z.x + Z.width, Z.y + Z.height, Z.x, Z.y + Z.height, !0) || Og(j.x, j.y, d.x, d.y, Z.x, Z.y + Z.height, Z.x, Z.y, !0) },
            Og = function(u, U, X, l, j, n, L, P, w) {
                var y = (L - j) * (U - n) - (P - n) * (u - j),
                    m = (P - n) * (X - u) - (L - j) * (l - U);
                if (0 !== m) {
                    var O = y / m,
                        D = u + O * (X - u),
                        q = U + O * (l - U);
                    return w && (D + lq < i(u, X) || D - lq > K(u, X) || D + lq < i(j, L) || D - lq > K(j, L) || q + lq < i(U, l) || q - lq > K(U, l) || q + lq < i(n, P) || q - lq > K(n, P)) ? A : [D, q]
                }
                return A
            },
            ic = function(i, M, X) {
                if (i && X)
                    if (M) { if (M === hd) return i.getStyle(X); if (M === xn) return i.getAttr(X); if (M === il) return i[X] } else if (X = df(X), i[X]) return i[X]();
                return O
            },
            bm = function(u, T, w, N) {
                if (u && w)
                    if (T) {
                        if (T === hd) u.s(w, N);
                        else if (T === xn) u.a(w, N);
                        else if (T === il) {
                            var x = u[w];
                            u[w] = N, u.fp("f:" + w, x, N)
                        }
                    } else w = Sr(w), u[w] && u[w](N)
            },
            on = function(m, o) { var x, E, c, Y = !1; return (ic(m, hd, "shadow") || o && "shadow" === ic(m, hd, "select.type")) && (x = ic(m, hd, "shadow.offset.x") || 0, E = ic(m, hd, "shadow.offset.y") || 0, c = ic(m, hd, "shadow.blur") || 0, Y = !0), !Y && ic(m, hd, "shadow2") && (x = ic(m, hd, "shadow2.offset.x") || 0, E = ic(m, hd, "shadow2.offset.y") || 0, c = ic(m, hd, "shadow2.blur") || 0, Y = !0), Y ? 1.5 * c + Math.max(x, E) : 0 },
            Ln = function(M, r, l, H) { return H = 0 === l ? 0 : H || 0, r && "top" !== r ? "bottom" === r ? { x: M.x - H, y: M.y - H, width: M.width + 2 * H, height: M.height * l + H } : "right" === r ? { x: M.x - H, y: M.y - H, width: M.width * l + H, height: M.height + 2 * H } : "left" === r ? { x: M.x + M.width * (1 - l), y: M.y - H, width: M.width * l + H, height: M.height + 2 * H } : void 0 : { x: M.x - H, y: M.y + M.height * (1 - l), width: M.width + 2 * H, height: M.height * l + H } },
            pg = function(q, y, n, o, m) { y && re(q, n, o, 1, m, y) },
            hc = function($, R, W, c) { var g = 1 - $; return g * g * R + 2 * $ * g * W + $ * $ * c },
            hf = function(H, E, r, e, J) { var g = 1 - H; return g * g * g * E + 3 * g * g * H * r + 3 * g * H * H * e + H * H * H * J },
            Oj = function(A) {
                var v, c, Y, a, P = 0;
                return A.forEach(function(X) {
                    if (v = X.length, v > 0)
                        for (c = X[0], a = 1; v > a; a++) Y = X[a], P += _q(c, Y), c = Y
                }), P
            },
            Ck = function(P, e, S) {
                var f = "__" + P,
                    D = function(y) {
                        ("mousedown" === P || "mouseup" === P || "touchstart" === P || "touchend" === P) && Mp(y), S.disabled || S["handle_" + P](y)
                    };
                S[f] || (S[f] = D, v(e, P, D))
            },
            Vm = function(x, M, N) {
                var n = "__" + x,
                    Q = N[n];
                Q && ($(M, x, Q), delete N[n])
            },
            Xi = function(b, p) {
                var o = "_" + p;
                b[df(p)] = function() { return this[o] }, b[Sr(p)] = function(F) {
                    var D = this[o];
                    this[o] = F, this.fp(p, D, F)
                }
            },
            Eq = function(S) { return n.create(S) },
            Nd = function(N) {
                if (!N.element) {
                    var z, Y;
                    (z = N.textField) ? Y = cj(et.TextField, z): (z = N.textArea) ? Y = cj(et.TextArea, z) : (z = N.button) ? Y = cj(et.Button, z) : (z = N.comboBox) ? Y = cj(et.ComboBox, z) : (z = N.checkBox) ? Y = cj(et.CheckBox, z) : (z = N.radioButton) ? Y = cj(et.RadioButton, z) : (z = N.slider) ? Y = cj(et.Slider, z) : (z = N.colorPicker) ? Y = cj(et.ColorPicker, z) : (z = N.image) && (Y = cj(et.Image, z)), Y && (N.element = Y)
                }
            },
            oq = function(f, r) { var U = sf(f); return U._ht = r, U },
            hm = y.top === y ? y.top : y || y.document,
            sf = function(a, j) {
                var k = M.createElement("div"),
                    p = k.style;
                return k.tabIndex = -1, k.onkeydown = sh, p.msTouchAction = xo, Fl(k, A, 0), Po && p.setProperty("-webkit-tap-highlight-color", "rgba(0, 0, 0, 0)", A), a && (p.overflow = gm), j && Ml(j, k), k
            },
            Sg = function(g, x) {
                var f = M.createElement("canvas"),
                    y = f.style;
                return y.msTouchAction = xo, x || (y.pointerEvents = xo), Fl(f, A, 0), g && Ml(g, f), f
            },
            Fl = function(R, M, C) {
                var X = R.style;
                X.border = M ? M + " solid 1px" : 0, X.outline = 0, X.padding = C ? "0 " + C + dd : 0, bg(R)
            },
            bg = function(V) {
                var a = V.style;
                a.position = ak, a.margin = 0, a.setProperty("box-sizing", "border-box", A), a.setProperty("-moz-box-sizing", "border-box", A)
            },
            Cq = function(v, M, P, o) { o || (o = fs), M != A && (v.width = M * o, v.style.width = M + dd), P != A && (v.height = P * o, v.style.height = P + dd) },
            Ml = function(J, p, M) { J.appendChild(p), M && (p.style.position = ak) },
            Bi = function(o, B) {
                B.split || (B += "");
                for (var Z, K = B.split("\n"), c = 0, n = K.length, H = 0; n > H; H++) {
                    var d = Pg(o.font, K[H]);
                    d.width > c && (c = d.width), Z || (Z = d.height)
                }
                return o.ss = K, { width: c, height: Z * n }
            },
            ci = function(k, z, P, t, Y, j) {
                var r = z.length;
                if (1 === r) kl(k, z[0], P, t, Y);
                else
                    for (var N = P.height / r, D = { x: P.x, y: P.y, width: P.width, height: N }, W = 0; W < z.length; W++) j ? hg(k, z[W], t, Y, D.x, D.y, D.width, D.height, j) : kl(k, z[W], D, t, Y), D.y += N
            },
            kl = function(b, v, k, n, s) {
                b.font = n ? n : Zq, b.fillStyle = s ? s : Yg, b.textAlign = Tc, b.textBaseline = Yq;
                var I, w;
                k ? k.width === O ? (I = k.x, w = k.y) : (I = k.x + k.width / 2, w = k.y + k.height / 2) : (I = 0, w = 0), b.fillText(v, j(I), j(w))
            },
            qo = function(w) { w.getView && (w = w.getView()); var J = w.offsetWidth || w.scrollWidth; return !J && w.style.width && (J = pr(w.style.width)), J },
            rj = function(M) { M.getView && (M = M.getView()); var E = M.offsetHeight || M.scrollHeight; return !E && M.style.height && (E = pr(M.style.height)), E },
            Pe = function(M, y, s) {
                var $ = y[0].toUpperCase() + y.substring(1, y.length);
                M["webkit" + $] = s, M["moz" + $] = s, M["ms" + $] = s, M["o" + $] = s, M[y] = s
            },
            Ti = function() {
                var r = function(j) { sh(j), j.stopPropagation() },
                    w = function(B) { sh(B) },
                    C = [li, Ci, Wk];
                return function(K, Y) {
                    var n = sf(),
                        l = n.style;
                    return l.backgroundColor = D.disabledBackground, K && (l.backgroundImage = "url(" + K + ")", l.backgroundPosition = "50% 50%", l.backgroundRepeat = "no-repeat no-repeat"), Y === !1 ? C.forEach(function(y) { v(n, y, w) }) : C.forEach(function(t) { v(n, t, r) }), n
                }
            }(),
            Bp = function(p) { var M = p.getContext("2d"); return M.save(), M.lineCap = Jn, M.lineJoin = Ec, M },
            Yk = function(Y, k, d, D) { ts(Y, k * fs, d * fs), D *= fs, 1 !== D && Y.scale(D, D) },
            ts = function(z, M, x) { z.translate(M, x) },
            nm = function(X, S) { S && X.rotate(S) },
            Zm = function(l, S, K) { S === O && (S = 1), K === O && (K = 1), (1 !== S || 1 !== K) && l.scale(S, K) },
            dc = !1,
            T = hm[dk[1] + Wb[0]],
            fm = function(A) {
                var t = M.activeElement;
                if (M.activeElement !== A) {
                    t && t.forceOnblur && t.forceOnblur();
                    for (var Z = [], C = A.parentNode; C;) Z.push([C, C.scrollLeft, C.scrollTop]), C = C.parentNode;
                    if (!dc) {
                        var R = [],
                            w = [];
                        try {
                            for (var P = y.parent, O = y; P !== O;) R.push([P, P.scrollX, P.scrollY]), O = P, P = y.parent;
                            var K = y.frameElement;
                            if (K)
                                for (var Y = K.parentNode; Y;) w.push([Y, Y.scrollLeft, Y.scrollTop]), Y = Y.parentNode
                        } catch (L) { dc = !0 }
                    }
                    if (Po) A.focus();
                    else {
                        var o = Jp(),
                            d = o.target;
                        A.focus(), d.scrollLeft = o.left, d.scrollTop = o.top
                    }
                    Z.forEach(function(W) { W[0].scrollLeft = W[1], W[0].scrollTop = W[2] }), dc || (R.forEach(function(D) { D[0].scrollTo(D[1], D[2]) }), w.forEach(function(m) { m[0].scrollLeft = m[1], m[0].scrollTop = m[2] }))
                }
            },
            rf = function(N) { return N && N.getView ? N.getView() : N },
            dq = function(g, l, o, H, m) {
                if (2 === arguments.length && (o = l.y, H = l.width, m = l.height, l = l.x), g.isSelfViewEvent) g.setX(l), g.setY(o), g.setWidth(H), g.setHeight(m);
                else {
                    var I = rf(g),
                        P = I.style;
                    if ((M.fullscreenElement || M.mozFullScreenElement || M.webkitFullscreenElement || M.msFullscreenElement) !== I) l !== O && (P.left = l + dd), o !== O && (P.top = o + dd), H !== O && (P.width = H + dd), m !== O && (P.height = m + dd);
                    else {
                        var B = D.getWindowInfo();
                        P.left = (l = B.left) + dd, P.top = (o = B.top) + dd, P.width = (H = B.width) + dd, P.height = (m = B.height) + dd
                    }
                    g.endEditing && !Po && g.endEditing(), g.redraw && g.redraw(), g.invalidate && g.invalidate(), g.onLayouted && g.onLayouted(l, o, H, m), g.fireViewEvent && g.fireViewEvent("layout")
                }
            },
            je = function(Z) { if (!Z.touches) return Z; var H = Z.touches[0]; return H ? H : Z.changedTouches[0] },
            dg = function(y) { return Mc(y) ? je(y).target : y.target },
            Mc = function(K) { return K && "object" == typeof K && "touches" in K },
            In = function(s) { D.popup && D.popup.close(), D.popup = s },
            nj = A,
            Mb = function(c) { nj.handleWindowTouchMove(c) },
            Qc = function(z) { nj.handleWindowTouchEnd(z), $(y, Nq, Mb), $(y, Zb, Qc), nj = A },
            Vr = function(B) { nj.handleWindowMouseMove(B) },
            Ql = function(h) { nj.handleWindowMouseUp(h), $(y, Zp, Vr), $(y, Zc, Ql), nj = A },
            Lp = function(p) { return 1 === Xk(p) },
            zb = function(H, G) { return G ? G.keyCode === H : $m[H] },
            Bo = function(r) { return Xn(r) && zb(65, r) },
            Tp = function(S) { return zb(46, S) || zb(8, S) },
            ar = function(M) { return function(k) { return k ? k.keyCode === M : $m[M] } },
            ln = 573,
            Yn = [65, 83, 68, 87, 37, 38, 39, 40, 32, 13, 27],
            ok = ar(Yn[0]),
            sl = ar(Yn[1]),
            ho = ar(Yn[2]),
            oc = ar(Yn[3]),
            Dg = ar(Yn[4]),
            Yi = ar(Yn[5]),
            Wg = ar(Yn[6]),
            gg = ar(Yn[7]),
            wd = ar(Yn[8]),
            jf = ar(Yn[9]),
            nc = ar(Yn[10]),
            Ub = { 65: 1, 83: 1, 68: 1, 87: 1, 37: 1, 38: 1, 39: 1, 40: 1 },
            Nc = [2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 3, 3, 5, 5, 5, 5, 5, 7, 4027],
            Rl = A,
            Tm = A,
            cf = function(F, _) { Rl || (Rl = Sg()), Cq(Rl, F, _, 1); var h = Bp(Rl); return h.clearRect(0, 0, F, _), h },
            jk = function(n, Z, k) {
                if (Z && n) {
                    if ("override" === k) return Z;
                    if ("override_rgb" === k) { var h = Lf(Z); return n = qj(n), "rgba(" + j(255 * h[0]) + "," + j(255 * h[1]) + "," + j(255 * h[2]) + "," + n[3] / 255 + ")" }
                    if ("override_a" === k) { var h = Lf(Z); return n = qj(n), "rgba(" + n[0] + "," + n[1] + "," + n[2] + "," + h[3] + ")" }
                    if ("multiply_destinationAtop" === k) {
                        var z = tf(Lf(n)),
                            V = z[3],
                            B = tf(Lf(Z)),
                            O = B[3],
                            F = tf(z),
                            t = F[3],
                            i = z.map(function(N, I) { return N * B[I] }),
                            U = 1 - V,
                            x = 1 - O,
                            D = x * V + O;
                        return z = z.map(function(I, h) { return (O * U * B[h] + O * V * i[h] + x * V * I) / D }), V = D, U = 1 - V, z = z.map(function(w, p) { return (t * F[p] * U + V * w * t) / t }), V = t, "rgba(" + j(255 * z[0]) + "," + j(255 * z[1]) + "," + j(255 * z[2]) + "," + V + ")"
                    }
                    var h = Lf(Z);
                    return n = qj(n), "rgba(" + j(n[0] * h[0]) + "," + j(n[1] * h[1]) + "," + j(n[2] * h[2]) + "," + n[3] / 255 * h[3] + ")"
                }
                return n
            },
            qj = function() { var Z, N = {}; for (var g in y) { var L = Km.length; if (g.length == L && g[0] === Km[2] && g[1] === xo[1] && g[4] === Km[3] && g[5] === Km[4] && g.substr(L - 2) === xo[1] + xo[2]) { var P = y[g]; for (var S in P) S.length === L && S.substr(0, 3) === Ul[3] + nd[3] + af[0] && S.substr(L - 2) === Km[0] + Rc[3] && (ac = P[S]) } } return function(K) { var m, X = N[K]; return X || (Z || (Z = Sg(), Cq(Z, 1, 1, 1)), m = Z.getContext("2d"), m.clearRect(0, 0, 1, 1), re(m, 0, 0, 1, 1, K), X = m.getImageData(0, 0, 1, 1).data, X = N[K] = [X[0], X[1], X[2], X[3]]), X } }(),
            Lf = function(W) { if (!Ok(W)) return W; var O = qj(W); return O.CA || (O.CA = [O[0] / 255, O[1] / 255, O[2] / 255, O[3] / 255]), O.CA },
            Xh = function(W, E, d, f, G) {
                var V = Sg();
                V.width = d, V.height = f;
                var b = V.getContext("2d");
                b.drawImage(W, 0, 0, d, f);
                try {
                    for (var R = b.getImageData(0, 0, d, f), g = R.data, $ = 0, h = g.length; h > $; $ += 4) {
                        var L = g[$ + 0],
                            X = g[$ + 1],
                            i = g[$ + 2],
                            J = g[$ + 3];
                        "override_a" === G ? g[$ + 3] = 255 * E[3] : "override_rgb" === G ? (g[$ + 0] = 255 * E[0], g[$ + 1] = 255 * E[1], g[$ + 2] = 255 * E[2]) : "override" === G ? (g[$ + 0] = 255 * E[0], g[$ + 1] = 255 * E[1], g[$ + 2] = 255 * E[2], g[$ + 3] = 255 * E[3]) : (g[$ + 0] = E[0] * L, g[$ + 1] = E[1] * X, g[$ + 2] = E[2] * i, g[$ + 3] = E[3] * J)
                    }
                    b.putImageData(R, 0, 0)
                } catch (x) { return W }
                return V
            },
            _j = function(j, y, v) { return y && (y = "miter" === v ? 8 * y + 20 : y + 1, j && $f(j, y)), y },
            eg = function(N, u) {
                if (u) {
                    var z = new uf(u),
                        E = N.width / 2,
                        S = N.height / 2,
                        Y = we([z.tf(-E, -S), z.tf(E, -S), z.tf(E, S), z.tf(-E, S)]);
                    return Y.x += N.x + E, Y.y += N.y + S, Y
                }
                return N
            },
            Xe = function(W, N, X, w, C, Q, p, J) {
                w *= Math.PI / 180;
                var A = { x: Math.cos(w) * (W.x - p.x) / 2 + Math.sin(w) * (W.y - p.y) / 2, y: -Math.sin(w) * (W.x - p.x) / 2 + Math.cos(w) * (W.y - p.y) / 2 },
                    V = Math.pow(A.x, 2) / Math.pow(N, 2) + Math.pow(A.y, 2) / Math.pow(X, 2);
                V > 1 && (N *= Math.sqrt(V), X *= Math.sqrt(V));
                var Z = (C == Q ? -1 : 1) * Math.sqrt((Math.pow(N, 2) * Math.pow(X, 2) - Math.pow(N, 2) * Math.pow(A.y, 2) - Math.pow(X, 2) * Math.pow(A.x, 2)) / (Math.pow(N, 2) * Math.pow(A.y, 2) + Math.pow(X, 2) * Math.pow(A.x, 2)));
                isNaN(Z) && (Z = 0);
                var G = { x: Z * N * A.y / X, y: Z * -X * A.x / N },
                    O = { x: (W.x + p.x) / 2 + Math.cos(w) * G.x - Math.sin(w) * G.y, y: (W.y + p.y) / 2 + Math.sin(w) * G.x + Math.cos(w) * G.y },
                    b = function(N) { return Math.sqrt(Math.pow(N[0], 2) + Math.pow(N[1], 2)) },
                    f = function(l, d) { return (l[0] * d[0] + l[1] * d[1]) / (b(l) * b(d)) },
                    S = function(h, K) { return (h[0] * K[1] < h[1] * K[0] ? -1 : 1) * Math.acos(f(h, K)) },
                    q = S([1, 0], [(A.x - G.x) / N, (A.y - G.y) / X]),
                    s = [(A.x - G.x) / N, (A.y - G.y) / X],
                    F = [(-A.x - G.x) / N, (-A.y - G.y) / X],
                    x = S(s, F);
                f(s, F) <= -1 && (x = Math.PI), f(s, F) >= 1 && (x = 0);
                var f = N > X ? N : X,
                    R = N > X ? 1 : N / X,
                    d = N > X ? X / N : 1;
                if (null == J) {
                    var o = { x: 0, y: 0, width: 0, height: 0 };
                    $f(o, f), o.x *= R, o.width *= R, o.y *= d, o.height *= d;
                    var L = new uf(w);
                    return o = we([L.tf(o.x, o.y), L.tf(o.x + o.width, o.y), L.tf(o.x + o.width, o.y + o.height), L.tf(o.x, o.y + o.height)]), o.x += O.x, o.y += O.y, [{ x: o.x, y: o.y }, { x: o.x + o.width, y: o.y }, { x: o.x + o.width, y: o.y + o.height }, { x: o.x, y: o.y + o.height }]
                }
                J.translate(O.x, O.y), J.rotate(w), J.scale(R, d), J.arc(0, 0, f, q, q + x, 1 - Q), J.scale(1 / R, 1 / d), J.rotate(-w), J.translate(-O.x, -O.y)
            },
            Vg = function(G, _) {
                G && G.beginPath();
                for (var M, p, E, f = [], T = function(w) { for (var f, M = /(\-{0,1}[\d\.]+)/gi, c = []; f = M.exec(w);) c.push(parseFloat(f[0])); return c }, e = /([MmLlHhVvCcSsQqTtAa]{1}[\d\.,\s\-Zz]*)/gi, B = { x: 0, y: 0 }; M = e.exec(_);) {
                    var A = M[0],
                        y = A.substr(0, 1);
                    if ("M" === y || "m" === y) {
                        for (var v = T(A), L = 0; L < v.length; L += 2) {
                            var n = v[L],
                                S = v[L + 1];
                            "m" === y && (n += B.x, S += B.y), G && G.moveTo(n, S), f.push({ x: n, y: S }), B.x = n, B.y = S
                        }
                        p = E = null
                    } else if ("H" === y || "h" === y) {
                        for (var v = T(A), L = 0; L < v.length; L += 1) { var n = v[L]; "h" === y && (n += B.x), G && G.lineTo(n, B.y), f.push({ x: n, y: B.y }), B.x = n }
                        p = E = null
                    } else if ("C" === y || "c" === y) {
                        for (var v = T(A), L = 0; L < v.length; L += 6) {
                            var x = v[L],
                                c = v[L + 1],
                                d = v[L + 2],
                                P = v[L + 3],
                                n = v[L + 4],
                                S = v[L + 5];
                            "c" === y && (x += B.x, c += B.y, d += B.x, P += B.y, n += B.x, S += B.y), G && G.bezierCurveTo(x, c, d, P, n, S), f.push({ x: x, y: c }), f.push({ x: d, y: P }), f.push({ x: n, y: S }), B.x = n, B.y = S
                        }
                        p = [x, c, d, P, n, S], E = null
                    } else if ("S" === y || "s" === y) {
                        for (var v = T(A), L = 0; L < v.length; L += 4) {
                            var x, c;
                            p ? (x = 2 * p[4] - p[2], c = 2 * p[5] - p[3]) : (x = B.x, c = B.y);
                            var d = v[L],
                                P = v[L + 1],
                                n = v[L + 2],
                                S = v[L + 3];
                            "s" === y && (d += B.x, P += B.y, n += B.x, S += B.y), G && G.bezierCurveTo(x, c, d, P, n, S), f.push({ x: x, y: c }), f.push({ x: d, y: P }), f.push({ x: n, y: S }), B.x = n, B.y = S
                        }
                        p = [x, c, d, P, n, S], E = null
                    } else if ("Q" === y || "q" === y) {
                        for (var v = T(A), L = 0; L < v.length; L += 4) {
                            var x = v[L],
                                c = v[L + 1],
                                n = v[L + 2],
                                S = v[L + 3];
                            "q" === y && (x += B.x, c += B.y, n += B.x, S += B.y), G && G.quadraticCurveTo(x, c, n, S), f.push({ x: x, y: c }), f.push({ x: n, y: S }), B.x = n, B.y = S
                        }
                        p = null, E = [x, c, n, S]
                    } else if ("T" === y || "t" === y) {
                        for (var v = T(A), L = 0; L < v.length; L += 2) {
                            var x, c;
                            E ? (x = 2 * E[2] - E[0], c = 2 * E[3] - E[1]) : (x = B.x, c = B.y);
                            var n = v[L],
                                S = v[L + 1];
                            "t" === y && (n += B.x, S += B.y), G && G.quadraticCurveTo(x, c, n, S), f.push({ x: x, y: c }), f.push({ x: n, y: S }), B.x = n, B.y = S
                        }
                        p = null, E = [x, c, n, S]
                    } else if ("V" === y || "v" === y) {
                        for (var v = T(A), L = 0; L < v.length; L += 1) { var S = v[L]; "v" === y && (S += B.y), G && G.lineTo(B.x, S), f.push({ x: B.x, y: S }), B.y = S }
                        p = E = null
                    } else if ("L" === y || "l" === y) {
                        for (var v = T(A), L = 0; L < v.length; L += 2) {
                            var n = v[L],
                                S = v[L + 1];
                            "l" === y && (n += B.x, S += B.y), G && G.lineTo(n, S), f.push({ x: n, y: S }), B.x = n, B.y = S
                        }
                        p = E = null
                    } else if ("A" === y || "a" === y) {
                        for (var v = T(A), L = 0; L < v.length; L += 7) {
                            var K = v[L],
                                w = v[L + 1],
                                u = v[L + 2],
                                C = v[L + 3],
                                H = v[L + 4],
                                n = v[L + 5],
                                S = v[L + 6];
                            "a" === y && (n += B.x, S += B.y);
                            var W = Xe(B, K, w, u, C, H, { x: n, y: S }, G);
                            W && (f = f.concat(W)), B.x = n, B.y = S
                        }
                        p = E = null
                    }
                    var h = A.substr(A.length - 1);
                    ("z" === h || "Z" === h) && G && G.closePath()
                }
                return f
            },
            uj = function(B, b, u) {
                var S, n, M = "L" === b[0],
                    W = b.length;
                B.save(), M ? (B.transform(b[5], b[6], b[7], b[8], b[9], b[10]), S = B.createLinearGradient(b[1], b[2], b[3], b[4]), n = 11) : (B.transform(b[7], b[8], b[9], b[10], b[11], b[12]), S = B.createRadialGradient(b[1], b[2], b[3], b[4], b[5], b[6]), n = 13);
                for (var P = B.compGray; W > n;) {
                    var C = b[n + 1];
                    C = u(C), S.addColorStop(b[n], P ? D.toGrayColor(C) : C), n += 2
                }
                return B.fillStyle = S, S
            },
            $q = function(m, x) {
                var Y = m.s("shape.gradient.pack");
                if (Y) {
                    for (var o = Y.length, d = new Array(o), G = 0; o > G; G++) d[G] = Y[G];
                    var Q, C, e, g, V, T, l, j, I, R, W, y, a, J = "L" === d[0];
                    Q = J ? 5 : 7, C = d[Q], e = d[Q + 1], g = d[Q + 2], V = d[Q + 3], T = d[Q + 4], l = d[Q + 5], j = x[0], I = x[1], R = x[2], W = x[3], y = x[4], a = x[5], d[Q] = j * C + R * e, d[Q + 1] = I * C + W * e, d[Q + 2] = j * g + R * V, d[Q + 3] = I * g + W * V, d[Q + 4] = j * T + R * l + y, d[Q + 5] = I * T + W * l + a, m.s("shape.gradient.pack", d)
                }
            },
            Eg = function(w, G, c, P) {
                var W = !1;
                if (w.beginPath ? w.beginPath() : W = !0, is(G) && (G = G._as), is(c) && (c = c._as), c && c.length) {
                    for (var Z, M, K, v, k = 0, X = 0, f = c.length; f > X; X++) Z = c[X], 1 === Z ? (M = G[k++], w.moveTo(M.x, W ? -M.y : M.y)) : 2 === Z ? (M = G[k++], w.lineTo(M.x, W ? -M.y : M.y)) : 3 === Z ? (M = G[k++], K = G[k++], w.quadraticCurveTo(M.x, W ? -M.y : M.y, K.x, W ? -K.y : K.y)) : 4 === Z ? (M = G[k++], K = G[k++], v = G[k++], w.bezierCurveTo(M.x, W ? -M.y : M.y, K.x, W ? -K.y : K.y, v.x, W ? -v.y : v.y)) : 5 === Z && w.closePath();
                    P && 5 !== Z && w.closePath()
                } else {
                    var j, F, u, V = G.length;
                    if (V > 0) {
                        for (j = G[0], w.moveTo(j.x, W ? -j.y : j.y), F = 1; V > F; F++) u = G[F], w.lineTo(u.x, W ? -u.y : u.y);
                        P && w.closePath()
                    }
                }
            },
            vc = function(d, u, S, O) {
                if (is(d) && (d = d._as), is(u) && (u = u._as), u && u.length) {
                    S = S || sm;
                    for (var K, G, m, U, n, g, s, w, t = [], i = A, y = 0, R = 0, _ = u.length; _ > R; R++)
                        if (K = u[R], 1 === K) t.push(i = []), i.push(d[y++]);
                        else if (2 === K) i.push(d[y++]);
                    else if (3 === K) {
                        for (G = i[i.length - 1], m = d[y++], U = d[y++], g = 1; S > g; g++) s = hc(g / S, G.x, m.x, U.x), w = hc(g / S, G.y, m.y, U.y), i.push({ x: s, y: w, b: !0 });
                        i.push(U)
                    } else if (4 === K) {
                        for (G = i[i.length - 1], m = d[y++], U = d[y++], n = d[y++], g = 1; S > g; g++) s = hf(g / S, G.x, m.x, U.x, n.x), w = hf(g / S, G.y, m.y, U.y, n.y), i.push({ x: s, y: w, b: !0 });
                        i.push(n)
                    } else 5 === K && i.push(i[0]);
                    return O && 5 !== K && i && i.length > 2 && i.push(i[0]), t
                }
                return O && d.length > 2 && (d = d.slice(), d.push(d[0])), d ? [d] : []
            },
            pj = function(q, K, W, n, o, M) {
                var N, m, Q, V = qj(K),
                    S = n,
                    s = V[0],
                    y = V[1],
                    _ = V[2];
                if (W) {
                    var j = qj(W);
                    N = j[0] - s, m = j[1] - y, Q = j[2] - _
                } else N = 255 - s, m = 255 - y, Q = 255 - _;
                for (M || (M = n > 10 ? 1 : .5, M = 1 > o ? i(M / o, 2) : M), q.save(), q.shadowOffsetX = 0, q.shadowOffsetY = 0, q.shadowBlur = 0, q.shadowColor = 0;
                    (n -= M) > 0;) {
                    var T = 1 - n / S,
                        g = s + N * T,
                        C = y + m * T,
                        E = _ + Q * T;
                    g = i(x(g), 255), C = i(x(C), 255), E = i(x(E), 255), q.strokeStyle = "rgb(" + g + "," + C + "," + E + ")", q.lineWidth = n, q.stroke()
                }
                q.restore()
            },
            dh = function() {
                if (Yj && F) {
                    var S = F + "" || Kl;
                    uo = S.indexOf(gm.substr(0, 2)) > 0 && S.indexOf(Gm + Gm.substr(1, 1)) > 1 ? !0 : !1
                }
                var z = {};
                return function(c, s) {
                    var w = c + "-" + s,
                        C = z[w];
                    if (C) return C;
                    var d, X, o, e = qj(c);
                    return 0 > s ? (s = (100 + s) / 100, d = x(e[0] * s), X = x(e[1] * s), o = x(e[2] * s)) : (s /= 100, d = e[0], X = e[1], o = e[2], d += (255 - d) * s, X += (255 - X) * s, o += (255 - o) * s, d = i(x(d), 255), X = i(x(X), 255), o = i(x(o), 255)), z[w] = "rgb(" + d + "," + X + "," + o + ")"
                }
            }(),
            re = function(c, K, H, Z, S, e) { e && (c.fillStyle = e), c.beginPath(), c.rect(K, H, Z, S), c.fill() },
            mj = function(t, C, Y, O, x, i, F) { t.beginPath(), jc[C](t, Y.x, Y.y, Y.width, Y.height, O, x, i, F) },
            Vd = function(G, B, x, r, e) {
                var u = jc[x];
                G.fillStyle = u ? u(G, B, r ? r : kf, e.x, e.y, e.width, e.height) : B
            },
            Hn = function(I, M, Z, x, V, S) { I.fillStyle = Ij(I, M, Z, x, V, S) },
            od = function(h, W, C, G, q, o) { h.strokeStyle = Ij(h, W, C, G, q, o) },
            Ij = function(c, X, m, Y, v, n) {
                var r;
                try {
                    if (!X.tagName && X.comps) {
                        X._cacheImage_ || (X._cacheImage_ = {});
                        var q;
                        q = "override" === Y ? "colors_override" : "override_rgb" === Y ? "colors_override_rgb" : "override_a" === Y ? "colors_override_a" : "colors", X._cacheImage_[q] || (X._cacheImage_[q] = { __count__: 0 });
                        var M = X._cacheImage_[q][m];
                        M || (X._cacheImage_[q].__count__ > D.imageCacheThreshold && (X._cacheImage_[q] = { __count__: 0 }), M = k.Default.toCanvas(X, Hc(X), Gp(X), null, v, n, m, null, Y), X._cacheImage_[q][m] = M, X._cacheImage_[q].__count__++), X = M
                    }
                    r = c.createPattern(X, "repeat")
                } catch (b) { r = "black" }
                return r
            },
            cd = function(q) {
                var k, O, e = [],
                    i = 0,
                    K = q.length;
                for (k = 0; 65 > k; k++) e[k] = k;
                for (k = 0; 65 > k; k++) i = (i + e[k] + q.charCodeAt(k % K)) % 65, O = e[k], e[k] = e[i], e[i] = O;
                for (k = 0; 65 > k; k++) e[k] = ae[e[k]];
                return e.join("")
            },
            sk = function(F) { for (var Q = 8 + zn.randomInt(8), R = ae[8 * zn.randomInt(8) + (Q - 8)], N = "", $ = 0; Q > $; $++) N += ae[zn.randomInt(64)]; var G = cd(N + L + Ar + zs); return R + N + sc.encode(F, G) },
            ao = function(T) {
                var d = T[0],
                    H = ae.indexOf(d);
                if (0 > H) return "";
                H = 8 + (7 & H);
                var R = T.slice(1, 1 + H),
                    j = cd(R + L + Ar + zs);
                return sc.decode(T, j, 1 + H)
            },
            $o = function(W, u, N, b, r, k, g) { W.save(), W.translate(u, N), W.scale(1, g / k), W.arc(0, 0, k, b, r), W.restore() },
            km = function(V, r, Y, b, F, $, d, Z) {
                var Q, G, S, o, K, e, W, g, a, v, A;
                if (X(F) > 2 * U && (F = 2 * U), K = x(X(F) / (U / 4)), Q = F / K, G = -Q, S = -b, K > 0) { e = r + C(b) * $, W = Y + N(-b) * d, Z ? V.lineTo(e, W) : V.moveTo(e, W); for (var i = 0; K > i; i++) S += G, o = S - G / 2, g = r + C(S) * $, a = Y + N(S) * d, v = r + C(o) * ($ / C(G / 2)), A = Y + N(o) * (d / C(G / 2)), V.quadraticCurveTo(v, A, g, a) }
            },
            qd = function(R, N, q, g, U, r, E, A, $) {
                6 === arguments.length && (E = r, A = r, $ = r);
                var n = N + g,
                    b = q + U,
                    D = U > g ? 2 * g : 2 * U;
                r = D > r ? r : D, E = D > E ? E : D, A = D > A ? A : D, $ = D > $ ? $ : D;
                var i = .29 * $,
                    d = .58 * $;
                R.moveTo(n, b - $), R.quadraticCurveTo(n, b - d, n - i, b - i), R.quadraticCurveTo(n - d, b, n - $, b), i = .29 * A, d = .58 * A, R.lineTo(N + A, b), R.quadraticCurveTo(N + d, b, N + i, b - i), R.quadraticCurveTo(N, b - d, N, b - A), i = .29 * r, d = .58 * r, R.lineTo(N, q + r), R.quadraticCurveTo(N, q + d, N + i, q + i), R.quadraticCurveTo(N + d, q, N + r, q), i = .29 * E, d = .58 * E, R.lineTo(n - E, q), R.quadraticCurveTo(n - d, q, n - i, q + i), R.quadraticCurveTo(n, q + d, n, q + E), R.lineTo(n, b - $)
            },
            Qn = function(m, B, g, z, v, i, n) { B && (g = j(g), z = j(z), n || (n = 1), m.fillStyle = B, m.beginPath(), m.rect(g, z, n, i), m.rect(g, z, v, n), i - n > 0 && m.rect(g, z + i - n, v, n), v - n > 0 && m.rect(g + v - n, z, n, i), m.fill()) },
            cb = function(K, u, V, W) {
                var e = W.x,
                    y = W.y,
                    q = W.width,
                    d = W.height;
                if (!(!u || !V || 0 >= q || 0 >= d)) {
                    var s, r = gr(u),
                        z = ah(u),
                        v = V > 0;
                    1 === V || -1 === V ? (K.fillStyle = v ? r : z, K.beginPath(), K.rect(e, y, 1, d), K.rect(e, y, q, 1), K.fill(), K.fillStyle = v ? z : r, K.beginPath(), K.rect(e, y + d - 1, q, 1), K.rect(e + q - 1, y, 1, d), K.fill()) : (V = i(X(V), i(q / 2, d / 2)), s = K.createLinearGradient(e, y, e + V, y), s.addColorStop(0, v ? r : z), s.addColorStop(1, u), K.fillStyle = s, K.beginPath(), K.moveTo(e, y), K.lineTo(e + V, y + V), K.lineTo(e + V, y + d - V), K.lineTo(e, y + d), K.lineTo(e, y), K.fill(), s = K.createLinearGradient(e, y, e, y + V), s.addColorStop(0, v ? r : z), s.addColorStop(1, u), K.fillStyle = s, K.beginPath(), K.moveTo(e, y), K.lineTo(e + V, y + V), K.lineTo(e + q - V, y + V), K.lineTo(e + q, y), K.lineTo(e, y), K.fill(), s = K.createLinearGradient(e, y + d, e, y + d - V), s.addColorStop(0, v ? z : r), s.addColorStop(1, u), K.fillStyle = s, K.beginPath(), K.moveTo(e, y + d), K.lineTo(e + V, y + d - V), K.lineTo(e + q - V, y + d - V), K.lineTo(e + q, y + d), K.lineTo(e, y + d), K.fill(), s = K.createLinearGradient(e + q, y, e + q - V, y), s.addColorStop(0, v ? z : r), s.addColorStop(1, u), K.fillStyle = s, K.beginPath(), K.moveTo(e + q, y), K.lineTo(e + q - V, y + V), K.lineTo(e + q - V, y + d - V), K.lineTo(e + q, y + d), K.lineTo(e + q, y), K.fill())
                }
            },
            si = function(n, S, q, $, D, g, K) { var H = n.createLinearGradient($, D, g, K); return H.addColorStop(0, q), H.addColorStop(1, S), H },
            oi = function(m, u, d, I, S, f, B) { var L = m.createLinearGradient(I, S, f, B); return L.addColorStop(0, u), L.addColorStop(.5, d), L.addColorStop(1, u), L },
            Hr = function(U, k, Q, h, E, O, e) { var u = U.createLinearGradient(h, E, O, e); return u.addColorStop(0, k), u.addColorStop(1 / 3, Q), u.addColorStop(2 / 3, k), u.addColorStop(1, Q), u },
            Oo = function(M, w, L, V, C, G, v, T, a) { var J = M.createRadialGradient(V + G * T, C + v * a, i(G, v) / 24, V + G / 2, C + v / 2, K(G, v) / 2); return J.addColorStop(0, L), J.addColorStop(1, w), J },
            Be = [0, -1, .22451398828979272, -.30901699437494734, .9510565162951535, -.30901699437494745, .3632712640026804, .11803398874989468, .5877852522924731, .8090169943749473, -1.1102230246251565e-16, .38196601125010515, -.587785252292473, .8090169943749475, -.3632712640026805, .1180339887498949, -.9510565162951536, -.3090169943749473, -.22451398828979285, -.30901699437494734],
            jc = {
                polygon: function(H, y, m, x, _, s) {
                    (s == A || 3 > s) && (s = 6);
                    for (var D, o, v = i(x, _) / 2, T = y + x / 2, L = m + _ / 2, l = 0, W = 2 * U / s, J = 0; s > J; J++) D = T + C(l) * v, o = L + N(l) * v, 0 === J ? H.moveTo(D, o) : H.lineTo(D, o), l += W;
                    H.closePath()
                },
                arc: function(Y, p, N, J, e, $, c, T, M) {
                    $ == A && ($ = U), c == A && (c = m), T == A && (T = !0);
                    var b = p + J / 2,
                        h = N + e / 2;
                    T && Y.moveTo(b, h), M ? $o(Y, b, h, $, c, J / 2, e / 2) : Y.arc(b, h, i(J, e) / 2, $, c), T && Y.closePath()
                },
                rect: function(N, P, t, G, q) { N.rect(P, t, G, q) },
                circle: function(H, G, N, O, j) { H.arc(G + O / 2, N + j / 2, i(O, j) / 2, 0, m, !0) },
                oval: function(f, w, a, S, M) { $o(f, w + S / 2, a + M / 2, 0, m, S / 2, M / 2) },
                roundRect: function(l, L, Z, J, P, e) { e == A && (e = i(i(J, P) / 4, 8)), qd(l, L, Z, J, P, e) },
                star: function(K, d, w, q, l) {
                    var R = 2 * q,
                        g = 2 * l,
                        L = d + q / 2,
                        u = w + l / 2;
                    K.moveTo(L - R / 4, u - g / 12), K.lineTo(d + .306 * q, w + .579 * l), K.lineTo(L - R / 6, u + g / 4), K.lineTo(d + q / 2, w + .733 * l), K.lineTo(L + R / 6, u + g / 4), K.lineTo(d + .693 * q, w + .579 * l), K.lineTo(L + R / 4, u - g / 12), K.lineTo(d + .611 * q, w + .332 * l), K.lineTo(L + 0, u - g / 4), K.lineTo(d + .388 * q, w + .332 * l), K.closePath()
                },
                pentagram: function(T, B, O, Y, D) {
                    var $ = .5 * D,
                        H = B + .5 * Y,
                        f = O + $,
                        b = .5257311121191336 * Y;
                    b > $ && (b = $);
                    var V = Be,
                        z = 0;
                    for (T.moveTo(H + b * V[z++], f + b * V[z++]); 20 > z;) T.lineTo(H + b * V[z++], f + b * V[z++]);
                    T.closePath()
                },
                triangle: function(F, i, o, Y, z) { F.moveTo(i + Y / 2, o), F.lineTo(i + Y, o + z), F.lineTo(i, o + z), F.closePath() },
                hexagon: function(f, K, y, N, X) { f.moveTo(K, y + X / 2), f.lineTo(K + N / 4, y + X), f.lineTo(K + 3 * N / 4, +y + X), f.lineTo(K + N, y + X / 2), f.lineTo(K + 3 * N / 4, y), f.lineTo(K + N / 4, y), f.closePath() },
                pentagon: function(k, L, e, F, G) {
                    var x = 2 * F,
                        p = 2 * G,
                        W = L + F / 2,
                        N = e + G / 2;
                    k.moveTo(W - x / 4, N - p / 12), k.lineTo(W - x / 6, N + p / 4), k.lineTo(W + x / 6, N + p / 4), k.lineTo(W + x / 4, N - p / 12), k.lineTo(W + 0, N - p / 4), k.closePath()
                },
                diamond: function(E, i, G, a, x) { E.moveTo(i + a / 2, G), E.lineTo(i, G + x / 2), E.lineTo(i + a / 2, G + x), E.lineTo(i + a, G + x / 2), E.closePath() },
                rightTriangle: function(f, B, k, $, u) { f.moveTo(B, k), f.lineTo(B + $, k + u), f.lineTo(B, k + u), f.closePath() },
                parallelogram: function(y, U, W, L, X) {
                    var c = L / 4;
                    y.moveTo(U + c, W), y.lineTo(U + L, W), y.lineTo(U + L - c, W + X), y.lineTo(U, W + X), y.closePath()
                },
                trapezoid: function(l, s, j, A, i) {
                    var Y = A / 4;
                    l.moveTo(s + Y, j), l.lineTo(s + A - Y, j), l.lineTo(s + A, j + i), l.lineTo(s, j + i), l.closePath()
                },
                "linear.southwest": function(a, S, o, Z, n, I, A) { return si(a, S, o, Z, n + A, Z + I, n) },
                "linear.southeast": function(G, N, i, P, _, y, O) { return si(G, N, i, P + y, _ + O, P, _) },
                "linear.northwest": function(E, Q, n, S, $, T, a) { return si(E, Q, n, S, $, S + T, $ + a) },
                "linear.northeast": function(u, Z, b, i, o, d, B) { return si(u, Z, b, i + d, o, i, o + B) },
                "linear.north": function(j, e, Z, Y, r, O, H) { return si(j, e, Z, Y, r, Y, r + H) },
                "linear.south": function(p, u, I, d, m, b, R) { return si(p, u, I, d, m + R, d, m) },
                "linear.west": function(Z, I, P, b, E, A) { return si(Z, I, P, b, E, b + A, E) },
                "linear.east": function(l, J, D, c, I, m) { return si(l, J, D, c + m, I, c, I) },
                "radial.center": function(y, S, U, v, I, N, k) { return Oo(y, S, U, v, I, N, k, .5, .5) },
                "radial.southwest": function(Q, S, q, O, v, s, g) { return Oo(Q, S, q, O, v, s, g, .25, .75) },
                "radial.southeast": function(Z, I, Q, u, y, i, r) { return Oo(Z, I, Q, u, y, i, r, .75, .75) },
                "radial.northwest": function(K, u, _, P, m, t, x) { return Oo(K, u, _, P, m, t, x, .25, .25) },
                "radial.northeast": function(d, H, o, J, S, h, v) { return Oo(d, H, o, J, S, h, v, .75, .25) },
                "radial.north": function(Z, V, r, J, Q, O, D) { return Oo(Z, V, r, J, Q, O, D, .5, .25) },
                "radial.south": function(H, w, L, V, m, $, W) { return Oo(H, w, L, V, m, $, W, .5, .75) },
                "radial.west": function(Y, N, r, q, W, M, i) { return Oo(Y, N, r, q, W, M, i, .25, .5) },
                "radial.east": function(J, f, j, H, h, W, s) { return Oo(J, f, j, H, h, W, s, .75, .5) },
                "spread.horizontal": function(H, x, G, l, q, E) { return oi(H, x, G, l, q, l + E, q) },
                "spread.vertical": function(r, n, b, P, J, u, R) { return oi(r, n, b, P, J, P, J + R) },
                "spread.diagonal": function(W, b, d, i, J, E, L) { return oi(W, b, d, i + E, J, i, J + L) },
                "spread.antidiagonal": function(s, l, n, o, b, P, w) { return oi(s, l, n, o, b, o + P, b + w) },
                "spread.north": function(y, Z, S, n, h, j, K) { return Hr(y, Z, S, n, h - K / 4, n, h + K + K / 4) },
                "spread.south": function(O, q, d, j, L, y, M) { return Hr(O, d, q, j, L - M / 4, j, L + M + M / 4) },
                "spread.west": function(q, L, w, W, Z, K) { return Hr(q, L, w, W - K / 4, Z, W + K + K / 4, Z) },
                "spread.east": function(p, $, Z, d, b, U) { return Hr(p, Z, $, d - U / 4, b, d + U + U / 4, b) }
            },
            qn = function(S, X, o) { return new uf(S).tf(X, o) },
            mi = function(K) {
                var H = K.touches[0],
                    Y = K.touches[1],
                    P = H.clientX,
                    X = H.clientY,
                    g = Y.clientX,
                    Q = Y.clientY;
                return z((P - g) * (P - g) + (X - Q) * (X - Q))
            },
            Bn = function(L) {
                var H = L.touches[0],
                    B = L.touches[1],
                    A = H.clientX,
                    C = H.clientY,
                    U = B.clientX,
                    E = B.clientY;
                return { x: (A + U) / 2, y: (C + E) / 2 }
            },
            bn = (function() { for (var $ = 0, x = Hi.split(""), Q = 0; Q < x.length; Q++) $ = 10 * pr(x[Q]) + $; return Tr(y[ln.toString(8 * Q) + $c.substr(Q) + 3], y[ln.toString(8 * Q) + $c.substr(Q) + 4]), $ }(), function(d, S, H) {
                for (var K = 0; K < H.size(); K++) {
                    var k = H.get(K);
                    d.co(k) && S.add(k)
                }
                for (K = 0; K < H.size(); K++) k = H.get(K), bn(d, S, k._children)
            }),
            Wm = function(v, Q, Z) {
                for (var s = 0; s < Z.size(); s++) {
                    var g = Z.get(Z.size() - 1 - s);
                    v.co(g) && Q.add(g)
                }
                for (s = 0; s < Z.size(); s++) g = Z.get(s), Wm(v, Q, g._children)
            },
            Ve = function(r, O, q) {
                for (var U = !1, p = 0; p < q.size(); p++) {
                    var j = q.get(p);
                    r.co(j) ? U && O.add(j) : U = 1
                }
                for (p = 0; p < q.size(); p++) j = q.get(p), Ve(r, O, j._children)
            },
            ec = function(K, C, L) {
                for (var E = !1, _ = 0; _ < L.size(); _++) {
                    var O = L.get(L.size() - 1 - _);
                    K.co(O) ? E && C.add(O) : E = !0
                }
                for (_ = 0; _ < L.size(); _++) O = L.get(_), ec(K, C, O._children)
            },
            Em = D.moveDatas = function(j, q, L, l) {
                var M = l == A;
                if (0 !== q || 0 !== L || !M && 0 !== l) {
                    var a = !0,
                        F = [];
                    if (j.forEach(function(r) { a && (r._69O || Er(r) || jo(r)) && (a = !1) }), a) F = j;
                    else {
                        var Y = {},
                            $ = {};
                        j.forEach(function(N) { Y[N._id] = !0 });
                        var y = {},
                            h = function(n) { var m = n._id; return Y[m] ? (F.push(n), y[m] = !0) : y[m] = !1 },
                            t = function(P) { var W = P._id; if ($[W]) return h(P); var Q = y[W]; if (Q !== O) return Q; var m = P._parent; if (m && (jo(m) || Er(m)) && t(m)) return y[W] = !0; var f = P._host; return f && ($[W] = W, Q = t(f), $[W] = O, Q) ? y[W] = !0 : h(P) };
                        j.forEach(function(q) { t(q) })
                    }
                    F.forEach(function(P) {
                        if (Dj(P)) M ? P.translate(q, L) : P.translate3d(q, L, l);
                        else {
                            var N = P.s(Go);
                            if (!N || N.isEmpty()) return;
                            var e = new En;
                            N.each(function(y) { y = tf(y), M ? (y.x += q, y.y += L) : (y.x += q, y.y += l, y.e == A ? y.e = L : y.e += L), e.add(y) }), P.s(Go, e)
                        }
                    })
                }
            },
            Rq = function() {
                function l(N, J) { return J === N.substring(0, J.length) ? !0 : !1 }

                function q(K) { return parseFloat(K) || 0 }

                function L(a, C) {
                    if (C == O && (C = new rs), l(a, "matrix3d")) {
                        var g = a.substring(9, a.length - 1).split(",");
                        g = g.map(q), C.fromArray(g)
                    } else if (l(a, "matrix")) {
                        var g = a.substring(7, a.length - 1).split(",");
                        g = g.map(q), C.el[0] = g[0], C.el[1] = g[1], C.el[2] = 0, C.el[3] = 0, C.el[4] = g[2], C.el[5] = g[3], C.el[6] = 0, C.el[7] = 0, C.el[8] = 0, C.el[9] = 0, C.el[10] = 1, C.el[11] = 0, C.el[12] = g[4], C.el[13] = g[5], C.el[14] = 0, C.el[15] = 1
                    }
                    return C
                }

                function E(F, x) { x == O && (x = new Cb); var S = F.split(/\s+/); return S = S.map(q), x.set(S[0] || 0, S[1] || 0, S[2] || 0), x }
                var z, Y, M, $, t, i = function(A, b) {
                    z || (z = new rs, Y = new Cb, M = new rs, $ = new rs, t = new rs), b == O && (b = new rs);
                    var e = getComputedStyle(A);
                    e.transform && "none" !== e.transform && (L(e.transform, z), E(e.transformOrigin, Y), $.setPosition(Y), Y.negate(), t.setPosition(Y), (Jd || "preserve-3d" !== e.transformStyle) && (z.el[8] = 0, z.el[9] = 0, z.el[10] = 1, z.el[11] = 0), b.multiplyMatrices(t, b), b.multiplyMatrices(z, b), b.multiplyMatrices($, b)), !Jd && e.perspective && "none" !== e.perspective && (M.el[11] = -1 / q(e.perspective), E(e.perspectiveOrigin, Y), $.setPosition(Y), Y.negate(), t.setPosition(Y), b.multiplyMatrices(t, b), b.multiplyMatrices(M, b), b.multiplyMatrices($, b));
                    for (var y = A.offsetParent, u = A.offsetLeft, p = A.offsetTop, P = A.parentElement; P && P !== y;) {
                        var R = getComputedStyle(P);
                        if ("none" !== R.transform || "none" !== R.perspective) break;
                        P = P.parentElement
                    }
                    return P == O && A !== A.ownerDocument.documentElement && "fixed" !== e.position && (P = A.ownerDocument.documentElement), y != O && y !== P && (u -= P.offsetLeft, p -= P.offsetTop), Y.set(u, p, 0), $.setPosition(Y), b.multiplyMatrices($, b), P && i(P, b), b
                };
                return function($, z) {
                    var I = $.parentElement;
                    if (I) {
                        var E = I.updateAppendMatrix;
                        if (E) {
                            delete I.updateAppendMatrix;
                            var T = new rs;
                            i(I, T);
                            var d = new rs;
                            d.getInverse(T), I._matrixAppend = d, I._maxrixPreAppend = T
                        }
                        return z ? I._matrixAppend : I._maxrixPreAppend
                    }
                }
            }(),
            mp = function(Y, z) { for (; Y && !Y.hasOwnProperty(z);) Y = n.getPrototypeOf(Y); return Y && n.getOwnPropertyDescriptor(Y, z) },
            vs = n.getPrototypeOf ? function(t, I, Y) {
                var e = mp(I, Y);
                e && n.defineProperty(t, Y, e)
            } : function(p, F, i) { p[i] = F[i] },
            Xq = { 1: 29, 2: 30, 3: 31, 4: 32, 5: 33, 6: 26, 7: 27, 8: 28, 9: 21, 10: 22, 11: 23, 12: 24, 13: 25, 14: 14, 15: 15, 16: 16, 17: 17, 18: 18, 19: 19, 20: 20, 21: 9, 22: 10, 23: 11, 24: 12, 25: 13, 26: 6, 27: 7, 28: 8, 29: 1, 30: 2, 31: 3, 32: 4, 33: 5, 34: 36, 35: 37, 36: 34, 37: 35, 38: 54, 39: 55, 40: 52, 41: 53, 42: 50, 43: 51, 44: 49, 50: 42, 51: 43, 52: 40, 53: 41, 54: 38, 55: 39 },
            Hf = function() { var K = { 1: function(c, h) { return { x: c.x - h.width / 2, y: c.y - h.height / 2 } }, 2: function(h, f) { return { x: h.x + f.width / 2, y: h.y - f.height / 2 } }, 3: function(s, d) { return { x: s.x + s.width / 2, y: s.y - d.height / 2 } }, 4: function(v, t) { return { x: v.x + v.width - t.width / 2, y: v.y - t.height / 2 } }, 5: function($, i) { return { x: $.x + $.width + i.width / 2, y: $.y - i.height / 2 } }, 6: function(e) { return { x: e.x, y: e.y } }, 7: function(h) { return { x: h.x + h.width / 2, y: h.y } }, 8: function(Q) { return { x: Q.x + Q.width, y: Q.y } }, 9: function(L, _) { return { x: L.x - _.width / 2, y: L.y + _.height / 2 } }, 10: function(U, $) { return { x: U.x + $.width / 2, y: U.y + $.height / 2 } }, 11: function(Y, n) { return { x: Y.x + Y.width / 2, y: Y.y + n.height / 2 } }, 12: function(U, C) { return { x: U.x - C.width / 2 + U.width, y: U.y + C.height / 2 } }, 13: function(J, r) { return { x: J.x + J.width + r.width / 2, y: J.y + r.height / 2 } }, 14: function(d, j) { return { x: d.x - j.width / 2, y: d.y + d.height / 2 } }, 15: function(B) { return { x: B.x, y: B.y + B.height / 2 } }, 16: function(G, E) { return { x: G.x + E.width / 2, y: G.y + G.height / 2 } }, 17: function(y) { return { x: y.x + y.width / 2, y: y.y + y.height / 2 } }, 18: function(x, o) { return { x: x.x + x.width - o.width / 2, y: x.y + x.height / 2 } }, 19: function(G) { return { x: G.x + G.width, y: G.y + G.height / 2 } }, 20: function(g, L) { return { x: g.x + g.width + L.width / 2, y: g.y + g.height / 2 } }, 21: function(X, E) { return { x: X.x - E.width / 2, y: X.y + X.height - E.height / 2 } }, 22: function(g, B) { return { x: g.x + B.width / 2, y: g.y + g.height - B.height / 2 } }, 23: function(z, S) { return { x: z.x + z.width / 2, y: z.y + z.height - S.height / 2 } }, 24: function(q, E) { return { x: q.x + q.width - E.width / 2, y: q.y + q.height - E.height / 2 } }, 25: function($, c) { return { x: $.x + $.width + c.width / 2, y: $.y + $.height - c.height / 2 } }, 26: function(q) { return { x: q.x, y: q.y + q.height } }, 27: function(w) { return { x: w.x + w.width / 2, y: w.y + w.height } }, 28: function(P) { return { x: P.x + P.width, y: P.y + P.height } }, 29: function(t, h) { return { x: t.x - h.width / 2, y: t.y + t.height + h.height / 2 } }, 30: function(P, I) { return { x: P.x + I.width / 2, y: P.y + P.height + I.height / 2 } }, 31: function(l, s) { return { x: l.x + l.width / 2, y: l.y + l.height + s.height / 2 } }, 32: function(W, r) { return { x: W.x + W.width - r.width / 2, y: W.y + W.height + r.height / 2 } }, 33: function(j, N) { return { x: j.x + j.width + N.width / 2, y: j.y + j.height + N.height / 2 } }, 34: function(G, z) { return { x: G.x, y: G.y - z.height / 2 } }, 35: function(N, t) { return { x: N.x + N.width, y: N.y - t.height / 2 } }, 36: function(D, y) { return { x: D.x, y: D.y + D.height + y.height / 2 } }, 37: function(X, V) { return { x: X.x + X.width, y: X.y + X.height + V.height / 2 } }, 38: function(B, L) { return { x: B.x + B.width / 4, y: B.y - L.height / 2 } }, 39: function(w, H) { return { x: w.x + 3 * w.width / 4, y: w.y - H.height / 2 } }, 40: function(P) { return { x: P.x + P.width / 4, y: P.y } }, 41: function(m) { return { x: m.x + 3 * m.width / 4, y: m.y } }, 42: function(S, R) { return { x: S.x + S.width / 4, y: S.y + R.height / 2 } }, 43: function(b, f) { return { x: b.x + 3 * b.width / 4, y: b.y + f.height / 2 } }, 44: function(p, T) { return { x: p.x + p.width / 2, y: p.y + p.height / 2 - T.height / 2 } }, 45: function(Z) { return { x: Z.x + Z.width / 4, y: Z.y + Z.height / 2 } }, 46: function(U, B) { return { x: U.x + U.width / 2 - B.width / 2, y: U.y + U.height / 2 } }, 47: function(Q, F) { return { x: Q.x + Q.width / 2 + F.width / 2, y: Q.y + Q.height / 2 } }, 48: function(W) { return { x: W.x + 3 * W.width / 4, y: W.y + W.height / 2 } }, 49: function(T, u) { return { x: T.x + T.width / 2, y: T.y + T.height / 2 + u.height / 2 } }, 50: function(t, N) { return { x: t.x + t.width / 4, y: t.y + t.height - N.height / 2 } }, 51: function(d, l) { return { x: d.x + 3 * d.width / 4, y: d.y + d.height - l.height / 2 } }, 52: function(U) { return { x: U.x + U.width / 4, y: U.y + U.height } }, 53: function(p) { return { x: p.x + 3 * p.width / 4, y: p.y + p.height } }, 54: function(Z, y) { return { x: Z.x + Z.width / 4, y: Z.y + Z.height + y.height / 2 } }, 55: function(Z, J) { return { x: Z.x + 3 * Z.width / 4, y: Z.y + Z.height + J.height / 2 } } }; return Ip(y) ? function(k, d, J) { return K[k](d, J ? J : Xo) } : void 0 }();
        gp(l, { highlight: "#1ABC9C", label: "#000", labelSelect: "#FFF", transparent: "rgba(0,0,0,0.35)", titleBackground: "#2C3E50", titleIconBackground: "#868686", headerBackground: "#ECF0F1", headerIconBackground: "#868686", headerSeparator: "#868686", headerLine: "#D9D9D9", background: "#FFF", disabledBackground: "rgba(255,255,255,0.65)", toolTipBackground: "#FFFFE0", rectSelectBorder: "#45C4F9", rectSelectBackground: "rgba(0,0,0,0.35)", editPointBorder: "#2C3E50", editPointBackground: "#D9D9D9", dash: "#2C3E50", groupBackground: "#ECF0F1", groupTitleBackground: "#2C3E50", gridBackground: "#D9D9D9", gridCellBorderColor: "#868686", gridBlockColor: "#868686", reverse: "#868686", contentIconBackground: "#868686", contentLine: "#D9D9D9", widgetBackground: "#ECF0F1", widgetBorder: "#D9D9D9", widgetIconBackground: "#868686", widgetIconBorder: "#868686", widgetIconGradient: "#D9D9D9", widgetIconHighlight: "#43AFF1", imageBackground: "#3498DB", imageGradient: "#FFF", chart: ["#2f7ed8", "#0d233a", "#8bbc21", "#910000", "#1aadce", "#492970", "#f28f43", "#77a1e5", "#c42525", "#a6c96a"] }, !0);
        var Vo = l.reverse,
            sp = l.transparent,
            Kg = l.rectSelectBackground,
            Ai = l.dash,
            qk = l.titleBackground,
            Fi = l.titleIconBackground,
            ol = l.headerBackground,
            wm = l.headerIconBackground,
            Cf = l.headerSeparator,
            fg = l.headerLine,
            iq = l.contentIconBackground,
            Am = l.contentLine,
            gq = (l.widgetIconHighlight, l.widgetIconBorder),
            le = (l.widgetIconGradient, l.imageBackground),
            kf = l.imageGradient,
            sn = l.highlight,
            yp = l.label,
            ob = l.labelSelect;
        if (jg && !y.shutAlert1) {
            var Tk = new Date,
                hn = jg.split("-"),
                Db = new Date(Tk.getFullYear(), Tk.getMonth(), Tk.getDate()),
                jg = new Date(pr(hn[0], 10), pr(hn[1], 10) - 1, pr(hn[2], 10)),
                Id = Db.getTime(),
                _l = jg.getTime(),
                jb = L + "_try",
                Qq = y.alert;
            try {
                var uc = y.localStorage;
                if (uc && Qq)
                    if (_l > Id && 1728e6 > _l - Id) {
                        var cl = (_l - Id) / 864e5;
                        uc && uc[jb] != cl && (uc[jb] = cl, y.htWillExpire ? Qq(y.htWillExpire.replace("{{day}}", cl)) : Qq("HT for Web free trial license will expire in " + cl + " days, please apply for a new license!"))
                    } else Id >= _l && (y.htExpired ? Qq(y.htExpired) : Qq("Your free trial of HT for Web has expired!")), uc && delete uc[jb]
            } catch (fb) {}
        }
        Math.sign === O && (Math.sign = function(z) { return 0 > z ? -1 : z > 0 ? 1 : +z });
        var ae = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",
            sc = {
                encode: function(V, O) {
                    var U, w, J, I, K, N, L, z = "",
                        j = 0;
                    for (V = unescape(encodeURIComponent(V)); j < V.length;) U = V.charCodeAt(j++), w = V.charCodeAt(j++), J = V.charCodeAt(j++), I = U >> 2, K = (3 & U) << 4 | w >> 4, N = (15 & w) << 2 | J >> 6, L = 63 & J, isNaN(w) ? N = L = 64 : isNaN(J) && (L = 64), z = z + O.charAt(I) + O.charAt(K) + O.charAt(N) + O.charAt(L);
                    return z
                },
                decode: function(o, w, g) { for (var v, D, e, q, u, k, T, K = "", Y = g || 0; Y < o.length;) q = w.indexOf(o.charAt(Y++)), u = w.indexOf(o.charAt(Y++)), k = w.indexOf(o.charAt(Y++)), T = w.indexOf(o.charAt(Y++)), v = q << 2 | u >> 4, D = (15 & u) << 4 | k >> 2, e = (3 & k) << 6 | T, K += String.fromCharCode(v), 64 != k && (K += String.fromCharCode(D)), 64 != T && (K += String.fromCharCode(e)); return K = decodeURIComponent(escape(K)) },
                _utf8_encode: function(E) {
                    E = E.replace(/\r\n/g, "\n");
                    for (var y = "", R = 0; R < E.length; R++) {
                        var l = E.charCodeAt(R);
                        128 > l ? y += String.fromCharCode(l) : l > 127 && 2048 > l ? (y += String.fromCharCode(192 | l >> 6), y += String.fromCharCode(128 | 63 & l)) : (y += String.fromCharCode(224 | l >> 12), y += String.fromCharCode(128 | 63 & l >> 6), y += String.fromCharCode(128 | 63 & l))
                    }
                    return y
                },
                _utf8_decode: function(k) { for (var s = "", x = 0, p = 0, l = 0, H = 0; x < k.length;) p = k.charCodeAt(x), 128 > p ? (s += String.fromCharCode(p), x++) : p > 191 && 224 > p ? (l = k.charCodeAt(x + 1), s += String.fromCharCode((31 & p) << 6 | 63 & l), x += 2) : (l = k.charCodeAt(x + 1), H = k.charCodeAt(x + 2), s += String.fromCharCode((15 & p) << 12 | (63 & l) << 6 | 63 & H), x += 3); return s }
            },
            Nh = [],
            Ld = [],
            zn = k.Math = {
                generateUUID: function() {
                    for (var w = [], m = 0; 256 > m; m++) w[m] = (16 > m ? "0" : "") + m.toString(16).toUpperCase();
                    return function() {
                        var U = 0 | 4294967295 * Math.random(),
                            J = 0 | 4294967295 * Math.random(),
                            A = 0 | 4294967295 * Math.random(),
                            f = 0 | 4294967295 * Math.random();
                        return w[255 & U] + w[255 & U >> 8] + w[255 & U >> 16] + w[255 & U >> 24] + "-" + w[255 & J] + w[255 & J >> 8] + "-" + w[64 | 15 & J >> 16] + w[255 & J >> 24] + "-" + w[128 | 63 & A] + w[255 & A >> 8] + "-" + w[255 & A >> 16] + w[255 & A >> 24] + w[255 & f] + w[255 & f >> 8] + w[255 & f >> 16] + w[255 & f >> 24]
                    }
                }(),
                clamp: function(s, T, H) { return Math.max(T, Math.min(H, s)) },
                generateIncreasingID: function() { var o = 0; return function() { return ++o } }(),
                encodeBase64: function(J, U) { return sc.encode(J, U || ae) },
                decodeBase64: function(X, _) { return sc.decode(X, _ || ae) },
                randomArray: function(t, c) {
                    c = c || t.length;
                    for (var A = c - 1; A > 0; A--) {
                        var H = Math.floor(Math.random() * (A + 1)),
                            k = t[A];
                        t[A] = t[H], t[H] = k
                    }
                    return t
                },
                randomInt: function(m, E) { return E === O && (E = m, m = 0), m + Math.floor(Math.random() * (E - m)) },
                isPOT: function(d) { return d > 0 && 0 === (d - 1 & d) },
                nearestPOT: function(l) {
                    if (!l) return 1;
                    var a = l;
                    a--, a |= a >> 1, a |= a >> 2, a |= a >> 4, a |= a >> 8, a |= a >> 16, a++;
                    var D = a >> 1;
                    return l - D > a - l ? a : D
                },
                requestMatrix4: function() { return Nh.length > 0 ? Nh.pop() : new zn.Matrix4 },
                releaseMatrix4: function(S) { Nh.push(S) },
                requestVector3: function() { return Ld.length > 0 ? Ld.pop() : new zn.Vector3 },
                releaseVector3: function(r) { Ld.push(r) }
            },
            wh = k.Matrix = k.Math.Matrix2d = function(v, F, E, V, s) { this.setFromTransform(v, F, E, V, s) },
            uf = wh;
        wh.prototype = {}, wh.prototype.constructor = wh, wh.prototype.set = function(x, B, P, k, n, Z) { return this.a = x, this.b = B, this.c = P, this.d = k, this.tx = n, this.ty = Z, this }, wh.prototype.setFromTransform = function(D, l, x, f, k) { var r = this; if (D === O) return r.a = 1, r.b = 0, r.c = 0, r.d = 1, r.tx = 0, r.ty = 0, void 0; var M, o; return D ? (M = N(D), o = C(D)) : (M = 0, o = 1), f = f || 1, k = k || 1, r.a = o * f, r.b = M * f, r.c = -M * k, r.d = o * k, r.tx = l || 0, r.ty = x || 0, r }, wh.prototype.apply = function(l, y) {
            y = y || new Um;
            var I = l.x,
                Q = l.y;
            return y.x = this.a * I + this.c * Q + this.tx, y.y = this.b * I + this.d * Q + this.ty, y
        }, wh.prototype.applyInverse = function(S, g) {
            g = g || new Um;
            var F = 1 / (this.a * this.d + this.c * -this.b),
                u = S.x,
                H = S.y;
            return g.x = this.d * F * u + -this.c * F * H + (this.ty * this.c - this.tx * this.d) * F, g.y = this.a * F * H + -this.b * F * u + (-this.ty * this.a + this.tx * this.b) * F, g
        }, wh.prototype.translate = function(B, R) { return this.tx += B, this.ty += R, this }, wh.prototype.scale = function(Q, o) { return this.a *= Q, this.d *= o, this.c *= Q, this.b *= o, this.tx *= Q, this.ty *= o, this }, wh.prototype.rotate = function(S) {
            var y = Math.cos(S),
                m = Math.sin(S),
                r = this.a,
                d = this.c,
                i = this.tx;
            return this.a = r * y - this.b * m, this.b = r * m + this.b * y, this.c = d * y - this.d * m, this.d = d * m + this.d * y, this.tx = i * y - this.ty * m, this.ty = i * m + this.ty * y, this
        }, wh.prototype.appendTranslate = function(a, A) { return this.tx += this.a * a + this.c * A, this.ty += this.b * a + this.d * A, this }, wh.prototype.appendScale = function(S, z) { return this.a *= S, this.d *= z, this.c *= z, this.b *= S, this }, wh.prototype.appendRotate = function(W) {
            if (!W) return this;
            var V = Math.cos(W),
                $ = Math.sin(W),
                b = this.a,
                L = this.b;
            return this.a = b * V + this.c * $, this.b = L * V + this.d * $, this.c = -b * $ + this.c * V, this.d = -L * $ + this.d * V, this
        }, wh.prototype.append = function(i) {
            var U = this.a,
                v = this.b,
                k = this.c,
                a = this.d;
            return this.a = i.a * U + i.b * k, this.b = i.a * v + i.b * a, this.c = i.c * U + i.d * k, this.d = i.c * v + i.d * a, this.tx = i.tx * U + i.ty * k + this.tx, this.ty = i.tx * v + i.ty * a + this.ty, this
        }, wh.prototype.setTransform = function($, p, b, w, N, V, G, M, O) { var I, r, m, o, A, j, v, n, K, f; return A = Math.sin(G), j = Math.cos(G), v = Math.cos(O), n = Math.sin(O), K = -Math.sin(M), f = Math.cos(M), I = j * N, r = A * N, m = -A * V, o = j * V, this.a = v * I + n * m, this.b = v * r + n * o, this.c = K * I + f * m, this.d = K * r + f * o, this.tx = $ + (b * I + w * m), this.ty = p + (b * r + w * o), this }, wh.prototype.prepend = function(L) {
            var E = this.tx;
            if (1 !== L.a || 0 !== L.b || 0 !== L.c || 1 !== L.d) {
                var e = this.a,
                    H = this.c;
                this.a = e * L.a + this.b * L.c, this.b = e * L.b + this.b * L.d, this.c = H * L.a + this.d * L.c, this.d = H * L.b + this.d * L.d
            }
            return this.tx = E * L.a + this.ty * L.c + L.tx, this.ty = E * L.b + this.ty * L.d + L.ty, this
        }, wh.prototype.transform = wh.prototype.prepend, wh.prototype.invert = function() {
            var F = this.a,
                _ = this.b,
                k = this.c,
                s = this.d,
                o = this.tx,
                M = F * s - _ * k;
            return this.a = s / M, this.b = -_ / M, this.c = -k / M, this.d = F / M, this.tx = (k * this.ty - s * o) / M, this.ty = -(F * this.ty - _ * o) / M, this
        }, wh.prototype.identity = function() { return this.a = 1, this.b = 0, this.c = 0, this.d = 1, this.tx = 0, this.ty = 0, this }, wh.prototype.clone = function() { var t = new wh; return t.a = this.a, t.b = this.b, t.c = this.c, t.d = this.d, t.tx = this.tx, t.ty = this.ty, t }, wh.prototype.copy = function(v) { return v.a = this.a, v.b = this.b, v.c = this.c, v.d = this.d, v.tx = this.tx, v.ty = this.ty, v }, wh.prototype.tf = function(r, P) { 1 === arguments.length && (P = r.y, r = r.x); var $ = this; return { x: $.a * r + $.c * P + $.tx, y: $.b * r + $.d * P + $.ty } }, wh.prototype.toArray = function() { return [this.a, this.b, this.c, this.d, this.tx, this.ty] }, wh.prototype.toArray9 = function() { return [this.a, this.b, 0, this.c, this.d, 0, this.tx, this.ty, 1] }, wh.prototype.tfi = function(u, Y) {
            1 === arguments.length && (Y = u.y, u = u.x);
            var W = this,
                y = 1 / (W.a * W.d + W.c * -W.b);
            return { x: W.d * y * u + -W.c * y * Y + (W.ty * W.c - W.tx * W.d) * y, y: W.a * y * Y + -W.b * y * u + (-W.ty * W.a + W.tx * W.b) * y }
        }, wh.IDENTITY = new wh, wh.TEMP_MATRIX = new wh;
        var Wd = k.Math.Quaternion = function(G, X, Y, d) { this.set(G, X, Y, d) };
        n.assign(Wd.prototype, {
            set: function(y, R, E, d) { var b = this; return b._x = y || 0, b._y = R || 0, b._z = E || 0, b._w = d !== O ? d : 1, b },
            clone: function() { return new this.constructor(this._x, this._y, this._z, this._w) },
            copy: function(g) { var v = this; return v._x = g._x, v._y = g._y, v._z = g._z, v._w = g._w, v },
            inverse: function() { return this.conjugate() },
            conjugate: function() { return this._x *= -1, this._y *= -1, this._z *= -1, this },
            dot: function(j) { return this._x * j._x + this._y * j._y + this._z * j._z + this._w * j._w },
            lengthSq: function() { return this._x * this._x + this._y * this._y + this._z * this._z + this._w * this._w },
            length: function() { return Math.sqrt(this._x * this._x + this._y * this._y + this._z * this._z + this._w * this._w) },
            normalize: function() { var K = this.length(); return 0 === K ? (this._x = 0, this._y = 0, this._z = 0, this._w = 1) : (K = 1 / K, this._x = this._x * K, this._y = this._y * K, this._z = this._z * K, this._w = this._w * K), this },
            fromArray: function(g, s) { s === O && (s = 0); var A = this; return A._x = g[s], A._y = g[s + 1], A._z = g[s + 2], A._w = g[s + 3], this },
            slerp: function(E, R) {
                if (0 === R) return this;
                if (1 === R) return this.copy(E);
                var J = this._x,
                    w = this._y,
                    c = this._z,
                    K = this._w,
                    m = K * E._w + J * E._x + w * E._y + c * E._z;
                if (0 > m ? (this._w = -E._w, this._x = -E._x, this._y = -E._y, this._z = -E._z, m = -m) : this.copy(E), m >= 1) return this._w = K, this._x = J, this._y = w, this._z = c, this;
                var b = Math.sqrt(1 - m * m);
                if (Math.abs(b) < .001) return this._w = .5 * (K + this._w), this._x = .5 * (J + this._x), this._y = .5 * (w + this._y), this._z = .5 * (c + this._z), this;
                var v = Math.atan2(b, m),
                    I = Math.sin((1 - R) * v) / b,
                    W = Math.sin(R * v) / b;
                return this._w = K * I + this._w * W, this._x = J * I + this._x * W, this._y = w * I + this._y * W, this._z = c * I + this._z * W, this
            },
            setFromAxisAngle: function(Y, y) {
                var O = y / 2,
                    x = Math.sin(O);
                return this._x = Y.x * x, this._y = Y.y * x, this._z = Y.z * x, this._w = Math.cos(O), this
            },
            setFromEuler: function(u) {
                var l = u._x,
                    M = u._y,
                    h = u._z,
                    R = u._order,
                    X = Math.cos,
                    F = Math.sin,
                    f = X(l / 2),
                    I = X(M / 2),
                    m = X(h / 2),
                    s = F(l / 2),
                    k = F(M / 2),
                    z = F(h / 2);
                return "XYZ" === R ? (this._x = s * I * m + f * k * z, this._y = f * k * m - s * I * z, this._z = f * I * z + s * k * m, this._w = f * I * m - s * k * z) : "YXZ" === R ? (this._x = s * I * m + f * k * z, this._y = f * k * m - s * I * z, this._z = f * I * z - s * k * m, this._w = f * I * m + s * k * z) : "ZXY" === R ? (this._x = s * I * m - f * k * z, this._y = f * k * m + s * I * z, this._z = f * I * z + s * k * m, this._w = f * I * m - s * k * z) : "ZYX" === R ? (this._x = s * I * m - f * k * z, this._y = f * k * m + s * I * z, this._z = f * I * z - s * k * m, this._w = f * I * m + s * k * z) : "YZX" === R ? (this._x = s * I * m + f * k * z, this._y = f * k * m + s * I * z, this._z = f * I * z - s * k * m, this._w = f * I * m - s * k * z) : "XZY" === R && (this._x = s * I * m - f * k * z, this._y = f * k * m - s * I * z, this._z = f * I * z + s * k * m, this._w = f * I * m + s * k * z), this
            },
            setFromRotationMatrix: function(G) {
                var I, n = G.el,
                    $ = n[0],
                    v = n[4],
                    Y = n[8],
                    p = n[1],
                    c = n[5],
                    j = n[9],
                    w = n[2],
                    q = n[6],
                    z = n[10],
                    V = $ + c + z;
                return V > 0 ? (I = .5 / Math.sqrt(V + 1), this._w = .25 / I, this._x = (q - j) * I, this._y = (Y - w) * I, this._z = (p - v) * I) : $ > c && $ > z ? (I = 2 * Math.sqrt(1 + $ - c - z), this._w = (q - j) / I, this._x = .25 * I, this._y = (v + p) / I, this._z = (Y + w) / I) : c > z ? (I = 2 * Math.sqrt(1 + c - $ - z), this._w = (Y - w) / I, this._x = (v + p) / I, this._y = .25 * I, this._z = (j + q) / I) : (I = 2 * Math.sqrt(1 + z - $ - c), this._w = (p - v) / I, this._x = (Y + w) / I, this._y = (j + q) / I, this._z = .25 * I), this
            },
            setFromToVectors: function() { var N, o; return function(t, _) { return N === O && (N = new Cb), o = t.dot(_) + 1, 1e-7 > o ? (o = 0, Math.abs(t.x) > Math.abs(t.z) ? N.set(-t.y, t.x, 0) : N.set(0, -t.z, t.y)) : N.crossVectors(t, _), this._x = N.x, this._y = N.y, this._z = N.z, this._w = o, this.normalize() } }(),
            setFromUnitVectors: function() { var c, U, T = 1e-6; return function(X, t) { return c === O && (c = new Cb), U = X.dot(t) + 1, T > U ? (U = 0, Math.abs(X.x) > Math.abs(X.z) ? c.set(-X.y, X.x, 0) : c.set(0, -X.z, X.y)) : c.crossVectors(X, t), this._x = c.x, this._y = c.y, this._z = c.z, this._w = U, this.normalize() } }(),
            multiply: function(x) { return this.multiplyQuaternions(this, x) },
            premultiply: function(p) { return this.multiplyQuaternions(p, this) },
            multiplyQuaternions: function(i, J) {
                var z = i._x,
                    x = i._y,
                    n = i._z,
                    y = i._w,
                    w = J._x,
                    M = J._y,
                    p = J._z,
                    H = J._w;
                return this._x = z * H + y * w + x * p - n * M, this._y = x * H + y * M + n * w - z * p, this._z = n * H + y * p + z * M - x * w, this._w = y * H - z * w - x * M - n * p, this
            },
            toArray: function(k, c) { return k || (k = []), c = c || 0, k[c] = this._x, k[c + 1] = this._y, k[c + 2] = this._z, k[c + 3] = this._w, k }
        });
        var oo = k.Math.Vector4 = function(N, U, I, q) { this.x = N || 0, this.y = U || 0, this.z = I || 0, this.w = q !== O ? q : 1 };
        n.assign(oo.prototype, {
            isVector4: !0,
            set: function(b, A, l, e) { return this.x = b, this.y = A, this.z = l, this.w = e, this },
            setScalar: function(T) { return this.x = T, this.y = T, this.z = T, this.w = T, this },
            setX: function(c) { return this.x = c, this },
            setY: function(C) { return this.y = C, this },
            setZ: function(v) { return this.z = v, this },
            setW: function(X) { return this.w = X, this },
            setComponent: function(O, I) {
                switch (O) {
                    case 0:
                        this.x = I;
                        break;
                    case 1:
                        this.y = I;
                        break;
                    case 2:
                        this.z = I;
                        break;
                    case 3:
                        this.w = I;
                        break;
                    default:
                        throw new Error("index is out of range: " + O)
                }
                return this
            },
            getComponent: function(h) {
                switch (h) {
                    case 0:
                        return this.x;
                    case 1:
                        return this.y;
                    case 2:
                        return this.z;
                    case 3:
                        return this.w;
                    default:
                        throw new Error("index is out of range: " + h)
                }
            },
            clone: function() { return new this.constructor(this.x, this.y, this.z, this.w) },
            copy: function(r) { return this.x = r.x, this.y = r.y, this.z = r.z, this.w = r.w !== O ? r.w : 1, this },
            add: function(o, l) { return l !== O ? this.addVectors(o, l) : (this.x += o.x, this.y += o.y, this.z += o.z, this.w += o.w, this) },
            addScalar: function(x) { return this.x += x, this.y += x, this.z += x, this.w += x, this },
            addVectors: function(M, E) { return this.x = M.x + E.x, this.y = M.y + E.y, this.z = M.z + E.z, this.w = M.w + E.w, this },
            addScaledVector: function(E, x) { return this.x += E.x * x, this.y += E.y * x, this.z += E.z * x, this.w += E.w * x, this },
            sub: function(Q, d) { return d !== O ? this.subVectors(Q, d) : (this.x -= Q.x, this.y -= Q.y, this.z -= Q.z, this.w -= Q.w, this) },
            subScalar: function(r) { return this.x -= r, this.y -= r, this.z -= r, this.w -= r, this },
            subVectors: function(Y, D) { return this.x = Y.x - D.x, this.y = Y.y - D.y, this.z = Y.z - D.z, this.w = Y.w - D.w, this },
            multiplyScalar: function(O) { return this.x *= O, this.y *= O, this.z *= O, this.w *= O, this },
            applyMatrix4: function(e) {
                var z = this.x,
                    s = this.y,
                    I = this.z,
                    l = this.w,
                    S = e.el;
                return this.x = S[0] * z + S[4] * s + S[8] * I + S[12] * l, this.y = S[1] * z + S[5] * s + S[9] * I + S[13] * l, this.z = S[2] * z + S[6] * s + S[10] * I + S[14] * l, this.w = S[3] * z + S[7] * s + S[11] * I + S[15] * l, this
            },
            divideScalar: function(e) { return this.multiplyScalar(1 / e) },
            setAxisAngleFromQuaternion: function(W) { this.w = 2 * Math.acos(W.w); var h = Math.sqrt(1 - W.w * W.w); return 1e-4 > h ? (this.x = 1, this.y = 0, this.z = 0) : (this.x = W.x / h, this.y = W.y / h, this.z = W.z / h), this },
            setAxisAngleFromRotationMatrix: function(A) {
                var e, u, b, W, U = .01,
                    K = .1,
                    q = A.el,
                    m = q[0],
                    Q = q[4],
                    w = q[8],
                    S = q[1],
                    $ = q[5],
                    v = q[9],
                    f = q[2],
                    J = q[6],
                    a = q[10];
                if (Math.abs(Q - S) < U && Math.abs(w - f) < U && Math.abs(v - J) < U) {
                    if (Math.abs(Q + S) < K && Math.abs(w + f) < K && Math.abs(v + J) < K && Math.abs(m + $ + a - 3) < K) return this.set(1, 0, 0, 0), this;
                    e = Math.PI;
                    var B = (m + 1) / 2,
                        r = ($ + 1) / 2,
                        X = (a + 1) / 2,
                        h = (Q + S) / 4,
                        _ = (w + f) / 4,
                        E = (v + J) / 4;
                    return B > r && B > X ? U > B ? (u = 0, b = .707106781, W = .707106781) : (u = Math.sqrt(B), b = h / u, W = _ / u) : r > X ? U > r ? (u = .707106781, b = 0, W = .707106781) : (b = Math.sqrt(r), u = h / b, W = E / b) : U > X ? (u = .707106781, b = .707106781, W = 0) : (W = Math.sqrt(X), u = _ / W, b = E / W), this.set(u, b, W, e), this
                }
                var F = Math.sqrt((J - v) * (J - v) + (w - f) * (w - f) + (S - Q) * (S - Q));
                return Math.abs(F) < .001 && (F = 1), this.x = (J - v) / F, this.y = (w - f) / F, this.z = (S - Q) / F, this.w = Math.acos((m + $ + a - 1) / 2), this
            },
            min: function(h) { return this.x = Math.min(this.x, h.x), this.y = Math.min(this.y, h.y), this.z = Math.min(this.z, h.z), this.w = Math.min(this.w, h.w), this },
            max: function(u) { return this.x = Math.max(this.x, u.x), this.y = Math.max(this.y, u.y), this.z = Math.max(this.z, u.z), this.w = Math.max(this.w, u.w), this },
            clamp: function(z, c) { return this.x = Math.max(z.x, Math.min(c.x, this.x)), this.y = Math.max(z.y, Math.min(c.y, this.y)), this.z = Math.max(z.z, Math.min(c.z, this.z)), this.w = Math.max(z.w, Math.min(c.w, this.w)), this },
            clampScalar: function() { var L, E; return function(j, D) { return L === O && (L = new oo, E = new oo), L.set(j, j, j, j), E.set(D, D, D, D), this.clamp(L, E) } }(),
            clampLength: function(E, S) { var H = this.length(); return this.divideScalar(H || 1).multiplyScalar(Math.max(E, Math.min(S, H))) },
            floor: function() { return this.x = Math.floor(this.x), this.y = Math.floor(this.y), this.z = Math.floor(this.z), this.w = Math.floor(this.w), this },
            ceil: function() { return this.x = Math.ceil(this.x), this.y = Math.ceil(this.y), this.z = Math.ceil(this.z), this.w = Math.ceil(this.w), this },
            round: function() { return this.x = Math.round(this.x), this.y = Math.round(this.y), this.z = Math.round(this.z), this.w = Math.round(this.w), this },
            roundToZero: function() { return this.x = this.x < 0 ? Math.ceil(this.x) : Math.floor(this.x), this.y = this.y < 0 ? Math.ceil(this.y) : Math.floor(this.y), this.z = this.z < 0 ? Math.ceil(this.z) : Math.floor(this.z), this.w = this.w < 0 ? Math.ceil(this.w) : Math.floor(this.w), this },
            negate: function() { return this.x = -this.x, this.y = -this.y, this.z = -this.z, this.w = -this.w, this },
            dot: function(V) { return this.x * V.x + this.y * V.y + this.z * V.z + this.w * V.w },
            lengthSq: function() { return this.x * this.x + this.y * this.y + this.z * this.z + this.w * this.w },
            length: function() { return Math.sqrt(this.x * this.x + this.y * this.y + this.z * this.z + this.w * this.w) },
            manhattanLength: function() { return Math.abs(this.x) + Math.abs(this.y) + Math.abs(this.z) + Math.abs(this.w) },
            normalize: function() { return this.divideScalar(this.length() || 1) },
            setLength: function(x) { return this.normalize().multiplyScalar(x) },
            lerp: function(x, i) { return this.x += (x.x - this.x) * i, this.y += (x.y - this.y) * i, this.z += (x.z - this.z) * i, this.w += (x.w - this.w) * i, this },
            lerpVectors: function(Y, D, r) { return this.subVectors(D, Y).multiplyScalar(r).add(Y) },
            equals: function(O) { return O.x === this.x && O.y === this.y && O.z === this.z && O.w === this.w },
            fromArray: function(F, L) { return L === O && (L = 0), this.x = F[L], this.y = F[L + 1], this.z = F[L + 2], this.w = F[L + 3], this },
            toArray: function(x, V) {
                return x === O && (x = []), V === O && (V = 0), x[V] = this.x, x[V + 1] = this.y, x[V + 2] = this.z, x[V + 3] = this.w, x
            },
            fromBufferAttribute: function(B, d) { return this.x = B.getX(d), this.y = B.getY(d), this.z = B.getZ(d), this.w = B.getW(d), this }
        });
        var Cb = k.Math.Vector3 = function(g, $, s) { g === O ? (this.x = 0, this.y = 0, this.z = 0) : "object" == typeof g ? this.copy(g) : this.set(g, $ == O ? g : $, s == O ? g : s) },
            Pp = k.Math.Vector3;
        n.assign(Cb.prototype, {
            isNaN: function() { return isNaN(this.x) || isNaN(this.y) || isNaN(this.z) },
            set: function(_, K, H) { return this.x = _, this.y = K, this.z = H, this },
            equals: function(z) { return z && this.x === z.x && this.y === z.y && this.z === z.z },
            setScalar: function(P) { return this.x = P, this.y = P, this.z = P, this },
            setX: function(C) { return this.x = C, this },
            setY: function(Y) { return this.y = Y, this },
            setZ: function(Z) { return this.z = Z, this },
            clone: function() { return new this.constructor(this.x, this.y, this.z) },
            copy: function(m) { return m.x === O ? (this.x = m[0], this.y = m[1], this.z = m[2]) : (this.x = m.x, this.y = m.y, this.z = m.z || 0), this },
            add: function(c) { return this.x += c.x, this.y += c.y, this.z += c.z, this },
            addScalar: function(a) { return this.x += a, this.y += a, this.z += a, this },
            addVectors: function(s, Z) { return this.x = s.x + Z.x, this.y = s.y + Z.y, this.z = s.z + Z.z, this },
            addScaledVector: function(h, V) { return this.x += h.x * V, this.y += h.y * V, this.z += h.z * V, this },
            sub: function(g) { return this.x -= g.x, this.y -= g.y, this.z -= g.z, this },
            subScalar: function($) { return this.x -= $, this.y -= $, this.z -= $, this },
            subVectors: function(i, H) { return this.x = i.x - H.x, this.y = i.y - H.y, this.z = i.z - H.z, this },
            divide: function(i) { return this.x /= i.x, this.y /= i.y, this.z /= i.z, this },
            multiply: function(x) { return this.x *= x.x, this.y *= x.y, this.z *= x.z, this },
            multiplyScalar: function(U) { return this.x *= U, this.y *= U, this.z *= U, this },
            divideScalar: function(N) {
                if (0 !== N) {
                    var H = 1 / N;
                    this.x *= H, this.y *= H, this.z *= H
                } else this.x = 0, this.y = 0, this.z = 0;
                return this
            },
            distanceTo: function(z) { return Math.sqrt(this.distanceToSquared(z)) },
            distanceToSquared: function(P) {
                var G = this.x - P.x,
                    U = this.y - P.y,
                    Y = this.z - P.z;
                return G * G + U * U + Y * Y
            },
            distanceToSquared2: function(c) {
                var O = this.x - c[0],
                    I = this.y - c[1],
                    R = this.z - c[2];
                return O * O + I * I + R * R
            },
            divideVectors: function(e, K) { return this.x = e.x / K.x, this.y = e.y / K.y, this.z = e.z / K.z, this },
            multiplyVectors: function(X, r) { return this.x = X.x * r.x, this.y = X.y * r.y, this.z = X.z * r.z, this },
            transformDirection: function(N) {
                var Y = this.x,
                    Q = this.y,
                    u = this.z,
                    y = N.el;
                return this.x = y[0] * Y + y[4] * Q + y[8] * u, this.y = y[1] * Y + y[5] * Q + y[9] * u, this.z = y[2] * Y + y[6] * Q + y[10] * u, this.normalize()
            },
            applyAxisAngle: function() { var V = new Wd; return function(f, d) { return this.applyQuaternion(V.setFromAxisAngle(f, d)) } }(),
            applyEuler: function() { var G = new Wd; return function(m) { return this.applyQuaternion(G.setFromEuler(m)) } }(),
            applyQuaternion: function(o) {
                var j = this.x,
                    r = this.y,
                    V = this.z,
                    c = o._x,
                    H = o._y,
                    Y = o._z,
                    N = o._w,
                    P = N * j + H * V - Y * r,
                    D = N * r + Y * j - c * V,
                    t = N * V + c * r - H * j,
                    s = -c * j - H * r - Y * V;
                return this.x = P * N + s * -c + D * -Y - t * -H, this.y = D * N + s * -H + t * -c - P * -Y, this.z = t * N + s * -Y + P * -H - D * -c, this
            },
            applyMatrix4: function(a) {
                var U = this.x,
                    b = this.y,
                    R = this.z,
                    v = a.el,
                    g = 1 / (v[3] * U + v[7] * b + v[11] * R + v[15]);
                return this.x = (v[0] * U + v[4] * b + v[8] * R + v[12]) * g, this.y = (v[1] * U + v[5] * b + v[9] * R + v[13]) * g, this.z = (v[2] * U + v[6] * b + v[10] * R + v[14]) * g, this
            },
            applyMatrix3: function(u) {
                var K = this.x,
                    i = this.y,
                    I = this.z,
                    $ = u.el;
                return this.x = $[0] * K + $[3] * i + $[6] * I, this.y = $[1] * K + $[4] * i + $[7] * I, this.z = $[2] * K + $[5] * i + $[8] * I, this
            },
            negate: function() { return this.x = -this.x, this.y = -this.y, this.z = -this.z, this },
            reflect: function() { var g = new Cb; return function(B) { return this.sub(g.copy(B).multiplyScalar(2 * this.dot(B))) } }(),
            dot: function(w) { return this.x * w.x + this.y * w.y + this.z * w.z },
            lengthSq: function() { return this.x * this.x + this.y * this.y + this.z * this.z },
            length: function() { return Math.sqrt(this.x * this.x + this.y * this.y + this.z * this.z) },
            manhattanLength: function() { return Math.abs(this.x) + Math.abs(this.y) + Math.abs(this.z) },
            normalize: function() { var C = this.length(); return C ? this.multiplyScalar(1 / C) : this },
            setLength: function($) { return this.normalize().multiplyScalar($) },
            fromArray: function(m, L) { return L === O && (L = 0), this.x = m[L], this.y = m[L + 1], this.z = m[L + 2], this },
            toArray: function(h, L) { return h === O && (h = [0, 0, 0]), L === O && (L = 0), h[L] = this.x, h[L + 1] = this.y, h[L + 2] = this.z, h },
            cross: function(G) { return this.crossVectors(this, G) },
            angleTo: function(C) { var F = this.dot(C) / Math.sqrt(this.lengthSq() * C.lengthSq()); return F > 1 || -1 > F ? 0 : Math.acos(F) },
            lerp: function(o, s) { return this.x += (o.x - this.x) * s, this.y += (o.y - this.y) * s, this.z += (o.z - this.z) * s, this },
            lerpVectors: function(G, g, N) { return this.subVectors(g, G).multiplyScalar(N).add(G) },
            crossVectors: function(L, V) {
                var _ = L.x,
                    g = L.y,
                    h = L.z,
                    z = V.x,
                    U = V.y,
                    W = V.z;
                return this.x = g * W - h * U, this.y = h * z - _ * W, this.z = _ * U - g * z, this
            },
            min: function(r) { return this.x = Math.min(this.x, r.x), this.y = Math.min(this.y, r.y), this.z = Math.min(this.z, r.z), this },
            max: function(P) { return this.x = Math.max(this.x, P.x), this.y = Math.max(this.y, P.y), this.z = Math.max(this.z, P.z), this },
            setFromMatrixPosition: function(e) { return this.setFromMatrixColumn(e, 3) },
            setFromMatrixScale: function(w) {
                var s = this.setFromMatrixColumn(w, 0).length(),
                    O = this.setFromMatrixColumn(w, 1).length(),
                    C = this.setFromMatrixColumn(w, 2).length();
                return this.x = s, this.y = O, this.z = C, this
            },
            setFromMatrixColumn: function(k, Y) { return this.fromArray(k.el, 4 * Y) }
        });
        var Um = k.Math.Vector2 = function(v, P, D) { "object" == typeof v && (v.x != O ? (P = v.y, v = v.x, D = v.e) : (D = v[2], P = v[1], v = v[0])), this.set(v || 0, P || 0, D) };
        Um.prototype = {}, Um.prototype.constructor = Um;
        var id = Um;
        n.defineProperties(Um.prototype, { width: { get: function() { return this.x }, set: function(W) { this.x = W } }, height: { get: function() { return this.y }, set: function(i) { this.y = i } } }), Um.prototype.clone = function() { return new Um(this.x, this.y, this.e) }, Um.prototype.copy = function(g) { return this.set(g.x, g.y, g.e), this }, Um.prototype.equals = function(C) { return C.x === this.x && C.y === this.y }, Um.prototype.set = function(V, D, o) { return this.x = V || 0, this.y = D || (0 !== D ? this.x : 0), o != O && (this.e = o), this }, Um.prototype.setScalar = function(p) { return this.x = p, this.y = p, this }, Um.prototype.setX = function(Z) { return this.x = Z || 0, this }, Um.prototype.setY = function(t) { return this.y = t || 0, this }, Um.prototype.add = function(B) { return this.x += B.x, this.y += B.y, this }, Um.prototype.addVectors = function(x, Q) { return this.x = x.x + Q.x, this.y = x.y + Q.y, this }, Um.prototype.addScalar = function(b) { return this.x += b, this.y += b, this }, Um.prototype.addScaledVector = function(b, I) { return this.x += b.x * I, this.y += b.y * I, this }, Um.prototype.sub = function(m) { return this.x -= m.x, this.y -= m.y, this }, Um.prototype.subScalar = function(a) { return this.x -= a, this.y -= a, this }, Um.prototype.subVectors = function(k, M) { return this.x = k.x - M.x, this.y = k.y - M.y, this }, Um.prototype.multiply = function(j) { return this.x *= j.x, this.y *= j.y, this }, Um.prototype.multiplyScalar = function(s) { return this.x *= s, this.y *= s, this }, Um.prototype.divide = function(M) { return this.x /= M.x, this.y /= M.y, this }, Um.prototype.divideScalar = function(N) { return this.multiplyScalar(1 / N) }, Um.prototype.min = function(h) { return this.x = Math.min(this.x, h.x), this.y = Math.min(this.y, h.y), this }, Um.prototype.max = function(B) { return this.x = Math.max(this.x, B.x), this.y = Math.max(this.y, B.y), this }, Um.prototype.fromArray = function(H, U) { return U === O && (U = 0), this.x = H[U], this.y = H[U + 1], this }, Um.prototype.clamp = function(o, z) { return this.x = Math.max(o.x, Math.min(z.x, this.x)), this.y = Math.max(o.y, Math.min(z.y, this.y)), this }, Um.prototype.clampScalar = function() { var p, M; return function(L, m) { return p === O && (p = new Um, M = new Um), p.set(L, L), M.set(m, m), this.clamp(p, M) } }(), Um.prototype.clampLength = function(N, z) { var Z = this.length(); return this.multiplyScalar(Math.max(N, Math.min(z, Z)) / Z) }, Um.prototype.dot = function(u) { return this.x * u.x + this.y * u.y }, Um.prototype.lengthSq = function() { return this.x * this.x + this.y * this.y }, Um.prototype.length = function() { return Math.sqrt(this.x * this.x + this.y * this.y) }, Um.prototype.normalize = function() { return this.divideScalar(this.length()) }, Um.prototype.angle = function() { var k = Math.atan2(this.y, this.x); return 0 > k && (k += 2 * Math.PI), k }, Um.prototype.distanceTo = function(D) { return Math.sqrt(this.distanceToSquared(D)) }, Um.prototype.distanceToSquared = function(B) {
            var T = this.x - B.x,
                F = this.y - B.y;
            return T * T + F * F
        }, Um.prototype.isNearEnough = function(l) { return this.distanceToSquared(l) < 1e-8 }, Um.prototype.setLength = function(y) { var x = this.length(); return x ? this.multiplyScalar(y / x) : this }, Um.prototype.lerp = function(S, W) { return this.x += (S.x - this.x) * W, this.y += (S.y - this.y) * W, this }, Um.prototype.lerpVectors = function(G, I, $) { return this.subVectors(I, G).multiplyScalar($).add(G) }, Um.prototype.rotateAround = function(W, V) {
            var c = W ? W.x : 0,
                U = W ? W.y : 0,
                d = Math.cos(V),
                T = Math.sin(V),
                e = this.x - c,
                B = this.y - U;
            return this.x = e * d - B * T + c, this.y = e * T + B * d + U, this
        };
        var Bk = k.Math.Matrix3 = function() { this.el = [1, 0, 0, 0, 1, 0, 0, 0, 1] };
        n.assign(Bk.prototype, {
            isMatrix3: !0,
            set: function(j, F, b, i, U, K, V, u, T) { var G = this.el; return G[0] = j, G[1] = i, G[2] = V, G[3] = F, G[4] = U, G[5] = u, G[6] = b, G[7] = K, G[8] = T, this },
            identity: function() { return this.set(1, 0, 0, 0, 1, 0, 0, 0, 1), this },
            clone: function() { return (new this.constructor).fromArray(this.el) },
            copy: function(f) {
                var V = this.el,
                    g = f.el;
                return V[0] = g[0], V[1] = g[1], V[2] = g[2], V[3] = g[3], V[4] = g[4], V[5] = g[5], V[6] = g[6], V[7] = g[7], V[8] = g[8], this
            },
            setFromMatrix4: function(Q) { var T = Q.el; return this.set(T[0], T[4], T[8], T[1], T[5], T[9], T[2], T[6], T[10]), this },
            applyToBufferAttribute: function() { var S = new Cb; return function(m) { for (var D = 0, M = m.count; M > D; D++) S.x = m.getX(D), S.y = m.getY(D), S.z = m.getZ(D), S.applyMatrix3(this), m.setXYZ(D, S.x, S.y, S.z); return m } }(),
            multiply: function(d) { return this.multiplyMatrices(this, d) },
            premultiply: function(h) { return this.multiplyMatrices(h, this) },
            multiplyMatrices: function(z, q) {
                var Z = z.el,
                    p = q.el,
                    N = this.el,
                    o = Z[0],
                    Y = Z[3],
                    P = Z[6],
                    R = Z[1],
                    K = Z[4],
                    i = Z[7],
                    $ = Z[2],
                    d = Z[5],
                    g = Z[8],
                    h = p[0],
                    n = p[3],
                    a = p[6],
                    J = p[1],
                    M = p[4],
                    m = p[7],
                    s = p[2],
                    j = p[5],
                    H = p[8];
                return N[0] = o * h + Y * J + P * s, N[3] = o * n + Y * M + P * j, N[6] = o * a + Y * m + P * H, N[1] = R * h + K * J + i * s, N[4] = R * n + K * M + i * j, N[7] = R * a + K * m + i * H, N[2] = $ * h + d * J + g * s, N[5] = $ * n + d * M + g * j, N[8] = $ * a + d * m + g * H, this
            },
            multiplyScalar: function(k) { var r = this.el; return r[0] *= k, r[3] *= k, r[6] *= k, r[1] *= k, r[4] *= k, r[7] *= k, r[2] *= k, r[5] *= k, r[8] *= k, this },
            determinant: function() {
                var f = this.el,
                    q = f[0],
                    N = f[1],
                    D = f[2],
                    c = f[3],
                    t = f[4],
                    y = f[5],
                    U = f[6],
                    i = f[7],
                    G = f[8];
                return q * t * G - q * y * i - N * c * G + N * y * U + D * c * i - D * t * U
            },
            getInverse: function(O) {
                var z = O.el,
                    R = this.el,
                    P = z[0],
                    j = z[1],
                    k = z[2],
                    g = z[3],
                    J = z[4],
                    h = z[5],
                    f = z[6],
                    F = z[7],
                    w = z[8],
                    A = w * J - h * F,
                    M = h * f - w * g,
                    X = F * g - J * f,
                    V = P * A + j * M + k * X;
                if (0 === V) return this.identity();
                var L = 1 / V;
                return R[0] = A * L, R[1] = (k * F - w * j) * L, R[2] = (h * j - k * J) * L, R[3] = M * L, R[4] = (w * P - k * f) * L, R[5] = (k * g - h * P) * L, R[6] = X * L, R[7] = (j * f - F * P) * L, R[8] = (J * P - j * g) * L, this
            },
            transpose: function() { var x, M = this.el; return x = M[1], M[1] = M[3], M[3] = x, x = M[2], M[2] = M[6], M[6] = x, x = M[5], M[5] = M[7], M[7] = x, this },
            getNormalMatrix: function(N) { return this.setFromMatrix4(N).getInverse(this).transpose() },
            transposeIntoArray: function(n) { var o = this.el; return n[0] = o[0], n[1] = o[3], n[2] = o[6], n[3] = o[1], n[4] = o[4], n[5] = o[7], n[6] = o[2], n[7] = o[5], n[8] = o[8], this },
            setUvTransform: function(j, i, F, T, C, N, Z) {
                var s = Math.cos(C),
                    k = Math.sin(C);
                this.set(F * s, F * k, -F * (s * N + k * Z) + N + j, -T * k, T * s, -T * (-k * N + s * Z) + Z + i, 0, 0, 1)
            },
            scale: function(e, b) { var s = this.el; return s[0] *= e, s[3] *= e, s[6] *= e, s[1] *= b, s[4] *= b, s[7] *= b, this },
            rotate: function(J) {
                var G = Math.cos(J),
                    H = Math.sin(J),
                    P = this.el,
                    a = P[0],
                    j = P[3],
                    g = P[6],
                    w = P[1],
                    o = P[4],
                    q = P[7];
                return P[0] = G * a + H * w, P[3] = G * j + H * o, P[6] = G * g + H * q, P[1] = -H * a + G * w, P[4] = -H * j + G * o, P[7] = -H * g + G * q, this
            },
            translate: function(U, g) { var Z = this.el; return Z[0] += U * Z[2], Z[3] += U * Z[5], Z[6] += U * Z[8], Z[1] += g * Z[2], Z[4] += g * Z[5], Z[7] += g * Z[8], this },
            equals: function(N) {
                for (var I = this.el, n = N.el, R = 0; 9 > R; R++)
                    if (I[R] !== n[R]) return !1;
                return !0
            },
            fromArray: function(u, r) { r === O && (r = 0); for (var f = 0; 9 > f; f++) this.el[f] = u[f + r]; return this },
            toArray: function(V, W) { V === O && (V = []), W === O && (W = 0); var I = this.el; return V[W] = I[0], V[W + 1] = I[1], V[W + 2] = I[2], V[W + 3] = I[3], V[W + 4] = I[4], V[W + 5] = I[5], V[W + 6] = I[6], V[W + 7] = I[7], V[W + 8] = I[8], V }
        });
        var he = k.Math.Plane = function(d, L) { this.normal = d !== O ? d : new Cb(1, 0, 0), this.constant = L !== O ? L : 0 };
        n.assign(he.prototype, {
            set: function(u, z) { return this.normal.copy(u), this.constant = z, this },
            setComponents: function(S, U, x, C) { return this.normal.set(S, U, x), this.constant = C, this },
            setFromNormalAndCoplanarPoint: function(X, R) { return this.normal.copy(X), this.constant = -R.dot(this.normal), this },
            setFromCoplanarPoints: function() {
                var z = new Cb,
                    L = new Cb;
                return function(v, _, E) { var O = z.subVectors(E, _).cross(L.subVectors(v, _)).normalize(); return this.setFromNormalAndCoplanarPoint(O, v), this }
            }(),
            clone: function() { return (new this.constructor).copy(this) },
            copy: function(Q) { return this.normal.copy(Q.normal), this.constant = Q.constant, this },
            normalize: function() { var y = 1 / this.normal.length(); return this.normal.multiplyScalar(y), this.constant *= y, this },
            negate: function() { return this.constant *= -1, this.normal.negate(), this },
            distanceToPoint: function(E) { return this.normal.dot(E) + this.constant },
            distanceToSphere: function(y) { return this.distanceToPoint(y.center) - y.radius },
            projectPoint: function(h, m) { return m === O && (m = new Cb), m.copy(this.normal).multiplyScalar(-this.distanceToPoint(h)).add(h) },
            intersectLine: function() {
                var B = new Cb;
                return function(e, n) {
                    n === O && (n = new Cb);
                    var y = e.delta(B),
                        H = this.normal.dot(y);
                    if (0 === H) return 0 === this.distanceToPoint(e.start) ? n.copy(e.start) : O;
                    var x = -(e.start.dot(this.normal) + this.constant) / H;
                    return 0 > x || x > 1 ? O : n.copy(y).multiplyScalar(x).add(e.start)
                }
            }(),
            intersectsLine: function(q) {
                var B = this.distanceToPoint(q.start),
                    m = this.distanceToPoint(q.end);
                return 0 > B && m > 0 || 0 > m && B > 0
            },
            intersectsBox: function(e) { return e.intersectsPlane(this) },
            intersectsSphere: function(K) { return K.intersectsPlane(this) },
            coplanarPoint: function(U) { return U === O && (U = new Cb), U.copy(this.normal).multiplyScalar(-this.constant) },
            applyMatrix4: function() {
                var u = new Cb,
                    k = new Bk;
                return function(B, E) {
                    var x = E || k.getNormalMatrix(B),
                        S = this.coplanarPoint(u).applyMatrix4(B),
                        p = this.normal.applyMatrix3(x).normalize();
                    return this.constant = -S.dot(p), this
                }
            }(),
            translate: function(T) { return this.constant -= T.dot(this.normal), this },
            equals: function(S) { return S.normal.equals(this.normal) && S.constant === this.constant }
        });
        var Vc = k.Math.Ray = function(b, y) { this.origin = b !== O ? b.clone() : new Cb, this.direction = y !== O ? y.clone() : new Cb };
        n.assign(Vc.prototype, {
            set: function(H, y) { return this.origin.copy(H), this.direction.copy(y), this },
            clone: function() { return (new this.constructor).copy(this) },
            copy: function(d) { return this.origin.copy(d.origin), this.direction.copy(d.direction), this.maxHitLen = d.maxHitLen, this },
            at: function(j, p) { var I = p || new Cb; return I.copy(this.direction).multiplyScalar(j).add(this.origin) },
            setMaxHitLength: function(l) { this.maxHitLen = l },
            lookAt: function(b) { return this.direction.copy(b).sub(this.origin).normalize(), this },
            applyMatrix4: function(o) {
                var n = this.maxHitLen;
                if (n) {
                    var s = this.direction.clone().multiplyScalar(n).add(this.origin);
                    s.applyMatrix4(o)
                }
                return this.origin.applyMatrix4(o), this.direction.transformDirection(o), n && (this.maxHitLen = this.origin.distanceTo(s)), this
            },
            distanceToPlane: function(G) { var Q = G.normal.dot(this.direction); if (0 === Q) return 0 === G.distanceToPoint(this.origin) ? 0 : null; var e = -(this.origin.dot(G.normal) + G.constant) / Q; return e >= 0 ? e : null },
            intersectPlane: function(N, Z) { var s = this.distanceToPlane(N); return null === s ? null : this.at(s, Z) },
            intersectSphere: function() {
                var z = new Cb;
                return function(c, W) {
                    z.subVectors(c.center, this.origin);
                    var D = z.dot(this.direction),
                        V = z.dot(z) - D * D,
                        P = c.radius * c.radius;
                    if (V > P) return null;
                    var x = Math.sqrt(P - V),
                        m = D - x,
                        t = D + x;
                    return 0 > m && 0 > t ? null : 0 > m ? this.at(t, W) : this.at(m, W)
                }
            }(),
            intersectEllipsoid: function() {
                var z = new Cb,
                    B = new Cb;
                return function(e, N) {
                    z.subVectors(e.center, this.origin), z.divide(e.radius), B.divideVectors(this.direction, e.radius);
                    var X = B.lengthSq(),
                        y = z.dot(B),
                        F = z.dot(z) * X - y * y;
                    if (F > X) return null;
                    var R = Math.sqrt(X - F),
                        U = (y - R) / X,
                        P = (y + R) / X;
                    return 0 > U && 0 > P ? null : 0 > U ? this.at(P, N) : this.at(U, N)
                }
            }(),
            intersectBox: function(k, _) {
                var z, G, b, W, T, I, s = 1 / this.direction.x,
                    j = 1 / this.direction.y,
                    e = 1 / this.direction.z,
                    U = this.origin;
                if (s >= 0 ? (z = (k.min.x - U.x) * s, G = (k.max.x - U.x) * s) : (z = (k.max.x - U.x) * s, G = (k.min.x - U.x) * s), j >= 0 ? (b = (k.min.y - U.y) * j, W = (k.max.y - U.y) * j) : (b = (k.max.y - U.y) * j, W = (k.min.y - U.y) * j), z > W || b > G) return null;
                if ((b > z || z !== z) && (z = b), (G > W || G !== G) && (G = W), e >= 0 ? (T = (k.min.z - U.z) * e, I = (k.max.z - U.z) * e) : (T = (k.max.z - U.z) * e, I = (k.min.z - U.z) * e), z > I || T > G) return null;
                if ((T > z || z !== z) && (z = T), (G > I || G !== G) && (G = I), 0 > G) return null;
                var B = z >= 0 ? z : G,
                    Y = this.maxHitLen;
                return Y && B > Y ? null : this.at(B, _)
            },
            intersectTriangle: function() {
                var j = new Cb,
                    A = new Cb,
                    J = new Cb,
                    C = new Cb;
                return function(h, I, O, X, l) {
                    A.subVectors(I, h), J.subVectors(O, h), C.crossVectors(A, J);
                    var P, s = this.direction.dot(C);
                    if (s > 0) {
                        if (X) return null;
                        P = 1
                    } else {
                        if (!(0 > s)) return null;
                        P = -1, s = -s
                    }
                    j.subVectors(this.origin, h);
                    var x = P * this.direction.dot(J.crossVectors(j, J));
                    if (0 > x) return null;
                    var M = P * this.direction.dot(A.cross(j));
                    if (0 > M || x + M > s) return null;
                    var g = -P * j.dot(C);
                    if (0 > g) return null;
                    var b = g / s,
                        Z = this.maxHitLen;
                    return Z && b > Z ? null : this.at(b, l)
                }
            }()
        });
        var tk = k.Math.Box3 = function(B, u) { this.min = B !== O ? B : new Cb(1 / 0, 1 / 0, 1 / 0), this.max = u !== O ? u : new Cb(-1 / 0, -1 / 0, -1 / 0) };
        n.assign(tk.prototype, {
            set: function(L, m) { return this.min.copy(L), this.max.copy(m), this },
            setFromArray: function(V) {
                for (var X = 1 / 0, p = 1 / 0, W = 1 / 0, Q = -1 / 0, K = -1 / 0, c = -1 / 0, r = 0, F = V.length; F > r; r += 3) {
                    var R = V[r],
                        u = V[r + 1],
                        G = V[r + 2];
                    X > R && (X = R), p > u && (p = u), W > G && (W = G), R > Q && (Q = R), u > K && (K = u), G > c && (c = G)
                }
                return this.min.set(X, p, W), this.max.set(Q, K, c), this
            },
            setFromPoints: function(X) { this.makeEmpty(); for (var R = 0, M = X.length; M > R; R++) this.expandByPoint(X[R]); return this },
            clone: function() { return (new this.constructor).copy(this) },
            intersectsBox: function(E) { return E.max.x < this.min.x || E.min.x > this.max.x || E.max.y < this.min.y || E.min.y > this.max.y || E.max.z < this.min.z || E.min.z > this.max.z ? !1 : !0 },
            copy: function(i) { return this.min.copy(i.min), this.max.copy(i.max), this },
            makeEmpty: function() { return this.min.x = this.min.y = this.min.z = 1 / 0, this.max.x = this.max.y = this.max.z = -1 / 0, this },
            isEmpty: function() { return this.max.x < this.min.x || this.max.y < this.min.y || this.max.z < this.min.z },
            expandByPoint: function(V) { return this.min.min(V), this.max.max(V), this },
            expandByBox: function(w) { return this.min.min(w.min), this.max.max(w.max), this },
            applyMatrix4: function() { var L = [new Cb, new Cb, new Cb, new Cb, new Cb, new Cb, new Cb, new Cb]; return function(v) { return this.isEmpty() ? this : (L[0].set(this.min.x, this.min.y, this.min.z).applyMatrix4(v), L[1].set(this.min.x, this.min.y, this.max.z).applyMatrix4(v), L[2].set(this.min.x, this.max.y, this.min.z).applyMatrix4(v), L[3].set(this.min.x, this.max.y, this.max.z).applyMatrix4(v), L[4].set(this.max.x, this.min.y, this.min.z).applyMatrix4(v), L[5].set(this.max.x, this.min.y, this.max.z).applyMatrix4(v), L[6].set(this.max.x, this.max.y, this.min.z).applyMatrix4(v), L[7].set(this.max.x, this.max.y, this.max.z).applyMatrix4(v), this.setFromPoints(L), this) } }()
        });
        var Mj = k.Math.Sphere = function(Q, G) { this.center = Q !== O ? Q : new Cb, this.radius = G !== O ? G : 0 };
        n.assign(Mj.prototype, {
            set: function(s, b) { return this.center.copy(s), this.radius = b, this },
            setFromPoints: function() {
                var y = new tk;
                return function(w, W) {
                    var z = this.center;
                    W !== O ? z.copy(W) : y.setFromPoints(w).getCenter(z);
                    for (var X = 0, G = 0, D = w.length; D > G; G++) X = Math.max(X, z.distanceToSquared(w[G]));
                    return this.radius = Math.sqrt(X), this
                }
            }(),
            clone: function() { return (new this.constructor).copy(this) },
            copy: function(d) { return this.center.copy(d.center), this.radius = d.radius, this },
            empty: function() { return this.radius <= 0 },
            containsPoint: function(J) { return J.distanceToSquared(this.center) <= this.radius * this.radius },
            distanceToPoint: function(Z) { return Z.distanceTo(this.center) - this.radius },
            intersectsSphere: function(M) { var E = this.radius + M.radius; return M.center.distanceToSquared(this.center) <= E * E },
            intersectsBox: function(O) { return O.intersectsSphere(this) },
            intersectsPlane: function(X) { return Math.abs(X.distanceToPoint(this.center)) <= this.radius },
            clampPoint: function(Z, P) { var u = this.center.distanceToSquared(Z); return P === O && (P = new Cb), P.copy(Z), u > this.radius * this.radius && (P.sub(this.center).normalize(), P.multiplyScalar(this.radius).add(this.center)), P },
            getBoundingBox: function(P) { return P === O && (P = new tk), P.set(this.center, this.center), P.expandByScalar(this.radius), P },
            applyMatrix4: function(k) { return this.center.applyMatrix4(k), this.radius = this.radius * k.getMaxScaleOnAxis(), this },
            translate: function($) { return this.center.add($), this },
            equals: function(d) { return d.center.equals(this.center) && d.radius === this.radius }
        });
        var mc = k.Math.Frustum = function(i, n, S, s, D, B) { this.planes = [i !== O ? i : new he, n !== O ? n : new he, S !== O ? S : new he, s !== O ? s : new he, D !== O ? D : new he, B !== O ? B : new he] };
        n.assign(mc.prototype, {
            set: function(C, U, Q, g, X, z) { var L = this.planes; return L[0].copy(C), L[1].copy(U), L[2].copy(Q), L[3].copy(g), L[4].copy(X), L[5].copy(z), this },
            clone: function() { return (new this.constructor).copy(this) },
            copy: function($) { for (var F = this.planes, R = 0; 6 > R; R++) F[R].copy($.planes[R]); return this },
            setFromMatrix: function(L) {
                var R = this.planes,
                    U = L.el,
                    P = U[0],
                    s = U[1],
                    b = U[2],
                    C = U[3],
                    q = U[4],
                    F = U[5],
                    D = U[6],
                    w = U[7],
                    N = U[8],
                    S = U[9],
                    _ = U[10],
                    y = U[11],
                    t = U[12],
                    W = U[13],
                    n = U[14],
                    v = U[15];
                return R[0].setComponents(C - P, w - q, y - N, v - t).normalize(), R[1].setComponents(C + P, w + q, y + N, v + t).normalize(), R[2].setComponents(C + s, w + F, y + S, v + W).normalize(), R[3].setComponents(C - s, w - F, y - S, v - W).normalize(), R[4].setComponents(C - b, w - D, y - _, v - n).normalize(), R[5].setComponents(C + b, w + D, y + _, v + n).normalize(), this
            },
            intersectsObject: function() { var h = new Mj; return function(f) { var x = f.geometry; return null === x.boundingSphere && x.computeBoundingSphere(), h.copy(x.boundingSphere).applyMatrix4(f.matrixWorld), this.intersectsSphere(h) } }(),
            intersectsSprite: function() { var z = new Mj; return function(G) { return z.center.set(0, 0, 0), z.radius = .7071067811865476, z.applyMatrix4(G.matrixWorld), this.intersectsSphere(z) } }(),
            intersectsSphere: function(w) { for (var q = this.planes, o = w.center, P = -w.radius, c = 0; 6 > c; c++) { var R = q[c].distanceToPoint(o); if (P > R) return !1 } return !0 },
            intersectsBox: function() { var L = new Cb; return function(Q) { for (var K = this.planes, O = 0; 6 > O; O++) { var A = K[O]; if (L.x = A.normal.x > 0 ? Q.max.x : Q.min.x, L.y = A.normal.y > 0 ? Q.max.y : Q.min.y, L.z = A.normal.z > 0 ? Q.max.z : Q.min.z, A.distanceToPoint(L) < 0) return !1 } return !0 } }(),
            containsPoint: function(Q) {
                for (var $ = this.planes, x = 0; 6 > x; x++)
                    if ($[x].distanceToPoint(Q) < 0) return !1;
                return !0
            }
        });
        var rs = k.Math.Matrix4 = function() { this.el = [1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1] };
        n.assign(rs.prototype, {
            set: function(o, d, H, s, C, w, z, r, y, v, c, J, Y, P, B, i) { var I = this.el; return I[0] = o, I[4] = d, I[8] = H, I[12] = s, I[1] = C, I[5] = w, I[9] = z, I[13] = r, I[2] = y, I[6] = v, I[10] = c, I[14] = J, I[3] = Y, I[7] = P, I[11] = B, I[15] = i, this },
            clone: function() { return (new rs).fromArray(this.el) },
            fromArray: function(I, R) { R === O && (R = 0); for (var E = this.el, Q = 0; 16 > Q; Q++) E[Q] = I[Q + R]; return this },
            getElements: function() { return this.el },
            scale: function(_) {
                var h = this.el,
                    D = _.x,
                    V = _.y,
                    w = _.z;
                return h[0] *= D, h[4] *= V, h[8] *= w, h[1] *= D, h[5] *= V, h[9] *= w, h[2] *= D, h[6] *= V, h[10] *= w, h[3] *= D, h[7] *= V, h[11] *= w, this
            },
            makeRotationFromEuler: function(v) {
                var f = this.el,
                    t = v._x,
                    m = v._y,
                    w = v._z,
                    T = v._order,
                    s = Math.cos(t),
                    p = Math.sin(t),
                    K = Math.cos(m),
                    l = Math.sin(m),
                    z = Math.cos(w),
                    q = Math.sin(w);
                if ("XYZ" === T) {
                    var r = s * z,
                        x = s * q,
                        B = p * z,
                        u = p * q;
                    f[0] = K * z, f[4] = -K * q, f[8] = l, f[1] = x + B * l, f[5] = r - u * l, f[9] = -p * K, f[2] = u - r * l, f[6] = B + x * l, f[10] = s * K
                } else if ("YXZ" === T) {
                    var S = K * z,
                        a = K * q,
                        i = l * z,
                        k = l * q;
                    f[0] = S + k * p, f[4] = i * p - a, f[8] = s * l, f[1] = s * q, f[5] = s * z, f[9] = -p, f[2] = a * p - i, f[6] = k + S * p, f[10] = s * K
                } else if ("ZXY" === T) {
                    var S = K * z,
                        a = K * q,
                        i = l * z,
                        k = l * q;
                    f[0] = S - k * p, f[4] = -s * q, f[8] = i + a * p, f[1] = a + i * p, f[5] = s * z, f[9] = k - S * p, f[2] = -s * l, f[6] = p, f[10] = s * K
                } else if ("ZYX" === T) {
                    var r = s * z,
                        x = s * q,
                        B = p * z,
                        u = p * q;
                    f[0] = K * z, f[4] = B * l - x, f[8] = r * l + u, f[1] = K * q, f[5] = u * l + r, f[9] = x * l - B, f[2] = -l, f[6] = p * K, f[10] = s * K
                } else if ("YZX" === T) {
                    var R = s * K,
                        V = s * l,
                        G = p * K,
                        Q = p * l;
                    f[0] = K * z, f[4] = Q - R * q, f[8] = G * q + V, f[1] = q, f[5] = s * z, f[9] = -p * z, f[2] = -l * z, f[6] = V * q + G, f[10] = R - Q * q
                } else if ("XZY" === T) {
                    var R = s * K,
                        V = s * l,
                        G = p * K,
                        Q = p * l;
                    f[0] = K * z, f[4] = -q, f[8] = l * z, f[1] = R * q + Q, f[5] = s * z, f[9] = V * q - G, f[2] = G * q - V, f[6] = p * z, f[10] = Q * q + R
                }
                return f[3] = 0, f[7] = 0, f[11] = 0, f[12] = 0, f[13] = 0, f[14] = 0, f[15] = 1, this
            },
            makeRotationFromQuaternion: function(P) {
                var b = this.el,
                    G = P._x,
                    E = P._y,
                    k = P._z,
                    j = P._w,
                    K = G + G,
                    L = E + E,
                    o = k + k,
                    c = G * K,
                    w = G * L,
                    d = G * o,
                    U = E * L,
                    D = E * o,
                    Z = k * o,
                    f = j * K,
                    x = j * L,
                    J = j * o;
                return b[0] = 1 - (U + Z), b[4] = w - J, b[8] = d + x, b[1] = w + J, b[5] = 1 - (c + Z), b[9] = D - f, b[2] = d - x, b[6] = D + f, b[10] = 1 - (c + U), b[3] = 0, b[7] = 0, b[11] = 0, b[12] = 0, b[13] = 0, b[14] = 0, b[15] = 1, this
            },
            identity: function() { return this.set(1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1), this },
            getInverse: function(K) {
                var m = this.el,
                    A = K.el,
                    U = A[0],
                    j = A[1],
                    $ = A[2],
                    G = A[3],
                    L = A[4],
                    y = A[5],
                    k = A[6],
                    l = A[7],
                    F = A[8],
                    s = A[9],
                    D = A[10],
                    T = A[11],
                    Q = A[12],
                    f = A[13],
                    S = A[14],
                    t = A[15],
                    C = s * S * l - f * D * l + f * k * T - y * S * T - s * k * t + y * D * t,
                    I = Q * D * l - F * S * l - Q * k * T + L * S * T + F * k * t - L * D * t,
                    W = F * f * l - Q * s * l + Q * y * T - L * f * T - F * y * t + L * s * t,
                    h = Q * s * k - F * f * k - Q * y * D + L * f * D + F * y * S - L * s * S,
                    c = U * C + j * I + $ * W + G * h;
                if (0 === c) return this.identity();
                var o = 1 / c;
                return m[0] = C * o, m[1] = (f * D * G - s * S * G - f * $ * T + j * S * T + s * $ * t - j * D * t) * o, m[2] = (y * S * G - f * k * G + f * $ * l - j * S * l - y * $ * t + j * k * t) * o, m[3] = (s * k * G - y * D * G - s * $ * l + j * D * l + y * $ * T - j * k * T) * o, m[4] = I * o, m[5] = (F * S * G - Q * D * G + Q * $ * T - U * S * T - F * $ * t + U * D * t) * o, m[6] = (Q * k * G - L * S * G - Q * $ * l + U * S * l + L * $ * t - U * k * t) * o, m[7] = (L * D * G - F * k * G + F * $ * l - U * D * l - L * $ * T + U * k * T) * o, m[8] = W * o, m[9] = (Q * s * G - F * f * G - Q * j * T + U * f * T + F * j * t - U * s * t) * o, m[10] = (L * f * G - Q * y * G + Q * j * l - U * f * l - L * j * t + U * y * t) * o, m[11] = (F * y * G - L * s * G - F * j * l + U * s * l + L * j * T - U * y * T) * o, m[12] = h * o, m[13] = (F * f * $ - Q * s * $ + Q * j * D - U * f * D - F * j * S + U * s * S) * o, m[14] = (Q * y * $ - L * f * $ - Q * j * k + U * f * k + L * j * S - U * y * S) * o, m[15] = (L * s * $ - F * y * $ + F * j * k - U * s * k - L * j * D + U * y * D) * o, this
            },
            makeRotationAxis: function(E, X) {
                var k = Math.cos(X),
                    I = Math.sin(X),
                    R = 1 - k,
                    z = E.x,
                    h = E.y,
                    y = E.z,
                    s = R * z,
                    M = R * h;
                return this.set(s * z + k, s * h - I * y, s * y + I * h, 0, s * h + I * y, M * h + k, M * y - I * z, 0, s * y - I * h, M * y + I * z, R * y * y + k, 0, 0, 0, 0, 1), this
            },
            multiply: function(Z) { return this.multiplyMatrices(this, Z) },
            premultiply: function(x) { return this.multiplyMatrices(x, this) },
            multiplyMatrices: function(u, l) {
                var G = u.el,
                    O = l.el,
                    Y = this.el,
                    V = G[0],
                    x = G[4],
                    E = G[8],
                    o = G[12],
                    j = G[1],
                    k = G[5],
                    U = G[9],
                    h = G[13],
                    i = G[2],
                    n = G[6],
                    f = G[10],
                    w = G[14],
                    B = G[3],
                    W = G[7],
                    T = G[11],
                    D = G[15],
                    S = O[0],
                    C = O[4],
                    F = O[8],
                    J = O[12],
                    g = O[1],
                    y = O[5],
                    v = O[9],
                    Z = O[13],
                    d = O[2],
                    M = O[6],
                    P = O[10],
                    Q = O[14],
                    b = O[3],
                    L = O[7],
                    p = O[11],
                    K = O[15];
                return Y[0] = V * S + x * g + E * d + o * b, Y[4] = V * C + x * y + E * M + o * L, Y[8] = V * F + x * v + E * P + o * p, Y[12] = V * J + x * Z + E * Q + o * K, Y[1] = j * S + k * g + U * d + h * b, Y[5] = j * C + k * y + U * M + h * L, Y[9] = j * F + k * v + U * P + h * p, Y[13] = j * J + k * Z + U * Q + h * K, Y[2] = i * S + n * g + f * d + w * b, Y[6] = i * C + n * y + f * M + w * L, Y[10] = i * F + n * v + f * P + w * p, Y[14] = i * J + n * Z + f * Q + w * K, Y[3] = B * S + W * g + T * d + D * b, Y[7] = B * C + W * y + T * M + D * L, Y[11] = B * F + W * v + T * P + D * p, Y[15] = B * J + W * Z + T * Q + D * K, this
            },
            lookAt: function() { var d = new Cb; return function(P, N, Q) { return d.subVectors(P, N), this.lookAtDirection(d, Q) } }(),
            lookAtDirection: function() {
                var e = new Cb,
                    m = new Cb,
                    N = new Cb;
                return function(H, l) { var Z = this.el; return N.copy(H), 0 === N.lengthSq() && (N.z = 1), N.normalize(), e.crossVectors(l, N), 0 === e.lengthSq() && (1 === Math.abs(l.z) ? N.x += 1e-4 : N.z += 1e-4, N.normalize(), e.crossVectors(l, N)), e.normalize(), m.crossVectors(N, e), Z[0] = e.x, Z[4] = m.x, Z[8] = N.x, Z[1] = e.y, Z[5] = m.y, Z[9] = N.y, Z[2] = e.z, Z[6] = m.z, Z[10] = N.z, this }
            }(),
            extractScale: function() {
                var N;
                return function(w) {
                    N === O && (N = new Cb), w === O && (w = new Cb);
                    var z = N.setFromMatrixColumn(this, 0).length(),
                        D = N.setFromMatrixColumn(this, 1).length(),
                        m = N.setFromMatrixColumn(this, 2).length();
                    return w.set(z, D, m), w
                }
            }(),
            extractRotation: function() {
                var F;
                return function(M) {
                    F === O && (F = new Cb), M === O && (M = new rs);
                    var w = this.el,
                        Q = M.el,
                        u = 1 / F.setFromMatrixColumn(M, 0).length(),
                        J = 1 / F.setFromMatrixColumn(M, 1).length(),
                        N = 1 / F.setFromMatrixColumn(M, 2).length();
                    return w[0] = Q[0] * u, w[1] = Q[1] * u, w[2] = Q[2] * u, w[4] = Q[4] * J, w[5] = Q[5] * J, w[6] = Q[6] * J, w[8] = Q[8] * N, w[9] = Q[9] * N, w[10] = Q[10] * N, this
                }
            }(),
            multiplyScalar: function(J) { var c = this.el; return c[0] *= J, c[4] *= J, c[8] *= J, c[12] *= J, c[1] *= J, c[5] *= J, c[9] *= J, c[13] *= J, c[2] *= J, c[6] *= J, c[10] *= J, c[14] *= J, c[3] *= J, c[7] *= J, c[11] *= J, c[15] *= J, this },
            getPosition: function(a) { return a === O && (a = new Cb), a.setFromMatrixColumn(this, 3) },
            setPosition: function(X) { var o = this.el; return o[12] = X.x, o[13] = X.y, o[14] = X.z, this },
            toArray: function(B, N) { B === O && (B = []), N === O && (N = 0); var t = this.el; return B[N] = t[0], B[N + 1] = t[1], B[N + 2] = t[2], B[N + 3] = t[3], B[N + 4] = t[4], B[N + 5] = t[5], B[N + 6] = t[6], B[N + 7] = t[7], B[N + 8] = t[8], B[N + 9] = t[9], B[N + 10] = t[10], B[N + 11] = t[11], B[N + 12] = t[12], B[N + 13] = t[13], B[N + 14] = t[14], B[N + 15] = t[15], B },
            determinant: function() {
                var q = this.el,
                    u = q[0],
                    n = q[4],
                    t = q[8],
                    X = q[12],
                    h = q[1],
                    o = q[5],
                    l = q[9],
                    C = q[13],
                    Z = q[2],
                    G = q[6],
                    d = q[10],
                    s = q[14],
                    J = q[3],
                    $ = q[7],
                    R = q[11],
                    j = q[15];
                return J * (+X * l * G - t * C * G - X * o * d + n * C * d + t * o * s - n * l * s) + $ * (+u * l * s - u * C * d + X * h * d - t * h * s + t * C * Z - X * l * Z) + R * (+u * C * G - u * o * s - X * h * G + n * h * s + X * o * Z - n * C * Z) + j * (-t * o * Z - u * l * G + u * o * d + t * h * G - n * h * d + n * l * Z)
            },
            copy: function(K) {
                var d = this.el,
                    h = K.el;
                return d[0] = h[0], d[1] = h[1], d[2] = h[2], d[3] = h[3], d[4] = h[4], d[5] = h[5], d[6] = h[6], d[7] = h[7], d[8] = h[8], d[9] = h[9], d[10] = h[10], d[11] = h[11], d[12] = h[12], d[13] = h[13], d[14] = h[14], d[15] = h[15], this
            },
            compose: function(v, g, H) {
                var K = this.el,
                    I = g._x,
                    l = g._y,
                    W = g._z,
                    $ = g._w,
                    G = I + I,
                    t = l + l,
                    u = W + W,
                    x = I * G,
                    s = I * t,
                    C = I * u,
                    S = l * t,
                    p = l * u,
                    k = W * u,
                    i = $ * G,
                    D = $ * t,
                    X = $ * u,
                    N = H.x,
                    w = H.y,
                    _ = H.z;
                return K[0] = (1 - (S + k)) * N, K[1] = (s + X) * N, K[2] = (C - D) * N, K[3] = 0, K[4] = (s - X) * w, K[5] = (1 - (x + k)) * w, K[6] = (p + i) * w, K[7] = 0, K[8] = (C + D) * _, K[9] = (p - i) * _, K[10] = (1 - (x + S)) * _, K[11] = 0, K[12] = v.x, K[13] = v.y, K[14] = v.z, K[15] = 1, this
            },
            decompose: function() {
                var C = new Cb,
                    W = new rs;
                return function(O, f, p) {
                    var y = this.el,
                        e = C.set(y[0], y[1], y[2]).length(),
                        o = C.set(y[4], y[5], y[6]).length(),
                        k = C.set(y[8], y[9], y[10]).length(),
                        m = this.determinant();
                    0 > m && (e = -e), O.x = y[12], O.y = y[13], O.z = y[14], W.copy(this);
                    var T = 1 / e,
                        V = 1 / o,
                        q = 1 / k;
                    return W.el[0] *= T, W.el[1] *= T, W.el[2] *= T, W.el[4] *= V, W.el[5] *= V, W.el[6] *= V, W.el[8] *= q, W.el[9] *= q, W.el[10] *= q, f.setFromRotationMatrix(W), p.x = e, p.y = o, p.z = k, this
                }
            }()
        });
        var qr = k.Math.Triangle = function(E, T, c) { this.a = E !== O ? E : new Cb, this.b = T !== O ? T : new Cb, this.c = c !== O ? c : new Cb };
        n.assign(qr, {
            barycoordFromPoint: function() {
                var W = new Cb,
                    X = new Cb,
                    k = new Cb;
                return function(C, c, $, b, v) {
                    W.subVectors(b, c), X.subVectors($, c), k.subVectors(C, c);
                    var V = W.dot(W),
                        R = W.dot(X),
                        w = W.dot(k),
                        B = X.dot(X),
                        o = X.dot(k),
                        y = V * B - R * R,
                        u = v || new Cb;
                    if (0 === y) return u.set(-2, -1, -1);
                    var O = 1 / y,
                        g = (B * w - R * o) * O,
                        Y = (V * o - R * w) * O;
                    return u.set(1 - g - Y, Y, g)
                }
            }()
        });
        var Mq = k.Math.Euler = function(v, _, l, f, q) { this.set(v, _, l, f, q) };
        Mq.RotationOrders = ["XYZ", "YZX", "ZXY", "XZY", "YXZ", "ZYX"], Mq.DefaultOrder = "XYZ", Mq.ReverseOrder = function() { var E = { xyz: "ZYX", xzy: "YZX", yxz: "ZXY", yzx: "XZY", zxy: "YXZ", zyx: "XYZ" }; return function(y) { return E[y] } }(), n.defineProperties(Mq.prototype, { x: { get: function() { return this._x }, set: function(i) { this._x = i, this.onChangeCallback() } }, y: { get: function() { return this._y }, set: function(u) { this._y = u, this.onChangeCallback() } }, z: { get: function() { return this._z }, set: function(T) { this._z = T, this.onChangeCallback() } }, order: { get: function() { return this._order }, set: function(r) { this._order = r, this.onChangeCallback() } } }), n.assign(Mq.prototype, {
            set: function(M, l, q, a, Z) { return ud(M) && (Z = q, a = l, q = M[2], l = M[1], M = M[0]), a ? Z && (a = Mq.ReverseOrder(a)) : a = "ZYX", this._x = M || 0, this._y = l || 0, this._z = q || 0, this._order = a || this._order, this.onChangeCallback(), this },
            clone: function() { return new this.constructor(this._x, this._y, this._z, this._order) },
            copy: function(B) { return this._x = B._x, this._y = B._y, this._z = B._z, this._order = B._order, this.onChangeCallback(), this },
            setFromRotationMatrix: function(O, d, A) {
                var b = k.Math.clamp,
                    B = O.el || O,
                    p = B[0],
                    J = B[4],
                    P = B[8],
                    N = B[1],
                    g = B[5],
                    R = B[9],
                    j = B[2],
                    x = B[6],
                    Q = B[10];
                return d = d || this._order, "XYZ" === d ? (this._y = Math.asin(b(P, -1, 1)), Math.abs(P) < .99999 ? (this._x = Math.atan2(-R, Q), this._z = Math.atan2(-J, p)) : (this._x = Math.atan2(x, g), this._z = 0)) : "YXZ" === d ? (this._x = Math.asin(-b(R, -1, 1)), Math.abs(R) < .99999 ? (this._y = Math.atan2(P, Q), this._z = Math.atan2(N, g)) : (this._y = Math.atan2(-j, p), this._z = 0)) : "ZXY" === d ? (this._x = Math.asin(b(x, -1, 1)), Math.abs(x) < .99999 ? (this._y = Math.atan2(-j, Q), this._z = Math.atan2(-J, g)) : (this._y = 0, this._z = Math.atan2(N, p))) : "ZYX" === d ? (this._y = Math.asin(-b(j, -1, 1)), Math.abs(j) < .99999 ? (this._x = Math.atan2(x, Q), this._z = Math.atan2(N, p)) : (this._x = 0, this._z = Math.atan2(-J, g))) : "YZX" === d ? (this._z = Math.asin(b(N, -1, 1)), Math.abs(N) < .99999 ? (this._x = Math.atan2(-R, g), this._y = Math.atan2(-j, p)) : (this._x = 0, this._y = Math.atan2(P, Q))) : "XZY" === d ? (this._z = Math.asin(-b(J, -1, 1)), Math.abs(J) < .99999 ? (this._x = Math.atan2(x, g), this._y = Math.atan2(P, p)) : (this._x = Math.atan2(-R, Q), this._y = 0)) : console.warn("unsupported order: " + d), this._order = d, A !== !1 && this.onChangeCallback(), this
            },
            setFromQuaternion: function() { var E = new rs; return function(k, Q, N) { return E.makeRotationFromQuaternion(k), this.setFromRotationMatrix(E, Q, N) } }(),
            setFromVector3: function(S, q) { return this.set(S.x, S.y, S.z, q || this._order) },
            reorder: function() { var u = new Wd; return function(s) { return u.setFromEuler(this), this.setFromQuaternion(u, s) } }(),
            equals: function(i) { return i._x === this._x && i._y === this._y && i._z === this._z && i._order === this._order },
            fromArray: function(t) {
                return this._x = t[0], this._y = t[1], this._z = t[2], t[3] !== O && (this._order = t[3]), this.onChangeCallback(), this
            },
            toArray: function(c, Q) { return c === O && (c = []), Q === O && (Q = 0), c[Q] = this._x, c[Q + 1] = this._y, c[Q + 2] = this._z, c[Q + 3] = this._order, c },
            toVector3: function(b) { return b ? b.set(this._x, this._y, this._z) : new Cb(this._x, this._y, this._z) },
            onChange: function(s) { return this.onChangeCallback = s, this },
            onChangeCallback: function() {}
        });
        var Xp = {
            ms_ac: function(a, A) { for (var E = A.ms_ac, H = 0; H < E.length; H++) Xi(a, E[H]) },
            ms_listener: function(u) {
                u.addListeners = function() {
                    var t = this,
                        k = Tn;
                    D.mockTouch && (k = vp.concat(vl).concat(hp)), t.__events__ = k;
                    for (var h = 0, o = k.length; o > h; h++) { var Q = k[h]; "wheel" === Q && !t.handle_wheel && t.handle_mousewheel && (t.handle_wheel = function(V) { fh(t, V) }), t["handle_" + Q] && Ck(Q, t.getView(), t) }
                }, u.removeListeners = function() {
                    var R = this,
                        F = R.__events__;
                    if (F) { R.__events__ = O; for (var D = 0, z = F.length; z > D; D++) R["handle_" + F[D]] && Vm(F[D], R.getView(), R) }
                }
            },
            ms_fire: function(Y) {
                Y.mp = function(X, P, K) { this.addPropertyChangeListener(X, P, K) }, Y.ump = function(M, O) { this.removePropertyChangeListener(M, O) }, Y.fp = function(f, v, N, W, G) { return this.firePropertyChange(f, v, N, W, G) }, Y.addPropertyChangeListener = function(b, u, o) {
                    var Y = this;
                    Y._62I || (Y._62I = new Fp), Y._62I.add(b, u, o)
                }, Y.removePropertyChangeListener = function(V, n) { this._62I && this._62I.remove(V, n) }, Y.firePropertyChange = function(W, B, E, x, z) {
                    if (x) { if (x(B, E)) return !1 } else if (B === E) return !1;
                    var C = this,
                        H = z || {};
                    return H.property = W, H.oldValue = B, H.newValue = E, H.source = C, H.data = C, C._62I && C._62I.fire(H), C.onPropertyChanged && C.onPropertyChanged(H), !0
                }
            },
            ms_attr: function(B) {
                B.a = function(z, $) {
                    var y = this;
                    if (2 === arguments.length) y.setAttr(z, $);
                    else { if (!zg(z)) return y.getAttr(z); for (var h in z) y.setAttr(h, z[h]) }
                    return y
                }, B.getAttr = function(Y, b) {
                    if (b === O && (b = 1), this._attrObject && Y in this._attrObject) return this._attrObject[Y];
                    if (this.getImage) {
                        var w = this.getImage();
                        if (Ok(w) && (w = Qr[w]), zg(w) && "dataBindings" in w)
                            for (var G = w.dataBindings, p = G.length - 1; p >= 0; p--) { var N = G[p]; if (N.attr === Y) { if ("defaultValue" in N) return N.defaultValue; break } }
                    }
                    return b ? V[Y] : O
                }, B.setAttr = function(B, k) {
                    var L = this;
                    L._attrObject || (L._attrObject = {});
                    var Y = L._attrObject[B];
                    k === O ? delete L._attrObject[B] : L._attrObject[B] = k, L.fp && L.fp("a:" + B, Y, k) && L.onAttrChanged && L.onAttrChanged(B, Y, k)
                }, B.getSerializableAttrs = function() { var h, $ = {}; for (h in this._attrObject) $[h] = 1; return $ }
            },
            ms_bnb: function(n) { n.getBodyColor = function(U) { return U.s("body.color") }, n.getBorderColor = function(Z) { return Z.s("border.color") } },
            _51o: function(J) {
                J.mi = function(o, R, n) { this.addInteractorListener(o, R, n) }, J.umi = function(A, E) { this.removeInteractorListener(A, E) }, J.fi = function(f) { this.fireInteractorEvent(f) }, J.addInteractorListener = function(g, o, O) {
                    var P = this;
                    P._63I || (P._63I = new Fp), P._63I.add(g, o, O)
                }, J.removeInteractorListener = function(Z, S) { this._63I && this._63I.remove(Z, S) }, J.fireInteractorEvent = function(B) { this._63I && this._63I.fire(B) }, J.setInteractors = function(L) {
                    var u = this,
                        s = u._interactors;
                    s && s.each(function(t) { t.tearDown() }), ud(L) && (L = new En(L)), u._interactors = L, L && L.each(function(V) { V.setUp() }), u.fp("interactors", s, L), u.invalidateSelection()
                }, J.getInteractors = function() { return this._interactors }
            },
            _49o: function(t) {
                t._44O = A, t._45O = A, t.getTopPainters = function() { return this._44O }, t.getBottomPainters = function() { return this._45O }, t.addTopPainter = function(b) {
                    var z = this;
                    z._44O || (z._44O = new En), z._44O.contains(b) || (z._44O.add(b), z.redraw && z.redraw())
                }, t.removeTopPainter = function(Z) {
                    var r = this;
                    r._44O && (r._44O.remove(Z), r.redraw && r.redraw())
                }, t.addBottomPainter = function(W) {
                    var x = this;
                    x._45O || (x._45O = new En), x._45O.contains(W) || (x._45O.add(W), x.redraw && x.redraw())
                }, t.removeBottomPainter = function(Q) {
                    var H = this;
                    H._45O && (H._45O.remove(Q), H.redraw && H.redraw())
                }, t._93db = function(_, V) {
                    var F = this;
                    F._45O && F._45O.each(function(o) { o.draw ? o.draw(_, V) : o.call(F, _, V) })
                }, t._92db = function(N, b) {
                    var H = this;
                    H._44O && H._44O.each(function(z) { z.draw ? z.draw(N, b) : z.call(H, N, b) })
                }
            },
            ms_sm: function(c) {
                c.sm = function() { return this.getSelectionModel() }, c.setSelectableFunc = function(G) { this.sm().setFilterFunc(G) }, c.getSelectableFunc = function() { return this.sm().getFilterFunc() }, c.getSelectionModel = function() { var i = this; return i._selectionModel ? i._selectionModel : i.dm().sm() }, c.isSelectionModelShared = function() { return !this._selectionModel }, c.setSelectionModelShared = function(r) {
                    var U = this,
                        y = !U._selectionModel,
                        C = U.handleSelectionChange,
                        u = U.dm();
                    y !== r && (U.invalidateSelection && U.invalidateSelection(), r ? (u.sm().ms(C, U), U._selectionModel.ums(C, U), U._selectionModel.dispose(), U._selectionModel = A) : (u.sm().ums(C, U), U._selectionModel = new $b(u), U._selectionModel.ms(C, U)), U.onSelectionModelSharedChanged(), U.fp("selectionModelShared", y, r))
                }, c.onSelectionModelSharedChanged = function() {
                    var T = this;
                    T.redraw(), T.invalidateSelection && T.invalidateSelection()
                }, c.removeSelection = function() {
                    var r = this.dm();
                    r.beginTransaction(), this.sm().toSelection().each(r.remove, r), r.endTransaction()
                }, c.selectAll = function() {
                    var G = this;
                    G.sm().ss(G.dm().toDatas(function(_) { return G.isVisible(_) && G.isSelectable(_) }))
                }, c.isSelected = function(R) { return this.sm().co(R) }, c.isSelectedById = function(F) { var k = this.dm().getDataById(F); return k ? this.isSelected(k) : !1 }, c.isSelectable = function(J) { return this.sm().isSelectable(J) }
            },
            ms_tx: function(c) {
                c._64I = 0, c._65O = 0, c.isScrollable = function() { return this.getWidth() < this._64I }, c._40o = function() { return this.isScrollable() }, c.getLogicalPoint = function(W) { return Mo(W, this._canvas || this._view, this.tx(), this.ty ? this.ty() : 0) }, c.tx = function(x) { return x === O ? this.getTranslateX() : (this.setTranslateX(x), void 0) }, c.getTranslateX = function() { return this._65O }, c.setTranslateX = function(w) {
                    var X = this,
                        Z = X.getWidth() - X._64I;
                    Z > w && (w = Z), w > 0 && (w = 0), w = j(w);
                    var v = X._65O;
                    X._65O = w, X.fp(Wb, v, w)
                }
            },
            ms_ty: function(A) {
                A._23Q = 0, A._66O = 0, A._41o = function() { return this.getHeight() < this._23Q }, A.getLogicalPoint = function(p) { return Mo(p, this._canvas || this._view, this.tx ? this.tx() : 0, this.ty()) }, A.ty = function(h) { return h === O ? this.getTranslateY() : (this.setTranslateY(h), void 0) }, A.getTranslateY = function() { return this._66O }, A.setTranslateY = function(P) {
                    var Y = this,
                        $ = Y.getHeight() - Y._23Q;
                    $ > P && (P = $), P > 0 && (P = 0), P = j(P);
                    var Z = Y._66O;
                    Y._66O = P, Y.fp(So, Z, P)
                }
            },
            ms_txy: function(X) {
                X._65O = 0, X._66O = 0, X.tx = function(l) { return l === O ? this.getTranslateX() : (this.setTranslateX(l), void 0) }, X.ty = function(o) { return o === O ? this.getTranslateY() : (this.setTranslateY(o), void 0) }, X.onTranslateEnded = function() {}, X.setTranslate = function(t, a, R) {
                    var k = this;
                    if (R = Ur(R)) {
                        k._65I && k._65I.stop(!0);
                        var f = k.tx(),
                            j = k.ty();
                        R.action = function(y) { k.setTranslate(f + (t - f) * y, j + (a - j) * y) }, R._37o = function() { delete k._66I, delete k._65I, k.onTranslateEnded() }, k._66I = 1, k._65I = Il(R)
                    } else k.tx(t), k.ty(a)
                }, X.getTranslateX = function() { return this._65O }, X.setTranslateX = function(G) {
                    var n = this;
                    G = n.adjustTranslateX(G);
                    var x = n._65O;
                    n._65O = G, n.fp(Wb, x, G)
                }, X.getTranslateY = function() { return this._66O }, X.setTranslateY = function(S) {
                    var R = this;
                    S = R.adjustTranslateY(S);
                    var N = R._66O;
                    R._66O = S, R.fp(So, N, S)
                }, X.adjustTranslateX = function(w) { return j(w) }, X.adjustTranslateY = function(a) { return j(a) }, X.translate = function(o, p, s) { this.setTranslate(this.tx() + o, this.ty() + p, s) }, X.getLogicalPoint = function(A) { var I = this; return Mo(A, this._canvas || I._view, I.tx(), I.ty()) }
            },
            ms_dm: function(B) { B.dm = function(p) { return p ? (this.setDataModel(p), void 0) : this.getDataModel() }, B.getDataModel = function() { return this._dataModel } },
            ms_lp: function(t) { t.lp = function(h) { return this.getLogicalPoint(h) } },
            ms_v: function(i) {
                i._disabled = !1, i.setDisabled = function(Q, d) {
                    var B = this,
                        G = B._disabled;
                    G !== Q && (G && (tp(B._63O), delete B._63O), Q && (Ml(B._view, B._63O = Ti(d)), B.iv()), B._disabled = Q, B.fp("disabled", G, Q))
                }, i.isDisabled = function() { return this._disabled }, i.getDisabledDiv = function() { return this._63O }, i.getView = function() { return this._view }, i.addToDOM = function(l) {
                    var B = this,
                        J = B.getView(),
                        t = J.style;
                    l = l || M.body, l.appendChild(J), t.left = "0", t.right = "0", t.top = "0", t.bottom = "0", v(y, "resize", function() { B.iv() }), B.iv()
                }, i.getWidth = function() { return this._view.clientWidth }, i.getHeight = function() { return this._view.clientHeight }, i.setWidth = function(W) {
                    var r = this;
                    r._view.style.width = W + dd, r.iv(), r.fp && r.fp(nn, A, W)
                }, i.setHeight = function(I) {
                    var p = this;
                    p._view.style.height = I + dd, p.iv(), p.fp && p.fp(Cm, A, I)
                }, i.setFocus = function($) {
                    var x = this,
                        Y = x._currentEditor;
                    return $ && Y && (Y.getView && (Y = Y.getView()), Y.contains($.target)) ? !1 : (fm(x._view), x.endEditing && x.endEditing(), x.fireViewEvent("focus"), !0)
                }, i.iv = function(t) { this.invalidate(t) }, i.invalidate = function(k) {
                    var $ = this;
                    $._68I || ($._68I = 1, Lh($.validate, $, A, k), $.onInvalidated && $.onInvalidated(), $.fireViewEvent("invalidate"))
                }, i.validate = function() {
                    var s = this,
                        G = s._view;
                    if (s._68I && (delete s._68I, G.parentNode))
                        if (0 === G.offsetWidth && 0 === G.offsetHeight && s._67I !== A) s._67I === O && (s._67I = D.reinvalidateCount), s._67I > 0 ? s._67I-- : s._67I = A, s.iv();
                        else {
                            s.fireViewEvent("beginValidate"), s.validateImpl(), s.onValidated && s.onValidated(), s.fireViewEvent("validate");
                            var U = s._63O;
                            U && (G.lastChild !== U && (tp(U), Ml(G, U)), dq(U, 0, 0, s.getWidth(), s.getHeight())), Rd(s), _d(s), en(s)
                        }
                }, i.layout = function(Z, L, z, A) { 1 === arguments.length ? dq(this, Z) : dq(this, Z, L, z, A) }, i.addViewListener = function(B, T, b) {
                    var c = this;
                    c._67O || (c._67O = new Fp), c._67O.add(B, T, b)
                }, i.removeViewListener = function(H, G) { this._67O.remove(H, G) }, i.fireViewEvent = function(q) {
                    var e = this;
                    e._67O && (Ok(q) && (q = { kind: q }), e._67O.fire(q)), D.viewListener && D.viewListener(e, q)
                }
            },
            ms_tip: function(F) {
                F.setToolTipEnabled = function(l) {
                    var p = this;
                    l ? Po || p._13o || (p.enableToolTip(), p.fp("toolTipEnabled", !1, !0)) : p._13o && (p.disableToolTip(), p.fp("toolTipEnabled", !0, !1))
                }, F.isToolTipEnabled = function() { return !!this._13o }, F.enableToolTip = function() {
                    var L = this;
                    if (!Po && !L._13o) {
                        L._13o = function(O) {
                            var q = L.getToolTip(O);
                            q != A ? (D.toolTipContinual && D.isToolTipShowing() ? yo(O, q) : (Hd(), Lo = { timeout: Ig(Rg, Qh), e: O, info: q }), pp = { e: O, view: L }) : Hd()
                        };
                        var s = L.getView();
                        v(s, Zp, L._13o), v(s, "mouseleave", D.hideToolTip)
                    }
                }, F.disableToolTip = function() {
                    var g = this;
                    if (g._13o) {
                        var Q = g.getView();
                        $(Q, Zp, g._13o), $(Q, "mouseleave", D.hideToolTip), delete g._13o
                    }
                }, F.getToolTip = function(v) { var q = this; if (q.getDataAt) { var D = q.getDataAt(v); return D ? D.getToolTip() : A } return q.getValue ? q.getValue() : void 0 }
            },
            _52o: function(B) {
                B._zoom = 1, B._29I = Xo, B.zoomIn = function(C, X) { this.setZoom(this._zoom * Gi, C, X) }, B.zoomOut = function(J, R) { this.setZoom(this._zoom / Gi, J, R) }, B.zoomReset = function(c, e) { this.setZoom(1, c, e) }, B.scrollZoomIn = function(E) { this.setZoom(this._zoom * ee, A, E) }, B.scrollZoomOut = function(n) { this.setZoom(this._zoom / ee, A, n) }, B.pinchZoomIn = function(y) { this.setZoom(this._zoom * Ol, A, y) }, B.pinchZoomOut = function(d) { this.setZoom(this._zoom / Ol, A, d) }, B.adjustZoom = function(H) { return Zr > H ? Zr : H > Wj ? Wj : H }, B.getZoom = function() { return this._zoom }, B.setZoom = function(W, b, $) {
                    var J = this;
                    if (b = Ur(b)) {
                        J._14o && J._14o.stop(!0);
                        var k = J._zoom;
                        b.action = function(D) { J._96O(k + (W - k) * D, $) }, b._37o = function() { delete J._zooming, delete J._14o, J.onZoomEnded() }, J._zooming = 1, J._14o = Il(b)
                    } else J._96O(W, $)
                }, B._96O = function(o, Z) {
                    var S = this;
                    if (o = S.adjustZoom(o), o !== S._zoom) {
                        S.validate();
                        var i = S._29I,
                            K = S._zoom;
                        0 !== i.width && 0 !== i.height && (Z = Z ? Z : { x: i.x + i.width / 2, y: i.y + i.height / 2 }, S.tx((Z.x - i.x) * K - Z.x * o), S.ty((Z.y - i.y) * K - Z.y * o)), S._zoom = o, S.fp("zoom", K, o)
                    }
                }
            },
            ms_edge: function(y) {
                y._2I = function(r) {
                    var Z = this;
                    Z._44I || (Z._44I = new En), Z._42I || (Z._42I = new En), Z._44I.add(r), Z._42I.add(r), Z._20I()
                }, y._4I = function(t) {
                    var B = this;
                    B._44I || (B._44I = new En), B._43I || (B._43I = new En), B._44I.add(t), B._43I.add(t), B._20I()
                }, y._16I = function(E) {
                    var x = this;
                    x._44I.remove(E), x._42I.remove(E), x._44I.isEmpty() && delete x._44I, x._42I.isEmpty() && delete x._42I, x._20I()
                }, y._18I = function(Q) {
                    var X = this;
                    X._44I.remove(Q), X._43I.remove(Q), X._44I.isEmpty() && delete X._44I, X._43I.isEmpty() && delete X._43I, X._20I()
                }, y._20I = function() {
                    var q = this;
                    if (delete q._45I, !q._44I || q._44I.isEmpty()) return delete q._70O, void 0;
                    var b;
                    q._44I.each(function(e) { e.isLooped() && (b || (b = {}), b[e._id] || (q._45I || (q._45I = new En), q._45I.add(e), b[e._id] = e)) }), b ? (q._70O = new En, q._44I.each(function(z) { b[z._id] ? "A" === b[z._id] || (b[z._id] = "A", q._70O.add(z)) : q._70O.add(z) })) : q._70O = q._44I
                }, y.hasAgentEdges = function() { return !!this._49I && !this._49I.isEmpty() }, y.getSourceAgentEdges = function() { return this._46I }, y.getTargetAgentEdges = function() { return this._47I }, y._1I = function(p) {
                    var Z = this;
                    Z._46I || (Z._46I = new En), Z._48I || (Z._48I = new En), Z._46I.add(p), Z._48I.add(p), Z._19I()
                }, y._3I = function(T) {
                    var Y = this;
                    Y._47I || (Y._47I = new En), Y._48I || (Y._48I = new En), Y._47I.add(T), Y._48I.add(T), Y._19I()
                }, y._15I = function(I) {
                    var t = this;
                    t._46I.remove(I), t._48I.remove(I), t._46I.isEmpty() && delete t._46I, t._48I.isEmpty() && delete t._48I, t._19I()
                }, y._17I = function(P) {
                    var w = this;
                    w._47I.remove(P), w._48I.remove(P), w._47I.isEmpty() && delete w._47I, w._48I.isEmpty() && delete w._48I, w._19I()
                }, y._19I = function() {
                    var U = this;
                    delete U._49I;
                    var N = U._48I;
                    if (N && !N.isEmpty()) {
                        var A = {};
                        N.each(function(W) { A[W._id] ? U._49I || (U._49I = new En) : A[W._id] = W }), U._49I ? N.each(function(D) { A[D._id] && (U._49I.add(D), delete A[D._id]) }) : U._49I = N
                    }
                }, y.getLoopedEdges = function() { return this._45I }, y.getEdges = function() { return this._70O }, y.getAgentEdges = function() { return this._49I }, y.getSourceEdges = function() { return this._42I }, y.getTargetEdges = function() { return this._43I }, y._8I = function() { this._70O && this._70O.each(function(i) { i._7I() }) }
            },
            ms_shadow: function(B) {
                $e.PARAMS.forEach(function(r) {
                    var g = r.replace(/(^|\.)[a-z]/g, function(x) { return x[x.length - 1].toUpperCase() }),
                        J = g.charAt(0).toLowerCase() + g.substr(1);
                    B["getShadow" + g] = function() { return this._getShadowParam(J) }, B["setShadow" + g] = function(E) { this._setShadowParam(J, E) }
                }), B.enableShadow = function(v) { this.shadowMap.setShadow(!0, v) }, B.disableShadow = function() { this.shadowMap.setShadow(!1) }, B._getShadowParam = function(K) { return this.shadowMap.getShadow()[K] }, B._setShadowParam = function(r, b) {
                    var g = this._getShadowParam(r),
                        j = {};
                    j[r] = b;
                    var $ = this.shadowMap;
                    $.setShadow($.enable, j), this.firePropertyChange("shadow" + r.charAt(0).toUpperCase() + r.substr(1), g, b)
                }
            }
        };
        gp(D, { getVersion: function() { return "7.2.2-dev21" } }, !0), gp(D, {
            numberDigits: 5,
            crossOrigin: "",
            baseZIndex: O,
            isTouchable: Po,
            mockTouch: !0,
            devicePixelRatio: y.devicePixelRatio ? y.devicePixelRatio : y.screen ? y.screen.deviceXDPI / y.screen.logicalXDPI : 1,
            reinvalidateCount: 3,
            hitMaxArea: 3e3,
            imageCacheThreshold: 20,
            autoMakeVisible: !0,
            autoHideScrollBar: !0,
            disabledOpacity: .4,
            disabledBackground: l.disabledBackground,
            forceHierarchicalSerialization: !0,
            extractBatchTranslation: !1,
            hoverDelay: 600,
            clickDelay: 200,
            toolTipDelay: 800,
            toolTipContinual: !1,
            getDragger: function() { return nj },
            lineCap: "butt",
            lineJoin: "round",
            imageGradient: "linear.northeast",
            dashPattern: [16, 16],
            blockMinSize: 1,
            encodeStringKey: null,
            doubleClickSpeed: 500,
            doubleClickRange: 1,
            doubleTouchRange: 20,
            touchMoveThreshold: 10,
            animDuration: 200,
            animEasing: function(C) { return C * C },
            labelColor: yp,
            labelSelectColor: ob,
            labelFont: "12px arial, sans-serif",
            widgetIndent: Po ? 30 : 20,
            widgetRowHeight: Po ? 30 : 20,
            widgetHeaderHeight: Po ? 32 : 22,
            widgetTitleHeight: Po ? 34 : 24,
            scrollBarColor: sp,
            scrollBarSize: 7,
            scrollBarTimeout: 1e3,
            scrollBarMinLength: 20,
            scrollBarInteractiveSize: Po ? 32 : 16,
            zoomIncrement: 1.3,
            scrollZoomIncrement: 1.05,
            pinchZoomIncrement: 1.08,
            pinchZoomThreshold: 1,
            zoomMax: 20,
            zoomMin: .01,
            segmentResolution: 12,
            shapeResolution: 24,
            shapeSide: 24,
            intersectionLineRect: Sf,
            intersectionLineLine: Og,
            isEnter: jf,
            isEsc: nc,
            isDelete: Tp,
            isSpace: wd,
            isLeft: Dg,
            isUp: Yi,
            isRight: Wg,
            isDown: gg,
            isTouchEvent: Mc,
            getTarget: dg,
            isString: Ok,
            isNumber: lc,
            isBoolean: Nl,
            isArray: ud,
            isSelectAll: Bo,
            isFunction: Fe,
            isObject: zg,
            getPropertyValue: ic,
            setPropertyValue: bm,
            addMethod: gp,
            createGradient: function(L, V, n, o, b, Z, d, X) { var N = jc[V]; return N(L, n, o, b, Z, d, X) },
            appendToScreen: function(q) { q = q.getView ? q.getView() : q, (M.fullscreenElement || M.mozFullScreenElement || M.webkitFullscreenElement || M.msFullscreenElement || M.body).appendChild(q) },
            encodeString: function(f) { return k.Math.encodeBase64(f, D.encodeStringKey) },
            decodeString: function(s) { return k.Math.decodeBase64(s, D.encodeStringKey) },
            findView: function(v) {
                var f = function(E, d) {
                        var U = d._ht;
                        U && E.push(U);
                        var T = d.children,
                            u = T.length;
                        if (u)
                            for (var Z = 0; u > Z; Z++) f(E, T[Z])
                    },
                    H = [];
                f(H, M.body);
                var n = function(v, E) {
                    for (var u = "2d" === E ? Rm.GraphView : Of.Graph3dView, J = 0, I = v.length; I > J; J++)
                        if (v[J] instanceof u) return H[J];
                    return null
                };
                return "all" === v ? H : "2d" === v ? n(H, "2d") : "3d" === v ? n(H, "3d") : n(H, "3d") || n(H, "2d")
            },
            toggleFullscreen: function(u) {
                var S = u.getView();
                if (M.fullscreenElement || M.mozFullScreenElement || M.webkitFullscreenElement || M.msFullscreenElement) M.exitFullscreen ? M.exitFullscreen() : M.msExitFullscreen ? M.msExitFullscreen() : M.mozCancelFullScreen ? M.mozCancelFullScreen() : M.webkitExitFullscreen && M.webkitExitFullscreen();
                else {
                    var x = !0;
                    if (u.isSelfViewEvent) {
                        var o = u.getX(),
                            d = u.getY(),
                            X = u.getWidth(),
                            r = u.getHeight(),
                            R = S.style.background,
                            C = S.style.backgroundColor;
                        R || C || (S.style.backgroundColor = "white"), S.requestFullscreen ? S.requestFullscreen() : S.msRequestFullscreen ? S.msRequestFullscreen() : S.mozRequestFullScreen ? S.mozRequestFullScreen() : S.webkitRequestFullscreen && S.webkitRequestFullscreen();
                        var T = setInterval(function() {
                            if (S !== (M.fullscreenElement || M.mozFullScreenElement || M.webkitFullscreenElement || M.msFullscreenElement)) clearInterval(T), u.setX(o), u.setY(d), u.setWidth(X), u.setHeight(r), u._fullscreen = !1, S.style.oldBackgroundColor = C, u.iv();
                            else {
                                var s = k.Default.getWindowInfo();
                                (x || s.width !== u.getWidth() || s.height !== u.getHeight()) && (u.setX(s.left), u.setY(s.top), u.setWidth(s.width), u.setHeight(s.height), u._fullscreen = !0, u.iv(), x = !1)
                            }
                        }, 500)
                    } else {
                        var Y = S.style.left,
                            $ = S.style.top,
                            X = S.style.width,
                            r = S.style.height,
                            R = S.style.background,
                            C = S.style.backgroundColor;
                        R || C || (S.style.backgroundColor = "white"), S.requestFullscreen ? S.requestFullscreen() : S.msRequestFullscreen ? S.msRequestFullscreen() : S.mozRequestFullScreen ? S.mozRequestFullScreen() : S.webkitRequestFullscreen && S.webkitRequestFullscreen();
                        var T = setInterval(function() {
                            if (S !== (M.fullscreenElement || M.mozFullScreenElement || M.webkitFullscreenElement || M.msFullscreenElement)) clearInterval(T), S.style.left = Y, S.style.top = $, S.style.width = X, S.style.height = r, S.style.oldBackgroundColor = C, u.iv();
                            else {
                                var E = k.Default.getWindowInfo();
                                (x || E.width !== u.getWidth() || E.height !== u.getHeight()) && (dq(u), x = !1)
                            }
                        }, 500)
                    }
                }
            },
            appendTimeStamp: function(q) { return q },
            setCompType: function(t, Z) { Ok(Z) && Z.substr(0, 12) == xf && (Z = D.parse(Z)), Fe(Z) || zg(Z) ? pi[t] = Z : vi(t) },
            getCompType: function(G) { var x = pi[G]; return x === O && Jl.test(G) && vi(G), x },
            getCompTypeMap: function() { return pi },
            drawCompType: function(V, D, N, A, y, z) { V(D, N, A, y, z) },
            numberListener: function() {
                var d = { 46: 1, 8: 1, 9: 1, 27: 1, 13: 1, 109: 1, 110: 1, 189: 1, 190: 1 };
                return function(C) {
                    var J = C.keyCode;
                    d[J] || 65 === J && D.isCtrlDown(C) || 86 === J && D.isCtrlDown(C) || 67 === J && D.isCtrlDown(C) || 88 === J && D.isCtrlDown(C) || J >= 35 && 40 >= J || (C.shiftKey || 48 > J || J > 57) && (96 > J || J > 105) && C.preventDefault()
                }
            }(),
            ignoreKeyCodes: [122, 123],
            preventDefault: function(e) {
                var l = e.target.tagName;
                ("DIV" === l || "CANVAS" === l) && !(D.ignoreKeyCodes.indexOf(e.keyCode) >= 0) && ("keydown" !== e.type || Dg(e) || Wg(e) || Yi(e) || gg(e) || Tp(e) || 65 === e.keyCode && (e.metaKey || e.ctrlKey)) && (e.preventDefault(), e.preventManipulation && e.preventManipulation())
            },
            getWindowInfo: function() {
                var m = M.documentElement,
                    X = m && (m.scrollLeft || m.scrollTop) ? m : M.body;
                return { target: X, left: X.scrollLeft, top: X.scrollTop, width: y.innerWidth || X.clientWidth, height: y.innerHeight || X.clientHeight }
            },
            isDragging: function() { return !!nj },
            isLeftButton: function(e) { return Mc(e) ? !0 : 0 === e.button },
            isMiddleButton: function(U) { return Mc(U) ? !1 : U && (1 === U.button || 4 & (U.buttons || 0)) },
            isRightButton: function(N) { return Mc(N) ? !1 : N && (2 === N.button || 2 & (N.buttons || 0)) },
            isInput: function(B) { if (!B) return !1; var T = B.tagName; return "INPUT" === T || "TEXTAREA" === T || "SELECT" === T },
            getTouchCount: function(z) { return Mc(z) ? z.touches.length : 1 },
            isDoubleClick: function() {
                function I(S) { S.details = 0, S.timeout = null, S.lastPoint = null }
                var X = {};
                return Je = new Io, tr = Je.getTime(),
                    function(H) {
                        if (Xk(H) > 1) return !1;
                        var q = H.button == A ? "" : H.button,
                            d = H.type + q,
                            z = d + "_isDoubleClick",
                            Z = X[d];
                        if (Z || (Z = X[d] = { details: 0, timeout: null, lastPoint: null }), H[z] === O) {
                            H[z] = !0;
                            var w = Sp(H);
                            Z.timeout && (pe(Z.timeout), Z.timeout = null);
                            var B = Mc(H) ? D.doubleTouchRange : D.doubleClickRange;
                            Z.lastPoint && _q(Z.lastPoint, w) > B && I(Z), Z.lastPoint = w, Z.details++, Z.timeout = Ig(function() { I(this) }.bind(Z), D.doubleClickSpeed)
                        }
                        return 2 === Z.details
                    }
            }(),
            isShiftDown: function(y) { return y ? y.shiftKey : $m["16"] },
            isCtrlDown: function(B) { return B ? Sb ? B.metaKey : B.ctrlKey : Sb ? $m["91"] : $m["17"] },
            getClientPoint: function(F) { return Mc(F) && (F = je(F)), { x: F.clientX, y: F.clientY } },
            isMouseEvent: function(Y) { return Y instanceof MouseEvent || 0 === Y.type.indexOf("mouse") },
            getTargetElement: function(R) {
                var r, h = Xr(R);
                if (r = D.isMouseEvent(R) || !M.elementFromPoint ? R.target : M.elementFromPoint(h.x, h.y), Jd && M.elementFromPoint) {
                    for (var q = [], z = [];
                        "none" === r.style.pointerEvents;) q.push(r), z.push(r.style.display || ""), r.style.display = "none", r = M.elementFromPoint(h.x, h.y);
                    q.forEach(function(A, X) { A.style.display = z[X] })
                }
                return r
            },
            getPagePoint: function(E) { return Mc(E) && (E = je(E)), { x: E.pageX, y: E.pageY } },
            createObject: function(N, o) {
                var G = new N;
                for (var C in o) {
                    var v = o[C];
                    if (Fe(v)) G[C] = v;
                    else if (0 === C.indexOf("s:")) G.s(C.substr(2), o[C]);
                    else if (0 === C.indexOf("a:")) G.a(C.substr(2), o[C]);
                    else {
                        var k = Sr(C),
                            v = o[C];
                        G[k] ? (G[k](v), "setToolTip" === k && G.enableToolTip && G.enableToolTip()) : G[C] = v
                    }
                }
                return G
            },
            setImage: function(r, e, f, O) {

                var l = arguments.length;
                // console.log(r, e, f, O, l, 333);
                4 === l ? jr(r, O, e, f) : 2 === l ? Ok(e) ? e.substr(0, 12) == xf ? fd(r, D.parse(e)) : jr(r, e) : fd(r, e) : 1 === l && jr(r, r)
            },
            getImage: function(T, Z, K) {
                var p;
                if (T == A) return A;
                if (zg(T) ? p = T : (p = Qr[T], T && p === O && (fj && fj[T] || jr(T, T))), Z && p && p.tagName) {
                    var q;
                    q = "override" === K ? "colors_override" : "override_rgb" === K ? "colors_override_rgb" : "override_a" === K ? "colors_override_a" : "colors", p[q] || (p[q] = { __count__: 0 });
                    var k = p[q][Z];
                    return k || (p[q].__count__ > D.imageCacheThreshold && (p[q] = { __count__: 0 }), k = Xh(p, Lf(Z), p.width, p.height, K), p[q][Z] = k, p[q].__count__++), k
                }
                return p
            },
            isImageComplete: function(g, G, x) {
                var r = Jc(g);
                if (!r) return !1;
                if (r.tagName) return r.complete;
                for (var s, g, w, c = r.comps, i = !0, L = 0, b = c.length; b > L; L++)
                    if (s = c[L], w = s.type, "image" === s.type) { g = s.name, g && g.func && (g = Rr(g, G)); var V = fe(g, G, x); if (!V) { i = !1; break } } else if (Jl.test(w) && D.getCompType(w) === O) { i = !1, vi(w); break }
                return i
            },
            getId: function() { var F = 1; return function() { return ++F } }(),
            callLater: function(I, L, d, C) { var N = function() { I.apply(L, d) }; return C ? Ig(N, C) : y.requestAnimationFrame(N) },
            cancelLater: function(s, A) { A ? pe(s) : y.cancelAnimationFrame(s) },
            clone: function(C) { if (null == C || "object" != typeof C) return C; if (C instanceof Date) { var c = new Date; return c.setTime(C.getTime()), c } if (C instanceof Array) { for (var c = [], X = 0, m = C.length; m > X; X++) c[X] = tf(C[X]); return c } if (C instanceof En) { for (var c = new En, X = 0, m = C.length; m > X; X++) c.set(X, tf(C.get(X))); return c } if (C instanceof Bq) return C; if (C instanceof Fq) { var c = new Fq; return c.deserialize(C.serialize()), c } if (C instanceof n) { var c = {}; for (var U in C) C.hasOwnProperty(U) && (c[U] = tf(C[U])); return c } return C },
            callWhenLoaded: function(h, T) {
                T = T || 100;
                var v = rq(h, T);
                $h || ($h = {}), $h[v] = { tick: v, cb: h, delay: T }
            },
            beforeLoadURL: function(_, C) {
                if ($h) {
                    var O = {};
                    for (var C in $h) {
                        var b = $h[C];
                        pe(b.tick);
                        var W = rq(b.cb, b.delay);
                        O[W] = { tick: W, delay: b.delay, cb: b.cb }
                    }
                    $h = O
                }
                return D.convertURL ? D.convertURL(_, C) : _
            },
            convertURL: function(F) { return F },
            handleRefGraphLoaded: function() {},
            handleCompTypeLoaded: function() {},
            handleImageLoaded: function() {},
            handleUnfoundImage: function() { return D.getImage("default_blank") },
            resizeImagePOT: function(A, o) {
                if (!A || !A.tagName) return A;
                var Q = A.width,
                    U = A.height;
                if (!Q || !U) return A;
                if (zn.isPOT(Q) && zn.isPOT(U) && (!o || Q === U)) return A;
                var I, u;
                o ? u = I = zn.nearestPOT(Math.min(Q, U)) : (I = zn.nearestPOT(Q), u = zn.nearestPOT(U));
                var J = Sg(),
                    V = J.getContext("2d");
                return Cq(J, I, u, 1), V.drawImage(A, 0, 0, Q, U, 0, 0, I, u), J
            },
            sortFunc: function(Z, E) {
                if (Z === E) return 0;
                if (Z == A && E != A) return 1;
                if (Z != A && E == A) return -1;
                if (Z == A && E == A) return 0;
                var J, z = typeof Z,
                    c = typeof E;
                return z === Kr && c === Kr ? J = Z.localeCompare(E) : z === zq && c === zq && (J = Z - E), J === O && (J = ("" + Z).localeCompare("" + E)), J > 0 ? 1 : 0 > J ? -1 : 0
            },
            getClassMap: function() { return Nr },
            getClass: function(i) {
                if (Ok(i)) {
                    var D, v = Nr[i];
                    if (!v) {
                        D = i.split("."), v = y;
                        for (var L = 0; L < D.length; L++) v = v[D[L]];
                        Nr[i] = v
                    }
                    return v
                }
                return i
            },
            def: function(D, w, x) {
                var v, N, K, X = function() {};
                if (X.prototype = w.prototype, v = new X, Ok(D)) {
                    if (Nr[D]) throw "'" + D + "' already defined";
                    K = pm(D), v.getClassName = function() { return D }
                } else K = D;
                if (v.constructor = K, v.getClass = function() { return K }, v.getSuperClass = function() { return w }, x)
                    for (N in x) Xp[N] && Xp.hasOwnProperty(N) ? Xp[N](v, x) : vs(v, x, N);
                K.prototype = v, K.superClass = w.prototype
            },
            startAnim: function() {
                var s = function(z) { z.duration && (z.startTime = Xc()), z.timeId = Lh(z.tick, A, A, z.interval) };
                return function(p) {
                    return p = tf(p), p.easing = p.easing || D.animEasing, p.duration || p.frames || (p.duration = D.animDuration), p.t = 0, p.duration ? p.interval = 0 : (p.frame = 0, p.interval = p.interval || 10), p.tick = function() {
                        if (p.duration) {
                            var M = (Xc() - p.startTime) / p.duration;
                            if (M > 1 && (M = 1), p.t = M, p.action(p.easing(M), M), !p.isRunning()) return;
                            1 === M ? p.stop() : p._isPaused || (p.timeId = Lh(p.tick))
                        } else {
                            if (p.frame++, M = p.t = p.frame / p.frames, p.action(p.easing(M), M), !p.isRunning()) return;
                            p.frame < p.frames ? p._isPaused || (p.timeId = Lh(p.tick, A, A, p.interval)) : p.stop()
                        }
                    }, p.resume = function() { p._isPaused && (delete p._isPaused, p.duration ? p.t < 1 && (p.startTime = Xc() - p.duration * p.t, p.timeId = Lh(p.tick)) : p.frame < p.frames && (p.timeId = Lh(p.tick, A, A, p.interval))) }, p.pause = function() { xb(p.timeId, !p.duration), p._isPaused = !0 }, p.isPaused = function() { return this._isPaused }, p.stop = function(N) { p.isRunning() && (xb(p.timeId, !p.duration), delete p.timeId, p.duration ? p.t < 1 && N && (p.t = 1, p.action(p.easing(1), 1)) : p.frame < p.frames && N && (p.frame = p.frames, p.action(p.easing(1), 1)), p._37o && p._37o(), p.finishFunc && p.finishFunc()) }, p.isRunning = function() { return p.timeId != A }, p.delay ? Lh(s, A, [p], p.delay) : s(p), p
                }
            }(),
            getTextSize: function() {
                var K = {},
                    V = M ? Sg().getContext("2d") : A;
                return function(y, i) { V.font = y ? y : Zq; var R = K[V.font]; return R || (R = 2 * V.measureText("e").width + 4, K[V.font] = R), { width: V.measureText(i).width + 4, height: R } }
            }(),
            drawText: function(m, $, e, f, c, B, I, k, g, Q) {
                if ($ != A) {
                    var F = Pg(e, $),
                        S = {};
                    S.y = Q && Q !== Yq ? Q === Gm ? B + F.height / 2 : B + k - F.height / 2 : B + k / 2, S.x = g && g !== Ui ? g === Ul ? c + I - F.width / 2 : c + I / 2 : c + F.width / 2, kl(m, $, S, e, f)
                }
            },
            getDistance: function(N, A) { var c = N.length; return A ? 3 === c ? z(dr(N[0] - A[0]) + dr(N[1] - A[1]) + dr(N[2] - A[2])) : 2 === c ? z(dr(N[0] - A[0]) + dr(N[1] - A[1])) : N.z === O ? z(dr(A.x - N.x) + dr(A.y - N.y)) : z(dr(A.x - N.x) + dr(A.y - N.y) + dr(A.z - N.z)) : 3 === c ? z(dr(N[0]) + dr(N[1]) + dr(N[2])) : 2 === c ? z(dr(N[0]) + dr(N[1])) : void 0 },
            brighter: function(R, x) { return 0 > x && (x = -x), dh(R, x ? x : 40) },
            darker: function(_, p) { return p > 0 && (p = -p), dh(_, p ? p : -40) },
            unionPoint: function(w, P) {
                if (!w) return A;
                if (2 === arguments.length) return w && P ? { x: i(w.x, P.x), y: i(w.y, P.y), width: X(w.x - P.x), height: X(w.y - P.y) } : A;
                var g = w;
                if (g._as && (g = g._as), g.length === O) return A;
                var y = g.length;
                if (0 >= y) return A;
                for (var v = 1, b = g[0], T = { x: b.x, y: b.y, width: 0, height: 0 }; y > v; v++) {
                    b = g[v];
                    var f = i(T.x, b.x),
                        M = K(T.x + T.width, b.x),
                        a = i(T.y, b.y),
                        R = K(T.y + T.height, b.y);
                    T.x = f, T.y = a, T.width = M - f, T.height = R - a
                }
                return T
            },
            unionRect: function(g, P) { if (g && !P) return tf(g); if (!g && P) return tf(P); if (g && P) { var v = { x: i(g.x, P.x), y: i(g.y, P.y) }; return v.width = K(g.x + g.width, P.x + P.width) - v.x, v.height = K(g.y + g.height, P.y + P.height) - v.y, v } return A },
            containsPoint: function(q, W, D, h) {
                if (h != A && 1 !== h) {
                    var i = q.x + q.width / 2,
                        H = q.y + q.height / 2;
                    q = { x: i - q.width / 2 * h, y: H - q.height / 2 * h, width: q.width * h, height: q.height * h }
                }
                if (D) {
                    var M = q.width / 2,
                        K = q.height / 2,
                        J = N(-D),
                        Y = C(-D),
                        Z = W.x - q.x - M,
                        R = W.y - q.y - K;
                    return W = { x: Y * Z - J * R, y: J * Z + Y * R }, Df({ x: -M, y: -K, width: q.width, height: q.height }, W)
                }
                return !(!q || W.x < q.x || W.y < q.y || W.x > q.x + q.width || W.y > q.y + q.height)
            },
            containsRect: function(U, i) {
                if (!U || !i) return !1;
                var x = i.x,
                    o = i.y,
                    m = i.width,
                    w = i.height,
                    T = U.width,
                    F = U.height;
                if (0 > (T | F | m | w)) return !1;
                var d = U.x,
                    t = U.y;
                if (d > x || t > o) return !1;
                if (T += d, m += x, x >= m) { if (T >= d || m > T) return !1 } else if (T >= d && m > T) return !1;
                if (F += t, w += o, o >= w) { if (F >= t || w > F) return !1 } else if (F >= t && w > F) return !1;
                return !0
            },
            intersectsRect: function(p, M) {
                if (!p || !M) return !1;
                var Z = M.width,
                    T = M.height,
                    s = p.width,
                    m = p.height;
                if (0 >= s || 0 >= m || 0 >= Z || 0 >= T) return !1;
                var O = M.x,
                    x = M.y,
                    J = p.x,
                    L = p.y;
                return s += J, m += L, Z += O, T += x, s > O && m > x && Z > J && T > L
            },
            intersection: function(j, N) {
                if (!j || !N) return A;
                var V = N.x,
                    O = N.y,
                    F = j.x,
                    q = j.y,
                    h = V,
                    E = O,
                    o = F,
                    w = q;
                return h += N.width, E += N.height, o += j.width, w += j.height, F > V && (V = F), q > O && (O = q), h > o && (h = o), E > w && (E = w), h -= V, E -= O, 0 >= h || 0 >= E ? A : { x: V, y: O, width: h, height: E }
            },
            grow: function(n, p, U) { U === O && (U = p), n.x -= p, n.y -= U, n.width = n.width + 2 * p, n.height = n.height + 2 * U },
            getScreenPoint: function(O, M, e, m, o, $, i) {
                var T = e.getBoundingClientRect(),
                    H = O * ($ || 1) - e.scrollLeft + (m || 0),
                    s = M * (i || 1) - e.scrollTop + (o || 0),
                    c = Rq(e, !1);
                if (c) { var X = new Cb(H, s, 0); return X.applyMatrix4(c), console.log(X), { x: X.x, y: X.y } }
                return { x: H + T.left, y: s + T.top }
            },
            getLogicalPoint: function(Z, f, N, S, J, F) {
                var g, s, w = f.getBoundingClientRect();
                Z.target ? (Xn(Z) ? Sb ? $m["91"] = !0 : $m["17"] = !0 : Sb ? $m["91"] = !1 : $m["17"] = !1, $m["16"] = eq(Z) ? !0 : !1, Z = Mc(Z) ? je(Z) : Z, g = Z.clientX, s = Z.clientY) : (g = Z.x, s = Z.y);
                var D = Rq(f, !0);
                if (D) {
                    var z = new Cb(g, s, 0);
                    z.applyMatrix4(D);
                    do {
                        if (Math.abs(z.z) <= 1e-6) break;
                        var O = new Cb(g, s, 1);
                        if (O.applyMatrix4(matrix), Math.abs(O.z) <= 1e-6) { z = O; break }
                        if (O.sub(z), Math.abs(O.z) <= 1e-6) break;
                        z.addScaledVector(O, -z.z / O.z)
                    } while (!1);
                    return { x: (z.x + f.scrollLeft - (N || 0)) / (J || 1), y: (z.y + f.scrollTop - (S || 0)) / (F || 1) }
                }
                return { x: (g - w.left + f.scrollLeft - (N || 0)) / (J || 1), y: (s - w.top + f.scrollTop - (S || 0)) / (F || 1) }
            },
            removeHTML: function() { var C; return function(Q) { return Q && Q.getView && (Q = Q.getView()), Q && Q.parentNode ? C === Q ? !0 : (C = Q, Q.parentNode.removeChild(Q), C = A, !0) : !1 } }(),
            getToolTipDiv: function() {
                if (!qe) {
                    qe = sf(), ti = sf();
                    var F = qe.style;
                    D.baseZIndex != A && (F.zIndex = pr(D.baseZIndex) + 3 + ""), F.whiteSpace = "nowrap", F.color = D.toolTipLabelColor, F.background = D.toolTipBackground, F.font = D.toolTipLabelFont, F.padding = "5px", F.boxShadow = "0px 0px 3px " + D.toolTipShadowColor
                }
                return qe
            },
            isToolTipShowing: function() { return qe && qe.parentNode ? !0 : ti && ti.parentNode ? !0 : !1 },
            updateToolTipContent: function(c, n) {
                if (D.isToolTipShowing() && (n || (n = pp && pp.view), c === O && n && pp.e && (c = n.getToolTip(pp.e)), c != A)) {
                    var F;
                    c.html ? (c = c.html, F = ti) : F = qe, F.innerHTML = c
                }
            },
            hideToolTip: function() {
                if (D.isToolTipShowing()) {
                    tp(qe), tp(ti), mq();
                    var K = pp && pp.view;
                    K && K.onHideToolTip && K.onHideToolTip(), pp = A
                }
            },
            showToolTip: function(T, C, U) {
                if (!T || C == A) return Hd(), void 0;
                D.getToolTipDiv();
                var J, B;
                if (C.html ? (C = C.html, J = ti, tp(qe)) : (J = qe, tp(ti)), B = J.style, J.innerHTML = C, J.parentNode || k.Default.appendToScreen(J), T.target) {
                    T = Xr(T);
                    var c = Jp(),
                        M = T.x,
                        $ = T.y,
                        _ = Po ? 60 : 12;
                    if (Po) {
                        var E = J.getBoundingClientRect();
                        B.left = M - E.width / 2 + dd, B.top = $ - E.height - _ < c.top ? $ + _ + dd : $ - E.height - _ + dd
                    } else {
                        B.left = M + _ + dd, B.top = $ + _ + dd;
                        var E = J.getBoundingClientRect();
                        E.left + E.width > c.width && (B.left = M - _ - E.width + dd), E.top + E.height > c.height && (B.top = $ - _ - E.height + dd), E.left < 0 && (B.left = M + _ + dd), E.top < 0 && (B.top = $ + _ + dd)
                    }
                } else B.left = T.x + dd, B.top = T.y + dd;
                mq(), U === O ? U = pp && pp.view : pp = { e: T, view: U }, U && U.onShowToolTip && U.onShowToolTip()
            },
            startDragging: function(h, n, $) { $ == O && ($ = !0), h !== nj && (nj ? $ && (Mc(n) ? nj.handleWindowTouchEnd(n) : nj.handleWindowMouseUp(n)) : Mc(n) ? (v(y, Nq, Mb), v(y, Zb, Qc)) : (v(y, Zp, Vr), v(y, Zc, Ql)), nj = h) },
            getImageMap: function() { return Qr },
            toBoundaries: function(i, j, o, H) {
                var M = [];
                return vc(i, j, o, H).forEach(function(P) {
                    var K = [];
                    P.forEach(function(i) { K.push(i.x, i.y) }), M.push(K)
                }), M
            },
            getCurrentKeyCodeMap: function() { return $m },
            drawCenterImage: function(Q, h, n, G, l, R, L, r) {
                !l && R && R.isSelfViewEvent && (l = R);
                var S = Hc(h, l, R),
                    y = Gp(h, l, R);
                as(Q, h, j(n - S / 2), j(G - y / 2), S, y, l, R, L, r)
            },
            drawStretchImage: function(N, R, C, V, F, U, D, O, g, E, K, h) {
                !O && g && g.isSelfViewEvent && (O = g);
                var _, Q = Hc(R, O, g, U),
                    H = Gp(R, O, g, D);
                "uniform" === C ? (_ = i(U / Q, D / H), Q *= _, H *= _, V += j((U - Q) / 2), F += j((D - H) / 2), U = Q, D = H) : "centerUniform" === C && ((Q > U || H > D) && (_ = i(U / Q, D / H), Q *= _, H *= _), V += j((U - Q) / 2), F += j((D - H) / 2), U = Q, D = H);
                var x = N.interactiveInfo;
                if (x) {
                    var q;
                    if (q = "center" === C ? { x: V + U / 2 - Q / 2, y: F + D / 2 - H / 2, width: Q, height: H } : { x: V, y: F, width: U, height: D }, x.rect) {
                        var Y = x.compInfos,
                            c = Y.length;
                        c && (Y[c - 1].rect.image = R)
                    } else x.rect = q
                }
                if ("center" === C) {
                    var P = K !== !1 && (Q > U || H > D);
                    P && (N.save(), N.beginPath(), N.rect(V, F, U, D), N.clip()), as(N, R, V + U / 2 - Q / 2, F + D / 2 - H / 2, Q, H, O, g, E, h), P && N.restore()
                } else as(N, R, V, F, U, D, O, g, E, h)
            },
            toCanvas: function(g, L, F, N, B, m, Z, P, V) {
                g = Jc(g, Z), L = L || Hc(g, B), F = F || Gp(g, B);
                var M = Sg(),
                    d = Bp(M);
                return P ? (Cq(M, L, F, P), d.scale(P, P)) : Cq(M, L, F, 1), Kq(d, g, N, 0, 0, L, F, B, m, Z, V), g && g.clampToEdge && (M.clampToEdge = g.clampToEdge), d.restore(), M
            },
            toGrayColor: function(X) {
                if (!X) return X;
                var F = qj(X),
                    E = j(.299 * F[0] + .587 * F[1] + .114 * F[2]);
                return "rgba(" + E + "," + E + "," + E + "," + F[3] / 255 + ")"
            },
            createGradientImage: function(L, T, q, c) { for (var R = ["L", 0, 0, L, 0, 1, 0, 0, 1, 0, 0], $ = 0, J = Math.min(T.length, q.length); J > $; $++) R.push(q[$], T[$]); var i = k.Default.toCanvas({ width: L, height: L, clampToEdge: !0, comps: [{ type: "shape", rotation: c || 0, points: [0, 0, L, 0, L, L, 0, L], background: "#ffffff", gradientPack: R }] }); return i },
            createElement: function(z, e, $, W) { var B = M.createElement(z); return Fl(B, e || l.widgetBorder, 2), B.style.font = $ ? $ : Zq, W != A && (B.value = W), D.onElementCreated && D.onElementCreated(B), B },
            containedInView: function(J, z) { var K = rf(z).getBoundingClientRect(); return Df({ x: K.left, y: K.top, width: K.width, height: K.height }, Sp(J)) },
            isIsolating: function() { return $k > 0 },
            setIsolating: function(G) { G ? $k++ : $k-- },
            getMSMap: function() { return Xp },
            stringify: function(r, T, I) {
                var W = Date.prototype.toJSON;
                Date.prototype.toJSON = function() { return "__ht__date" + this.getTime() };
                var u = Fq.prototype.toJSON;
                Fq.prototype.toJSON = function() { return "__ht__dataModel" + this.serialize(0) }, T = I ? 0 : T == A ? 2 : T;
                var K = JSON.stringify(r, function(C, G) { return "function" == typeof G ? "__ht__" + (G.__ht__ || G.toString()) : lc(G) ? Gb(G) : G instanceof k.List ? "__ht__list" + (G.__ht__list || D.stringify(G._as)) : G }, T);
                return Date.prototype.toJSON = W, Fq.prototype.toJSON = u, I && (K = xf + sk(K)), K
            },
            parse: function(e, y) {
                return Ok(e) ? e.substr(0, 12) != xf || (e = ao(e.substr(12)), Ok(e)) ? (y = y || {}, JSON.parse(e, function(U, q) {
                    if (Ok(q))
                        if (y.ignoreFunction || "__ht__function" != q.substr(0, 14)) { if (!y.ignoreDate && "__ht__date" == q.substr(0, 10)) return new Date(pr(q.substr(10))); if ("__ht__list" === q.substr(0, 10)) return new En(D.parse(q.substr(10))); if (!y.ignoreDataModel && "__ht__dataModel" === q.substr(0, 15)) { var N = new Fq; return N.deserialize(D.parse(q.substr(15))), N } } else {
                            var w = q.indexOf("{") + 1,
                                A = q.lastIndexOf("}"),
                                K = q.indexOf("(") + 1,
                                R = q.indexOf(")");
                            if (w && A && K && R) try { var c = new Function(q.substring(K, R), q.substring(w, A)); return c.__ht__ = q.substr(6), c } catch (L) { throw console.info("=== SyntaxError ===\n", q), L }
                        }
                    return q
                })) : e : e
            },
            loadJS: function(v, P) {
                P && v.push(P);
                var Y = v.shift();
                if (ud(Y)) v = Y.contact(v), D.loadJS(v);
                else if (Fe(Y)) Y(), D.loadJS(v);
                else if (Ok(Y)) {
                    var U = M.createElement("script");
                    U.onload = function() { D.loadJS(v) }, U.setAttribute("src", Y), M.getElementsByTagName("head")[0].appendChild(U)
                } else v.length && D.loadJS(v)
            },
            extendClass: function($, q) { var j = $.prototype; for (var J in q) Xp[J] && Xp.hasOwnProperty(J) ? Xp[J](j, q) : j[J] = q[J] },
            toRoundedCorner: function() {
                function e(N, g, I) { N.x = g.x, N.y = g.e || I, N.z = g.y }
                var m = new Cb,
                    H = new Cb,
                    M = new Cb,
                    _ = new Cb;
                return function(d, v) {
                    var V, N = 0;
                    d.getPoints && (N = d.getElevation(), d = d.getPoints()), V = d instanceof En ? d : new En(d);
                    var Z = V.size();
                    if (0 >= v) return { points: V };
                    var x = new En,
                        u = new En,
                        t = V.get(0);
                    e(m, t, N), x.add(t), u.add(1);
                    for (var J = 1; Z > J; J++)
                        if (Z > J + 1) {
                            var P = V.get(J),
                                n = V.get(J + 1);
                            e(H, P, N), e(M, n, N), _.subVectors(m, H).setLength(Math.min(.99 * _.length(), v)).add(H), P.e !== O || t.e !== O ? x.add({ x: _.x, y: _.z, e: _.y }) : x.add({ x: _.x, y: _.z }), x.add(P), _.subVectors(M, H).setLength(Math.min(.99 * _.length(), v)).add(H), P.e !== O || n.e !== O ? x.add(t = { x: _.x, y: _.z, e: _.y }) : x.add(t = { x: _.x, y: _.z }), m.copy(_), u.addAll([2, 3])
                        } else x.add(V.get(J)), u.add(2);
                    return { points: x, segments: u }
                }
            }(),
            toColorData: qj,
            setCanvas: Cq,
            createDiv: sf,
            createDisabledDiv: Ti,
            createView: oq,
            createCanvas: Sg,
            appendChild: Ml,
            initContext: Bp,
            checkLoadingImage: Rd,
            translateAndScale: Yk,
            layout: dq,
            getPosition: Hf,
            drawPoints: Eg,
            drawRoundRect: qd,
            drawBorder: Qn,
            setFocus: fm,
            getter: df,
            setter: Sr,
            isEmptyObject: ef,
            cameraPriority: function() {
                var K = { skybox: 0, main: 1e4, top: 1e7, infinity: 1 / 0 };
                return n.seal(n.defineProperties({}, {
                    skybox: {
                        configurable: !1,
                        enumerable: !1,
                        get: function() { return K.skybox },
                        set: function(C) {
                            if (C >= K.main) throw new RangeError("Skybox camera must have lower priority than the main camera.");
                            K.skybox = Number(C)
                        }
                    },
                    main: {
                        configurable: !1,
                        enumerable: !1,
                        get: function() { return K.main },
                        set: function(J) {
                            if (J <= K.skybox) throw new RangeError("Main camera must have higher priority than the skybox camera.");
                            if (J >= K.top) throw new RangeError("Main camera must have lower priority than the top camera.");
                            K.main = Number(J)
                        }
                    },
                    top: {
                        configurable: !1,
                        enumerable: !1,
                        get: function() { return K.top },
                        set: function(d) {
                            if (d <= K.main) throw new RangeError("Top camera must have higher priority than the main camera.");
                            K.top = Number(d)
                        }
                    }
                }))
            }()
        }, !0), gp(c, { autoAdjustIndex: 1, hierarchicalRendering: 1, adjustChildrenToTop: 1, autoHideScrollBar: 1, autoUpdate: 1, firstPersonMode: 1, ortho: 1, strict: 1, stickToRight: 1, instant: 1, closePath: 1, hierarchical: 1, doubleClickToToggle: 1, continuousLayout: 1, syncSize: 1 }, !0);
        var gl = D.disabledOpacity,
            Qh = D.toolTipDelay,
            fs = D.devicePixelRatio,
            Yc = D.autoMakeVisible,
            Br = D.autoHideScrollBar,
            zl = D.imageGradient,
            yo = D.showToolTip,
            Hd = D.hideToolTip,
            Ho = D.dashPattern,
            Jn = D.lineCap,
            Ec = D.lineJoin,
            Yg = D.labelColor,
            Yr = D.labelSelectColor,
            Zq = D.labelFont,
            Ef = D.widgetIndent,
            rk = D.widgetRowHeight,
            ks = D.widgetHeaderHeight,
            Bf = D.widgetTitleHeight,
            aq = D.scrollBarColor,
            Oq = D.scrollBarSize,
            Bg = D.scrollBarTimeout,
            ji = D.scrollBarMinLength,
            Xb = D.scrollBarInteractiveSize,
            Gi = D.zoomIncrement,
            ee = D.scrollZoomIncrement,
            Ol = D.pinchZoomIncrement,
            Wj = D.zoomMax,
            Zr = D.zoomMin,
            cj = D.createObject,
            sh = D.preventDefault,
            Dr = D.setImage,
            Jc = D.getImage,
            fe = D.isImageComplete,
            Gj = D.drawCenterImage,
            Kq = D.drawStretchImage,
            Ji = D.getId,
            Lh = D.callLater,
            xb = D.cancelLater,
            Ob = D.sortFunc,
            tf = D.clone,
            pm = D.getClass,
            Il = D.startAnim,
            gr = D.brighter,
            ah = D.darker,
            hg = D.drawText,
            Pg = D.getTextSize,
            pn = D.isLeftButton,
            kd = D.isMiddleButton,
            Up = D.isRightButton,
            Xk = D.getTouchCount,
            Mp = D.isDoubleClick,
            eq = D.isShiftDown,
            Xn = D.isCtrlDown,
            Sp = D.getClientPoint,
            Xr = D.getPagePoint,
            _q = D.getDistance,
            we = D.unionPoint,
            bp = D.unionRect,
            Df = D.containsPoint,
            io = D.containsRect,
            Jk = D.intersectsRect,
            _i = D.intersection,
            Jp = D.getWindowInfo,
            $f = D.grow,
            Mo = D.getLogicalPoint,
            Rk = D.getScreenPoint,
            zi = D.startDragging,
            tp = D.removeHTML,
            Im = D.createElement,
            sm = D.segmentResolution,
            sb = D.shapeResolution,
            Ee = D.shapeSide,
            eh = D.def,
            fi = function(a, Y, x) { eh(L + "." + a, Y, x) },
            jh = function(q, f) { q.childNodes.forEach(function(U) { f(U), jh(U, f) }) };
        gp(D, {
            toolTipLabelColor: Yg,
            toolTipLabelFont: Zq,
            toolTipBackground: l.toolTipBackground,
            toolTipShadowColor: sp,
            debugTipLabelFont: Zq,
            debugTipLabelColor: Yg,
            debugTipBackground: l.toolTipBackground,
            drawBreakableText: ci,
            setDevicePixelRatio: function(g) {
                fs = D.devicePixelRatio = "number" == typeof g ? g : y.screen ? y.screen.deviceXDPI / y.screen.logicalXDPI : 1, jh(M.body, function(z) {
                    var t = z._ht;
                    t && t._canvas && (Cq(t._canvas, t.getWidth(), t.getHeight()), t.redraw ? t.redraw() : t.iv())
                })
            }
        }, !0);
        var lq = 1e-6,
            jn = "undefined" != typeof Uint16Array ? Uint16Array : Array,
            ss = "undefined" != typeof Float32Array ? Float32Array : Array,
            zd = function(c, w, W) {
                var o = [c[0] - w[0], c[1] - w[1], c[2] - w[2]];
                if (W) {
                    var r = _q(o);
                    r > 0 && (o[0] /= r, o[1] /= r, o[2] /= r)
                }
                return o
            },
            wo = function() {
                var H = "charCodeAt",
                    w = 2 * (2 * ak.length + 1);
                for (var W in y)
                    if (W === L + Ui[0] + (dd.length + 2)) {
                        var i = y[W];
                        if (!i) break;
                        for (var $ = i.length, o = 0; $ > o; o++)
                            if (i[o][H](0) === w && i[o + 1] != A && i[o + 1] === dd[0] && i[o + 2] != A && i[o + 2][H](0) === w) {
                                for (var F = o + 3; $ > F; F++)
                                    if (i[F][H](0) === w) {
                                        if (0 == i[F + 1])
                                            for (var X, b = F + 2; $ > b; b++) {
                                                if (i[b][H](0) === w) { 0 == i[b - 1] && X && (_e = X.substr(0, X.length - 1)); break }
                                                X == A ? X = i[b] : X += i[b]
                                            }
                                        break
                                    }
                                break
                            }
                        break
                    }
                return function(s) { return [-s[0], -s[1], -s[2]] }
            }(),
            Uj = function(x, E) { return 3 === x.length ? x[0] * E[0] + x[1] * E[1] + x[2] * E[2] : x[0] * E[0] + x[1] * E[1] },
            ur = function() { var G = new Array(16); return G[0] = 1, G[1] = 0, G[2] = 0, G[3] = 0, G[4] = 0, G[5] = 1, G[6] = 0, G[7] = 0, G[8] = 0, G[9] = 0, G[10] = 1, G[11] = 0, G[12] = 0, G[13] = 0, G[14] = 0, G[15] = 1, G },
            Re = ur(),
            Ac = function(o) { var b = new Array(16); return b[0] = o[0], b[1] = o[1], b[2] = o[2], b[3] = o[3], b[4] = o[4], b[5] = o[5], b[6] = o[6], b[7] = o[7], b[8] = o[8], b[9] = o[9], b[10] = o[10], b[11] = o[11], b[12] = o[12], b[13] = o[13], b[14] = o[14], b[15] = o[15], b },
            Mn = function(Z, G) { return Z[0] = G[0], Z[1] = G[1], Z[2] = G[2], Z[3] = G[3], Z[4] = G[4], Z[5] = G[5], Z[6] = G[6], Z[7] = G[7], Z[8] = G[8], Z[9] = G[9], Z[10] = G[10], Z[11] = G[11], Z[12] = G[12], Z[13] = G[13], Z[14] = G[14], Z[15] = G[15], Z },
            ve = function(m) { return m[0] = 1, m[1] = 0, m[2] = 0, m[3] = 0, m[4] = 0, m[5] = 1, m[6] = 0, m[7] = 0, m[8] = 0, m[9] = 0, m[10] = 1, m[11] = 0, m[12] = 0, m[13] = 0, m[14] = 0, m[15] = 1, m },
            yi = function($, f) {
                var d = $[0],
                    e = $[1],
                    Z = $[2];
                return $[0] = f[0] * d + f[4] * e + f[8] * Z + f[12], $[1] = f[1] * d + f[5] * e + f[9] * Z + f[13], $[2] = f[2] * d + f[6] * e + f[10] * Z + f[14], $
            },
            ki = function(X, T) {
                var p = X[0],
                    q = X[1],
                    j = X[2],
                    l = X[3];
                return X[0] = T[0] * p + T[4] * q + T[8] * j + T[12] * l, X[1] = T[1] * p + T[5] * q + T[9] * j + T[13] * l, X[2] = T[2] * p + T[6] * q + T[10] * j + T[14] * l, X[3] = T[3] * p + T[7] * q + T[11] * j + T[15] * l, X
            },
            Sn = function() {
                var z, a, c, k, e = Tl(Yn[1] + Yn[7]),
                    l = Tl(Yn[0] + Yn[3] - Yn[10]),
                    D = Tl(Yn[8] + 2),
                    B = function() { return a = c.charAt(z), z += 1, a },
                    G = function() {
                        var P = "";
                        if (a === D)
                            for (; B();) {
                                if (a === D) return B(), P;
                                P += a
                            } else B()
                    },
                    M = function() { for (; a && " " >= a;) B() },
                    A = function() {
                        var h, j = {};
                        if (a === e) {
                            if (B(), M(), a === l) return B(), j;
                            for (; a;) {
                                if (h = G(), M(), B(), j[h] = k(), M(), a === l) return B(), j;
                                B(), M()
                            }
                        }
                    };
                return k = function() {
                        switch (M(), a) {
                            case e:
                                return A();
                            default:
                                return G()
                        }
                    },
                    function(R) { if (g = {}, R) { var O; if (c = R, z = 0, a = " ", O = k(), M(), !a) return O } }
            }(),
            gk = function(E, b) {
                if (b) {
                    var T = N(b),
                        u = C(b),
                        t = E[4],
                        w = E[5],
                        V = E[6],
                        P = E[7],
                        B = E[8],
                        e = E[9],
                        o = E[10],
                        X = E[11];
                    E[4] = t * u + B * T, E[5] = w * u + e * T, E[6] = V * u + o * T, E[7] = P * u + X * T, E[8] = B * u - t * T, E[9] = e * u - w * T, E[10] = o * u - V * T, E[11] = X * u - P * T
                }
            },
            tq = function(B, Q) {
                if (Q) {
                    var k = N(Q),
                        h = C(Q),
                        s = B[0],
                        E = B[1],
                        d = B[2],
                        a = B[3],
                        p = B[8],
                        o = B[9],
                        g = B[10],
                        V = B[11];
                    B[0] = s * h - p * k, B[1] = E * h - o * k, B[2] = d * h - g * k, B[3] = a * h - V * k, B[8] = s * k + p * h, B[9] = E * k + o * h, B[10] = d * k + g * h, B[11] = a * k + V * h
                }
            },
            bi = function(h, B) {
                if (B) {
                    var G = N(B),
                        l = C(B),
                        Q = h[0],
                        b = h[1],
                        X = h[2],
                        x = h[3],
                        F = h[4],
                        I = h[5],
                        S = h[6],
                        r = h[7];
                    h[0] = Q * l + F * G, h[1] = b * l + I * G, h[2] = X * l + S * G, h[3] = x * l + r * G, h[4] = F * l - Q * G, h[5] = I * l - b * G, h[6] = S * l - X * G, h[7] = r * l - x * G
                }
            },
            Rp = function(Z, l, i) { return cq(A, i === !1 ? A : Z.getFinalScale3d(), Z.getFinalRotation3d(), Z.getRotationMode(), Z.p3(), A, l) },
            cq = function(r, v, $, C, J, X, Y) { return X || (X = ur()), J && ge(X, J), Wl(X, $, C), Y && lk(X, X, Y), v && ro(X, v), r && lk(X, X, r), X },
            Vq = function(O, I, u) {
                I = pr(I), u = pr(u);
                var E = this;
                E.g = O, E._84O = I, E._85O = u, E._70I = !0, E.F = 0, E._83O = I + u, E.pen = { x: 0, y: 0 }
            },
            op = "lineDashOffset",
            ug = "setLineDash",
            bk = function(C) { for (var c in C) 1 === c.length && (op = C[c]); return c ? 1 : 0 },
            ad = function(I, T, N) { return se(T) ? I : I[ug] ? (I[ug](T), N && (I.lineDashOffset = N), I) : new Vq(I, T[0], T.length > 1 ? T[1] : T[0]) },
            Xd = function(i, R) {!se(R) && i[ug] && (i[ug](qf), i.lineDashOffset = 0) };
        eh(Vq, n, {
            _69I: 6,
            moveTo: function(N, b) {
                var Y = this,
                    F = Y.pen;
                F.x = N, F.y = b, Y.g.moveTo(N, b), Y.start || (Y.start = { x: N, y: b })
            },
            lineTo: function(J, r) {
                var m = this,
                    T = m.pen,
                    G = J - T.x,
                    _ = r - T.y,
                    h = Cc(_, G),
                    D = C(h),
                    L = N(h),
                    y = m._23O(T.x, T.y, J, r),
                    S = m._85O,
                    x = m._84O,
                    $ = m._83O;
                if (m.F) { if (m.F > y) return m._70I ? m._72I(J, r) : m.moveTo(J, r), m.F -= y, void 0; if (m._70I ? m._72I(T.x + D * m.F, T.y + L * m.F) : m.moveTo(T.x + D * m.F, T.y + L * m.F), y -= m.F, m.F = 0, m._70I = !m._70I, !y) return }
                var Q = w(y / $);
                if (Q) {
                    for (var i = D * x, u = L * x, k = D * S, M = L * S, P = 0; Q > P; P++) m._70I ? (m._72I(T.x + i, T.y + u), m.moveTo(T.x + k, T.y + M)) : (m.moveTo(T.x + k, T.y + M), m._72I(T.x + i, T.y + u));
                    y -= $ * Q
                }
                m._70I ? y > x ? (m._72I(T.x + D * x, T.y + L * x), m.moveTo(J, r), m.F = S - (y - x), m._70I = !1) : (m._72I(J, r), y === x ? (m.F = 0, m._70I = !m._70I) : (m.F = x - y, m.moveTo(J, r))) : y > S ? (m.moveTo(T.x + D * S, T.y + L * S), m._72I(J, r), m.F = x - (y - S), m._70I = !0) : (m.moveTo(J, r), y === S ? (m.F = 0, m._70I = !m._70I) : m.F = S - y)
            },
            quadraticCurveTo: function(y, d, r, T) {
                var C, Y = this,
                    R = Y.pen,
                    F = R.x,
                    X = R.y,
                    V = Y._22O(F, X, y, d, r, T),
                    e = 0,
                    N = 0,
                    u = Y._85O,
                    _ = Y._84O;
                if (Y.F) { if (Y.F > V) return Y._70I ? Y._71I(y, d, r, T) : Y.moveTo(r, T), Y.F -= V, void 0; if (e = Y.F / V, C = Y._20O(F, X, y, d, r, T, e), Y._70I ? Y._71I(C[2], C[3], C[4], C[5]) : Y.moveTo(C[4], C[5]), Y.F = 0, Y._70I = !Y._70I, !V) return }
                var J = V - V * e,
                    t = w(J / Y._83O),
                    O = _ / V,
                    n = u / V;
                if (t)
                    for (var o = 0; t > o; o++) Y._70I ? (N = e + O, C = Y._21O(F, X, y, d, r, T, e, N), Y._71I(C[2], C[3], C[4], C[5]), e = N, N = e + n, C = Y._21O(F, X, y, d, r, T, e, N), Y.moveTo(C[4], C[5])) : (N = e + n, C = Y._21O(F, X, y, d, r, T, e, N), Y.moveTo(C[4], C[5]), e = N, N = e + O, C = Y._21O(F, X, y, d, r, T, e, N), Y._71I(C[2], C[3], C[4], C[5])), e = N;
                J = V - V * e, Y._70I ? J > _ ? (N = e + O, C = Y._21O(F, X, y, d, r, T, e, N), Y._71I(C[2], C[3], C[4], C[5]), Y.moveTo(r, T), Y.F = u - (J - _), Y._70I = !1) : (C = Y._19O(F, X, y, d, r, T, e), Y._71I(C[2], C[3], C[4], C[5]), V === _ ? (Y.F = 0, Y._70I = !Y._70I) : (Y.F = _ - J, Y.moveTo(r, T))) : J > u ? (N = e + n, C = Y._21O(F, X, y, d, r, T, e, N), Y.moveTo(C[4], C[5]), C = Y._19O(F, X, y, d, r, T, N), Y._71I(C[2], C[3], C[4], C[5]), Y.F = _ - (J - u), Y._70I = !0) : (Y.moveTo(r, T), J === u ? (Y.F = 0, Y._70I = !Y._70I) : Y.F = u - J)
            },
            bezierCurveTo: function() {
                var T = arguments;
                this.pen = { x: T[4], y: T[5] }, this.g.bezierCurveTo(T[0], T[1], T[2], T[3], T[4], T[5])
            },
            arc: function(i, T, p, d, F, V) { V || (d = -d, F = -F), km(this, i, T, d, F - d, p, p, !1) },
            rect: function(w, F, z, l) {
                var I = this;
                I.pen = { x: w, y: F }, I.moveTo(w, F), I.lineTo(w, F + l), I.lineTo(w + z, F + l), I.lineTo(w + z, F), I.lineTo(w, F)
            },
            beginPath: function() { this.g.beginPath() },
            closePath: function() { this.lineTo(this.start.x, this.start.y) },
            _23O: function(I, v, D, M) {
                var N = D - I,
                    g = M - v;
                return z(N * N + g * g)
            },
            _22O: function(s, e, Q, V, t, i, T) { for (var d, K, D, A, X, B, p, N = 0, L = s, $ = e, O = T > 0 ? T : this._69I, U = 1; O >= U; U++) D = U / O, A = 1 - D, X = A * A, B = 2 * D * A, p = D * D, d = X * s + B * Q + p * t, K = X * e + B * V + p * i, N += this._23O(L, $, d, K), L = d, $ = K; return N },
            _21O: function(V, E, A, N, v, Q, P, f) { var S = this; if (0 === P) return S._20O(V, E, A, N, v, Q, f); if (1 === f) return S._19O(V, E, A, N, v, Q, P); var W = S._20O(V, E, A, N, v, Q, f); return W.push(P / f), S._19O.apply(S, W) },
            _20O: function(g, Y, n, b, X, i, k) {
                if (1 !== k) {
                    var w = n + (X - n) * k,
                        o = b + (i - b) * k;
                    n = g + (n - g) * k, b = Y + (b - Y) * k, X = n + (w - n) * k, i = b + (o - b) * k
                }
                return [g, Y, n, b, X, i]
            },
            _19O: function(k, F, B, A, X, T, G) {
                if (1 !== G) {
                    var i = k + (B - k) * G,
                        j = F + (A - F) * G;
                    B += (X - B) * G, A += (T - A) * G, k = i + (B - i) * G, F = j + (A - j) * G
                }
                return [k, F, B, A, X, T]
            },
            _72I: function(T, w) {
                var o = this.pen;
                (T !== o.x || w !== o.y) && (o.x = T, o.y = w, this.g.lineTo(T, w))
            },
            _71I: function($, J, d, I) {
                var X = this.pen;
                ($ !== d || J !== I || d !== X.x || I !== X.y) && (X.x = d, X.y = I, this.g.quadraticCurveTo($, J, d, I))
            }
        }), eo = Se() + 1, co && y.console && eo && !0 && (y.navigator && y.navigator.userAgent.toLowerCase().indexOf("chrome") > -1 ? y.console.log.apply(console, ["Hightopo - Version" + k.Default.getVersion() + " - %cTrialhttp://hightopo.com/request.html", "color: #f00;"]) : y.console.log("Hightopo - Version" + k.Default.getVersion() + " - Trialhttp://hightopo.com/request.html"));
        var Ik = A,
            ih = A,
            _d = D.checkLoadingCompType = function(H) { Ik && !H._72O && (ih || (ih = {}), ih[H._72O = Ji()] = H) },
            vi = function(i, k) {
                if (k || (k = i), k && (Ik || (Ik = {}), !Ik[i])) {
                    var Q = new Gq;
                    if (Ik[k] = { request: Q, url: k }, k = D.beforeLoadURL(k, i), k.data) {
                        var P = D.parse(k.data);
                        kn(i, P), D.handleCompTypeLoaded(i, P)
                    } else {

                        let params = {
                            "width": 240,
                            "height": 500,
                            "func": "__ht__function(g, rect, comp, data, view) { \nvar ft = {'width':240,'height':56,'comps':[{'type':'rect','background':'#404040','borderColor':'#979797','rect':[0,0,240,36.49397]},{'type':'rect','borderWidth':2,'borderColor':'#f9f9f9','borderCap':'round','anchorX':0,'anchorY':0,'rect':[20.8,0,198.4,36.49397]},{'type':'shape','background':'#404040','closePath':true,'points':[6.14311,38,38.37408,38,31.03886,55.8746,12.61379,55.8746]},{'type':'shape','background':'#404040','closePath':true,'points':[199.54434,38,231.77531,38,224.44009,55.8746,206.01502,55.8746]},{'type':'oval','background':'rgb(20,20,20)','borderWidth':1,'borderColor':'rgb(219,219,219)','rect':[31.51866,11.14316,13.71085,14.20765]},{'type':'shape','borderWidth':1,'borderColor':'rgb(219,219,219)','points':[33.72323,13.09132,38.78916,17.81871,33.72323,23.25018,38.78916,17.81871,43.35844,23.25018,38.78916,17.81871,43.35844,13.09132]},{'type':'oval','background':'rgb(20,20,20)','borderWidth':1,'borderColor':'rgb(219,219,219)','rect':[197.54434,11.06692,13.71085,14.20765]},{'type':'shape','borderWidth':1,'borderColor':'rgb(219,219,219)','points':[199.74891,13.01508,204.81485,17.74247,199.74891,23.17394,204.81485,17.74247,209.38412,23.17394,204.81485,17.74247,209.38412,13.01508]}]}  \nvar hd = {'width':240,'height':50,'comps':[{'type':'rect','background':'#404040','borderColor':'#979797','rect':[0,0,240,50]},{'type':'rect','borderWidth':2,'borderColor':'#f9f9f9','borderCap':'round','anchorX':0,'anchorY':0,'rect':[20.8,0,198.4,49.5]}]}\nvar usize = comp.getValue('usize'),\n\tmainColor = comp.getValue('mainColor'),\n\tname = comp.getValue('name') || 'Rack';\n\nvar width = rect.width,\n\theight = rect.height;\n\nvar uh = 20.8,\n\tU_GAP = 2,\n\thh = 30,\n\tfh = 56; width += U_GAP;\n\n// var childrenIndexs = [];\n// data.getChildren().each(function(child) {\n// \tchildrenIndexs.push(child.a('uindex'));\n// });\n\nht.Default.drawImage(g, ht.Default.getImage(hd), 0, 0, width, hh);\nht.Default.drawText(g, name, '15px Calibri', '#ffffff', 0, 0, width, hh, 'center', 'middle');\n//left rect\ng.save();\ng.fillStyle = mainColor;\ng.fillRect(0, hh, uh, (uh+U_GAP) * usize);\ng.restore();\n\n//right rect\ng.save();\ng.fillStyle = mainColor;\ng.fillRect(width - uh, hh, uh, (uh+U_GAP) * usize);\ng.restore();\n// u\nvar uy = hh;\nfor (var i = 0; i < usize; i++) {\t\n\t// u rect\n\tg.save();\n\tg.fillStyle = '#332E34';\n\tg.fillRect(uh, uy, width - uh * 2, (uh+U_GAP));\n\tg.strokeStyle = '#1B161C';\n\tg.strokeRect(uh, uy, width - uh * 2, (uh+U_GAP));\n\tg.restore();\n\n\t// u index\n\t// if (childrenIndexs.indexOf(usize - 1) < 0) {\n\t\tht.Default.drawText(g, ((usize - i) < 10 ? '0' : '') + (usize - i), '10px Calibri', '#5F6062', uh, uy, width - uh * 2, (uh+U_GAP), 'center', 'middle');\n\t// }\n\n\tif ((usize - i) % 5 === 0) {\n\t\tg.save();\n\t\tg.fillStyle = '#AF0917';\n\t\tg.beginPath();\n\t\tg.arc(uh * 0.5, uy + (uh+U_GAP) * 0.5, 2, 0, 2 * Math.PI, false);\n\t\tg.fill();\n\t\tg.restore();\n\n\t\tg.save();\n\t\tg.fillStyle = '#AF0917';\n\t\tg.beginPath();\n\t\tg.arc(width - uh * 0.5, uy + (uh+U_GAP) * 0.5, 2, 0, 2 * Math.PI, false);\n\t\tg.fill();\n\t\tg.restore();\n\t}\n\t\n\tuy += (uh+U_GAP);\n}\n\n//footer\nht.Default.drawImage(g, ht.Default.getImage(ft), 0, uy, width, fh);\n}",
                            "properties": {
                                "usize": {
                                    "valueType": "PositiveNumber",
                                    "defaultValue": 16
                                },
                                "name": {
                                    "valueType": "String",
                                    "defaultValue": "Rack"
                                },
                                "mainColor": {
                                    "valueType": "Color",
                                    "defaultValue": "#4A4A4A"
                                }
                            }
                        }
                        let a = JSON.stringify(params)
                        var X = D.parse(a);
                        kn(i, X), D.handleCompTypeLoaded(i, X)
                            // jQuery.get(encodeURI(k), function(params) {

                        //     })
                        // Q.onload = function() {
                        //     if (200 === this.status || 0 === this.status) {
                        //         var X = D.parse(Q.getResponseText());
                        //         console.log(X, 3);
                        //         kn(i, X), D.handleCompTypeLoaded(i, X)
                        //     } else kn(i, A)
                        // }
                        //     , Q.onerror = function() { kn(i, A) };
                        // var w = {};
                        // console.log(w, encodeURI(k), 2222);
                        // w.url = encodeURI(k), w.sync = !1, Q.send(w)
                    }
                }
            },
            kn = function(b, F) {
                if (pi[b] = F, delete Ik[b], ef(Ik) && (Ik = A, ih)) {
                    for (var d in ih) {
                        var x = ih[d];
                        x.invalidateAll && x.invalidateAll(O, "compTypeLoaded", b), x.redraw && x.redraw(), x.iv(), delete x._72O
                    }
                    ih = A
                }
                if (F && ih)
                    for (var d in ih) {
                        var x = ih[d];
                        x.invalidateAll && x.invalidateAll(O, "compTypeLoading", b), x.redraw && x.redraw(), x.iv()
                    }
            },
            Ek = l.chart,
            Hq = "",
            qg = !0,
            nk = D.compStack = [],
            ye = /^style@/,
            Pc = /^attr@/,
            _f = /^field@/,
            jm = { x: .5, y: .5 },
            Gr = function() { qg = !0 },
            ws = function() { return qg },
            Hc = function(L, x, s, p) { if (!L) return 0; if (Rr(L.fitSize, x, s) && p) return p; var w = Rr(L.width, x, s); return null == w ? 20 : w },
            Gp = function(x, K, o, V) { if (!x) return 0; if (Rr(x.fitSize, K, o) && V) return V; var E = Rr(x.height, K, o); return null == E ? 20 : E },
            Rr = function(v, u, Z) {
                if (!v || !v.func) return v;
                var X, f = v.func,
                    L = v.value;
                return X = Fe(f) ? Z && Z.vectorDataBindingDisabled && !v.isSafeFunc ? L : f(u, Z) : u instanceof Bq || (k.ui ? u instanceof k.ui.View : 0) ? Pc.test(f) ? u.a(Hq + f.slice(5)) : ye.test(f) ? u.s(Hq + f.slice(6)) : _f.test(f) ? u[f.slice(6)] : u[f] ? u[f](Z) : L : L, L !== O && X == A ? L : X
            },
            as = D.drawImage = function() {
                var X, p, o, W, Z, G, F = 3,
                    _ = 6,
                    T = function(a) { var Z, s, W, V = !1; return Q(a, "shadow") && (Z = Q(a, "shadowOffsetX") || F, s = Q(a, "shadowOffsetY") || F, W = Q(a, "shadowBlur") || _, V = !0), !V && p instanceof Bq && ((ic(p, hd, "shadow") || "shadow" === ic(p, hd, "select.type") && o && o.isSelected && o.isSelected(p)) && (Z = ic(p, hd, "shadow.offset.x") || 0, s = ic(p, hd, "shadow.offset.y") || 0, W = ic(p, hd, "shadow.blur") || 0, V = !0), !V && ic(p, hd, "shadow2") && (Z = ic(p, hd, "shadow2.offset.x") || 0, s = ic(p, hd, "shadow2.offset.y") || 0, W = ic(p, hd, "shadow2.blur") || 0, V = !0)), V ? 1.5 * W + Math.max(Z, s) : 0 },
                    n = function(A, d) {
                        A.getValue && A.getValue.compType === d || (A.getValue = function(f) {
                            var v = Q(A, f);
                            if (v === O && d.properties) {
                                var s = d.properties[f];
                                s && (v = s.defaultValue)
                            }
                            return v
                        }, A.getColor = function(Q, g) { return g === !0 ? c(Q) : c(A.getValue(Q)) }, A.getValue.compType = d)
                    },
                    Q = function(B, l, c) {
                        var w, T = !1;
                        if (B.prefix && p instanceof Bq) {
                            var C = p.a(Hq + l);
                            C !== O && (T = !0, w = C)
                        }
                        return w === O && (w = B[l]), w && w.func && (T = !0, w = Rr(w, p, o)), c && (w = c(w), T || (B[l] = w)), w
                    },
                    c = function(v, m) { var R; return R = m ? Q(v, m) : v, X && X.compGray && R ? D.toGrayColor(R) : Z && R ? jk(R, Z, G) : R },
                    H = function(w) {
                        if (ud(w)) {
                            for (var G = new En, K = w.length, c = 0; K > c; c += 2) G.add({ x: w[c], y: w[c + 1] });
                            w = G
                        }
                        return w
                    },
                    P = function(f) {
                        var c = Q(f, "anchorX"),
                            g = Q(f, "anchorY");
                        if (c !== O || g !== O) return { x: c === O ? jm.x : c, y: g === O ? jm.y : g };
                        var F = Q(f, "type"),
                            q = Q(f, "name");
                        if ("image" !== F || !q) return jm;
                        var I = Jc(q);
                        return I && I.anchorX !== O && I.anchorY !== O ? { x: I.anchorX, y: I.anchorY } : jm
                    },
                    J = function(D, r) {
                        var z = Q(D, Ej),
                            $ = P(D);
                        if (ud(z)) {
                            var p = z.length,
                                W = Q(D, "relative"),
                                k = r.width,
                                w = r.height;
                            if (4 === p) z = { x: z[0], y: z[1], width: z[2], height: z[3] }, W && (z.x *= k, z.y *= w, z.width *= k, z.height *= w);
                            else if (3 === p) {
                                var d = z[0];
                                z = { width: z[1], height: z[2] }, W && (z.width *= k, z.height *= w), "object" == typeof d ? d.length && (d = { x: d[0], y: d[1] }) : d = Hf(d, r, z), z.x = d.x - z.width * $.x, z.y = d.y - z.height * $.y
                            }
                            z.x += Q(D, "offsetX") || 0, z.y += Q(D, "offsetY") || 0, !W && r.fitSize && (z = S(D, z, r))
                        }
                        return z
                    },
                    S = function(k, b, l) {
                        if (b) {
                            var $, J, y, I = { x: b.x, y: b.y, width: b.width, height: b.height },
                                V = P(k),
                                u = Q(k, "layoutH"),
                                F = Q(k, "layoutV"),
                                e = 1,
                                m = 1,
                                c = 0,
                                j = 0,
                                N = 1,
                                G = 1;
                            switch (u) {
                                case "left":
                                    break;
                                case "right":
                                    I.x += l.width - l.rw;
                                    break;
                                case "center":
                                    I.x += .5 * (l.width - l.rw);
                                    break;
                                case "scale":
                                case "leftright":
                                default:
                                    $ = Q(k, ij) || 0, $ && (c = Math.abs(j = Math.sin($)), N = Math.abs(G = Math.cos($))), "leftright" !== u ? (e += N * (l.widthScale - 1), m += c * (l.widthScale - 1)) : (e += I.width ? N * (l.width - l.rw) / I.width : 0, m += I.height ? c * (l.width - l.rw) / I.height : 0, J = -Math.min(-V.x * G + V.y * j, -V.x * G - (1 - V.y) * j, (1 - V.x) * G + V.y * j, (1 - V.x) * G - (1 - V.y) * j))
                            }
                            switch (F) {
                                case "top":
                                    break;
                                case "bottom":
                                    I.y += l.height - l.rh;
                                    break;
                                case "center":
                                    I.y += .5 * (l.height - l.rh);
                                    break;
                                case "scale":
                                case "topbottom":
                                default:
                                    $ == A && ($ = Q(k, ij), $ && (c = Math.abs(j = Math.sin($)), N = Math.abs(G = Math.cos($)))), "topbottom" !== F ? (e += c * (l.heightScale - 1), m += N * (l.heightScale - 1)) : (e += I.width ? c * (l.height - l.rh) / I.width : 0, m += I.height ? N * (l.height - l.rh) / I.height : 0, y = -Math.min(-V.x * j - V.y * G, -V.x * j + (1 - V.y) * G, (1 - V.x) * j - V.y * G, (1 - V.x) * j + (1 - V.y) * G))
                            }
                            return (1 !== e || 1 !== m) && ("scale" !== u && u ? "leftright" === u && (I.x += I.width * (1 - e) * V.x + J * (l.width - l.rw)) : I.x += I.x * (l.widthScale - 1) + V.x * I.width * (l.widthScale - e), "scale" !== F && F ? "topbottom" === F && (I.y += I.height * (1 - m) * V.y + y * (l.height - l.rh)) : I.y += I.y * (l.heightScale - 1) + V.y * I.height * (l.heightScale - m), I.width *= e, I.height *= m), I.width < 0 && (I.width = 0), I.height < 0 && (I.height = 0), I
                        }
                    },
                    E = function(A) { return ud(A) ? new En(A) : A },
                    B = function(J, Y, x, p, o, y, W) {
                        var D = X.interactiveInfo,
                            w = J.transform;
                        if (w) return X.save(), X.setTransform(w.a, w.b, w.c, w.d, w.tx, w.ty), D && D.compInfos.push({ comp: J, rect: Y, matrix: w.clone(), prefix: Hq, refRect: D.refRect }), !0;
                        o === O && (o = 1), y === O && (y = 1);
                        var U = Q(J, "clipPercentage"),
                            g = Me(x, Y);
                        if (g && !p && 1 === o && 1 === y && !(1 > U)) return D && D.compInfos.push({ comp: J, rect: Y, matrix: D.matrix.clone(), prefix: Hq, refRect: D.refRect }), !1;
                        W = W || jm;
                        var t = Y.x + Y.width * W.x,
                            E = Y.y + Y.height * W.y,
                            A = x.x + x.width * W.x,
                            n = x.y + x.height * W.y,
                            V = x.width ? o * (Y.width / x.width) : 1,
                            I = x.height ? y * (Y.height / x.height) : 1;
                        if (X.save(), D && (D.matrix.appendTranslate(t, E).appendRotate(p).appendScale(V, I).appendTranslate(-A, -n), D.compInfos.push({ comp: J, rect: Y, matrix: D.matrix.clone(), prefix: Hq, refRect: D.refRect })), ts(X, t, E), nm(X, p || 0), Zm(X, V, I), ts(X, -A, -n), 1 > U) {
                            0 > U && (U = 0);
                            var q = Ln(x, Q(J, "clipDirection"), U, T(J));
                            X.beginPath(), X.rect(q.x, q.y, q.width, q.height), X.clip()
                        }
                        return !0
                    },
                    V = function() { X.restore() },
                    k = function(C, r, R) {
                        var T = Q(C, "path"),
                            E = Q(C, ij),
                            H = Q(C, "scaleX"),
                            U = Q(C, "scaleY"),
                            e = P(C),
                            L = A,
                            h = Vg(null, T);
                        if (R || (R = C.unionRect, R || (R = we(h), C.path.func || (C.unionRect = R)), L = R), R) {
                            L || (L = C.unionRect, L || (L = we(h), C.path.func || (C.unionRect = L)));
                            var D = B(C, R, L, E, H, U, e),
                                N = Q(C, "borderPattern"),
                                _ = ad(X, N),
                                Z = c(C, "background"),
                                d = c(C, "borderColor"),
                                j = Q(C, "borderWidth"),
                                m = Q(C, "gradient"),
                                x = c(C, "gradientColor"),
                                f = Q(C, "border3d"),
                                y = c(C, "border3dColor"),
                                w = Q(C, "border3dAccuracy"),
                                g = X.lineJoin,
                                a = X.lineCap;
                            X.lineJoin = Q(C, "borderJoin") || Ec, X.lineCap = Q(C, "borderCap") || Jn, Z ? (Vd(X, Z, m, x, L), Vg(X, T), X.fill(), _ !== X && Vg(X, T)) : Vg(X, T);
                            var Y = Q(C, "borderWidthAbsolute");
                            if (Y && (X.save(), X.setTransform(1, 0, 0, 1, 0, 0)), j && d && (X.lineWidth = j, X.strokeStyle = d, X.stroke(), f && pj(X, d, y, j, W, w)), Xd(X, N), Q(C, "dash")) {
                                var l = Q(C, "dashWidth") || j;
                                if (l > 0) {
                                    N = Q(C, "dashPattern") || Ho;
                                    var _ = ad(X, N, Q(C, "dashOffset")),
                                        $ = c(C, "dashColor") || c(Ai);
                                    _ !== X && Vg(X, T), X.strokeStyle = $, X.lineWidth = l, X.stroke(), Q(C, "dash3d") && pj(X, $, c(C, "dash3dColor"), l, W, Q(C, "dash3dAccuracy")), Xd(X, N)
                                }
                            }
                            Y && X.restore(), r === Ej && cb(X, Z, Q(C, "depth"), L), X.lineJoin = g, X.lineCap = a, D && V()
                        }
                    },
                    e = function(b, i, l, v) {
                        var y = Q(b, Vf, H),
                            s = Q(b, ij),
                            h = P(b);
                        if (y && v.fitSize) {
                            var e = new En,
                                N = we(y),
                                _ = S(b, N, v),
                                n = N.x + h.x * N.width,
                                r = N.y + h.y * N.height,
                                x = _.x + h.x * _.width,
                                D = _.y + h.y * _.height,
                                J = N.width ? _.width / N.width : 1,
                                k = N.height ? _.height / N.height : 1;
                            y.each(function(K) { e.add({ x: x + (K.x - n) * J, y: D + (K.y - r) * k }) }), y = e, b.unionRect = null
                        }
                        var w = Q(b, "scaleX"),
                            C = Q(b, "scaleY"),
                            d = i === ii,
                            L = A;
                        if (!l && d && (l = b.unionRect, l || (l = we(y), b.points.func || (b.unionRect = l)), L = l), l) {
                            d ? L || (L = b.unionRect, L || (L = we(y), b.points.func || (b.unionRect = L))) : L = l;
                            var g, K, F, j, U = B(b, l, L, s, w, C, h),
                                t = Q(b, "borderPattern"),
                                I = ad(X, t),
                                m = c(b, "background"),
                                Y = Jc(Q(b, "repeatImage"), Z, G),
                                R = Q(b, "gradientPack"),
                                $ = c(b, "borderColor"),
                                z = Q(b, "borderWidth"),
                                u = Jc(Q(b, "borderRepeatImage"), Z, G),
                                q = Q(b, "segments", E),
                                O = Q(b, "gradient"),
                                a = c(b, "gradientColor"),
                                M = Q(b, "border3d"),
                                f = c(b, "border3dColor"),
                                np = Q(b, "border3dAccuracy"),
                                al = Q(b, "closePath"),
                                hd = Q(b, "fillRule") || "nonzero",
                                aj = X.lineJoin,
                                Eb = X.lineCap,
                                vh = T(b);
                            if (X.lineJoin = Q(b, "borderJoin") || Ec, X.lineCap = Q(b, "borderCap") || Jn, d)
                                if (m || Y || R) {
                                    var ao = Q(b, "fillClipPercentage");
                                    if (1 > ao) {
                                        0 > ao && (ao = 0);
                                        var $c = Ln(L, Q(b, "fillClipDirection"), ao, vh);
                                        X.save(), X.beginPath(), X.rect($c.x, $c.y, $c.width, $c.height), X.clip()
                                    }
                                    Eg(X, y, q, al), R ? uj(X, R, c) : Y ? Hn(X, Y, Z, G, p, o) : Vd(X, m, O, a, L), X.fill(hd), R && X.restore(), 1 > ao && X.restore(), I !== X && Eg(I, y, q, al)
                                } else Eg(I, y, q, al);
                            else if ("roundRect" === i ? g = Q(b, "cornerRadius") : "polygon" === i ? g = Q(b, "polygonSide") : "arc" === i && (g = Q(b, "arcFrom"), K = Q(b, "arcTo"), F = Q(b, "arcClose"), j = Q(b, "arcOval")), m || Y || R) {
                                var ao = Q(b, "fillClipPercentage");
                                if (1 > ao) {
                                    0 > ao && (ao = 0);
                                    var $c = Ln(L, Q(b, "fillClipDirection"), ao, vh);
                                    X.save(), X.beginPath(), X.rect($c.x, $c.y, $c.width, $c.height), X.clip()
                                }
                                mj(X, i, L, g, K, F, j), R ? uj(X, R, c) : Y ? Hn(X, Y, Z, G, p, o) : Vd(X, m, O, a, L), X.fill(hd), R && X.restore(), 1 > ao && X.restore(), X !== I && mj(I, i, L, g, K, F, j)
                            } else mj(I, i, L, g, K, F, j);
                            var Aq = Q(b, "borderWidthAbsolute");
                            if (Aq && (X.save(), X.setTransform(1, 0, 0, 1, 0, 0)), z && ($ || u) && (X.lineWidth = z, u ? od(X, u, Z, G, p, o) : X.strokeStyle = $, X.stroke(), M && pj(X, $, f, z, W, np)), Xd(X, t), Q(b, "dash")) {
                                var Kn = Q(b, "dashWidth") || z;
                                if (Kn > 0) {
                                    t = Q(b, "dashPattern") || Ho;
                                    var I = ad(X, t, Q(b, "dashOffset")),
                                        di = c(b, "dashColor") || c(Ai);
                                    I !== X && (d ? Eg(I, y, q, al) : mj(I, i, L, g, K, F, j)), X.strokeStyle = di, X.lineWidth = Kn, X.stroke(), Q(b, "dash3d") && pj(X, di, c(b, "dash3dColor"), Kn, W, Q(b, "dash3dAccuracy")), Xd(X, t)
                                }
                            }
                            Aq && X.restore(), i === Ej && cb(X, m, Q(b, "depth"), L), X.lineJoin = aj, X.lineCap = Eb, U && V()
                        }
                    },
                    u = function(a, n) {
                        var U = Z || Q(a, gd),
                            W = G || Q(a, "blendMode"),
                            q = Q(a, "name"),
                            R = Jc(q, U, W);
                        R && R.cacheRule != A && (R = Uh(X, R, Q(a, "stretch"), n.width, n.height, p, o, U)), R ? Kq(X, R, Q(a, "stretch"), n.x, n.y, n.width, n.height, p, o, U, null, W) : qg = !1
                    },
                    v = function(k, o) {
                        var u = Q(k, "text");
                        if (u != A) {
                            var B = Q(k, "gradientPack"),
                                d = B ? uj(X, B, c) : c(k, gd);
                            hg(X, u, Q(k, "font"), d, o.x, o.y, o.width, o.height, Q(k, "align"), Q(k, "vAlign")), B && X.restore()
                        }
                    },
                    x = function(H, w) { Qn(X, c(H, gd), w.x, w.y, w.width, w.height, Q(H, "width")) },
                    b = function(z, e) {
                        var n = Q(z, wn),
                            R = 0;
                        if (n && (n.forEach(function(p) { R += p }), R > 0)) {
                            for (var t = Q(z, "colors") || Ek, $ = Q(z, "startAngle") || 0, s = Q(z, "hollow"), F = Q(z, $c), M = Q(z, Vn), o = Q(z, oj), G = F ? new En : A, g = e.x, K = e.y, I = e.width, Y = e.height, k = g + I / 2, y = K + Y / 2, E = i(I, Y) / 2, w = 0, f = 0; f < n.length; f++) {
                                var c = n[f],
                                    b = m * c / R,
                                    j = $ + b;
                                if (X.fillStyle = t[w++], w === t.length && (w = 0), X.beginPath(), s) {
                                    var D = k + C($) * E / 2,
                                        V = y + N($) * E / 2,
                                        L = k + C(j) * E,
                                        l = y + N(j) * E;
                                    X.moveTo(D, V), X.arc(k, y, E / 2, $, j, !1), X.lineTo(L, l), X.arc(k, y, E, j, $, !0)
                                } else X.moveTo(k, y), X.arc(k, y, E, j, $, !0);
                                G && (b = ($ + j) / 2, G.add({ text: Fe(F) ? F(c, f, R, p) : c, x: k + .75 * C(b) * E, y: y + .75 * N(b) * E })), X.closePath(), X.fill(), $ = j
                            }
                            G && G.each(function(C) { hg(X, C.text, M, o, C.x, C.y, 0, 0, Tc) })
                        }
                    },
                    l = function(x, F) {
                        var J = Q(x, ko);
                        if (J && J.length > 0) {
                            var i = J.length,
                                T = Q(x, $c),
                                V = Q(x, Vn),
                                N = Q(x, oj),
                                l = T ? new En : A,
                                B = Q(x, "minValue") || 0,
                                E = Q(x, "maxValue");
                            if (E == A && (E = 0, J.forEach(function(G) { Q(G, wn).forEach(function(Q) { E = K(E, Q) }) })), B === E) return;
                            for (var L = F.height / (E - B), c = F.y + E * L, o = Q(J[0], wn).length, j = F.width / (3 * o + 1), u = 2 * j / i, m = 0, d = 0; i > d; d++)
                                for (var R = J[d], y = Q(R, gd), e = Q(R, "colors"), G = Q(R, wn), S = 0; o > S; S++) {
                                    e ? X.fillStyle = e[S] : y ? X.fillStyle = y : (X.fillStyle = Ek[m++], m === Ek.length && (m = 0));
                                    var r = G[S],
                                        O = r * L,
                                        s = F.x + (1 + 3 * S) * j + d * u;
                                    if (re(X, s, c - O, u, O), l) {
                                        var w = Fe(T) ? T(r, S, R, p) : r,
                                            H = Pg(V, w).height;
                                        l.add({ x: s, y: c - O - H, width: u, height: H, text: w })
                                    }
                                }
                            l && l.each(function(q) { hg(X, q.text, V, N, q.x, q.y, q.width, q.height, Tc) })
                        }
                    },
                    I = function(I, s) {
                        var M = Q(I, ko);
                        if (M && M.length > 0) {
                            var l = M.length,
                                h = Q(M[0], wn).length,
                                g = s.width / (3 * h + 1),
                                W = 0,
                                C = Q(I, "maxValue"),
                                f = Q(I, $c),
                                Z = Q(I, Vn),
                                j = Q(I, oj),
                                e = f ? new En : A;
                            if (C == A) {
                                C = 0;
                                for (var $ = 0; h > $; $++) {
                                    for (var D = 0, G = 0; l > G; G++) D += Q(M[G], wn)[$];
                                    C = K(C, D)
                                }
                            }
                            if (C > 0) {
                                for (var $ = 0; h > $; $++)
                                    for (var Y = s.y + s.height, G = 0; l > G; G++) {
                                        var c = M[G],
                                            J = Q(c, gd),
                                            w = Q(c, wn)[$],
                                            R = w / C * s.height;
                                        J ? X.fillStyle = J : (X.fillStyle = Ek[W++], W === Ek.length && (W = 0)), Y -= R;
                                        var E = { x: s.x + (1 + 3 * $) * g, y: Y, width: 2 * g, height: R };
                                        re(X, E.x, E.y, E.width, E.height), e && (E.text = Fe(f) ? f(w, $, c, p) : w, e.add(E))
                                    }
                                e && e.each(function(Y) { hg(X, Y.text, Z, j, Y.x, Y.y, Y.width, Y.height, Tc) })
                            }
                        }
                    },
                    j = function(F, $) {
                        var I = Q(F, ko);
                        if (I && I.length > 0) {
                            for (var a = I.length, e = Q(I[0], wn).length, d = $.width / (3 * e + 1), x = 0, j = Q(F, $c), q = Q(F, Vn), w = Q(F, oj), M = j ? new En : A, D = 0; e > D; D++) {
                                for (var n = 0, V = 0; a > V; V++) n += Q(I[V], wn)[D];
                                if (n > 0) {
                                    var f = $.y + $.height;
                                    for (V = 0; a > V; V++) {
                                        var i = I[V],
                                            O = Q(i, gd),
                                            L = Q(i, wn)[D],
                                            t = L / n * $.height;
                                        O ? X.fillStyle = O : (X.fillStyle = Ek[x++], x === Ek.length && (x = 0)), f -= t;
                                        var G = { x: $.x + (1 + 3 * D) * d, y: f, width: 2 * d, height: t };
                                        re(X, G.x, G.y, G.width, G.height), M && (G.text = Fe(j) ? j(L, D, i, p) : L, M.add(G))
                                    }
                                }
                            }
                            M && M.each(function(L) { hg(X, L.text, q, w, L.x, L.y, L.width, L.height, Tc) })
                        }
                    },
                    R = function(c, q) {
                        var h = Q(c, ko);
                        if (h && h.length > 0) {
                            var F = h.length,
                                Z = Q(c, "minValue") || 0,
                                T = Q(c, "maxValue");
                            if (T == A && (T = 0, h.forEach(function(y) { Q(y, wn).forEach(function(I) { T = K(T, I) }) })), Z === T) return;
                            for (var w = q.height / (T - Z), j = q.y + T * w, Y = Q(h[0], wn).length, x = q.width / (3 * Y + 1), d = 0, i = Q(c, "lineWidth") || 2, z = Q(c, "line3d"), E = Q(c, "linePoint"), v = Q(c, $c), N = Q(c, Vn), k = Q(c, oj), l = 0; F > l; l++) {
                                var r = h[l],
                                    V = Q(r, gd),
                                    L = Q(r, wn);
                                V ? X.strokeStyle = V : (V = X.strokeStyle = Ek[d++], d === Ek.length && (d = 0)), X.beginPath();
                                for (var G = 0; Y > G; G++) {
                                    var M = q.x + (2 + 3 * G) * x,
                                        R = j - L[G] * w;
                                    0 === G ? X.moveTo(M, R) : X.lineTo(M, R)
                                }
                                if (X.lineWidth = i, X.stroke(), z && pj(X, V, A, i, W), E || v) {
                                    var P, e = i / 2 + 2;
                                    for (G = 0; Y > G; G++) {
                                        var D = L[G];
                                        if (M = q.x + (2 + 3 * G) * x, R = j - D * w, Fe(E) ? E(X, M, R, V, G, r, p) : E && (X.fillStyle = V, X.beginPath(), X.arc(M, R, e, 0, m, !0), X.fill()), Fe(v) ? P = v(D, G, r, p) : v && (P = D), P) {
                                            var t = Pg(N, P).height,
                                                b = X.shadowBlur;
                                            if (b) {
                                                var O = X.shadowOffsetX,
                                                    n = X.shadowOffsetY,
                                                    $ = X.shadowColor;
                                                X.shadowOffsetX = 0, X.shadowOffsetY = 0, X.shadowBlur = 0, X.shadowColor = A
                                            }
                                            hg(X, P, N, k, M, R - t - e + 2, 0, t, Tc), b && (X.shadowOffsetX = O, X.shadowOffsetY = n, X.shadowBlur = b, X.shadowColor = $)
                                        }
                                    }
                                }
                            }
                        }
                    },
                    L = function(C) { X = C[0], p = C[1], o = C[2], W = C[3], Z = C[4], G = C[5] },
                    Y = function() { return [X, p, o, W, Z, G] },
                    $ = function(C, e) {
                        var w;
                        o && o.getDrawableState ? w = o.getDrawableState(p) : o && o.getState ? w = o.getState(p) : (w = p instanceof Bq ? p.s(me) : null, (w === O || null === w) && (w = Q(C, me)));
                        var $ = Q(e, me);
                        return $ !== O && null !== $ && $ !== w ? !1 : Q(e, fn)
                    },
                    f = { border: x, image: u, text: v, pieChart: b, columnChart: l, stackedColumnChart: I, percentageColumnChart: j, lineChart: R };
                return function(j, K, q, u, d, r, h, M, g, l) {
                    if (K && d && r) {
                        var a = Y();
                        X = j, p = h, o = M, !p && o && o.isSelfViewEvent && (p = o), W = o ? o._zoom ? o._zoom : 1 : 1, Z = g, G = l;
                        var i = d,
                            x = r;
                        if (xj()) {
                            var b, T, N, S, U;
                            0 === X[Zk] ? xj[0] && (b = !0) : b = !0, X.texureImage2D ? xj[1] && (T = !0) : T = !0, X.texureImage3D ? xj[2] && (N = !0) : N = !0, X.drawDNDState ? xj[3] && (U = !0) : U = !0, fc.widget[0] ? xj[4] && (S = !0) : S = !0, b && T && N && S && U && (i = q, x = u)
                        }
                        if (K.tagName) return Ok(_e) && !y[_e] || X.drawImage(K, i, x, d, r), L(a), void 0;
                        if (0 == Q(K, "visible")) return L(a), void 0;
                        Z || (Z = Rr(K.color, p, o)), l || (G = Rr(K.blendMode, p, o)), Ok(_e) && !y[_e] && (d = i, r = x);
                        var z = Hc(K, p, o, d),
                            I = Gp(K, p, o, r),
                            t = { x: 0, y: 0, width: z, height: I, fitSize: Q(K, "fitSize") },
                            R = Q(K, "clip"),
                            m = Q(K, "opacity");
                        if (t.fitSize) {
                            var s = t.rw = Rr(K.width, p, o) || 20;
                            t.widthScale = z / s;
                            var w = t.rh = Rr(K.height, p, o) || 20;
                            t.heightScale = I / w
                        }
                        if (X.save(), X.interactiveInfo) {
                            var v = X.interactiveInfo.matrix,
                                C = v.clone();
                            v.appendTranslate(i, x).appendScale(d / z, r / I), X.interactiveInfo.refRect = t
                        }
                        ts(X, i, x), (z !== d || I !== r) && X.scale(d / z, r / I), R && (Fe(R) ? R(X, z, I, p, o, K) : (X.beginPath(), X.rect(0, 0, z, I), X.clip())), m != A && (X.globalAlpha *= m), Q(K, "comps").forEach(function(S) {
                            if (S.prefix) {
                                var r = Hq,
                                    h = Rr(S.prefix, p, o);
                                h && (Hq = Hq + h + ".")
                            }
                            if (0 == $(K, S)) return S.prefix && (Hq = r), void 0;
                            if (nk.splice(0, 0, S), X.interactiveInfo) var Y = X.interactiveInfo.matrix.clone();
                            var w = Q(S, "opacity"),
                                l = Q(S, "shadow"),
                                G = Q(S, "type"),
                                u = Q(S, "refRect") || t,
                                M = J(S, u);
                            if (w != A) {
                                var x = X.globalAlpha;
                                X.globalAlpha *= w
                            }
                            if (l) {
                                var s = W * D.devicePixelRatio,
                                    j = X.shadowOffsetX,
                                    i = X.shadowOffsetY,
                                    C = X.shadowBlur,
                                    N = X.shadowColor,
                                    Z = Q(S, "shadowOffsetX"),
                                    g = Q(S, "shadowOffsetY"),
                                    q = Q(S, "shadowBlur"),
                                    b = c(S, "shadowColor");
                                X.shadowOffsetX = (Z == A ? F : Z) * s, X.shadowOffsetY = (g == A ? F : g) * s, X.shadowBlur = (q == A ? _ : q) * s, X.shadowColor = b || c(sn)
                            }
                            if ("save" === G) X.save();
                            else if ("endClip" === G || "restore" === G) X.restore();
                            else if ("clip" === G) X.save(), Eg(X, Q(S, "points", H), Q(S, "segments", E), !0), X.clip();
                            else if (jc[G]) M = M || { x: 0, y: 0, width: u.width, height: u.height }, e(S, G, M, u);
                            else if (G === ii) e(S, G, M, u);
                            else if ("SVGPath" === G) k(S, G, M);
                            else {
                                M = M || { x: 0, y: 0, width: u.width, height: u.height };
                                var y = Q(S, ij),
                                    v = Q(S, "scaleX"),
                                    d = Q(S, "scaleY"),
                                    I = P(S),
                                    R = B(S, M, M, y, v, d, I);
                                if (Fe(G)) n(S, G), D.drawCompType(G, X, M, S, p, o);
                                else if (D.getCompType(G)) {
                                    var m = D.getCompType(G),
                                        L = m.func || m;
                                    n(S, m), D.drawCompType(L, X, M, S, p, o)
                                } else f[G] ? f[G](S, M) : D.getCompType(G) === O && Jl.test(G) && vi(G);
                                R && V()
                            }
                            l && (X.shadowOffsetX = j, X.shadowOffsetY = i, X.shadowBlur = C, X.shadowColor = N), w != A && (X.globalAlpha = x), X.interactiveInfo && (X.interactiveInfo.matrix = Y), S.prefix && (Hq = r), nk.splice(0, 1)
                        }), X.interactiveInfo && (X.interactiveInfo.matrix = C), X.restore(), L(a)
                    }
                }
            }();
        D.getCurrentComp = function() { return nk[0] }, D.getParentComp = function() { return nk[1] }, D.getInternal = function() { return { isEnter: jf, isEsc: nc, isSpace: wd, isLeft: Dg, isUp: Yi, isRight: Wg, isDown: gg, addMethod: gp, superCall: th, toPointsArray: vc, translateAndScale: Yk, appendArray: no, createWorldMatrix: cq, vec3TransformMat4: yi, setCanvas: Cq, createDiv: sf, createView: oq, createCanvas: Sg, createImage: to, initContext: Bp, layout: dq, fillRect: re, Mat: uf, drawBorder: Qn, isString: Ok, setBorder: Fl, getPropertyValue: ic, setPropertyValue: bm, drawVerticalLine: pg, draw3DRect: cb, getPinchDist: mi, isSameRect: Me, getPosition: Hf, intersectionLineRect: Sf, getNodeRect: Kc, getEdgeAgentPosition: Cg, getEdgeHostPosition: an, getImageWidth: Hc, getImageHeight: Gp, initItemElement: Nd, drawPoints: Eg, createG2: ad, closePopup: In, isH: po, createAnim: Ur, createNormalMatrix: Mr, toColorArray: Lf, createNormals: Dc, toFloatArray: mo, glMV: Vp, glPop: lf, batchShape: ym, createNodeMatrix: Rp, getShapeModel: bl, getFaceInfo: lb, transformAppend: uk, drawFaceInfo: mn, glUploadData: Qm, glUploadElementData: kk, glDrawArray: xc, glDrawElement: pc, pickValueToColor: Jr, to3dPointsArray: Ro, setGLDebugMode: function(m) { bs = m }, cube: function() { return { vs: Nf, is: yk, uv: Lb } }, ui: function() { return { DataUI: de, NodeUI: Bd, EdgeUI: As, GroupUI: be, ShapeUI: Rf, GridUI: sg, Data3dUI: Gs, Node3dUI: Hs, Shape3dUI: Ks } }, getInternalVersion: function() { return "U2FsdGVkX1/6TDqoum1JwNdFyyYvUJxfvW9MMjesgbw=" }, getDragger: function() { return nj }, addMSMap: function(r) { gp(Xp, r) }, k: s, addEventListener: v, removeEventListener: $ } },
            function(q) {
                function $(q, C) { q != A && (C == A && Kr != typeof q ? this._54O(q, 256) : this._54O(q, C)) }

                function c() { return new $(A) }

                function E(A, m, Q, o, k, S) {
                    for (; --S >= 0;) {
                        var $ = m * this[A++] + Q[o] + k;
                        k = w($ / 67108864), Q[o++] = 67108863 & $
                    }
                    return k
                }

                function P(u, Q, Z, g, X, C) {
                    for (var d = 32767 & Q, U = Q >> 15; --C >= 0;) {
                        var M = 32767 & this[u],
                            D = this[u++] >> 15,
                            $ = U * M + D * d;
                        M = d * M + ((32767 & $) << 15) + Z[g] + (1073741823 & X), X = (M >>> 30) + ($ >>> 15) + U * D + (X >>> 30), Z[g++] = 1073741823 & M
                    }
                    return X
                }

                function J(Z, c, P, C, D, d) {
                    for (var v = 16383 & c, I = c >> 14; --d >= 0;) {
                        var M = 16383 & this[Z],
                            N = this[Z++] >> 14,
                            h = I * M + N * v;
                        M = v * M + ((16383 & h) << 14) + P[C] + D, D = (M >> 28) + (h >> 14) + I * N, P[C++] = 268435455 & M
                    }
                    return D
                }

                function p(h) { return en.charAt(h) }

                function T(L, Z) {
                    var V = Fd[L.charCodeAt(Z)];
                    return V == A ? -1 : V
                }

                function h($) {
                    for (var F = this.t - 1; F >= 0; --F) $[F] = this[F];
                    $.t = this.t, $.s = this.s
                }

                function V(A) { this.t = 1, this.s = 0 > A ? -1 : 0, A > 0 ? this[0] = A : -1 > A ? this[0] = A + this.DV : this.t = 0 }

                function X(p) { var o = c(); return o._58O(p), o }

                function M(z, r) {
                    var B, N = this;
                    if (16 == r) B = 4;
                    else if (8 == r) B = 3;
                    else if (256 == r) B = 8;
                    else if (2 == r) B = 1;
                    else if (32 == r) B = 5;
                    else {
                        if (4 != r) return N.fromRadix(z, r), void 0;
                        B = 2
                    }
                    N.t = 0, N.s = 0;
                    for (var O = z.length, y = !1, l = 0; --O >= 0;) {
                        var e = 8 == B ? 255 & z[O] : T(z, O);
                        0 > e ? "-" == z.charAt(O) && (y = !0) : (y = !1, 0 == l ? N[N.t++] = e : l + B > N.DB ? (N[N.t - 1] |= (e & (1 << N.DB - l) - 1) << l, N[N.t++] = e >> N.DB - l) : N[N.t - 1] |= e << l, l += B, l >= N.DB && (l -= N.DB))
                    }
                    8 == B && 0 != (128 & z[0]) && (N.s = -1, l > 0 && (N[N.t - 1] |= (1 << N.DB - l) - 1 << l)), N._57O(), y && $.ZERO._78O(N, N)
                }

                function S() { for (var r = this, v = r.s & r.DM; r.t > 0 && r[r.t - 1] == v;) --r.t }

                function G(J) {
                    var j = this;
                    if (j.s < 0) return "-" + j._85O()[dh](J);
                    var R;
                    if (16 == J) R = 4;
                    else if (8 == J) R = 3;
                    else if (2 == J) R = 1;
                    else if (32 == J) R = 5;
                    else {
                        if (4 != J) return j.toRadix(J);
                        R = 2
                    }
                    var g, e = (1 << R) - 1,
                        X = !1,
                        s = "",
                        _ = j.t,
                        Y = j.DB - _ * j.DB % R;
                    if (_-- > 0)
                        for (Y < j.DB && (g = j[_] >> Y) > 0 && (X = !0, s = p(g)); _ >= 0;) R > Y ? (g = (j[_] & (1 << Y) - 1) << R - Y, g |= j[--_] >> (Y += j.DB - R)) : (g = j[_] >> (Y -= R) & e, 0 >= Y && (Y += j.DB, --_)), g > 0 && (X = !0), X && (s += p(g));
                    return X ? s : "0"
                }

                function e() { var Y = c(); return $.ZERO._78O(this, Y), Y }

                function y() { return this.s < 0 ? this._85O() : this }

                function R(Q) {
                    var a = this,
                        s = a.s - Q.s;
                    if (0 != s) return s;
                    var o = a.t;
                    if (s = o - Q.t, 0 != s) return a.s < 0 ? -s : s;
                    for (; --o >= 0;)
                        if (0 != (s = a[o] - Q[o])) return s;
                    return 0
                }

                function l(Q) { var P, $ = 1; return 0 != (P = Q >>> 16) && (Q = P, $ += 16), 0 != (P = Q >> 8) && (Q = P, $ += 8), 0 != (P = Q >> 4) && (Q = P, $ += 4), 0 != (P = Q >> 2) && (Q = P, $ += 2), 0 != (P = Q >> 1) && (Q = P, $ += 1), $ }

                function k() { var C = this; return C.t <= 0 ? 0 : C.DB * (C.t - 1) + l(C[C.t - 1] ^ C.s & C.DM) }

                function n(L, k) {
                    var d;
                    for (d = this.t - 1; d >= 0; --d) k[d + L] = this[d];
                    for (d = L - 1; d >= 0; --d) k[d] = 0;
                    k.t = this.t + L, k.s = this.s
                }

                function r(p, J) {
                    for (var s = p; s < this.t; ++s) J[s - p] = this[s];
                    J.t = K(this.t - p, 0), J.s = this.s
                }

                function W(u, Z) {
                    var k, g = this,
                        X = u % g.DB,
                        d = g.DB - X,
                        s = (1 << d) - 1,
                        n = w(u / g.DB),
                        M = g.s << X & g.DM;
                    for (k = g.t - 1; k >= 0; --k) Z[k + n + 1] = g[k] >> d | M, M = (g[k] & s) << X;
                    for (k = n - 1; k >= 0; --k) Z[k] = 0;
                    Z[n] = M, Z.t = g.t + n + 1, Z.s = g.s, Z._57O()
                }

                function O(m, R) {
                    var J = this;
                    R.s = J.s;
                    var G = w(m / J.DB);
                    if (G >= J.t) return R.t = 0, void 0;
                    var f = m % J.DB,
                        i = J.DB - f,
                        l = (1 << f) - 1;
                    R[0] = J[G] >> f;
                    for (var K = G + 1; K < J.t; ++K) R[K - G - 1] |= (J[K] & l) << i, R[K - G] = J[K] >> f;
                    f > 0 && (R[J.t - G - 1] |= (J.s & l) << i), R.t = J.t - G, R._57O()
                }

                function b(Q, g) {
                    for (var l = this, O = 0, j = 0, M = i(Q.t, l.t); M > O;) j += l[O] - Q[O], g[O++] = j & l.DM, j >>= l.DB;
                    if (Q.t < l.t) {
                        for (j -= Q.s; O < l.t;) j += l[O], g[O++] = j & l.DM, j >>= l.DB;
                        j += l.s
                    } else {
                        for (j += l.s; O < Q.t;) j -= Q[O], g[O++] = j & l.DM, j >>= l.DB;
                        j -= Q.s
                    }
                    g.s = 0 > j ? -1 : 0, -1 > j ? g[O++] = l.DV + j : j > 0 && (g[O++] = j), g.t = O, g._57O()
                }

                function H(I, A) {
                    var e = this.abs(),
                        K = I.abs(),
                        a = e.t;
                    for (A.t = a + K.t; --a >= 0;) A[a] = 0;
                    for (a = 0; a < K.t; ++a) A[a + e.t] = e.am(0, K[a], A, a, 0, e.t);
                    A.s = 0, A._57O(), this.s != I.s && $.ZERO._78O(A, A)
                }

                function Z(F) {
                    for (var L = this.abs(), Z = F.t = 2 * L.t; --Z >= 0;) F[Z] = 0;
                    for (Z = 0; Z < L.t - 1; ++Z) {
                        var S = L.am(Z, L[Z], F, 2 * Z, 0, 1);
                        (F[Z + L.t] += L.am(Z + 1, 2 * L[Z], F, 2 * Z + 1, S, L.t - Z - 1)) >= L.DV && (F[Z + L.t] -= L.DV, F[Z + L.t + 1] = 1)
                    }
                    F.t > 0 && (F[F.t - 1] += L.am(Z, L[Z], F, 2 * Z, 0, 1)), F.s = 0, F._57O()
                }

                function U(J, S, t) {
                    var V = J.abs(),
                        H = this;
                    if (!(V.t <= 0)) {
                        var r = H.abs();
                        if (r.t < V.t) return S != A && S._58O(0), t != A && H._77O(t), void 0;
                        t == A && (t = c());
                        var j = c(),
                            y = H.s,
                            a = J.s,
                            p = H.DB - l(V[V.t - 1]);
                        p > 0 ? (V._44O(p, j), r._44O(p, t)) : (V._77O(j), r._77O(t));
                        var n = j.t,
                            Y = j[n - 1];
                        if (0 != Y) {
                            var s = Y * (1 << H.F1) + (n > 1 ? j[n - 2] >> H.F2 : 0),
                                R = H.FV / s,
                                K = (1 << H.F1) / s,
                                N = 1 << H.F2,
                                g = t.t,
                                e = g - n,
                                x = S == A ? c() : S;
                            for (j._59O(e, x), t._52O(x) >= 0 && (t[t.t++] = 1, t._78O(x, t)), $.ONE._59O(n, x), x._78O(j, j); j.t < n;) j[j.t++] = 0;
                            for (; --e >= 0;) {
                                var d = t[--g] == Y ? H.DM : w(t[g] * R + (t[g - 1] + N) * K);
                                if ((t[g] += j.am(0, d, t, e, 0, n)) < d)
                                    for (j._59O(e, x), t._78O(x, t); t[g] < --d;) t._78O(x, t)
                            }
                            S != A && (t._45O(n, S), y != a && $.ZERO._78O(S, S)), t.t = n, t._57O(), p > 0 && t._46O(p, t), 0 > y && $.ZERO._78O(t, t)
                        }
                    }
                }

                function u(O) { var p = c(); return this.abs()._49O(O, A, p), this.s < 0 && p._52O($.ZERO) > 0 && O._78O(p, p), p }

                function Y(w) { this.m = w }

                function I(c) { return c.s < 0 || c._52O(this.m) >= 0 ? c.mod(this.m) : c }

                function d(J) { return J }

                function Q(Z) { Z._49O(this.m, A, Z) }

                function f(Q, O, P) { Q._47O(O, P), this._74O(P) }

                function _(x, t) { x._48O(t), this._74O(t) }

                function D() { if (this.t < 1) return 0; var U = this[0]; if (0 == (1 & U)) return 0; var c = 3 & U; return c = 15 & c * (2 - (15 & U) * c), c = 255 & c * (2 - (255 & U) * c), c = 65535 & c * (2 - (65535 & (65535 & U) * c)), c = c * (2 - U * c % this.DV) % this.DV, c > 0 ? this.DV - c : -c }

                function F(A) {
                    var y = this;
                    y.m = A, y.mp = A._50O(), y.mpl = 32767 & y.mp, y.mph = y.mp >> 15, y.um = (1 << A.DB - 15) - 1, y.mt2 = 2 * A.t
                }

                function j(O) { var z = c(); return O.abs()._59O(this.m.t, z), z._49O(this.m, A, z), O.s < 0 && z._52O($.ZERO) > 0 && this.m._78O(z, z), z }

                function t(W) { var N = c(); return W._77O(N), this._74O(N), N }

                function v(_) {
                    for (var c = this; _.t <= c.mt2;) _[_.t++] = 0;
                    for (var Z = 0; Z < c.m.t; ++Z) {
                        var l = 32767 & _[Z],
                            u = l * c.mpl + ((l * c.mph + (_[Z] >> 15) * c.mpl & c.um) << 15) & _.DM;
                        for (l = Z + c.m.t, _[l] += c.m.am(0, u, _, Z, 0, c.m.t); _[l] >= _.DV;) _[l] -= _.DV, _[++l]++
                    }
                    _._57O(), _._45O(c.m.t, _), _._52O(c.m) >= 0 && _._78O(c.m, _)
                }

                function g(h, E) { h._48O(E), this._74O(E) }

                function a(_, o, V) { _._47O(o, V), this._74O(V) }

                function Oo() { return 0 == (this.t > 0 ? 1 & this[0] : this.s) }

                function ei(z, O) {
                    if (z > 4294967295 || 1 > z) return $.ONE;
                    var I = c(),
                        A = c(),
                        r = O._73O(this),
                        M = l(z) - 1;
                    for (r._77O(I); --M >= 0;)
                        if (O._76O(I, A), (z & 1 << M) > 0) O._75O(A, r, I);
                        else {
                            var N = I;
                            I = A, A = N
                        }
                    return O.revert(I)
                }

                function be(u, J) { var K; return K = 256 > u || J._51O() ? new Y(J) : new F(J), this.exp(u, K) }

                function Pg() { var L = this; if (L.s < 0) { if (1 == L.t) return L[0] - L.DV; if (0 == L.t) return -1 } else { if (1 == L.t) return L[0]; if (0 == L.t) return 0 } return (L[1] & (1 << 32 - L.DB) - 1) << L.DB | L[0] }

                function vn(g, i) { return new $(g, i) }

                function _n() {
                    var x = this;
                    x.n = A, x.e = 0, x.d = A, x.p = A, x.q = A, x.dmp1 = A, x.dmq1 = A, x._10A = A
                }

                function gi(B) { return B._53O(this.e, this.n) }

                function pq(J) {
                    var g, R, F, $ = "",
                        c = 0;
                    for (g = 0; g < J.length && J.charAt(g) != Go; ++g) F = an.indexOf(J.charAt(g)), 0 > F || (0 == c ? ($ += p(F >> 2), R = 3 & F, c = 1) : 1 == c ? ($ += p(R << 2 | F >> 4), R = 15 & F, c = 2) : 2 == c ? ($ += p(R), $ += p(F >> 2), R = 3 & F, c = 3) : ($ += p(R << 2 | F >> 4), $ += p(15 & F), c = 0));
                    return 1 == c && ($ += p(R << 2)), $
                }

                function nj(h) {
                    var d = h.split(""),
                        f = pq(h);
                    return d.forEach(function(n) {
                        var Z = n.length;
                        Z > 0 && f && (zk += pr(n))
                    }), f
                }

                function ab(g, M) {
                    var i = Ci._4O.Util._56O(g, "ss"),
                        F = {},
                        Z = 0;
                    return F.v = i == M, F.t = 1, F.s = 0 > Z ? -1 : 0, nh = F.v, Z > 0 ? F[0] = Z : -1 > Z ? F[0] = Z + F.DV : F.t = 0, [i, F]
                }

                function kf($) {
                    var J = 38,
                        r = $.substring(0, J);
                    if (r && 30 == r.indexOf("05000420")) { var g = ["ss", $.substring(J)]; return g }
                    return []
                }

                function mp(c, h) {
                    h = h.replace(as, ""), h = h.replace(/[ \n]+/g, "");
                    var F = vn(h, 16);
                    if (F._55O() > this.n._55O()) return 0;
                    var H = this._37O(F),
                        v = H[dh](16).replace(/^1f+00/, ""),
                        G = kf(v);
                    if (0 == G.length) return !1;
                    for (var S, u, y, n = .5, x = Ee, b = [0, .5, .75, .875, .9375], D = [], t = [], R = [], E = m / x, p = G[1], O = ab(c, p)[0], s = 0, k = 0; s < b.length; s++) { var r = 0 === s % 2 ? 0 : .5; for (S = 0; x >= S; S++) u = (S + r) * E, y = 1 - b[s], D.push(C(u) * n * y, -n + 2 * b[s] * n, -N(u) * n * y), t.push((S + r) / x, y) }
                    for (s = 0; s < b.length - 1; s++) {
                        var I = s * (x + 1),
                            U = (s + 1) * (x + 1);
                        for (S = 0; x > S; S++) R.push(I + S, U + S + 1, U + S, I + S, I + S + 1, U + S + 1)
                    }
                    return R.forEach(function(s) { k += s }), p == O && k > 10
                }
                var Mm, Kn = 0xdeadbeefcafe,
                    Rk = 15715070 == (16777215 & Kn),
                    dh = "toString",
                    Co = "",
                    Ar = "nat",
                    Mk = function() {};
                o = q["D" + 11182[dh](B(2, 5))];
                var $k = $.prototype;
                Zh += Ye.substr(0, 1);
                var eg = q.navigator ? q.navigator.appName : "";
                Rk && "Microsoft Internet Explorer" == eg ? ($k.am = P, Mm = 30) : Rk && "Netscape" != eg ? ($k.am = E, Mm = 26) : ($k.am = J, Mm = 28), $k.DB = Mm, $k.DM = (1 << Mm) - 1, $k.DV = 1 << Mm;
                var Zk = 52;
                $k.FV = B(2, Zk), $k.F1 = Zk - Mm, $k.F2 = 2 * Mm - Zk;
                var Or, us, en = "0123456789abcdefghijklmnopqrstuvwxyz",
                    Fd = [],
                    ie = function(i) { return String.fromCharCode(i) };
                for (Or = "0".charCodeAt(0), us = 0; 9 >= us; ++us) Fd[Or++] = us;
                for (Or = "a".charCodeAt(0), us = 10; 36 > us; ++us) Fd[Or++] = us;
                for (Or = "A".charCodeAt(0), us = 10; 36 > us; ++us) Fd[Or++] = us;
                var Wo = Y.prototype;
                Wo._73O = I, Wo.revert = d, Wo._74O = Q, Wo._75O = f, Wo._76O = _;
                var vk = F.prototype;
                vk._73O = j, vk.revert = t, vk._74O = v, vk._75O = a, vk._76O = g, $k._77O = h, $k._58O = V, $k._54O = M, $k._57O = S, $k._59O = n, $k._45O = r, $k._44O = W, $k._46O = O, $k._78O = b, $k._47O = H, $k._48O = Z, $k._49O = U, $k._50O = D, $k._51O = Oo, $k.exp = ei, $k.toString = G, $k._85O = e, $k.abs = y, $k._52O = R, $k._55O = k, $k.mod = u, $k._53O = be, $.ZERO = X(0), $.ONE = X(1), $k._86O = Pg;
                var Pp = function(z, i) {
                    var f = this;
                    f.isPublic = !0, typeof z !== Kr ? (f.n = z, f.e = i) : z != A && i != A && z.length > 0 && i.length > 0 && (f.n = vn(z, 16), f.e = pr(i, 16))
                };
                Tm = function() {
                    var X, m, z = nj(cb),
                        H = z.substr(0, 4),
                        g = z.substr(4, 2),
                        c = z.substr(6, 2),
                        N = 1,
                        i = !N,
                        D = s,
                        Q = [],
                        y = pd.charAt(7);
                    if (o && (o[dh]().indexOf(Ar) < 0 || o[Zh][dh]().indexOf(Ar) < 0 || !z ? X = A : (z = new o(H - 0, g - N, c - 0), m = z.setHours(9), o[Zh]() > m ? X = $q[y] : i = !0)), z && X && X[0] && X[x(.5)] && D) {
                        var S = Sn(X[0]),
                            G = Sn(X[1]);
                        for (var v in G) Q.push(v);
                        var E, f = 0,
                            I = S[Q[f]],
                            h = G[Q[f++]],
                            U = G[Q[f++]],
                            T = G[Q[f++]],
                            J = G[Q[f++]],
                            t = G[Q[f++]],
                            M = G[Q[f++]],
                            W = S[Q[f]],
                            P = G[Q[f++]],
                            R = yi._27O(D);
                        if (I === h && R && P) {
                            E = h + U + T + J + t + M;
                            var l = !M || M === ac;
                            if (!l && M)
                                for (var d, k = 0, b = M.length; b > k; k++) M[k] === jl[f] ? d === ac ? l = !0 : d[0] === cc[5] && ac && ac.indexOf(d.substr(1)) >= 0 ? l = !0 : d = A : (d == A ? d = M[k] : d += M[k], k === b - 1 && (d === ac ? l = !0 : d[0] === cc[5] && ac && ac.indexOf(d.substr(1)) >= 0 && (l = !0)));
                            E && R._31O(E, P) && R._31O(I, W) && l && (!t || o[Zh]() < t) && (i = !0)
                        }
                    }
                    return i || (mj = se), y
                };
                var We = _n.prototype;
                We._37O = gi, We._38O = Pp;
                var an = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",
                    Go = "=",
                    _o = 25,
                    dk = 10,
                    cb = "ICFhU===",
                    hh = hh || function(Z, S) {
                        var p = {},
                            m = p._7A = {},
                            l = m._6A = function() {
                                function $() {}
                                return {
                                    _80O: function(B) { $.prototype = this; var p = new $; return B && p._5A(B), p.hasOwnProperty("_82O") || (p._82O = function() { p.$super._82O.apply(this, arguments) }), p._82O.prototype = p, p.$super = this, p },
                                    _3A: function() { var y = this._80O(); return y._82O.apply(y, arguments), y },
                                    _82O: function() {},
                                    _5A: function(y) {
                                        for (var G in y) y.hasOwnProperty(G) && (this[G] = y[G]);
                                        y.hasOwnProperty(dh) && (this.toString = y.toString)
                                    },
                                    _88O: function() { return this._82O.prototype._80O(this) }
                                }
                            }(),
                            w = m._39O = l._80O({
                                _82O: function(r, x) { r = this._84O = r || [], this._65O = x != S ? x : 4 * r.length },
                                toString: function(Z) { return (Z || r).stringify(this) },
                                _89O: function(W) {
                                    var X = this._84O,
                                        E = W._84O,
                                        I = this._65O,
                                        e = W._65O;
                                    if (this._57O(), I % 4)
                                        for (var Z = 0; e > Z; Z++) {
                                            var z = 255 & E[Z >>> 2] >>> 24 - 8 * (Z % 4);
                                            X[I + Z >>> 2] |= z << 24 - 8 * ((I + Z) % 4)
                                        } else if (E.length > 65535)
                                            for (var Z = 0; e > Z; Z += 4) X[I + Z >>> 2] = E[Z >>> 2];
                                        else X.push.apply(X, E);
                                    return this._65O += e, this
                                },
                                _57O: function() {
                                    var T = this._84O,
                                        k = this._65O;
                                    T[k >>> 2] &= 4294967295 << 32 - 8 * (k % 4), T.length = x(k / 4)
                                },
                                _88O: function() { var r = l._88O.call(this); return r._84O = this._84O.slice(0), r },
                                _87O: function(p) { for (var O = [], u = 0; p > u; u += 4) O.push(0 | 4294967296 * Se); return new w._82O(O, p) }
                            }),
                            L = p._2A = {},
                            r = L._69O = {
                                stringify: function(d) {
                                    var S, H = d._84O,
                                        V = d._65O,
                                        C = [];
                                    for (S = 0; V > S; S++) {
                                        var G = 255 & H[S >>> 2] >>> 24 - 8 * (S % 4);
                                        C.push((G >>> 4).toString(16)), C.push((15 & G).toString(16))
                                    }
                                    return C.join("")
                                },
                                _68O: function(R) { for (var K = R.length, j = [], Q = 0; K > Q; Q += 2) j[Q >>> 3] |= pr(R.substr(Q, 2), 16) << 24 - 4 * (Q % 8); return new w._82O(j, K / 2) }
                            },
                            s = L._8A = {
                                stringify: function(h) {
                                    var f, T = h._84O,
                                        c = h._65O,
                                        M = [];
                                    for (f = 0; c > f; f++) {
                                        var x = 255 & T[f >>> 2] >>> 24 - 8 * (f % 4);
                                        M.push(ie(x))
                                    }
                                    return M.join("")
                                },
                                _68O: function(u) {
                                    var V, e = u.length,
                                        y = [];
                                    for (V = 0; e > V; V++) y[V >>> 2] |= (255 & u.charCodeAt(V)) << 24 - 8 * (V % 4);
                                    return new w._82O(y, e)
                                }
                            },
                            Y = L._9A = { stringify: function(P) { try { return decodeURIComponent(escape(s.stringify(P))) } catch (u) { throw new Error("") } }, _68O: function(j) { return s._68O(unescape(encodeURIComponent(j))) } },
                            H = m._32O = l._80O({
                                _1A: function() { this._83O = new w._82O, this._23O = 0 },
                                _33O: function(e) { typeof e == Kr && (e = Y._68O(e)), this._83O._89O(e), this._23O += e._65O },
                                _25O: function(r) {
                                    var G = this._83O,
                                        t = G._84O,
                                        Z = G._65O,
                                        b = this._79O,
                                        z = 4 * b,
                                        k = Z / z;
                                    k = r ? x(k) : K((0 | k) - this._22O, 0);
                                    var C = k * b,
                                        E = i(4 * C, Z);
                                    if (C) {
                                        for (var R = 0; C > R; R += b) this._20O(t, R);
                                        var M = t.splice(0, C);
                                        G._65O -= E
                                    }
                                    return new w._82O(M, E)
                                },
                                _88O: function() { var p = l._88O.call(this); return p._83O = this._83O._88O(), p },
                                _22O: 0
                            });
                        m._66O = H._80O({ cfg: l._80O(), _82O: function(Z) { this.cfg = this.cfg._80O(Z), this._1A() }, _1A: function() { H._1A.call(this), this._34O() }, _81O: function(B) { return this._33O(B), this._25O(), this }, _72O: function(g) { g && this._33O(g); var A = this._21O(); return A }, _79O: 16, _26O: function(W) { return function(J, B) { return new W._82O(B)._72O(J) } }, _19O: function($) { return function(M, O) { return new F._71O._82O($, O)._72O(M) } } });
                        var F = p._67O = {};
                        return p
                    }();
                ! function() {
                    var i = hh,
                        c = i._7A,
                        j = c._39O,
                        H = c._66O,
                        r = i._67O,
                        n = [],
                        Z = [];
                    ! function() {
                        function q(R) {
                            for (var w = z(R), D = 2; w >= D; D++)
                                if (!(R % D)) return !1;
                            return !0
                        }

                        function r(x) { return 0 | 4294967296 * (x - (0 | x)) }
                        for (var F = 2, _ = 0; 64 > _;) q(F) && (8 > _ && (n[_] = r(B(F, .5))), Z[_] = r(B(F, 1 / 3)), _++), F++
                    }();
                    var d = [],
                        F = r._41O = H._80O({
                            _34O: function() { this._64O = new j._82O(n.slice(0)) },
                            _20O: function(K, S) {
                                for (var E = this._64O._84O, B = E[0], b = E[1], I = E[2], y = E[3], u = E[4], p = E[5], G = E[6], A = E[7], s = 0; 64 > s; s++) {
                                    if (16 > s) d[s] = 0 | K[S + s];
                                    else {
                                        var e = d[s - 15],
                                            V = (e << 25 | e >>> 7) ^ (e << 14 | e >>> 18) ^ e >>> 3,
                                            l = d[s - 2],
                                            g = (l << 15 | l >>> 17) ^ (l << 13 | l >>> 19) ^ l >>> 10;
                                        d[s] = V + d[s - 7] + g + d[s - 16]
                                    }
                                    var Q = u & p ^ ~u & G,
                                        F = B & b ^ B & I ^ b & I,
                                        f = (B << 30 | B >>> 2) ^ (B << 19 | B >>> 13) ^ (B << 10 | B >>> 22),
                                        N = (u << 26 | u >>> 6) ^ (u << 21 | u >>> 11) ^ (u << 7 | u >>> 25),
                                        j = A + N + Q + Z[s] + d[s],
                                        t = f + F;
                                    A = G, G = p, p = u, u = 0 | y + j, y = I, I = b, b = B, B = 0 | j + t
                                }
                                E[0] = 0 | E[0] + B, E[1] = 0 | E[1] + b, E[2] = 0 | E[2] + I, E[3] = 0 | E[3] + y, E[4] = 0 | E[4] + u, E[5] = 0 | E[5] + p, E[6] = 0 | E[6] + G, E[7] = 0 | E[7] + A
                            },
                            _21O: function() {
                                var i = this._83O,
                                    l = i._84O,
                                    R = 8 * this._23O,
                                    Q = 8 * i._65O;
                                return l[Q >>> 5] |= 128 << 24 - Q % 32, l[(Q + 64 >>> 9 << 4) + 14] = w(R / 4294967296), l[(Q + 64 >>> 9 << 4) + 15] = R, i._65O = 4 * l.length, this._25O(), this._64O
                            },
                            _88O: function() { var z = H._88O.call(this); return z._64O = this._64O._88O(), z }
                        });
                    i._41O = H._26O(F), i._42O = H._19O(F)
                }();
                var as = new RegExp("");
                as.compile("[^0-9a-f]", "gi"), _n._28O = -1, _n._29O = -2, We._31O = mp, We._63O = mp, _n._43O = -2;
                var ai = new function() {
                    var i = this;
                    i._5O = function(f, d) { if ("8" != f.substring(d + 2, d + 3)) return 1; var u = pr(f.substring(d + 3, d + 4)); return 0 == u ? -1 : u > 0 && 10 > u ? u + 1 : -2 }, i._13O = function(_, c) { var r = i._5O(_, c); return 1 > r ? "" : _.substring(c + 2, c + 2 + 2 * r) }, i._12O = function(Y, T) { var M = i._13O(Y, T); if ("" == M) return -1; var G; return G = pr(M.substring(0, 1)) < 8 ? new $(M, 16) : new $(M.substring(2), 16), G._86O() }, i._6O = function(F, N) { var K = i._5O(F, N); return 0 > K ? K : N + 2 * (K + 1) }, i._11O = function(P, n) {
                        var q = i._6O(P, n),
                            $ = i._12O(P, n);
                        return P.substring(q, q + 2 * $)
                    }, i._10O = function(N, V) {
                        var C = i._6O(N, V),
                            B = i._12O(N, V);
                        return C + 2 * B
                    }, i._7O = function(z, F) {
                        var K = [],
                            y = i._6O(z, F);
                        K.push(y);
                        for (var j = i._12O(z, F), w = y, k = 0;;) {
                            var R = i._10O(z, w);
                            if (R == A || R - y >= 2 * j) break;
                            if (k >= 200) break;
                            K.push(R), w = R, k++
                        }
                        return K
                    }
                };
                if (ai._90O = ie(dk + 24), ai._91O = L + ie(dk * dk + 8), Ci == A || !Ci) var Ci = {};
                Ci._4O != A && Ci._4O || (Ci._4O = {});
                var Vr = Ci._4O;
                Ci._4O.Util = new function() {
                    var A = this;
                    A._56O = function(e) { var M = new Ci._4O._3O; return M._30O(e) }, A._4A = function(S) { var H = new Ci._4O._3O; return H._36O(S) }, A._11A = function(Y) { var f = new Vr._3O; return f._30O(Y) }
                }, Ci._4O._3O = function() {
                    var Y = this;
                    Y._8O = function(E, K) {
                        if ("ss" == E && "cj" == K) {
                            try { Y.md = hh._67O._41O._3A() } catch (I) { Mk(Co) }
                            Y._24O = function(s) { Y.md._81O(s) }, Y._35O = function(Q) {
                                var J = hh._2A._69O._68O(Q);
                                Y.md._81O(J)
                            }, Y._60O = function() { var B = Y.md._72O(); return B[dh](hh._2A._69O) }, Y._30O = function(U) { return Y._24O(U), Y._60O() }, Y._36O = function(V) { return Y._35O(V), Y._60O() }
                        }
                    }, Y._24O = function() { Mk(Co) }, Y._35O = function() { Mk(Co) }, Y._60O = function() { Mk(Co) }, Y._30O = function() { Mk(Co) }, Y._36O = function() { Mk(Co) }, Y._8O("ss", "cj")
                }, Nj = function($) {
                    var r = hf[Uf[7]],
                        D = 1,
                        k = !1;
                    if (Nc.a != hf[zq]) return Nc.a;
                    if (Nc.forEach(function(a) { D *= a }), $ > D) {
                        if (r && r[1] && r[0]) {
                            var y = r[0],
                                H = r[1];
                            H = H.split(ai._90O), y = y.split(ai._90O);
                            var x = H[3],
                                W = y[3],
                                u = H[7],
                                A = H[11],
                                c = H[15],
                                t = H[19],
                                R = H[23],
                                C = H[27],
                                e = y[7],
                                N = x + u + A + c + t + R,
                                j = R ? !1 : !0,
                                _ = W === x;
                            if (R) {
                                var h = R && R.split(Sr("firefox")[3]);
                                if (h)
                                    for (var U = 0; U < h.length; U++) { var O = h[U]; if (O[0] === To[8] && (O = O.substring(1)), Om.indexOf(O) >= 0) { j = !0; break } }
                            }
                            k = _ && Ph()(W, e) && Ph()(N, C) && j && (!t || t > $), k && A.indexOf(wk.length) >= 0 && (Nj[wk.length] = wk), k && A.indexOf(wk.length + 1) >= 0 && (Nj[wk.length + 1] = wk), k && A.indexOf(wk.length + 3) >= 0 && (Nj[wk.length + 3] = wk)
                        }
                        k || (de.prototype._42 = Rg)
                    } else k = !0, Nj[wk.length] = Nj[wk.length + 1] = Nj[wk.length + 3] = wk;
                    return Nc.a = k, k
                }, _o = String.fromCharCode(_o + 20);
                var Zr = function(D) { return D = D.replace(as, Co), D = D.replace(/[ \n]+/g, Co) },
                    el = "30",
                    fi = "06",
                    il = "02",
                    rr = "03",
                    Ad = vn,
                    oc = /^1f+00/,
                    yi = function() {
                        var Z;
                        return Z = {
                            _18O: function(p) {
                                var E = p,
                                    $ = E.replace(/\s+/g, ""),
                                    I = pq($);
                                return I
                            },
                            _14O: function(C) {
                                var P = this._18O(C),
                                    Q = this._15O(P);
                                return Q
                            },
                            _15O: function(x) {
                                var H = this._17O(x);
                                if ("2a864886f70d010101" == H._61O) {
                                    var X = this._16O(H.key),
                                        h = new _n;
                                    return h._38O(X.n, X.e), h
                                }
                                Mk(Co)
                            },
                            _16O: function(f) {
                                var i = {};
                                f.substr(0, 2) != el && Mk(Co);
                                var O = ai._7O(f, 0);
                                return 2 != O.length && Mk(Co), f.substr(O[0], 2) != il && Mk(Co), i.n = ai._11O(f, O[0]), f.substr(O[1], 2) != il && Mk(Co), i.e = ai._11O(f, O[1]), i
                            },
                            _17O: function(Y) {
                                var j = {};
                                j._40O = A;
                                var h = ai._7O(Y, 0);
                                2 != h.length && Mk(Co);
                                var I = h[0];
                                Y.substr(I, 2) != el && Mk(Co);
                                var P = ai._7O(Y, I);
                                return 2 != P.length && Mk(Co), Y.substr(P[0], 2) != fi && Mk(Co), j._61O = ai._11O(Y, P[0]), Y.substr(P[1], 2) == fi ? j._40O = ai._11O(Y, P[1]) : Y.substr(P[1], 2) == el && (j._40O = {}, j._40O.p = ai._70O(Y, P[1], [0], il), j._40O.q = ai._70O(Y, P[1], [1], il), j._40O.g = ai._70O(Y, P[1], [2], il)), Y.substr(h[1], 2) != rr && Mk(Co), j.key = ai._11O(Y, h[1]).substr(2), j
                            }
                        }, Z._17O ? Z : A
                    }(),
                    Hg = yi._27O = function(S) { return yi._14O(S) };
                Ph = function() {
                    return function(T, r) {
                        if (T && r) {
                            r = Zr(r);
                            var d = Ad(r, B(2, 4)),
                                t = this;
                            if (!t || !t.n || d._55O() > t.n._55O()) return 0;
                            var f = t._37O(d),
                                c = f[dh](B(2, 4)).replace(oc, ""),
                                q = kf(c);
                            if (0 == q.length) return !1;
                            var l = q[0],
                                e = q[1],
                                y = function(C) { return Ci._4O.Util._56O(C, l) },
                                X = y(T);
                            return e == X
                        }
                    }.bind(Hg(s))
                };
                var Zp, Tg;
                return function() {
                    var Z = xe.length - Pd.length;
                    if (Z > 0)
                        for (var j = 0; Z > j; j++) Zp = Vr.Util, Tg = Zr
                }(), Vl = function(J, $) {
                    $ = Tg($);
                    var k = Hg(op),
                        A = dd.length,
                        K = 2 * A,
                        H = Ad($, B(A, K)),
                        u = k,
                        b = !0;
                    if (u) {
                        var P = u[xo[0]];
                        P && H._55O() <= P._55O() && (b = !1)
                    }
                    if (b) return 0;
                    var O = u._37O(H),
                        S = O[dh](B(A, K)).replace(oc, ""),
                        m = kf(S);
                    if (0 == m.length) return !1;
                    var s = m[0],
                        t = m[1],
                        X = Zp._11A(J, s);
                    return t == X
                }, yi
            }(y, n), gp(D, {
                load: function() {
                    var l = {},
                        T = function(z) { return z ? "c_" + (z.sync ? "1" : "0") + "_" + (z.post ? "1" : "0") + "_" + (z.responseType || "H") + "_" + (z.mimeType || "H") + "_" + (z.data ? JSON.stringify(z.data) : "H") : "" };
                    return function(L, B, v) {
                        var Q, n = l[L],
                            w = T(v);
                        return n && (Q = n[w]) ? (Q.push(B), void 0) : (l[L] || (n = l[L] = { count: 0 }), Q = n[w] = [B], n.count++, D.xhrLoad(L, function(a) { delete n[w], n.count--, n.count || delete l[L], Q.forEach(function(Y) { Y(a) }) }, v), void 0)
                    }
                }(),
                asyncEach: function(k, c, i) {
                    "function" != typeof i && (i = Function.prototype);
                    var U = new Array(k.length),
                        F = 0,
                        X = !1;
                    k.forEach(function(A, g) { c(A, function(G, $) { return X ? void 0 : G ? (X = !0, i(null)) : (U[g] = $, F++, F === k.length ? i(U) : void 0) }) })
                },
                xhrLoad: function(J, g, G) {
                    var c = !1;
                    ud(J) || (c = !0, J = [J]), G = G || {};
                    var $ = G.sync,
                        u = null,
                        H = G.method || "GET";
                    return G.post && (H = "POST"), G.method = H, D.asyncEach(J, function(U, C) {
                        var y = new Gq;
                        U = D.beforeLoadURL(U), U.data ? C(null, U.data) : (G.url = encodeURI(U), G.responseType ? y.setResponseType(G.responseType) : y.setOverrideMimeType(G.mimeType || "text/plain"), y.onload = function() { 200 === this.status || 0 === this.status ? C(null, y.getResponseText()) : C(!0) }, y.onerror = function() { C(!0) }, y.send(G))
                    }, function(k) {
                        var H = "function" == typeof g;
                        (H || $) && (u = c && k ? k[0] : k, H && g(u))
                    }), $ ? u : void 0
                }
            });
        var bb = n.setPrototypeOf || function(s, B) { return s.__proto__ = B, s },
            Od = n.getPrototypeOf || function(X) { return X.__proto__ },
            of = n.freeze;
        n.isFrozen;
        var ek = function() { var _ = function(L) { return L }; return function(c) { return c && c.length ? new Function("o", ["return o['", c.join("']['"), "'];"].join("")) : _ } }(),
            Fk = function() { var $ = function(r, K) { return r = K }; return function(d) { return d && d.length ? new Function("o", "v", ["return o['", d.join("']['"), "'] = v;"].join("")) : $ } }();
        ! function() {
            function t(W) {
                var Y = [];
                if (W)
                    for (var d;
                        (d = S.exec(W)) != O;) Y.push(d[1]);
                return Y
            }

            function c(s, M) {
                var d = v.exec(M);
                this._cell = s, this._key = d[1], this._format = d[2], this._style = t(d[3])
            }

            function J(L) {
                for (var Q = this._cellList = [], $ = this._paramList = [], w = L.split(G), m = 0, S = w.length; S > m; ++m) {
                    var W = w[m];
                    if ("{{" !== W)
                        for (var a = W.split(y), K = 0, v = a.length; v > K; ++K) {
                            var k = a[K];
                            y.test(k) ? ($.push(new c(Q.length, k)), Q.push(O)) : k.length > 0 && Q.push(k)
                        } else Q.push("{")
                }
                this._formatList = this._cellList.slice(0)
            }
            var P = {},
                I = {},
                G = /(\{\{)/,
                y = /(\{\w+(?:\:\w+(?:\&[\w\.])*)?\})/,
                v = /\{(\w+)(?:\:(\w+)((?:\&[\w\.])*))?\}/,
                S = /\&([\w\.]*)/g;
            J.prototype._73O = function(Z) {
                for (var o = this._paramList.length; o--;) {
                    var f = this._paramList[o],
                        j = Z[pr(f._key) + 1],
                        W = I[f._format];
                    W && (j = W(j, f._style)), this._formatList[f._cell] = j
                }
                return this._formatList.join("")
            }, J.prototype._map = function(S) {
                for (var Y = this._paramList.length; Y--;) {
                    var p = this._paramList[Y],
                        O = S[p._key],
                        f = I[p._format];
                    f && (O = f(O, p._style)), this._formatList[p._cell] = O
                }
                return this._formatList.join("")
            };
            var n = function(_) { var q = P[_]; return q || (P[_] = q = new J(_)), q._73O(arguments) };
            return n.map = function(R, e) { var g = P[R]; return g || (P[R] = g = new J(R)), g._map(e) }, n.setValueFormat = function(x, y) { I[x] = y }, n.gc = function() { P.length = 0 }, n.__parsed = P, n
        }();
        var jq = function() {
                function v(P, Q, T, U) {
                    var v = P ? P.path.slice(0) : [];
                    Q && v.push(Q), this.desc = T, this.name = Q, this.path = of(v), this.getter = ek(v), this.setter = Fk(v), this.isLeaf = U, this.parent = P, this.children = [], this.childMap = {}
                }
                return v.create = function() {
                    function p(u, O, A, Z) {
                        var Q = Z(A),
                            M = new v(u, O, A, Q);
                        if (!Q) {
                            for (var U = M.children, x = M.childMap, N = n.keys(A), E = 0, s = N.length; s > E; ++E) {
                                var C = N[E],
                                    D = p(M, C, A[C], Z);
                                U.push(D), x[D.name] = D
                            }
                            M.children = of(U), M.childMap = of(x)
                        }
                        return of(M), M
                    }
                    return function(j, H) { return p(O, O, j, H) }
                }(), v.prototype.forEach = function(j, I) {
                    for (var u = this.children, D = 0, h = u.length; h > D; ++D) {
                        var L = u[D];
                        j(L, I)
                    }
                }, v
            }(),
            of = n.freeze,
            jj = { main: { mask: 1, priority: D.cameraPriority.main, clearDepth: !1, ignore: !1 }, top: { mask: 2, priority: D.cameraPriority.top, ignore: !1 } },
            um = "main",
            Mg = jj[um].mask,
            bc = function(D, L, T) {
                if (D = D || 0, !(L in jj)) {
                    if (Qb >= 32) throw new Error("Only 31 render layer can be defined.");
                    jj[L] = { mask: 1 << Qb++, priority: jj[um].priority }
                }
                if (T)
                    for (var x in T) jj[L][x] = T[x];
                return mb = qs(n.keys(jj)), Qb = mb.length, D |= jj[L].mask
            },
            kp = function(t, N) { return t && N && t & N },
            qs = function(W) { return W.sort(function($, S) { return jj[$].priority - jj[S].priority }) },
            mb = qs(n.keys(jj)),
            Qb = mb.length;
        gp(D, { setRenderLayerInfo: function(z, j) { bc(0, z, j) }, getRenderLayerInfo: function(V) { return jj[V] } }, !0);
        var En = k.List = function() {
            this._as = [];
            var H, k, X = arguments.length;
            if (1 === X) {
                var r = arguments[0];
                if (is(r) && (r = r._as), ud(r))
                    for (k = r.length, H = 0; k > H; H++) this._as.push(r[H]);
                else r != A && this._as.push(r)
            } else if (X > 1)
                for (H = 0; X > H; H++) this._as.push(arguments[H])
        };
        fi("List", n, {
            forEach: function(T, q) { this.each(T, q) },
            push: function() { for (var s = 0; s < arguments.length; s++) this.add(arguments[s]) },
            pop: function() { return this._as.pop() },
            shift: function() { return this._as.shift() },
            unshift: function() { return this._as.unshift.apply(this._as, arguments) },
            size: function() { return this._as.length },
            isEmpty: function() { return 0 === this._as.length },
            add: function(_, B) { return B === O ? this._as.push(_) : this._as.splice(B, 0, _) },
            addAll: function(M) { is(M) && (M = M._as), ud(M) ? no(this._as, M) : this._as.push(M) },
            get: function(N) { return this._as[N] },
            slice: function(x, $) { return new En(this._as.slice(x, $)) },
            remove: function(R) { var o = this._as.indexOf(R); return o >= 0 && o < this._as.length && this.removeAt(o), o },
            removeAt: function(b) { return this._as.splice(b, 1)[0] },
            set: function(f, S) { return this._as[f] = S },
            clear: function() { return this._as.splice(0, this._as.length) },
            contains: function(O) { return this._as.indexOf(O) >= 0 },
            indexOf: function(m) { return this._as.indexOf(m) },
            each: function(h, Y) {
                for (var W = 0, t = this._as.length; t > W; W++) {
                    var a = this._as[W];
                    Y ? h.call(Y, a, W, this) : h(a, W, this)
                }
            },
            reverseEach: function(d, S) {
                for (var c = this._as.length - 1; c >= 0; c--) {
                    var $ = this._as[c];
                    S ? d.call(S, $) : d($)
                }
            },
            getArray: function() { return this._as },
            toArray: function(O, C) { if (O) { for (var Y, j = [], h = 0, U = this._as.length; U > h; h++) Y = this._as[h], C ? O.call(C, Y) && j.push(Y) : O(Y) && j.push(Y); return j } return this._as.concat() },
            toList: function(z, w) { if (z) { for (var s, U = new En, T = 0, q = this._as.length; q > T; T++) s = this._as[T], w ? z.call(w, s) && U.add(s) : z(s) && U.add(s); return U } return new En(this) },
            reverse: function() { this._as.reverse() },
            sort: function(x) { return this._as.sort(x ? x : Ob), this },
            toString: function() { return this._as.toString() }
        }), n.defineProperties(En.prototype, { length: { get: function() { return this._as.length }, set: function(u) { this._as.length = u } } });
        var xg = new En;
        gp(xg, { size: function() { return 0 }, indexOf: function() { return -1 }, contains: function() { return !1 }, isEmpty: function() { return !0 }, sort: js, each: js, reverseEach: js, toArray: function() { return [] }, toList: function() { return new En }, add: Vb, addAll: Vb, set: Vb, remove: Vb, removeAt: Vb, clear: Vb });
        var Fp = k.Notifier = function() { this._f = 0 };
        fi("Notifier", n, {
            contains: function(i, V) {
                if (this._ls)
                    for (var m, W = 0, J = this._ls.size(); J > W; W++)
                        if (m = this._ls.get(W), i === m.l && V === m.s) return !0;
                return !1
            },
            add: function(z, O, w) {
                var Z = this,
                    l = { l: z, s: O, a: w };
                Z._ls || (Z._ls = new En), Z._f ? (Z._as || (Z._as = new En), Z._as.add(l)) : l.a ? Z._ls.add(l, 0) : Z._ls.add(l)
            },
            remove: function(F, V) {
                var w = this;
                w._ls && (w._f ? (w._rs || (w._rs = new En), w._rs.add({ l: F, s: V })) : w._remove(F, V))
            },
            _remove: function(I, k) {
                for (var Y, b = this._ls, L = 0, R = b.size(); R > L; L++)
                    if (Y = b.get(L), Y.l === I && Y.s === k) return b.removeAt(L), void 0
            },
            fire: function(d) {
                var f = this,
                    N = f._ls;
                if (f._b = 1e4, N) {
                    ++f._f;
                    try { for (var L, s = 0, Z = N.size(); Z > s; s++) L = N.get(s), L.s ? L.l.call(L.s, d) : L.l(d) } catch (d) { Ig(function() { throw d }) } finally {
                        if (--f._f) return;
                        if (f._rs) {
                            for (Z = f._rs.size(), s = 0; Z > s; s++) L = f._rs.get(s), f._remove(L.l, L.s);
                            delete f._rs
                        }
                        if (f._as) {
                            for (Z = f._as.size(), s = 0; Z > s; s++) L = f._as.get(s), L.a ? N.add(L, 0) : N.add(L);
                            delete f._as
                        }
                    }
                }
            }
        });
        var Bq = k.Data = function() { this._id = Ji() };
        fi("Data", n, {
            ms_ac: ["tag", "name", "displayName", "icon", "toolTip", "attrObject", "styleMap", "layer", "adjustChildrenToTop", "dataBindings"],
            ms_dm: 1,
            ms_attr: 1,
            _icon: A,
            _parent: A,
            _children: xg,
            _childMap: A,
            _styleMap: A,
            _layer: "0",
            _renderLayer: um,
            _renderLayerMask: Mg,
            _adjustChildrenToTop: !1,
            getRenderLayerMask: function() { return this._renderLayerMask || Mg },
            getRenderLayer: function() { return this._renderLayer || um },
            setRenderLayer: function(E) {
                var t = this,
                    u = bc(0, E);
                t._renderLayerMask = u;
                var A = t._renderLayer;
                t._renderLayer = E, t.fp("renderLayer", A, t._renderLayer)
            },
            testRenderLayer: function(q) { var $ = jj[q]; return $ && kp(this._renderLayerMask, jj[q].mask) },
            getUIClass: function() { return A },
            _22Q: function() { return A },
            beginTransaction: function() { this._dataModel && this._dataModel.beginTransaction() },
            endTransaction: function() { this._dataModel && this._dataModel.endTransaction() },
            s: function(q, E) {
                var p = this;
                if (2 === arguments.length) p.setStyle(q, E);
                else { if (!zg(q)) return p.getStyle(q); for (var w in q) p.setStyle(w, q[w]) }
                return p
            },
            fp: function(C, d, q, x, p) { return this.firePropertyChange(C, d, q, x, p) },
            firePropertyChange: function(e, H, A, D, J) {
                if (D) { if (D(H, A)) return !1 } else if (H === A) return !1;
                var E = this,
                    c = J || {};
                return c.property = e, c.oldValue = H, c.newValue = A, c.data = E, E._dataModel && E._dataModel.handleDataPropertyChange(c), E.onPropertyChanged(c), !0
            },
            onPropertyChanged: function(K) {
                var N = this,
                    F = N._parent,
                    P = K.property;
                if (Er(F)) {
                    var Z = N.s(Sl),
                        p = "s:ingroup" === P;
                    (Z && Ce[P] || P === p) && F._81I(), (Z || p) && F.fp("childChange", !0, !1)
                }
                jo(F) && (Ce[P] || "elevation" === P || ps[P] || "scaleTall" === P || "tall" === P) && F.updateFromChildren(), ("s:alwaysOnTop" === P || "s:shape3d.alwaysOnTop" === P) && (K.newValue ? this.setRenderLayer("top") : this.setRenderLayer(O))
            },
            _21I: function(V) {
                var J = this;
                if (V && J._dataModel) throw "Remove data from dataModel before adding";
                J._dataModel = V
            },
            removeFromDataModel: function() { this._dataModel ? this._dataModel.remove(this) : this.setParent(null) },
            clearChildrenFromDataModel: function() { for (var R = 0, y = this._children.toArray(), M = y.length; M > R; R++) y[R].removeFromDataModel() },
            getId: function() { return this._id },
            setId: function(q) { this._id = q },
            getChildren: function() { return this._children },
            size: function() { return this._children.size() },
            toChildren: function(u, J) { return this._children.toList(u, J) },
            eachChild: function(l, U) { this._children.each(l, U) },
            addChild: function(P, C) {
                var d = this;
                P !== d && (d._children === xg && (d._children = new En, d._childMap = {}), C >= 0 || (C = d._children.size()), d._childMap[P._id] || d.isDescendantOf(P) || (P._parent && P._parent.removeChild(P), (0 > C || C > d._children.size()) && (C = d._children.size()), d._children.add(P, C), d._childMap[P._id] = P, P.setParent(d), d.onChildAdded(P, C), d.fp(_m, A, P)))
            },
            onChildAdded: function() {},
            removeChild: function(s) {
                var $ = this;
                if ($._childMap && $._childMap[s._id]) {
                    var V = $._children.remove(s);
                    delete $._childMap[s._id], $.fp(_m, s, A), s.setParent(A, V), $.onChildRemoved(s, V)
                }
            },
            onChildRemoved: function() {},
            getChildAt: function(m) { return this._children.get(m) },
            clearChildren: function() {
                var x = this;
                if (!x._children.isEmpty())
                    for (var A = 0, S = x._children.toArray(), a = S.length; a > A; A++) x.removeChild(S[A])
            },
            getParent: function() { return this._parent },
            setParent: function(I, l) {
                var k = this;
                if (!(k._73I || k._parent === I || k === I || I && I.isDescendantOf(k))) {
                    var X, J = k._parent;
                    k._parent = I, k._73I = 1, J ? (l == A && (l = J.getChildren().indexOf(k)), J.removeChild(k)) : k._dataModel && l == A && (l = k._dataModel.getRoots().indexOf(k)), I && (I.addChild(k), X = I.getChildren().indexOf(k)), delete k._73I, k.fp("parent", J, I, O, { oldIndex: l, newIndex: X }), k.onParentChanged(J, I)
                }
            },
            onParentChanged: function() {},
            hasChildren: function() { return this._children.size() > 0 },
            isEmpty: function() { return this._children.isEmpty() },
            isRelatedTo: function(K) { return K ? this.isDescendantOf(K) || K.isDescendantOf(this) : !1 },
            isParentOf: function(Z) { return Z && this._childMap ? !!this._childMap[Z._id] : !1 },
            isDescendantOf: function(u) {
                if (!u || u.isEmpty()) return !1;
                for (var j = this._parent; j;) {
                    if (u === j) return !0;
                    j = j._parent
                }
                return !1
            },
            getStyle: function(T, $) { $ === O && ($ = 1); var l = this._styleMap ? this._styleMap[T] : O; return l === O && $ ? h[T] : l },
            setStyle: function(g, J) {
                var D = this;
                D._styleMap || (D._styleMap = {});
                var r = D._styleMap[g];
                J === O ? delete D._styleMap[g] : D._styleMap[g] = J, D.fp("s:" + g, r, J) && D.onStyleChanged(g, r, J)
            },
            onStyleChanged: function() {},
            iv: function(O) { this.invalidate(O) },
            invalidate: function(X) { this.fp(X || "*", !1, !0) },
            toString: function() { var w = this; return w._displayName || w._name || w._tag || w._id },
            toLabel: function() { return this._displayName || this._name },
            addStyleIcon: function(l, q) {
                var u = this,
                    b = u.s(ag);
                u.beginTransaction(), b || u.s(ag, b = {}), q ? b[l] = q : delete b[l], u.fp(ag, A, b), u.endTransaction()
            },
            removeStyleIcon: function(L) {
                var H = this.s(ag);
                if (H) {
                    var w = H[L];
                    delete H[L], this.fp(ag, A, H)
                }
                return w
            },
            _calcAnchorMatrix3d: function() {},
            appendAnchorMatrix3d: function(w) {
                var x = this;
                if (x.hasOwnProperty("_anchor") || x.hasOwnProperty("_anchorElevation")) {
                    var D = x.getAnchor3d(),
                        u = { x: D.x - .5, y: D.y - .5, z: D.z - .5 };
                    ge(w, [-u.x, -u.y, -u.z])
                }
            },
            getSerializableProperties: function() { return { name: 1, displayName: 1, icon: 1, toolTip: 1, parent: 1, layer: 1, renderLayer: 1, tag: 1, adjustChildrenToTop: 1, dataBindings: 1 } },
            getSerializableStyles: function() { var n, N = {}; for (n in this._styleMap) N[n] = 1; return N },
            getCurrentPrefix: function() { return this._interactPrefix || Hq },
            ca: function(K, u) { var O = this.getCurrentPrefix(); return K = O + K, 2 === arguments.length ? this.a(K, u) : this.a(K) }
        });
        var Fq = k.DataModel = function() {
            var g = this;
            g._isDeserializing = 0, g._datas = new En, g._dataMap = {}, g._roots = new En, g._rootMap = {}, g._fsDataMap = {}, g._78O = {}, g._reflectorMap = {}, g._36I = new Fp, g._35I = new Fp, g._serializeNotifier = new Fp, g._selectionModel = new $b(g);
            var n = g._29Q = [],
                l = g._scheduleCallback = function() {
                    for (var Q = Date.now(), A = 0; A < n.length; A++) {
                        var T = n[A];
                        T.enabled && Q - T.lastTime > T.interval && (T.beforeAction && T.beforeAction(), T.action && g.each(function(r) { T.action(r) }), T.afterAction && T.afterAction(), T.lastTime = Q)
                    }
                    n.length && (g._30Q = y.requestAnimationFrame(l))
                }
        };
        fi("DataModel", n, {
            ms_fire: 1,
            ms_attr: 1,
            ms_ac: ["layers", "name", "autoAdjustIndex", "hierarchicalRendering", "background", "envmap", "postProcessingData", "init"],
            _name: O,
            _autoAdjustIndex: !0,
            _hierarchicalRendering: !1,
            _background: O,
            _init: O,
            _envmap: O,
            _cubicEnvmap: !1,
            _postProcessingData: O,
            sm: function() { return this.getSelectionModel() },
            mm: function($, H, j) { this.addDataModelChangeListener($, H, j) },
            umm: function(H, Y) { this.removeDataModelChangeListener(H, Y) },
            md: function(S, A, y) { this.addDataPropertyChangeListener(S, A, y) },
            umd: function(M, e) { this.removeDataPropertyChangeListener(M, e) },
            mh: function(s, A, m) { this.addHierarchyChangeListener(s, A, m) },
            umh: function(f, Q) { this.removeHierarchyChangeListener(f, Q) },
            getAttrObject: function() { return this._attrObject },
            setAttrObject: function(A) { return this._attrObject = A },
            getSelectionModel: function() { return this._selectionModel },
            size: function() { return this._datas.size() },
            isEmpty: function() { return this._datas.isEmpty() },
            getRoots: function() { return this._roots },
            getDatas: function() { return this._datas },
            getFullscreenDatas: function() { return this._fsDataMap },
            getReflectors: function() { return this._reflectorMap },
            getDataById: function(i) { return this._dataMap[i] },
            removeDataById: function(Q) { this.remove(this.getDataById(Q)) },
            toDatas: function(F, C) { return this._datas.toList(F, C) },
            each: function(v, h) { this._datas.each(v, h) },
            getDataByTag: function(m) { return this._78O[m] },
            getTagMap: function() { return this._78O },
            removeDataByTag: function(l) { this.remove(this.getDataByTag(l)) },
            add: function(o, u, G) {
                var H = this,
                    m = o._id,
                    E = o._tag,
                    j = H._roots;
                if (H._dataMap[m]) throw "'" + m + "' already exists";
                E != A && (H._78O[E] = o), H._dataMap[m] = o, G >= 0 ? H._datas.add(o, G) : H._datas.add(o), o._parent || (H._rootMap[m] = o, u >= 0 ? j.add(o, u) : j.add(o)), o.s("fullscreen") !== O && (H._fsDataMap[m] = o), o.s("shape3d.reflector") && (H._reflectorMap[m] = o), o._21I(H), H.onAdded(o), H._36I.fire({ kind: "add", data: o, rootsIndex: u, datasIndex: G })
            },
            onAdded: function() {},
            remove: function(i, t) {
                if (i) {
                    var s = this,
                        Y = i._id,
                        V = t && t.keepStructure,
                        P = t && t.keepChildren,
                        N = i.getTag();
                    if (i._dataModel === s) {
                        var y = i instanceof em;
                        y && D.setIsolating(!0), this.beginTransaction(), V ? s._removingData || (s._removingData = i) : s.prepareRemove(i), P || i.toChildren().each(function(u) { s.remove(u, t) }, s), V ? s._removingData === i && (i._parent && i._parent.removeChild(i), delete s._removingData) : i._parent && i._parent.removeChild(i);
                        var k = s._datas.remove(i);
                        delete s._dataMap[Y], N != A && delete s._78O[N];
                        var W;
                        s._rootMap[Y] && (delete s._rootMap[Y], W = s._roots.remove(i)), s._fsDataMap[Y] && delete s._fsDataMap[Y], s._reflectorMap[Y] && delete s._reflectorMap[Y], i._21I(A), s.onRemoved(i), s._36I.fire({ kind: nd, data: i, rootsIndex: W, datasIndex: k }), this.endTransaction(), y && D.setIsolating(!1)
                    }
                }
            },
            onRemoved: function() {},
            prepareRemove: function() {},
            clear: function() {
                var Q = this;
                if (Q._datas.size()) {
                    var p = Q._historyManager ? this.toJSON() : O;
                    Q._datas.toArray().forEach(function(g) { g._21I(A) }), Q._datas.clear(), Q._dataMap = {}, Q._roots.clear(), Q._rootMap = {}, Q._fsDataMap = {}, Q._reflectorMap = {}, Q._78O = {}, Q._36I.fire({ kind: Cl, json: p })
                }
            },
            contains: function(q) { return q && q._dataModel === this },
            handleDataPropertyChange: function(V) {
                var C = this,
                    Q = V.data,
                    g = V.property;
                if ("parent" === g) {
                    var k = Q._id,
                        T = C._rootMap,
                        u = C._roots;
                    Q._parent ? T[k] && (delete T[k], u.remove(Q)) : T[k] || (T[k] = Q, u.add(Q))
                } else if ("tag" === g) {
                    var w = V.oldValue,
                        m = V.newValue,
                        a = C._78O;
                    w != A && delete a[w], m != A && (a[m] = Q)
                } else if ("s:fullscreen" === g) {
                    var k = Q._id,
                        h = C._fsDataMap;
                    V.oldValue != A && delete h[k], V.newValue != A && (h[k] = Q)
                } else if ("s:shape3d.reflector" === g) {
                    var k = Q._id,
                        y = C._reflectorMap;
                    V.oldValue && delete y[k], V.newValue && (y[k] = Q)
                }
                this.onDataPropertyChanged(Q, V), this._35I.fire(V)
            },
            onDataPropertyChanged: function() {},
            addDataModelChangeListener: function(f, c, B) { this._36I.add(f, c, B) },
            removeDataModelChangeListener: function(s, M) { this._36I.remove(s, M) },
            addSerializeListener: function(l, n, A) { this._serializeNotifier.add(l, n, A) },
            removeSerializeListener: function(b, N) { this._serializeNotifier.remove(b, N) },
            fireSerializeEvent: function(S) { this._serializeNotifier.fire(S) },
            addDataPropertyChangeListener: function(x, h, C) { this._35I.add(x, h, C) },
            removeDataPropertyChangeListener: function(d, N) { this._35I.remove(d, N) },
            _38I: function(r, V, c) { this._37I && this._37I.fire({ data: r, oldIndex: V, newIndex: c }) },
            addHierarchyChangeListener: function(m, Q, K) { this._37I || (this._37I = new Fp), this._37I.add(m, Q, K) },
            removeHierarchyChangeListener: function(s, o) { this._37I.remove(s, o) },
            getSiblings: function(I) { var S = I._parent; return S ? S._children : this._roots },
            eachByHierarchical: function(c, P, D) {
                if (P) return this._eachByHierarchical(c, P, D);
                for (var n = 0, m = this._roots, N = m.size(); N > n; n++)
                    if (this._eachByHierarchical(c, m.get(n), D) === !1) return !1;
                return !0
            },
            _eachByHierarchical: function(F, R, I) {
                if (I) { if (F.call(I, R) === !1) return !1 } else if (F(R) === !1) return !1;
                for (var T = R.size(), k = 0; T > k; k++)
                    if (this._eachByHierarchical(F, R.getChildAt(k), I) === !1) return !1;
                return !0
            },
            reverseEachByHierarchical: function(h, V, k) {
                if (V) return this._reverseEachByHierarchical(h, V, k);
                for (var S = this._roots, C = S.size(), I = C - 1; I >= 0; I--)
                    if (this._reverseEachByHierarchical(h, S.get(I), k) === !1) return !1;
                return !0
            },
            _reverseEachByHierarchical: function(n, k, j) {
                for (var X = k.size(), C = X - 1; C >= 0; C--)
                    if (this._reverseEachByHierarchical(n, k.getChildAt(C), j) === !1) return !1;
                if (j) { if (n.call(j, k) === !1) return !1 } else if (n(k) === !1) return !1;
                return !0
            },
            eachByDepthFirst: function(h, Y, r) {
                if (Y) return this._11I(h, Y, r);
                for (var H = 0, i = this._roots, R = i.size(); R > H; H++)
                    if (this._11I(h, i.get(H), r) === !1) return !1;
                return !0
            },
            _11I: function(j, J, G) {
                for (var U = J.size(), F = 0; U > F; F++)
                    if (this._11I(j, J.getChildAt(F), G) === !1) return !1;
                if (G) { if (j.call(G, J) === !1) return !1 } else if (j(J) === !1) return !1;
                return !0
            },
            eachByBreadthFirst: function(Q, F, j) {
                var d = new En;
                for (F ? d.add(F) : this._roots.each(d.add, d); d.size() > 0;)
                    if (F = d.removeAt(0), F.eachChild(d.add, d), j) { if (Q.call(j, F) === !1) return !1 } else if (Q(F) === !1) return !1;
                return !0
            },
            moveTo: function(f, d) {
                var a = this.getSiblings(f),
                    A = a.indexOf(f);
                A === d || 0 > A || d >= 0 && d <= a.size() && (a.remove(f), d > a.size() && d--, a.add(f, d), this._38I(f, A, d))
            },
            moveUp: function(_) { this.moveTo(_, this.getSiblings(_).indexOf(_) - 1) },
            moveDown: function(F) { this.moveTo(F, this.getSiblings(F).indexOf(F) + 1) },
            moveToTop: function(g) { this.moveTo(g, 0) },
            moveToBottom: function(A) { this.moveTo(A, this.getSiblings(A).size()) },
            moveSelectionUp: function(x) {
                this.beginTransaction(), x || (x = this.sm());
                var P = new En;
                Ve(x, P, this._roots), P.each(this.moveUp, this), this.endTransaction()
            },
            moveSelectionDown: function(t) {
                this.beginTransaction(), t || (t = this.sm());
                var B = new En;
                ec(t, B, this._roots), B.each(this.moveDown, this), this.endTransaction()
            },
            moveSelectionToTop: function(b) {
                this.beginTransaction(), b || (b = this.sm());
                var n = new En;
                Wm(b, n, this._roots), n.each(this.moveToTop, this), this.endTransaction()
            },
            moveSelectionToBottom: function(U) {
                this.beginTransaction(), U || (U = this.sm());
                var E = new En;
                bn(U, E, this._roots), E.each(this.moveToBottom, this), this.endTransaction()
            },
            moveToIndex: function(h, L, a) {
                var A = this.getDatas();
                null == a && (a = A.indexOf(h)), a === L || 0 > a || L >= 0 && L <= A.size() && (A.remove(h), L > A.size() && L--, A.add(h, L), this._76I(h, a, L))
            },
            bringForward: function(y) { this.moveToIndex(y, this.getDatas().indexOf(y) + 1) },
            bringToFront: function(y) { this.moveToIndex(y, this.size()) },
            sendBackward: function(b) { this.moveToIndex(b, this.getDatas().indexOf(b) - 1) },
            sendToBack: function(q) { this.moveToIndex(q, 0) },
            bringSelectionForward: function(P) {
                this.beginTransaction(), P || (P = this.sm());
                for (var C = new En, v = this.getDatas(), n = !1, U = 0; U < v.size(); U++) {
                    var j = v.get(v.size() - 1 - U);
                    P.contains(j) ? n && C.add(j) : n = !0
                }
                C.each(this.bringForward, this), this.endTransaction()
            },
            bringSelectionToFront: function(i) {
                this.beginTransaction(), i || (i = this.sm());
                for (var G = new En, x = this.getDatas(), d = 0; d < x.size(); d++) {
                    var V = x.get(d);
                    i.contains(V) && G.add(V)
                }
                G.each(this.bringToFront, this), this.endTransaction()
            },
            sendSelectionBackward: function(H) {
                this.beginTransaction(), H || (H = this.sm());
                for (var m = new En, n = this.getDatas(), C = !1, K = 0; K < n.size(); K++) {
                    var J = n.get(K);
                    H.contains(J) ? C && m.add(J) : C = !0
                }
                m.each(this.sendBackward, this), this.endTransaction()
            },
            sendSelectionToBack: function(N) {
                this.beginTransaction(), N || (N = this.sm());
                for (var A = new En, y = this.getDatas(), c = 0; c < y.size(); c++) {
                    var R = y.get(y.size() - 1 - c);
                    N.contains(R) && A.add(R)
                }
                A.each(this.sendToBack, this), this.endTransaction()
            },
            addScheduleTask: function(s) {
                var z = this;
                z.removeScheduleTask(s), s.enabled == A && (s.enabled = !0), s.interval == A && (s.interval = 10), s.lastTime = Date.now(), z._29Q.push(s), z._30Q == A && (z._30Q = y.requestAnimationFrame(z._scheduleCallback))
            },
            removeScheduleTask: function(Q) {
                var t = this,
                    e = t._29Q,
                    z = e.indexOf(Q);
                z >= 0 && e.splice(z, 1), e.length || t._30Q == A || (y.cancelAnimationFrame(t._30Q), delete t._30Q)
            },
            getHistoryManager: function() { return this._historyManager },
            enableHistoryManager: function(a) { this._historyManager || new k.HistoryManager(this), null != a && this._historyManager.setMaxHistoryCount(a), this._historyManager.setDisabled(!1) },
            disableHistoryManager: function() { this._historyManager && this._historyManager.setDisabled(!0) },
            clearHistoryManager: function() { this._historyManager && this._historyManager.clear() },
            undo: function(l) { this._historyManager && this._historyManager.undo(l) },
            redo: function(T) { this._historyManager && this._historyManager.redo(T) },
            beginTransaction: function() { this._historyManager && this._historyManager.beginTransaction() },
            endTransaction: function() { this._historyManager && this._historyManager.endTransaction() },
            addHistory: function(W) { this._historyManager && this._historyManager.addHistory(W) },
            onHistoryManagerChanged: function() {},
            isDeserializing: function() { return this._isDeserializing > 0 },
            setDeserializing: function(D) { D ? this._isDeserializing++ : this._isDeserializing-- },
            isCubicEnvmap: function() { return this._cubicEnvmap },
            setCubicEnvmap: function(R) {
                var M = this._cubicEnvmap;
                this._cubicEnvmap = R, this.fp("cubicEnvmap", M, R)
            }
        });
        var $b = k.SelectionModel = function(N) {
            var R = this;
            R._68O = Km, R._map = {}, R._73O = new En, R._74I = new Fp, R._21I(N)
        };
        fi("SelectionModel", n, {
            ms_fire: 1,
            ms_dm: 1,
            ms: function(H, k, w) { this.addSelectionChangeListener(H, k, w) },
            ums: function(t, Z) { this.removeSelectionChangeListener(t, Z) },
            fd: function() { return this.getFirstData() },
            ld: function() { return this.getLastData() },
            sg: function() { return this._68O === Gn },
            co: function(R) { return this._map[R._id] != A },
            ss: function(j) { this.setSelection(j) },
            as: function(n) { this.appendSelection(n) },
            rs: function(T) { this.removeSelection(T) },
            cs: function() { this.clearSelection() },
            sa: function() { this.selectAll() },
            getSelectionMode: function() { return this._68O },
            setSelectionMode: function(D) {
                var U = this;
                if (U._68O !== D && (D === xo || D === Gn || D === Km)) {
                    U.cs();
                    var y = U._68O;
                    U._68O = D, U.fp("selectionMode", y, D)
                }
            },
            _21I: function(Z) {
                var f = this,
                    E = f._dataModel;
                E !== Z && (E && (f.cs(), E.umm(f.handleDataModelChange, f)), f._dataModel = Z, Z.mm(f.handleDataModelChange, f, !0), f.fp(ll, E, Z))
            },
            dispose: function() {
                var A = this;
                A.cs(), A._dataModel.umm(A.handleDataModelChange, A)
            },
            handleDataModelChange: function(j) {
                var W = this;
                if (j.kind === nd) {
                    var V = j.data;
                    W.co(V) && (W._73O.remove(V), delete W._map[V._id], W._75I(nd, new En(V)))
                } else j.kind === Cl && W.cs()
            },
            getFilterFunc: function() { return this._filterFunc },
            setFilterFunc: function(S) {
                var v = this;
                if (v._filterFunc !== S) {
                    v.cs();
                    var O = v._filterFunc;
                    v._filterFunc = S, v.fp("filterFunc", O, v._filterFunc)
                }
            },
            _75I: function(J, m, T, K) { T && (this._73O.each(function(b) { K[b._id] ? T.remove(b) : T.add(b) }), m = T.toList()), this._74I.fire({ kind: J, datas: new En(m) }) },
            addSelectionChangeListener: function(S, Z, A) { this._74I.add(S, Z, A) },
            removeSelectionChangeListener: function(M, J) { this._74I.remove(M, J) },
            _97O: function(d, W) { for (var p, Y = this, r = 0, U = new En(d); r < U.size(); r++) p = U.get(r), (Y._filterFunc && !Y._filterFunc(p) || W && Y.co(p) || !W && !Y.co(p) || !Y._dataModel.contains(p)) && (U.removeAt(r), r--); return U },
            appendSelection: function(k) {
                var m = this;
                if (m._68O !== xo) {
                    var d, K, z = m._73O,
                        u = m._97O(k, !0);
                    u.isEmpty() || (m.sg() && (d = new En(z), K = m._map, z.clear(), m._map = {}, u = new En(u.get(u.size() - 1))), u.each(function(i) { z.add(i), m._map[i._id] = i }), m._75I("append", u, d, K))
                }
            },
            removeSelection: function(n) {
                var H = this,
                    c = H._97O(n),
                    b = 0,
                    u = c.size();
                if (0 !== u) {
                    for (; u > b; b++) {
                        var h = c.get(b);
                        H._73O.remove(h), delete H._map[h._id]
                    }
                    H._75I(nd, c)
                }
            },
            toSelection: function(m, y) { return this._73O.toList(m, y) },
            getSelection: function() { return this._73O },
            each: function(B, l) { this._73O.each(B, l) },
            setSelection: function(t) {
                var g = this,
                    Q = g._73O;
                if (g._68O !== xo && !(Q.isEmpty() && !t || 1 === Q.size() && g.ld() === t)) {
                    var P = new En(Q),
                        Z = g._map;
                    Q.clear(), g._map = {};
                    var H = g._97O(t, !0);
                    g.sg() && H.size() > 1 && (H = new En(H.get(H.size() - 1))), H.each(function(b) { Q.add(b), g._map[b._id] = b }), g._75I("set", A, P, Z)
                }
            },
            clearSelection: function() {
                var j = this,
                    G = j._73O;
                if (G.size() > 0) {
                    var $ = G.toList();
                    G.clear(), j._map = {}, j._75I(Cl, $)
                }
            },
            selectAll: function() {
                var f = this;
                if (f._68O !== xo) {
                    var M, D, K = f._dataModel.toDatas();
                    if (f._filterFunc)
                        for (M = 0; M < K.size(); M++) D = K.get(M), f._filterFunc(D) || (K.removeAt(M), M--);
                    var n = f._73O,
                        s = new En(n),
                        p = f._map;
                    n.clear(), f._map = {}, f.sg() && K.size() > 1 && (K = new En(K.get(K.size() - 1)));
                    var P = K.size();
                    for (M = 0; P > M; M++) D = K.get(M), n.add(D), f._map[D._id] = D;
                    f._75I("all", A, s, p)
                }
            },
            size: function() { return this._73O.size() },
            isEmpty: function() { return this._73O.isEmpty() },
            contains: function(Q) { return this._map[Q._id] != A },
            getLastData: function() { var L = this._73O; return L.size() > 0 ? L.get(L.size() - 1) : A },
            getFirstData: function() { var k = this._73O; return k.size() > 0 ? k.get(0) : A },
            isSelectable: function(c) { var F = this; return c && F._68O !== xo ? F._filterFunc ? F._filterFunc(c) : !0 : !1 },
            getTopSelection: function() {
                var p = this,
                    $ = new En;
                return p._73O.each(function(e) {
                    for (var J = e.getParent(); J;) {
                        if (p.contains(J)) { e = A; break }
                        J = J.parent
                    }
                    e && $.add(e)
                }), $
            }
        });
        var Kc = function() {
            return fk(0),
                function(C, p) {
                    var w;
                    if (oh(p)) {
                        var r = C.getDataUI(p);
                        r && r._88I && (w = r._88I.rect)
                    }
                    return w ? w : p.getRect()
                }
        }();
        gp(D, { edgeGroupAgentFunc: A, graphViewAutoScrollZone: 16, graphViewZoomable: !0, graphViewResettable: !1, graphViewPannable: !0, graphViewRectSelectable: !0, graphViewScrollBarVisible: !0, graphViewRectSelectBorderColor: l.rectSelectBorder, graphViewRectSelectBackground: Kg, graphViewEditPointSize: Po ? 17 : 7, graphViewEditPointBorderColor: l.editPointBorder, graphViewEditPointBackground: l.editPointBackground, setEdgeType: function(n, F, q) { qp[n] = F, fq[n] = q }, getEdgeType: function(l) { return qp[l] }, getEdgeTypeMap: function() { return qp }, getNodeRect: Kc }, !0);
        var Yp = { "layout.h": O, "layout.v": O, "2d.selectable": !0, "2d.visible": !0, "2d.movable": !0, "2d.editable": !0, "2d.move.mode": O, "2d.attachable": !1, "2d.hostable": !1, interactive: !1, preventDefaultWhenInteractive: !0, "image.stretch": "fill", icons: O, ingroup: !0, "body.color": O, "2d.gray": !1, fullscreen: O, "fullscreen.gap": 2, "fullscreen.lock": !1, opacity: O, pixelPerfect: !0, keepAspectRatio: !1, "attach.points": null, "attach.style": null, "attach.close.threshold": 16, "clip.direction": "top", "clip.percentage": 1, "select.color": sn, "select.width": 1, "select.padding": 2, "select.type": Ej, shadow: !1, "shadow.blur": 6, "shadow.offset.x": 3, "shadow.offset.y": 3, shadow2: !1, "shadow2.color": sn, "shadow2.blur": 6, "shadow2.offset.x": 3, "shadow2.offset.y": 3, "border.color": O, "border.width": 2, "border.padding": 2, "border.type": Ej, label: O, "label.font": O, "label.color": Yg, "label.background": O, "label.position": 31, "label.position.fixed": !1, "label.offset.x": 0, "label.offset.y": 2, "label.rotation": O, "label.max": O, "label.opacity": O, "label.scale": 1, "label.align": O, "label.selectable": !0, label2: O, "label2.font": O, "label2.color": Yg, "label2.background": O, "label2.position": 34, "label2.position.fixed": !1, "label2.offset.x": 0, "label2.offset.y": -2, "label2.rotation": O, "label2.max": O, "label2.opacity": O, "label2.scale": 1, "label2.align": O, "label2.selectable": !0, note: O, "note.expanded": !0, "note.font": O, "note.color": Yr, "note.background": sn, "note.position": 8, "note.offset.x": -3, "note.offset.y": 3, "note.max": O, "note.toggleable": !0, "note.border.width": 1, "note.border.color": O, "note.opacity": O, "note.scale": 1, "note.align": O, note2: O, "note2.expanded": !0, "note2.font": O, "note2.color": Yr, "note2.background": sn, "note2.position": 3, "note2.offset.x": 3, "note2.offset.y": -3, "note2.max": O, "note2.toggleable": !0, "note2.border.width": 1, "note2.border.color": O, "note2.opacity": O, "note2.scale": 1, "note2.align": O, "group.type": O, "group.image": O, "group.image.stretch": "fill", "group.repeat.image": O, "group.border.repeat.image": O, "group.padding": 8, "group.padding.left": 0, "group.padding.right": 0, "group.padding.top": 0, "group.padding.bottom": 0, "group.position": 17, "group.toggleable": !0, "group.title.font": O, "group.title.color": Yr, "group.title.background": l.groupTitleBackground, "group.title.align": Ui, "group.title.orientation": Gm, "group.background": l.groupBackground, "group.depth": 1, "group.border.width": 1, "group.border.pattern": O, "group.border.color": le, "group.border.radius": O, "group.border.cap": Jn, "group.border.join": Ec, "group.border.width.absolute": !1, "group.splitLine": !1, "group.gradient": A, "group.gradient.color": "#FFF", shape: O, "shape.background": le, "shape.repeat.image": O, "shape.border.repeat.image": O, "shape.border.width": 0, "shape.border.width.absolute": !1, "shape.border.color": le, "shape.border.3d": !1, "shape.border.3d.color": O, "shape.border.3d.accuracy": O, "shape.border.cap": Jn, "shape.border.join": Ec, "shape.border.pattern": O, "shape.gradient": A, "shape.gradient.color": "#FFF", "shape.depth": 0, "shape.dash": !1, "shape.dash.pattern": Ho, "shape.dash.offset": 0, "shape.dash.color": Ai, "shape.dash.width": O, "shape.dash.3d": !1, "shape.dash.3d.color": O, "shape.dash.3d.accuracy": O, "shape.polygon.side": 6, "shape.arc.from": U, "shape.arc.to": m, "shape.arc.close": !0, "shape.arc.oval": !1, "shape.corner.radius": O, "shape.gradient.pack": O, "shape.fill.rule": "nonzero", "shape.fill.clip.direction": "top", "shape.fill.clip.percentage": 1, "shape.foreground": O, "shape.foreground.gradient": A, "shape.foreground.gradient.color": "#FFF", "shape.foreground.clip.direction": "top", "shape.foreground.clip.percentage": 1, "autolayout.gap": O, "autolayout.hgap": O, "autolayout.vgap": O, "edge.type": O, "edge.points": O, "edge.segments": O, "edge.color": le, "edge.width": 2, "edge.width.absolute": !1, "edge.repeat.image": null, "edge.offset": 0, "edge.group": 0, "edge.expanded": !0, "edge.gap": 12, "edge.toggleable": !0, "edge.center": !1, "edge.3d": !1, "edge.3d.color": O, "edge.3d.accuracy": O, "edge.cap": Jn, "edge.join": Ec, "edge.source.position": 17, "edge.source.anchor.x": O, "edge.source.anchor.y": O, "edge.source.offset.x": 0, "edge.source.offset.y": 0, "edge.source.index": -1, "edge.source.percent": 0, "edge.target.position": 17, "edge.target.anchor.x": O, "edge.target.anchor.y": O, "edge.target.offset.x": 0, "edge.target.offset.y": 0, "edge.target.index": -1, "edge.target.percent": 0, "edge.pattern": O, "edge.dash": !1, "edge.dash.pattern": Ho, "edge.dash.offset": 0, "edge.dash.color": Ai, "edge.dash.width": O, "edge.dash.3d": !1, "edge.dash.3d.color": O, "edge.dash.3d.accuracy": O, "edge.independent": !1, "attach.row.index": 0, "attach.column.index": 0, "attach.row.span": 1, "attach.column.span": 1, "attach.padding": 0, "attach.padding.left": 0, "attach.padding.right": 0, "attach.padding.top": 0, "attach.padding.bottom": 0, "attach.index": -1, "attach.offset": 0, "attach.offset.relative": !1, "attach.offset.opposite": !1, "attach.thickness": O, "attach.gap": 0, "attach.gap.relative": !1, "grid.row.count": 1, "grid.column.count": 1, "grid.row.percents": O, "grid.column.percents": O, "grid.border": 1, "grid.border.left": 0, "grid.border.right": 0, "grid.border.top": 0, "grid.border.bottom": 0, "grid.gap": 1, "grid.background": l.gridBackground, "grid.depth": 1, "grid.cell.depth": -1, "grid.cell.border.color": l.gridCellBorderColor, "grid.block": O, "grid.block.padding": 3, "grid.block.width": 1, "grid.block.color": l.gridBlockColor, text: "", "text.align": "left", "text.vAlign": "middle", "text.color": Yg, "text.gradient.pack": O, "text.font": Zq, "text.shadow": !1, "text.shadow.color": sn, "text.shadow.blur": 6, "text.shadow.offset.x": 3, "text.shadow.offset.y": 3, "text.scale.x": 1, "text.scale.y": 1, keepPosition: !0 };
        Yp[me] = O, gp(h, Yp, !0), gp(Fq, {
            _76I: function(O, d, b) { this._39I && this._39I.fire({ data: O, oldIndex: d, newIndex: b }) },
            addIndexChangeListener: function(B, P, l) {
                var p = this;
                p._39I || (p._39I = new Fp), p._39I.add(B, P, l)
            },
            removeIndexChangeListener: function(Q, o) { this._39I.remove(Q, o) },
            prepareRemove: function(m) { Si(m) && (m.setSource(A), m.setTarget(A)), m._70O && m._70O.toList().each(this.remove, this), m._69O && m._69O.toList().each(function(U) { U.setHost(A) }), m._host && m.setHost(A) },
            onAdded: function(r) { this.isAutoAdjustIndex() && this.adjustIndex(r) },
            onDataPropertyChanged: function(b, f) { vq[f.property] && this.isAutoAdjustIndex() && this.adjustIndex(b) },
            isAdjustable: function(c) { return Dj(c) || Si(c) },
            isAdjustedToBottom: function(h) { return Er(h) ? h.isExpanded() && rc(h) : !1 },
            adjustIndex: function(E) {
                var Z = this;
                this.isHierarchicalRendering() || (Z.isAdjustedToBottom(E) ? (Z.sendToBottom(E), E.eachChild(Z.adjustIndex, Z)) : Z.sendToTop(E))
            },
            sendToTop: function(W) {
                var d = this;
                if (d.contains(W) && d.isAdjustable(W)) {
                    var L = d._datas;
                    if (W !== L.get(d.size() - 1)) {
                        var t = L.indexOf(W);
                        L.removeAt(t), L.add(W), d._76I(W, t, d.size() - 1)
                    }
                    if (Si(W)) {
                        var C = W._40I;
                        C && !d.isAdjustedToBottom(C) && d.sendToTop(C), C = W._41I, C && !d.isAdjustedToBottom(C) && d.sendToTop(C)
                    }
                    W._69O && W._69O.each(function(q) { q.isRelatedTo(W) || Dj(W) && q.isLoopedHostOn(W) || d.sendToTop(q) }), W.ISubGraph || (!Er(W) || W.isExpanded()) && W._adjustChildrenToTop && W.eachChild(function(t) { Si(t) || d.sendToTop(t) })
                }
            },
            sendToBottom: function(Y, b) {
                var H = this;
                if (Y !== b && H.contains(Y) && H.isAdjustable(Y) && (!b || H.contains(b))) {
                    var x = H._datas,
                        M = x.remove(Y),
                        g = b ? H._datas.indexOf(b) : 0;
                    if (x.add(Y, g), M !== g) { H._76I(Y, M, g); var J = Y._parent;!J || J.ISubGraph || Si(J) || H.sendToBottom(Y._parent, Y) }
                }
            }
        }), gp(Xp, {
            ms_edit: function(E) {
                E._46O = function(D) {
                    var m = this,
                        T = m.gv.dm(),
                        C = m._index,
                        $ = m._89I,
                        Q = m._node,
                        a = m._shape,
                        A = m._edge,
                        q = m._77I;
                    Q && $ ? (this.fi({ kind: "endEditRect", event: D, data: Q, direction: $ }), T.endTransaction()) : a && C >= 0 ? (m.fi({ kind: "endEditPoint", event: D, data: a, index: C }), T.endTransaction()) : A && C >= 0 ? (m.fi({ kind: "endEditPoint", event: D, data: A, index: C }), T.endTransaction()) : q && (m.fi({ kind: "endEditRotation", event: D, data: q }), T.endTransaction())
                }, E._78I = function(h) {
                    var p = this;
                    p.autoScroll(h);
                    var C = p.gv.lp(h),
                        s = p._index,
                        G = p._89I,
                        E = p._node,
                        v = p._shape,
                        b = p._edge,
                        H = p._77I;
                    if (E && G) p._80O(C), p.fi({ kind: "betweenEditRect", event: h, data: E, direction: G });
                    else if (v && s >= 0) C.e = v.getPoints().get(s).e, v.setPoint(s, C), p.fi({ kind: "betweenEditPoint", event: h, data: v, index: s });
                    else if (b && s >= 0) {
                        var x = b.s(Go);
                        C.e = x.get(s).e, x.set(s, C), b.fp(Go, A, x), p.fi({ kind: "betweenEditPoint", event: h, data: b, index: s })
                    } else if (H) {
                        var V = H.p(),
                            i = H.getScale(),
                            Q = Z + Cc(C.y - V.y, C.x - V.x);
                        i.y < 0 && (Q += U), X(Q) < .04 && (Q = 0), H.setRotation(Q), p.fi({ kind: "betweenEditRotation", event: h, data: H })
                    }
                }, E._80O = function(B) {
                    var H = this,
                        w = H._node,
                        F = H._rect,
                        A = F.x,
                        k = F.y,
                        Z = F.width,
                        I = F.height,
                        D = H._89I,
                        m = H._anchor,
                        y = H._matrix,
                        B = y.tfi(B);
                    "northwest" === D ? F = we(B, { x: A + Z, y: k + I }) : D === wk ? F = we({ x: A, y: B.y }, { x: A + Z, y: k + I }) : "northeast" === D ? F = we({ x: A, y: B.y }, { x: B.x, y: k + I }) : D === Ye ? F = we({ x: B.x, y: k }, { x: A + Z, y: k + I }) : D === so ? F = we({ x: A, y: k }, { x: B.x, y: k + I }) : "southwest" === D ? F = we({ x: B.x, y: k }, { x: A + Z, y: B.y }) : "south" === D ? F = we({ x: A, y: k }, { x: A + Z, y: B.y }) : "southeast" === D && (F = we({ x: A, y: k }, B)), w.setPosition(y.tf(F.x + F.width * m.x, F.y + F.height * m.y)), w.setWidth(F.width), w.setHeight(F.height)
                }, E._80I = function(M, t, D, B) {
                    var c = this,
                        q = c.gv._zoom,
                        P = (c.gv.getEditPointSize() + 2) / q;
                    return Df({ x: t - P / 2, y: D - P / 2, width: P, height: P }, M) ? (c._89I !== B && (c._89I = B), !0) : !1
                }, E._79I = function(U, q, M) {
                    var Q = this,
                        e = Q.gv,
                        l = q ? e.getDataUI(q) : A,
                        z = l ? l._55O : A;
                    if (z) {
                        var h, E, b, G, B = e._zoom,
                            J = (e.getEditPointSize() + 2) / B,
                            D = e.lp(U);
                        if (Dj(q)) {
                            if (z._56O && Dj(q) && (E = z._98o, Df({ x: E.x - J / 2, y: E.y - J / 2, width: J, height: J }, D))) return Q._77I = q, M && Q.fi({ kind: "beginEditRotation", event: U, data: q }), Q.setCursor("crosshair"), !0;
                            if (z._43O && q instanceof Lj)
                                for (b = q.getPoints(), h = b.size() - 1; h >= 0; h--)
                                    if (E = b.get(h), Df({ x: E.x - J / 2, y: E.y - J / 2, width: J, height: J }, D)) return Q._index = h, Q._shape = q, M && Q.fi({ kind: "beginEditPoint", event: U, data: q, index: h }), Q.setCursor("crosshair"), !0;
                            if (z._42O)
                                for (var g = q.getEditControlPoints(), r = ["northwest", -1, -1, Ye, -1, 0, "southwest", -1, 1, "south", 0, 1, "southeast", 1, 1, so, 1, 0, "northeast", 1, -1, wk, 0, -1], h = 0, G = g.length; G > h; h++) {
                                    var n = r[3 * h],
                                        T = g[h];
                                    if (Q._80I(D, T.x, T.y, n)) {
                                        Q._node = q;
                                        var a = q.getWidth(),
                                            W = q.getHeight(),
                                            s = q.getAnchor();
                                        Q._rect = { x: -a * s.x, y: -W * s.y, width: a, height: W }, Q._anchor = s, Q._matrix = q.getMatrix();
                                        var F = q.getRotation(),
                                            H = C(F),
                                            x = N(F),
                                            P = r[3 * h + 1] * ej(q.getScale().x),
                                            I = r[3 * h + 2] * ej(q.getScale().y),
                                            i = Math.atan2(-x * P - H * I, H * P - x * I),
                                            o = (Math.round(i / (Math.PI / 4)) + 8) % 8,
                                            c = [Or, "nesw-resize", pd, "nwse-resize", Or, "nesw-resize", pd, "nwse-resize"][o];
                                        return Q.setCursor(c), M && Q.fi({ kind: "beginEditRect", event: U, data: q, direction: Q._89I }), !0
                                    }
                                }
                        }
                        if (z._43O && Si(q) && q.s(Lk) === Vf && (b = q.s(Go)))
                            for (h = b.size() - 1; h >= 0; h--)
                                if (E = b.get(h), Df({ x: E.x - J / 2, y: E.y - J / 2, width: J, height: J }, D)) return Q._index = h, Q._edge = q, M && Q.fi({ kind: "beginEditPoint", event: U, data: q, index: h }), Q.setCursor("crosshair"), !0
                    }
                    return !1
                }
            },
            ms_gv: function(e) {
                e._currentSubGraph = A, e._initView = function() { this._fpsInfo = { time: 0, fps: 0, frames: 0 } }, e.upSubGraph = function() { this.setCurrentSubGraph(Op(this._currentSubGraph)) }, e.isVisible = function(x) {
                    var g = this;
                    if (Op(x) !== g._currentSubGraph) return !1;
                    if (Si(x)) {
                        var R = x._40I,
                            l = x._41I;
                        if (!R || !l) return !1;
                        if (!(x.s("edge.independent") || g.isVisible(R) && g.isVisible(l))) return !1;
                        if (x.isEdgeGroupHidden()) return !1
                    } else
                        for (var k = x._parent; k && !k.ISubGraph;) {
                            if (Er(k) && (!k.isExpanded() || !g.isVisible(k))) return !1;
                            k = k._parent
                        }
                    if (x._parent instanceof em && !g.isVisible(x._parent)) return !1;
                    if (x._refGraph instanceof Ae && !g.isVisible(x._refGraph)) return !1;
                    if (g instanceof Mm) { if (!x.s("3d.visible")) return !1 } else { var H = g.getLayersInfo(); if (H) { var C = H[x._layer]; if (C && C.visible === !1) return !1 } if (!x.s("2d.visible")) return !1 }
                    return g._visibleFunc ? g._visibleFunc(x) : !0
                }, e.handleSelectionChange = function(t) {
                    var w = this;
                    t.datas.each(function(v) {
                        w.invalidateData(v);
                        var L = v._parent;
                        Er(L) && Dj(v) && v.s(Sl) && (w.invalidateData(L), L._49I && L._49I.each(function(d) { w.invalidateData(d) }))
                    }), w.onSelectionChanged(t)
                }, e.onSelectionChanged = function(q) {
                    var H = this,
                        L = H.sm();
                    if (1 === L.size() && ("set" === q.kind || "append" === q.kind)) {
                        var Z = L.ld();
                        H.isAutoMakeVisible() && H.makeVisible(Z), H.adjustIndex && H._dataModel.isAutoAdjustIndex() && H.adjustIndex(Z)
                    }
                }, e.makeVisible = function(G) {
                    if (G) {
                        var B = this,
                            I = B.getDataUI ? B.getDataUI(G) : B.getData3dUI(G);
                        if (I) {
                            var e = G,
                                n = Op(G);
                            for (n !== B._currentSubGraph && B.setCurrentSubGraph(n);
                                (e = e._parent) && e !== n;) Er(e) && e.setExpanded(!0);
                            B._23I = G, B.iv()
                        }
                    }
                }, e.getLabel = function(X) { var I = X.getStyle($c); return I === O ? X.getName() : I }, e.getLabelBackground = function(R) { return R.getStyle("label.background") }, e.getLabelColor = function(L) { return L.getStyle("label.color") }, e.getLabel2 = function(G) { return G.getStyle("label2") }, e.getLabel2Background = function(t) { return t.getStyle("label2.background") }, e.getLabel2Color = function(W) { return W.getStyle("label2.color") }, e.getNote = function(y) { return y.getStyle(Rc) }, e.getNoteBackground = function(q) { return q.getStyle("note.background") }, e.getNote2 = function(A) { return A.getStyle(td) }, e.getNote2Background = function(N) { return N.getStyle("note2.background") }, e.handleClick = function(o, I, w) {
                    var i = this;
                    I ? (i.fi({ kind: "clickData", event: o, data: I, part: w }), i.onDataClicked(I, o)) : (i.fi({ kind: "clickBackground", event: o }), i.onBackgroundClicked(o))
                }, e.handleDoubleClick = function(j, M, R) {
                    var _ = this;
                    pn(j) && (M ? (_.fi({ kind: "doubleClickData", event: j, data: M, part: R }), _.onDataDoubleClicked(M, j, R), _.checkDoubleClickOnNote(j, M, R) || _.checkDoubleClickOnRotation && _.checkDoubleClickOnRotation(j, M, R) || (Si(M) ? _.onEdgeDoubleClicked(M, j, R) : M.ISubGraph ? _.onSubGraphDoubleClicked(M, j, R) : Er(M) ? _.onGroupDoubleClicked(M, j, R) : M.IDoorWindow ? _.onDoorWindowDoubleClicked(M, j, R) : M.ICSGBox && _.onCSGBoxDoubleClicked(M, j, R))) : (_.fi({ kind: "doubleClickBackground", event: j }), _.onBackgroundDoubleClicked(j)))
                }, e.onSubGraphDoubleClicked = function(V) { this.setCurrentSubGraph(V) }, e.onEdgeDoubleClicked = function(V, M) { this.isEditable(V) || (V.ISubGraph && !Xn(M) ? this.setCurrentSubGraph(V) : V.s("edge.toggleable") && V.toggle()) }, e._39Q = function(m) { return this.isInteractive(m) ? this.preventDefaultWhenInteractive(m) : !1 }, e.preventDefaultWhenInteractive = function(g) { return g.s("preventDefaultWhenInteractive") }, e.onGroupDoubleClicked = function(q) { q.s("group.toggleable") && q.toggle() }, e.onDoorWindowDoubleClicked = function(D) { D.s("dw.toggleable") && D.toggle(!0) }, e.onCSGBoxDoubleClicked = function(d, D) {
                    var R = this;
                    if (R instanceof Mm) {
                        var q = R.intersectObject(D, d);
                        q && d.s(q.part + ".toggleable") && d.toggleFace(q.part, !0)
                    }
                }, e.onBackgroundClicked = function() {}, e.onBackgroundDoubleClicked = function() { this.upSubGraph() }, e.onDataClicked = function() {}, e.onDataDoubleClicked = function() {}, e.onAutoLayoutEnded = function() {}, e.onMoveEnded = function() {}, e.onPanEnded = function() {}, e.onPinchEnded = function() {}, e.onRectSelectEnded = function() {}, e.onZoomEnded = function() {}, e.serialize = function(O) { return this.dm().serialize(O) }, e.toJSON = function() { return this.dm().toJSON() }, e.deserialize = function(n, r) {
                    var B = this;
                    r = r instanceof Bq ? { rootParent: r } : Nl(r) ? { setId: r } : Fe(r) ? { finishFunc: r } : r || {}, r.view = B;
                    var o = B.dm();
                    return r.__innerHandler__ = function(C) {
                        if (Nl(o.a("toolTipEnable")) && (o.a("toolTipEnable") ? B.enableToolTip() : B.disableToolTip()), B instanceof k.graph.GraphView && (Nl(o.a("zoomable")) && B.setZoomable && B.setZoomable(o.a("zoomable")), Nl(o.a("pannable")) && B.setPannable && B.setPannable(o.a("pannable")), Nl(o.a("rectSelectable")) && B.setRectSelectable && B.setRectSelectable(o.a("rectSelectable")), o.a("fitContent") === !0 && B.fitContent && B.fitContent(!0, 0)), B instanceof k.graph3d.Graph3dView) {
                            var Q = C.scene;
                            Q && Q.shadow != A && B.shadowMap.setShadow(Q.shadow, Q.shadowParams);
                            var e = o.a("sceneContext");
                            e ? (e.eye && B.setEye(e.eye), e.center && B.setCenter(e.center), lc(e.far) && B.setFar(e.far), lc(e.near) && B.setNear(e.near)) : (lc(o.a("sceneNear")) && B.setNear(o.a("sceneNear")), lc(o.a("sceneFar")) && B.setFar(o.a("sceneFar")), Q && (Q.eye && B.setEye(Q.eye), Q.center && B.setCenter(Q.center))), Nl(o.a("sceneShadowEnabled")) && (o.a("sceneShadowEnabled") ? B.enableShadow() : B.disableShadow()), lc(o.a("sceneShadowDegreeX")) && B.setShadowDegreeX(o.a("sceneShadowDegreeX")), lc(o.a("sceneShadowDegreeZ")) && B.setShadowDegreeZ(o.a("sceneShadowDegreeZ")), lc(o.a("sceneShadowIntensity")) && B.setShadowIntensity(o.a("sceneShadowIntensity")), o.a("sceneShadowQuality") != A && B.setShadowQuality(o.a("sceneShadowQuality")), o.a("sceneShadowType") && B.setShadowType(o.a("sceneShadowType")), lc(o.a("sceneShadowRadius")) && B.setShadowRadius(o.a("sceneShadowRadius")), lc(o.a("sceneShadowBias")) && B.setShadowBias(o.a("sceneShadowBias")), Nl(o.a("sceneDashEnable")) && B.setDashDisabled(!o.a("sceneDashEnable")), Ok(o.a("sceneHighlightMode")) && B.setHighlightMode(o.a("sceneHighlightMode")), lc(o.a("sceneHighlightWidth")) && B.setHighlightWidth(o.a("sceneHighlightWidth")), o.a("sceneHighlightColor") && B.setHighlightColor(o.a("sceneHighlightColor")), Nl(o.a("sceneHeadlightEnable")) && B.setHeadlightDisabled(!o.a("sceneHeadlightEnable")), lc(o.a("sceneHeadlightRange")) && B.setHeadlightRange(o.a("sceneHeadlightRange")), o.a("sceneHeadlightColor") && B.setHeadlightColor(o.a("sceneHeadlightColor")), lc(o.a("sceneHeadlightIntensity")) && B.setHeadlightIntensity(o.a("sceneHeadlightIntensity")), lc(o.a("sceneHeadlightAmbientIntensity")) && B.setHeadlightAmbientIntensity(o.a("sceneHeadlightAmbientIntensity")), Nl(o.a("sceneFogEnable")) && B.setFogDisabled(!o.a("sceneFogEnable")), o.a("sceneFogMode") && B.setFogMode(o.a("sceneFogMode")), Nl(o.a("sceneFogDensity")) && B.setFogDensity(!o.a("sceneFogDensity")), o.a("sceneFogColor") && B.setFogColor(o.a("sceneFogColor")), lc(o.a("sceneFogNear")) && B.setFogNear(o.a("sceneFogNear")), lc(o.a("sceneFogFar")) && B.setFogFar(o.a("sceneFogFar")), Nl(o.a("sceneBatchBrightnessDisabled")) && B.setBatchBrightnessDisabled(o.a("sceneBatchBrightnessDisabled")), Nl(o.a("sceneBatchBlendDisabled")) && B.setBatchBlendDisabled(o.a("sceneBatchBlendDisabled")), Nl(o.a("sceneBatchColorDisabled")) && B.setBatchColorDisabled(o.a("sceneBatchColorDisabled")), o.a("sceneBatchInfoMap") && B.setBatchInfoMap(o.a("sceneBatchInfoMap")), lc(o.a("sceneMoveStep")) && B.setMoveStep(o.a("sceneMoveStep")), lc(o.a("sceneRotateStep")) && B.setRotateStep(o.a("sceneRotateStep")), Nl(o.a("sceneSortable")) && B.setSortable(o.a("sceneSortable")), Fe(o.a("sceneSortFunc")) && B.setSortFunc(o.a("sceneSortFunc"));
                            var Y = o.a("sceneSkyboxType") || "sphere";
                            if (Y != A) {
                                var s = {},
                                    $ = !1;
                                if ("sphere" === Y) {
                                    s.shape3d = Y;
                                    var Z = o.a("sceneSkyboxImage");
                                    Z && (s["shape3d.image"] = Z, $ = !0)
                                } else s.shape3d = O, ["front", "back", "left", "right", "top", "bottom"].forEach(function(i) {
                                    var V = i + ".image",
                                        v = i.charAt(0).toUpperCase() + i.slice(1),
                                        y = o.a("sceneSkybox" + v + "Image");
                                    y && (s[V] = y, $ = !0)
                                });
                                if ($) {
                                    var q = new xk;
                                    q.s3(20, 20, 20), s["body.color"] = o.a("sceneSkyboxBodyColor"), s.envmap = o.a("sceneSkyboxEnvmap"), s.light = !1, s["texture.wrap"] = "clampToEdge", q.s(s), ["X", "Y", "Z"].forEach(function(G) {
                                        var U = o.a("sceneSkyboxRotation" + G);
                                        lc(U) && q["setRotation" + G](U)
                                    }), B.setSkybox(q)
                                }
                            }
                        }
                    }, o.deserialize(n, r.rootParent, r)
                }, e.isDebugTipShowing = function() { return !!this._debugDiv }, e.showDebugTip = function() {
                    var h = this,
                        s = h._debugDiv;
                    if (!s) {
                        s = h._debugDiv = M.createElement("div"), s.style.position = "absolute", s.style.overflow = "hidden", s.style.font = D.debugTipLabelFont, s.style.padding = "6px", s.style.backgroundColor = D.debugTipBackground, s.style.color = D.debugTipLabelColor;
                        var o = h.getView();
                        h._79O ? o.insertBefore(s, h._79O) : o.appendChild(s);
                        var W = function() {
                            h.redraw();
                            var M = h._canvas,
                                C = "FPS: " + h._fpsInfo.fps + "<br/>" + "Datas: " + h.dm().getDatas().length + (M ? "<br/>Size: " + M.width + " * " + M.height : ""),
                                d = h.dm()._historyManager;
                            d && (C += "<br/>Undoes: " + d.getHistories().length + " index: " + d.getHistoryIndex());
                            var K = h.getDebugTip();
                            K && (C += "<hr>" + K), s.innerHTML = C, h._isDebugging && requestAnimationFrame(W)
                        };
                        requestAnimationFrame(W), h._isDebugging = !0
                    }
                }, e.hideDebugTip = function() {
                    var f = this,
                        h = f._debugDiv;
                    h && (delete f._debugDiv, f.getView().removeChild(h), f._isDebugging = !1)
                }, e.updateDOMAppendMatrix = function() {
                    var N = this.getView();
                    N && (N.updateAppendMatrix = !0)
                }, e.countFrame = function() {
                    if (this._isDebugging) {
                        var T = Date.now(),
                            K = this._fpsInfo;
                        T - K.time > 1e3 ? (K.fps = Math.round(1e5 * (K.frames + 1) / (T - K.time)) / 100, K.time = T, K.frames = 0) : K.frames++
                    }
                }
            },
            ms_icons: function(p) {
                p.getRotation = function(Q) { return Q == A ? 0 : Q }, p._15O = function() {
                    var X = this,
                        K = X.s(ag);
                    if (K) {
                        var e = X,
                            b = X.data || X._data,
                            f = X._38o = { icons: K, rects: {} };
                        for (var D in K) {
                            var a = K[D],
                                C = Rr(a.shape3d, b, e);
                            if (!(Rr(a.visible, b, e) === !1 || Rr(a.for3d, b, e) && !X.I3d || C && !X.I3d)) {
                                var u = C ? [C] : Rr(a.names, b, e),
                                    m = u ? u.length : 0,
                                    d = Rr(a.position, b, e) || 3,
                                    i = Rr(a.offsetX, b, e) || 0,
                                    U = Rr(a.offsetY, b, e) || 0,
                                    V = Rr(a.direction, b, e) || so,
                                    M = Rr(a.gap, b, e),
                                    S = M != A ? M : 1,
                                    Z = Rr(a.rotation, b, e),
                                    $ = Rr(a.keepOrien, b, e),
                                    n = Rr(a.rotationFixed, b, e) ? Z : X.getRotation(Z, $, d),
                                    L = A,
                                    h = f.rects[D] = new Array(m);
                                h.rotation = n;
                                for (var H = 0; m > H; H++) {
                                    var x, Y, J, c, G = u[H];
                                    if (C) J = 0, c = 0;
                                    else {
                                        var l = Jc(G);
                                        J = Rr(a.width, b, e), c = Rr(a.height, b, e), J == A && (J = Hc(l, b)), c == A && (c = Gp(l, b))
                                    }
                                    if (L ? V === so ? i += J / 2 : V === Ye ? i -= J / 2 : V === wk ? U -= c / 2 : U += c / 2 : L = { width: J, height: c }, X.I3d) {
                                        var v = -J / 2,
                                            E = -c / 2;
                                        Y = { width: J, height: c, mat: X._16O(Rr(a.autorotate, b, e), d, L, Rr(a.face, b, e) || Pi, Rr(a.t3, b, e), Rr(a.r3, b, e), Rr(a.rotationMode, b, e), i, U), vs: new ss([v, -E, 0, v, -E - c, 0, v + J, -E - c, 0, v + J, -E, 0]) }
                                    } else x = X.getPosition(d, i, U, L, Rr(a.positionFixed, b, e)), Y = { x: x.x - J / 2, y: x.y - c / 2, width: J, height: c }, X._68o(Y, n);
                                    h[H] = Y, V === so ? i += J / 2 + S : V === Ye ? i -= J / 2 + S : V === wk ? U -= c / 2 + S : U += c / 2 + S
                                }
                            }
                        }
                    }
                }
            }
        });
        var Tj = { 1: 1, 2: 1, 6: 1, 9: 1, 10: 1, 14: 1, 15: 1, 16: 1, 21: 1, 22: 1, 26: 1, 29: 1, 30: 1, 34: 1, 36: 1, 38: 1, 40: 1, 42: 1, 45: 1, 50: 1, 52: 1, 54: 1 },
            zo = { 3: 1, 7: 1, 11: 1, 17: 1, 23: 1, 27: 1, 31: 1, 44: 1, 46: 1, 47: 1, 49: 1 },
            _n = { translateX: 1, translateY: 1, zoom: 1, scrollBarVisible: 1 },
            vq = { sourceAgent: 1, targetAgent: 1, expanded: 1, parent: 1, host: 1 },
            Ce = { position: 1, width: 1, height: 1, expanded: 1, rotation: 1, anchor: 1, scale: 1, "s:edge.points": 1 },
            _r = { "edge.type": 1, "edge.group": 1 },
            ps = { rotation: 1, rotationX: 1, rotationZ: 1 },
            ke = { rotation: 1, rotationX: 1, rotationZ: 1, position: 1, width: 1, height: 1, anchor: 1, scale: 1 },
            fo = { position: 1, width: 1, height: 1, anchor: 1, scale: 1, "s:grid.row.count": 1, "s:grid.column.count": 1, "s:grid.row.percents": 1, "s:grid.column.percents": 1, "s:grid.border": 1, "s:grid.border.left": 1, "s:grid.border.right": 1, "s:grid.border.top": 1, "s:grid.border.bottom": 1, "s:grid.gap": 1 },
            kh = { "attach.row.index": 1, "attach.column.index": 1, "attach.row.span": 1, "attach.column.span": 1, "attach.padding": 1, "attach.padding.left": 1, "attach.padding.right": 1, "attach.padding.top": 1, "attach.padding.bottom": 1, "attach.index": 1, "attach.offset": 1, "attach.offset.relative": 1, "attach.offset.opposite": 1, "attach.gap": 1, "attach.gap.relative": 1, "attach.thickness": 1 },
            lr = { shape: 1, thickness: 1, position: 1, anchor: 1, scale: 1 },
            Op = function(U) {
                if (!U) return A;
                if (Si(U)) {
                    var R = U._40I,
                        o = U._41I;
                    if (!R || !o) return A;
                    var l = Op(R),
                        s = Op(o);
                    return l === s ? l : A
                }
                for (var K = U._parent; Si(K) && !K.ISubGraph;) K = K._parent;
                return K ? K.ISubGraph ? K : Op(K) : A
            },
            wr = function(g, v, u, P) {
                var S = v.getStyle(u) * P;
                S && $f(g, S), S = v.getStyle(u + ".left") * P, S && (g.x -= S, g.width += S), S = v.getStyle(u + ".right") * P, S && (g.width += S), S = v.getStyle(u + ".top") * P, S && (g.y -= S, g.height += S), S = v.getStyle(u + ".bottom") * P, S && (g.height += S), g.width < 0 && (g.width = -g.width, g.x -= g.width), g.height < 0 && (g.height = -g.height, g.y -= g.height)
            },
            rc = function(d) {
                for (var G, j = 0, E = d.size(); E > j; j++)
                    if (G = d.getChildAt(j), Dj(G) && rc(G)) return !0;
                return d.hasAgentEdges()
            },
            sj = function($) {
                if (!$) return A;
                for (var Y = $._parent; Er(Y);) {
                    if (!Er(Y._parent)) return Y.isExpanded() ? $ : Y;
                    Y.isExpanded() || ($ = Y), Y = Y._parent
                }
                return $
            },
            Sk = function(o, j) {
                if (!o || !j) return A;
                var J, x, Y, b = Op(o),
                    n = Op(j);
                if (b !== n) {
                    for (; n && b !== n;) n = Op(n);
                    if (b === n) return o;
                    J = new En, J.add(o, 0);
                    for (var p = o._parent; Dj(p) && !j.isDescendantOf(p);) J.add(p, 0), p = p._parent;
                    for (Y = J.size(), x = 0; Y > x; x++) { var S = J.get(x); if (Er(S) && !S.isExpanded()) return S; if (S.ISubGraph) return S }
                    return o
                }
                return o
            },
            wf = function(S) {
                if (S.isLooped()) return S._source;
                var z = sj(S._source),
                    j = sj(S._target);
                return z === j ? S._source : Sk(z, j)
            },
            Wi = function(s) {
                if (s.isLooped()) return s._target;
                var H = sj(s._source),
                    W = sj(s._target);
                return H === W ? s._target : Sk(W, H)
            },
            an = function(N, g, b) {
                "target" !== b && (b = "source");
                var K = "target" === b ? g.getTargetAgent() : g.getSourceAgent(),
                    h = "edge." + b + ".";
                if (Si(K)) {
                    var O = N.getDataUI(K);
                    O._79o();
                    var B = g.s(h + "index");
                    if (B >= 0) { var m = hl(O); return m[Math.max(0, Math.min(B, m.length - 1))] }
                    var x = g.s(h + "percent") || 0;
                    x = Math.max(0, Math.min(x, 1));
                    var f = Jf(O);
                    return Tf(f, 100 * x)
                }
                return Cg(N, K, g.s(h + "position"), g.s(h + "offset.x"), g.s(h + "offset.y"), g.s(h + "anchor.x"), g.s(h + "anchor.y"))
            },
            Cg = function(U, h, W, a, F, Y, P) {
                if (!h) return A;
                var H, J = h.getRotation ? h.getRotation() : 0;
                if (Y !== O || P !== O) {
                    Y = Y === O ? .5 : Y, P = P === O ? .5 : P;
                    var f = h.getScale();
                    if (J && !oh(h, U) || f.x < 0 || f.y < 0) {
                        var g = h.getPosition(),
                            u = h.getWidth(),
                            n = h.getHeight(),
                            D = h.getAnchor(),
                            i = new uf(J, g.x, g.y, f.x, f.y);
                        W = i.tf((Y - D.x) * u, (P - D.y) * n)
                    } else H = Kc(U, h), W = { x: H.x + Y * H.width, y: H.y + P * H.height }
                } else W = Hf(W, Kc(U, h));
                if (J) {
                    var d = C(J),
                        r = N(J),
                        E = a * d - F * r;
                    F = a * r + F * d, a = E
                }
                return W.x += a, W.y += F, W
            },
            Pk = function(P, F) {
                if (!P || !F) return A;
                var J, Y, l, r, y, C;
                if (P === F) {
                    if (r = P.getLoopedEdges(), !r) return A;
                    r = new En(r)
                } else { if (y = P.getAgentEdges(), C = F.getAgentEdges(), !y || !C) return A; for (Y = y.size(), J = 0; Y > J; J++) l = y.get(J), C.contains(l) && (r || (r = new En), r.add(l)) }
                if (r)
                    for (J = 0; J < r.size(); J++) l = r.get(J), l.getStyle(Lk) === Vf && (l._22I(A), r.removeAt(J), J--);
                return r
            },
            Mi = function(N, Q) {
                var $ = Pk(N, Q);
                if ($ && !$.isEmpty()) {
                    if (1 === $.size()) return $.get(0)._22I(A), void 0;
                    var p = new En,
                        D = new En;
                    $.each(function(h) {
                        var W = h.s("edge.group");
                        p.contains(W) || p.add(W)
                    }), p.sort(), p.each(function(p) { D.add(new k.EdgeGroup($.toList(function(y) { return p === y.s("edge.group") }), D)) }), D.each(function(n) { n.each(function(g) { g._22I(n) }) })
                }
            },
            Tq = function(m, P, J) {
                var E = m._canvas;
                m._zoom;
                var $ = Mo(P, E),
                    z = Mo(J, E);
                return { x: $.x - z.x, y: $.y - z.y }
            },
            Ug = function(l, Y) {
                if (Y) {
                    var s = Y.rect,
                        X = Y.color,
                        k = Y.rotation,
                        v = Y.labelWidth,
                        m = Y.background,
                        w = Y.opacity,
                        t = Y.scale,
                        _ = t != A && 1 !== t;
                    if (w != A) {
                        var Z = l.globalAlpha;
                        l.globalAlpha *= w
                    }
                    if (k || _) {
                        l.save();
                        var c = s.x + s.width / 2,
                            j = s.y + s.height / 2;
                        ts(l, c, j), k && nm(l, k), _ && l.scale(t, t), ts(l, -c, -j)
                    }
                    if (m && re(l, s.x, s.y, s.width, s.height, m), v) {
                        var T = s.width,
                            I = l.createLinearGradient(s.x, s.y, s.x + T, s.y);
                        I.addColorStop(0, X), I.addColorStop(.9, X), I.addColorStop(1, rl), X = I, s.width = v
                    }
                    ci(l, Y.ss, s, Y.font, X, Y.align), v && (s.width = T), (k || _) && l.restore(), w != A && (l.globalAlpha = Z)
                }
            },
            uh = function($, E) {
                if (E) {
                    var y = E.rect,
                        R = y.x,
                        r = y.y,
                        S = y.width,
                        I = y.height,
                        X = E.background,
                        L = E.backgroundImage,
                        p = E.borderWidth,
                        q = E.borderColor,
                        W = E.labelWidth,
                        v = E.opacity,
                        d = E.scale,
                        M = d != A && 1 !== d;
                    if (v != A) {
                        var _ = $.globalAlpha;
                        $.globalAlpha *= v
                    }
                    if (M) {
                        $.save();
                        var x = y.x + y.width / 2,
                            H = y.y + y.height / 2;
                        ts($, x, H), $.scale(d, d), ts($, -x, -H)
                    }
                    if (E.expanded) {
                        var N = i(8, S / 4),
                            J = r + I - 8;
                        if ($.fillStyle = X, $.beginPath(), $.moveTo(R, r), $.lineTo(R, J), $.lineTo(R + S / 2, J), $.lineTo(R + S / 2, r + I), $.lineTo(R + S / 2 + N, J), $.lineTo(R + S, J), $.lineTo(R + S, r), $.closePath(), $.fill(), p && ($.lineWidth = p, $.lineJoin = "round", $.lineCap = "round", q ? ($.strokeStyle = q, $.stroke()) : ($.strokeStyle = ah(X), $.beginPath(), $.moveTo(R + S, r), $.lineTo(R + S, J), $.lineTo(R + S / 2 + N, J), $.lineTo(R + S / 2, r + I), $.stroke(), $.strokeStyle = gr(X), $.beginPath(), $.moveTo(R + S, r), $.lineTo(R, r), $.lineTo(R, J), $.lineTo(R + S / 2, J), $.lineTo(R + S / 2, r + I), $.stroke())), L) Kq($, Jc(L), lp, y.x, y.y, y.width, y.height - 8, E.data, E.view);
                        else {
                            if (y.height -= 8, X = E.color, W) {
                                var Y = S,
                                    D = $.createLinearGradient(R, r, R + Y, r);
                                D.addColorStop(0, X), D.addColorStop(.9, X), D.addColorStop(1, rl), X = D, y.width = W
                            }
                            ci($, E.ss, y, E.font, X, E.align), W && (y.width = Y), y.height += 8
                        }
                    } else if (E.icon) as($, Jc(E.icon), R, r, S, I, E.data, E.view);
                    else {
                        var C = S / 2;
                        p && ($.lineWidth = p, $.lineJoin = "round", $.lineCap = "round", $.strokeStyle = q ? q : ah(X), $.beginPath(), $.arc(R + C, r + C, C, Z, 1.6 * U, !0), $.moveTo(R + C, r + I), $.lineTo(R + S - C / 5, r + C), $.stroke(), $.strokeStyle = q ? q : gr(X), $.beginPath(), $.arc(R + C, r + C, C, 1.6 * U, Z, !0), $.moveTo(R + C, r + I), $.lineTo(R + C / 5, r + C), $.stroke()), $.fillStyle = X, $.beginPath(), $.arc(R + C, r + C, C, 0, m, !0), $.moveTo(R + C, r + I), $.lineTo(R + S - C / 5, r + C), $.lineTo(R + C / 5, r + C), $.closePath(), $.fill(), $.fillStyle = E.color, $.beginPath(), $.arc(R + C, r + C, C / 3, 0, m, !0), $.fill()
                    }
                    M && $.restore(), v != A && ($.globalAlpha = _)
                }
            },
            ck = function(T, E) { return E > 2 * T ? T : E / 2 },
            hs = function(e, Y, s, O) { if (!e || !Y) return 0; var M = Cc(Y.y - e.y, Y.x - e.x); return s || (M = Y.x < e.x ? M + U : M), M + O },
            Ym = function($, D, s, w, T, u, y) { y && ($.x > D.x || $.x === D.x && $.y > D.y) && (s = Xq[s], T = -T); var J = Hf(s, { x: 0, y: 0, width: _q($, D), height: 0 }, u); return J.x += w, J.y += T, J = new uf(Cc(D.y - $.y, D.x - $.x)).tf(J), J.x += $.x, J.y += $.y, J },
            Qo = function(y, F, I, i, M) {
                if (y._19Q = !0, !I.getEdgeGroup()) return i ? I.s("edge.gap") : 0;
                if (Si(I.getSourceAgent()) || Si(I.getTargetAgent())) return 0;
                var p, Y = 0,
                    N = 0,
                    z = 0;
                if (I.getEdgeGroup().getSiblings().each(function(_) {
                        _.each(function(k) {
                            if (F.isVisible(k) && k.s(Lk) == M) {
                                var o = k.s("edge.gap");
                                p ? (N += z / 2 + o / 2, z = o) : (p = k, z = o), k === I && (Y = N)
                            }
                        })
                    }), i) return N - Y + z;
                var O = Y - N / 2;
                return p && I._40I !== p._40I && (y._19Q = !1), O
            },
            vk = function() {
                var a = function(f) { var z = []; return f.forEach(function($) { z.push({ x: $.x, y: $.y }), z.push({ x: $.x + $.width, y: $.y + $.height }), z.push({ x: $.x + $.width, y: $.y }), z.push({ x: $.x, y: $.y + $.height }) }), z };
                return function(Y, G, R) {
                    if ("oval" === Y) {
                        var I = 0,
                            H = R.height / R.width,
                            T = H * H,
                            x = R.x + R.width / 2,
                            $ = R.y + R.height / 2,
                            y = a(G);
                        y.forEach(function(C) {
                            var v = C.x - x,
                                z = C.y - $,
                                h = v * v + z * z / T;
                            h > I && (I = h)
                        }), I = z(I);
                        var c = H * I;
                        return { x: x - I, y: $ - c, width: 2 * I, height: 2 * c }
                    }
                    if ("circle" === Y) {
                        var O = 0,
                            x = R.x + R.width / 2,
                            $ = R.y + R.height / 2,
                            y = a(G);
                        return y.forEach(function(T) {
                            var S = T.x - x,
                                B = T.y - $,
                                M = S * S + B * B;
                            M > O && (O = M)
                        }), O = z(O), { x: x - O, y: $ - O, width: 2 * O, height: 2 * O }
                    }
                    return "roundRect" === Y ? ($f(R, i(R.width, R.height) / 16), R) : R
                }
            }(),
            Rm = k.graph = {},
            Fj = function(b, T, B) { eh(L + ".graph." + b, T, B) };
        k.layout = {};
        var hb = {},
            Uh = function(I, F, K, U, E, L, C, N) {
                var x = C._zoom;
                if (x !== C._cacheZoom && (C._cacheZoom = x, C._cacheImage = {}), x *= fs, U = Math.ceil(U * x), E = Math.ceil(E * x), U > 2048 || E > 2048) return F;
                var H = [F.uuid, U, E, K].join("_");
                F.cacheRule && (H += "_" + Rr(F.cacheRule, L, C));
                var $ = C._cacheImage[H];
                return $ || (Gr(), $ = k.Default.toCanvas(F, U, E, K, L, C, N), ws() && (C._cacheImage[H] = $)), $
            };
        gp(D, {
            setImageCacheRule: function(k, n) {
                var d;
                n || "object" != typeof k ? (d = {}, d[k] = n) : d = k;
                for (var l in d) {
                    var q = d[l];
                    Ok(l) ? (eh = Jc(l), eh ? eh.cacheRule = q : hb[l] = q) : l.cacheRule = q
                }
            }
        });
        var Zl = { comps: [{ type: ii, points: [85, 50, 70, 115, 100, 71, 86, 107, 88, 49, 57, 79, 112, 85, 116, 110, 83, 84, 74, 50, 118, 100, 102, 75, 89, 70, 65, 72, 75, 107, 119, 99, 116, 119, 69, 68, 71, 76, 75, 85, 90, 98, 77, 61], borderWidth: 1, borderColor: A }] };
        if (Zl[nn] = Zl[Cm] = 160, y.Image) {
            var qc = new y.Image;
            qc.src = "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAALUlEQVRYR+3QQREAAAABQfqXFsNnFTizzXk99+MAAQIECBAgQIAAAQIECBAgMBo/ACHo7lH9AAAAAElFTkSuQmCC", Dr("default_blank", qc)
        }
        Dr("node_image", to(30, 30, [{ type: Ej, rect: [4, 5, 22, 16], gradient: zl, gradientColor: kf, background: le }, { type: Ej, rect: [2, 3, 26, 20], borderWidth: 1, borderColor: le }, { type: Ej, rect: [11, 23, 8, 4], background: le }, { type: Ej, rect: [6, 27, 18, 2], background: le }])), Dr("node_icon", to(16, 16, [{ type: Ej, rect: [2, 2, 12, 10], gradient: zl, gradientColor: kf, background: le }, { type: Wo, rect: [2, 2, 12, 10], width: 1, color: le }, { type: Ej, rect: [6, 12, 4, 2], background: le }, { type: Ej, rect: [4, 14, 8, 1], background: le }])), Dr("block_icon", to(16, 16, [{ type: Wo, rect: [1, 1, 14, 14], width: 1, color: le }])), Dr("group_image", to(66, 39, [{ type: Ej, rect: [44.3, 18, 18.1, 12.8], gradient: zl, gradientColor: kf, background: le }, { type: Ej, rect: [3.3, 17.8, 18.1, 12.8], gradient: zl, gradientColor: kf, background: le }, { type: Ej, rect: [15.8, 3.2, 33.5, 26.4], borderWidth: 1, borderColor: le, gradient: zl, gradientColor: kf, background: le }, { type: Ej, rect: [26.2, 29.4, 12.8, 4.2], background: le }, { type: Ej, rect: [21.3, 33.5, 22.5, 2.3], background: le }, { type: Ej, rect: [5.3, 32.7, 14.1, 2.1], background: le }, { type: Ej, rect: [9, 30.4, 6.7, 2.4], background: le }, { type: Ej, rect: [50, 30.7, 6.7, 2.4], background: le }, { type: Ej, rect: [46.3, 33, 14.1, 2.1], background: le }])), Dr("group_icon", to(16, 16, [{ type: Ej, rect: [4, 12, 4, 2], background: le }, { type: Ej, rect: [2, 13, 8, 1], background: le }, { type: Ej, rect: [12, 12, 2, 1], background: le }, { type: Ej, rect: [11, 13, 4, 1], background: le }, { type: Ej, rect: [10, 7, 6, 5], gradient: zl, gradientColor: kf, background: le }, { type: Ej, rect: [1, 2, 10, 10], gradient: zl, gradientColor: kf, background: le }, { type: Wo, rect: [1, 2, 10, 10], width: 1, color: le }])), Dr("refGraph_icon", to(16, 16, [{ type: "shape", borderWidth: 1, borderColor: le, borderCap: "round", rotation: .7854, points: [12.5502, 6.7981, 12.5502, 6.7981, 12.5502, 4.8181, 12.5502, 3.7981, 12.5502, 2.7781, 11.36687, 1.7981, 10.0502, 1.7981, 8.73354, 1.7981, 7.5502, 2.8181, 7.5502, 3.7981, 7.5502, 4.55989, 7.5502, 7.79805, 7.5502, 7.79805, 7.5502, 7.79805, 7.5502, 9.7981, 10.0502, 9.7981], segments: [1, 4, 4, 4, 4, 4] }, { type: "shape", borderWidth: 1, borderColor: le, borderCap: "round", rotation: -2.35619, points: [8.4498, 11.2019, 8.4498, 11.2019, 8.4498, 9.2219, 8.4498, 8.2019, 8.4498, 7.1819, 7.26646, 6.2019, 5.9498, 6.2019, 4.63313, 6.2019, 3.4498, 7.2219, 3.4498, 8.2019, 3.4498, 8.9637, 3.4498, 12.20186, 3.4498, 12.20186, 3.4498, 12.20186, 3.4498, 14.2019, 5.9498, 14.2019], segments: [1, 4, 4, 4, 4, 4] }])), Dr("edge_icon", to(16, 16, [{ type: Ej, rect: [2.1, 6.9, 11.5, 2.6], rotation: -.79, gradient: zl, gradientColor: kf, background: le }, { type: Ej, rect: [10.8, 1, 4, 4], background: le }, { type: Ej, rect: [1, 11, 4, 4], background: le }])), Dr("subGraph_image", to(72, 45, [{ type: ii, points: [9, 42, .3, 38.4, 2.4, 28.8, 5.7, 21.6, 11.7, 22.5, 11.7, 15.9, 16.8, 13.8, 21.6, 12, 24.3, 15.9, 27.9, 3, 42.3, 2.1, 59.4, 4.5, 57.3, 18.3, 67.5, 18.9, 69.6, 27.3, 69.9, 38.4, 64.2, 41.4], segments: [1, 3, 3, 3, 3, 3, 3, 3, 3], gradient: zl, gradientColor: kf, background: le }, { type: Ej, rect: [29.6, 30.7, 3.6, 1.8], background: le }, { type: Ej, rect: [28.4, 32.3, 6, 1.2], background: le }, { type: Ej, rect: [37.3, 32, 10.8, 1.8], background: le }, { type: Ej, rect: [39.1, 29.9, 7.2, 2.3], background: le }, { type: Ej, rect: [26.6, 23.7, 9.6, 7.2], gradient: zl, gradientColor: kf, background: le }, { type: Ej, rect: [34.3, 16.8, 16.8, 13.2], borderWidth: 1, borderColor: le, gradient: zl, gradientColor: kf, background: le }])), Dr("subGraph_icon", to(17, 17, [{ type: ii, points: [2.2, 14.6, .2, 11.9, .8, 8.8, 1.8, 5.9, 5.6, 7.4, 3.8, 1.6, 10.3, 3, 14.5, 4.2, 12.2, 7.5, 18.9, 7.2, 14.5, 14.5], segments: [1, 3, 3, 3, 3, 3], gradient: zl, gradientColor: kf, background: le }])), Dr("shape_icon", to(16, 16, [{ type: ii, points: [1.5, 1, 8.4, 1, 8.4, 7.2, 14.6, 7.1, 14.6, 14.9, 1.5, 14.9, 1.5, 1], background: le }])), Dr("polyline_icon", to(16, 16, [{ type: ii, points: [1.5, 1, 8.4, 1, 8.4, 7.2, 14.6, 7.1, 14.6, 14.9, 1.5, 14.9, 1.5, 1], borderWidth: 1, borderColor: le }, Qd(7.5, .4), Qd(7.5, 6.3), Qd(13.6, 6.3), Qd(13.6, 14), Qd(.7, 13.9), Qd(.7, .3)])), Dr("grid_icon", to(16, 16, [{ type: Ej, rect: [1, 1, 4, 4], background: le, gradient: zl, gradientColor: kf }, { type: Ej, rect: [6, 1, 4, 4], background: le, gradient: zl, gradientColor: kf }, { type: Ej, rect: [11, 1, 4, 4], background: le, gradient: zl, gradientColor: kf }, { type: Ej, rect: [11, 6, 4, 4], background: le, gradient: zl, gradientColor: kf }, { type: Ej, rect: [6, 6, 4, 4], background: le, gradient: zl, gradientColor: kf }, { type: Ej, rect: [1, 6, 4, 4], background: le, gradient: zl, gradientColor: kf }, { type: Ej, rect: [11, 11, 4, 4], background: le, gradient: zl, gradientColor: kf }, { type: Ej, rect: [6, 11, 4, 4], background: le, gradient: zl, gradientColor: kf }, { type: Ej, rect: [1, 11, 4, 4], background: le, gradient: zl, gradientColor: kf }])), Dr("light_icon", to(16, 16, [{ type: "rect", rect: [6, 9, 5, 5], borderWidth: 1, borderColor: le }, { type: "circle", rect: [1, 1, 15, 10], borderWidth: 1, borderColor: le, gradient: zl, gradientColor: kf, background: { func: function(C) { var c = C ? C.s(ue) : A; return ud(c) ? "rgb(" + pr(255 * c[0]) + "," + pr(255 * c[1]) + "," + pr(255 * c[2]) + ")" : c || le } } }])), Dr("text_icon", to(16, 16, [{ type: "shape", points: [3, 3, 13, 3, 8, 3, 8, 14], segments: [1, 2, 1, 2], borderWidth: 1, borderColor: le }])), Dr("border_image", { fitSize: !0, comps: [{ type: "border", relative: !0, rect: [0, 0, 1, 1], color: { func: "style@border_color" }, width: { func: "style@border_width" } }] }), Dr("columnChart_image", { fitSize: !0, boundExtend: 150, comps: [{ type: { func: "style@chart.type" }, relative: !0, rect: [0, 0, 1, 1], label: { func: "style@chart.label" }, labelColor: { func: "style@chart.label.color" }, labelFont: { func: "style@chart.label.font" }, series: { func: "style@chart.series" }, minValue: { func: "style@chart.min.value" }, maxValue: { func: "style@chart.max.value" } }] }), Dr("lineChart_image", { fitSize: !0, boundExtend: 150, comps: [{ type: "lineChart", relative: !0, rect: [0, 0, 1, 1], label: { func: "style@chart.label" }, labelColor: { func: "style@chart.label.color" }, labelFont: { func: "style@chart.label.font" }, series: { func: "style@chart.series" }, minValue: { func: "style@chart.min.value" }, maxValue: { func: "style@chart.max.value" }, linePoint: { func: "style@chart.line.point" }, lineWidth: { func: "style@chart.line.width" }, line3d: { func: "style@chart.line.3d" } }] }), Dr("pieChart_image", { fitSize: !0, boundExtend: 150, comps: [{ type: "pieChart", relative: !0, rect: [0, 0, 1, 1], label: { func: "style@chart.label" }, labelColor: { func: "style@chart.label.color" }, labelFont: { func: "style@chart.label.font" }, hollow: { func: "style@chart.hollow" }, startAngle: { func: "style@chart.start.angle" }, values: { func: "style@chart.values" }, colors: { func: "style@chart.colors" } }] });
        var Md = function(A, R, Y, b, x, j) { var r, t, F, y, P, o, H, w, s, p, C, V = []; if (Math.abs(b) > 2 * Math.PI && (b = 2 * Math.PI), P = Math.ceil(Math.abs(b) / (Math.PI / 4)), r = b / P, t = -r, F = -Y, P > 0) { o = A + Math.cos(Y) * x, H = R + Math.sin(-Y) * j, V.push({ x: o, y: H }); for (var h = 0; P > h; h++) F += t, y = F - t / 2, w = A + Math.cos(F) * x, s = R + Math.sin(F) * j, p = A + Math.cos(y) * (x / Math.cos(t / 2)), C = R + Math.sin(y) * (j / Math.cos(t / 2)), V.push({ x: p, y: C }), V.push({ x: w, y: s }) } return V },
            Jq = function(p) {
                if (p) {
                    var K = p._data;
                    if (K instanceof k.Shape) return { points: K.getPoints(), segments: K.getSegments() };
                    var g;
                    if (K instanceof k.Edge && (g = p._78o)) {
                        var W, x, d = g.type,
                            b = g.points,
                            i = g.segments,
                            j = g.edgeTypeInfo;
                        if (!d || b) {
                            var Q = g.sourcePoint,
                                U = Q.x,
                                m = Q.y,
                                a = g.targetPoint,
                                S = a.x,
                                y = a.y;
                            if (d) i ? (W = new En({ x: U, y: m }), W.addAll(b), W.add({ x: S, y: y }), x = new En(i._as)) : (W = new En({ x: U, y: m }), b.each(function(Z) { W.add(Z) }), W.add({ x: S, y: y }));
                            else if (g.looped) { W = new En(Md(U, m, 0, 2 * Math.PI, g.radius, g.radius)), x = new En([1]); for (var Y = 0; Y < (W.size() - 1) / 2; Y++) x.add(3) } else W = new En, g.center ? (W.add({ x: g.c1.x, y: g.c1.y }), W.add({ x: U, y: m }), W.add({ x: S, y: y }), W.add({ x: g.c2.x, y: g.c2.y })) : (W.add({ x: U, y: m }), W.add({ x: S, y: y }))
                        } else j && (W = new En(j.points._as), j.segments && (x = new En(j.segments._as)));
                        return { points: W, segments: x }
                    }
                }
            },
            Jf = function(p, i, L) {
                if (null == i) {
                    var n = Jq(p);
                    if (!n) return;
                    i = n.points, L = n.segments
                }
                if (i) {
                    if (Array.isArray(i) && (i = new En(i)), "number" == typeof i.get(0)) {
                        for (var c = new k.List, s = 0; s < i.size(); s += 2) c.add({ x: i.get(s), y: i.get(s + 1) });
                        i = c
                    }
                    if (!L) { L = [1]; for (var Y = i.length - 1; Y > 0; Y--) L.push(2) }
                    Array.isArray(L) && (L = new En(L));
                    for (var R = vc(i._as, L._as, 50), v = R.length, A = [], s = 0; v > s; s++) {
                        var B = R[s];
                        B.length > 1 && A.push(B)
                    }
                    return A
                }
            },
            zc = function(p) {
                for (var o = 0, T = p.length - 1, B = 0; T > B; B++) {
                    var K = p[B],
                        n = p[B + 1],
                        m = n.x - K.x,
                        J = n.y - K.y;
                    o += Math.sqrt(m * m + J * J)
                }
                return o
            },
            Qp = function(C, L) { for (var I = 0, W = L.length, b = 0; W > b; b++) { var N = L[b]; if (I += N, I > C) return b } return Math.min(b, W - 1) },
            fl = function(w, Z) {
                for (var $ = 0, L = 0, Q = 0, t = w.length - 1, e = 0; t > e; e++) {
                    var f = w[e],
                        E = w[e + 1],
                        q = E.x - f.x,
                        F = E.y - f.y;
                    if (Q = Math.sqrt(q * q + F * F), $ += Q, $ > Z) { $ -= Q, L = e; break }
                }
                var B = w[L],
                    c = w[L + 1],
                    U = Math.atan2(c.y - B.y, c.x - B.x),
                    J = Z - $,
                    F = Math.sin(U) * J,
                    q = Math.cos(U) * J;
                return { x: B.x + q, y: B.y + F }
            },
            Tf = function(w, k) {
                if (w) {
                    var Z;
                    if (0 === k) Z = w[0][0];
                    else if (100 === k) w = w[w.length - 1], Z = w[w.length - 1];
                    else {
                        for (var W = 0, h = [], i = w.length, $ = 0; i > $; $++) {
                            var z = w[$],
                                Y = zc(z);
                            W += Y, h.push(Y)
                        }
                        for (var d = W * k / 100, A = Qp(d, h), C = 0, M = 0; A > M; M++) C += h[M];
                        d -= C, Z = fl(w[A], d)
                    }
                    return Z
                }
            },
            hl = function(X) {
                var l, r, t, T, s = Jq(X),
                    h = [],
                    K = s.points,
                    P = s.segments,
                    A = -1;
                for (r = 0, t = P ? P.length : K.length; t > r; r++) {
                    if (l = P ? P.get(r) : 1, 3 === l) T = 2;
                    else if (4 === l) T = 3;
                    else {
                        if (5 === l) continue;
                        T = 1
                    }
                    A += T, h.push(K.get(A))
                }
                return h
            },
            vo = function(M, c, y, i) {
                function K(s) { if (s >= 0 && 1 >= s) { W = c(s); var e = (M.x - W.x) * (M.x - W.x) + (M.y - W.y) * (M.y - W.y); return G > e ? (G = e, v = s, !0) : !1 } }
                y = y || 100, i = i || 1e-5;
                for (var G = 1 / 0, v = 0, W = new Um, Z = 0; y > Z; ++Z) K(Z / y);
                for (var N = 1 / (2 * y); N > i;) K(v - N) || K(v + N) || (N /= 2);
                return v
            };
        gp(D, { _edgeProtectMethod: { getStraightLinePoints: Jf, calculateLineLength: zc, calcSegmentIndexByDistance: Qp, calculatePointAlongLine: fl, getPercentPosition: Tf, getRealPointsFromDataUI: hl } });
        var Mf = function(E, k) {
                for (var g = E.vertices, O = 0; O < g.length; O++) {
                    var L = g[O],
                        $ = L.y;
                    L.y = L.z, L.z = -$, k && (L.y += k)
                }
            },
            Eb = function(N) {
                for (var L, e, l, q, s, A, I = [], v = [], G = [], Z = N.faces, t = 0, R = 0, r = 0, g = Z.length; g > t; t++, R += 6, r += 9) {
                    var n = Z[t];
                    1 === n.i ? (L || (L = [], e = [], l = []), us(n, t, R, r, N, L, l, e)) : 2 === n.i ? (q || (q = [], s = [], A = []), us(n, t, R, r, N, q, A, s)) : us(n, t, R, r, N, I, G, v)
                }
                return { vs: I, uv: v, ns: G, top_vs: L, top_uv: e, top_ns: l, bottom_vs: q, bottom_uv: s, bottom_ns: A }
            },
            us = function(X, c, b, p, m, I, n, t) {
                var o = m.vertices,
                    F = m.faceVertexUvs,
                    P = o[X.a],
                    E = o[X.b],
                    V = o[X.c];
                I.push(P.x, P.y, P.z, E.x, E.y, E.z, V.x, V.y, V.z);
                var Z, W, Y, k = X.vertexNormals;
                3 === k.length ? (Z = k[0], W = k[1], Y = k[2]) : Z = W = Y = X.normal, n.push(Z.x, Z.y, Z.z, W.x, W.y, W.z, Y.x, Y.y, Y.z);
                var l = F[0][c][0],
                    y = F[0][c][1],
                    z = F[0][c][2];
                t.push(l.x, l.y, y.x, y.y, z.x, z.y)
            },
            Ab = function() {
                function _(k, K) { return k.dot(K) > 0 }

                function P(c, P, e, R, r, p, d) {
                    for (var w, C, H = [P, e, R], S = [r, p, d], Q = [], i = H.length, L = !0; i-- && L;) {
                        for (var n = H[i], D = S.length, Z = !1; D--;)
                            if (n.equals(S[D])) { S.splice(D, 1), Q.push(n), Z = !0; break }
                        if (!Z) {
                            if (w) { L = !1; break }
                            w = n
                        }
                    }
                    return L && 2 === Q.length && (C = S[0], j.subVectors(w, Q[0]), s.subVectors(C, Q[0]), x.subVectors(w, Q[1]), j.x * x.y * s.z + x.x * s.y * j.z + s.x * j.y * x.z - s.x * x.y * j.z - s.y * x.z * j.x - s.z * x.x * j.y < 1e-6 && (U.subVectors(C, Q[1]), l.subVectors(Q[1], Q[0]), _(l, j) && _(l, s) && (l.negate(), _(l, x) && _(l, U)))) ? (c.push(Q[1].x, Q[1].y, Q[1].z), c.push(w.x, w.y, w.z), c.push(w.x, w.y, w.z), c.push(Q[0].x, Q[0].y, Q[0].z), c.push(Q[0].x, Q[0].y, Q[0].z), c.push(C.x, C.y, C.z), c.push(C.x, C.y, C.z), c.push(Q[1].x, Q[1].y, Q[1].z), 2) : (c.push(P.x, P.y, P.z), c.push(e.x, e.y, e.z), c.push(e.x, e.y, e.z), c.push(R.x, R.y, R.z), c.push(R.x, R.y, R.z), c.push(P.x, P.y, P.z), 1)
                }

                function M() { this._vertexMap = {}, this._lineMap = {}, this._lineList = [] }

                function a(S, Q, C, R, A, H, w) {
                    var y = [C, A];
                    S[0] === R && y.reverse();
                    var n = [y[0]._key, y[1]._key].join("|"),
                        W = S._triangles[n];
                    W || (S._triangles[n] = W = {});
                    var k = [H._key, w._key].join("|");
                    W[k] || (W[k] = [H, w])
                }

                function m(J, k, z) {
                    var B = J._planes[z._key];
                    if (!B)
                        for (var r in J._planes) { var A = J._planes[r]; if (A._normal.angleTo(z) < .001) { B = A; break } }
                    return B ? (B._vertices.indexOf(k) < 0 && B._vertices.push(k), void 0) : (J._planes[z._key] = { _normal: z, _vertices: [k] }, void 0)
                }

                function G(a, u) { return 0 === u ? "0|0|0" : 1 / 0 === Math.abs(u) ? [a.x, a.y, a.z].join("|") : [Math.round(C.angleTo(a) * u), Math.round(Z.angleTo(a) * u), Math.round(B.angleTo(a) * u)].join("|") }

                function o(T, R) {
                    var _ = T._ctlineModel;
                    if (_ || (T._ctlineModel = _ = []), _[0]) return _[0];
                    var F;
                    F = ud(T) ? T : [T];
                    var Y, S, O, f, k, n, H, v, Z, p, r, c, W, j, b, N, x, M, h, o = ["", "top_", "bottom_"];
                    _ = [];
                    var e = [];
                    for ($i(F, R, e), Y = 0, S = e.length; S > Y; Y++)
                        if (p = e[Y])
                            for (Bm(p), O = 0, f = o.length; f > O; O++)
                                if (Z = p[o[O] + "lvs"])
                                    for (x = _.length, M = Z.length, _.length = x + M, h = 0; M > h; ++h, ++x) _[x] = Z[h];
                                else if (H = p[o[O] + "vs"]) {
                        v = p[o[O] + "is"], n = v ? v.length : H.length / 3;
                        for (var k = 0; n - 1 > k;) v ? (r = v[k], c = v[k + 1], W = v[k + 2], j = v[k + 3], b = v[k + 4], N = v[k + 5]) : (r = k, c = k + 1, W = k + 2, j = k + 3, b = k + 4, N = k + 5), u.fromArray(H, 3 * r), y.fromArray(H, 3 * c), i.fromArray(H, 3 * W), E.fromArray(H, 3 * j), D.fromArray(H, 3 * b), I.fromArray(H, 3 * N), k += 3 * P(_, u, y, i, E, D, I);
                        n > k && (v ? (r = v[k], c = v[k + 1], W = v[k + 2]) : (r = k, c = k + 1, W = k + 2), u.fromArray(H, 3 * r), y.fromArray(H, 3 * c), i.fromArray(H, 3 * W), _.push(u.x, u.y, u.z), _.push(y.x, y.y, y.z), _.push(y.x, y.y, y.z), _.push(i.x, i.y, i.z), _.push(i.x, i.y, i.z), _.push(u.x, u.y, u.z))
                    }
                    return T._ctlineModel[0] = _, _
                }

                function r(w, d, N) {
                    var I = w._ctlineModel;
                    I || (w._ctlineModel = I = []);
                    var l = I[1];
                    if (l && l.epsilon === N) return l;
                    l = [], l.epsilon = N;
                    var o;
                    o = ud(w) ? w : [w];
                    var H, S, f, n, j, B, A, C, Y, e, W, z, g = ["", "top_", "bottom_"],
                        v = new M,
                        i = [];
                    for ($i(o, d, i), H = 0, S = i.length; S > H; H++)
                        if (Y = i[H])
                            for (Bm(Y), f = 0, n = g.length; n > f; f++)
                                if (A = Y[g[f] + "vs"]) { C = Y[g[f] + "is"], B = C ? C.length : A.length / 3; for (var j = 0, j = 0; B > j; j += 3) C ? (e = C[j], W = C[j + 1], z = C[j + 2]) : (e = j, W = j + 1, z = j + 2), v._addTriangle(A, O, e, W, z, N) }
                    return v._toLineVS(l), w._ctlineModel[1] = l, l
                }

                function T(F, R, u) {
                    var Y = F._ctlineModel;
                    Y || (F._ctlineModel = Y = []);
                    var t = Y[2];
                    if (t && t.epsilon === u) return t;
                    t = [], t.epsilon = u;
                    var q;
                    q = ud(F) ? F : [F];
                    var S, U, y, Z, $, j, b, W, I, h, C, V, X, l = ["", "top_", "bottom_"],
                        K = new M,
                        w = [];
                    for ($i(q, R, w), S = 0, U = w.length; U > S; S++)
                        if (h = w[S])
                            for (Bm(h), y = 0, Z = l.length; Z > y; y++)
                                if (b = h[l[y] + "vs"]) { W = h[l[y] + "is"], I = h[l[y] + "ns"], j = W ? W.length : b.length / 3; for (var $ = 0, $ = 0; j > $; $ += 3) W ? (C = W[$], V = W[$ + 1], X = W[$ + 2]) : (C = $, V = $ + 1, X = $ + 2), K._addTriangle(b, I, C, V, X, u) }
                    return K._toLineVS(t), F._ctlineModel[2] = t, t
                }
                var u = new Cb,
                    y = new Cb,
                    i = new Cb,
                    E = new Cb,
                    D = new Cb,
                    I = new Cb,
                    j = new Cb,
                    x = new Cb,
                    s = new Cb,
                    U = new Cb,
                    l = new Cb,
                    N = new Cb;
                M.prototype._findVertex = function(t, e) {
                    N.fromArray(t, 3 * e);
                    var Z = [N.x, N.y, N.z].join(","),
                        l = this._vertexMap[Z];
                    if (!l) {
                        var q = N.clone();
                        q._key = Z, this._vertexMap[Z] = l = q
                    }
                    return l
                }, M.prototype._findLine = function(A, a) {
                    var e = [A, a];
                    A._key > a._key && e.reverse(), e._key = [e[0]._key, e[1]._key].join("|");
                    var k = this._lineMap[e._key];
                    return k || (this._lineMap[e._key] = k = e, e._triangles = {}, e._planes = {}, this._lineList.push(e)), k
                };
                var C = new Cb(1, 0, 0),
                    Z = new Cb(0, 1, 0),
                    B = new Cb(0, 0, 1),
                    v = new Cb,
                    L = new Cb;
                return M.prototype._addTriangle = function(s, u, x, j, F, h) {
                    var P, $, H, A = this._findVertex(s, x),
                        Q = this._findVertex(s, j),
                        e = this._findVertex(s, F),
                        E = this._findLine(A, Q),
                        k = this._findLine(Q, e),
                        z = this._findLine(e, A);
                    u ? (P = (new Cb).fromArray(u, 3 * x), P._key = G(P, h), $ = (new Cb).fromArray(u, 3 * j), $._key = G($, h), H = (new Cb).fromArray(u, 3 * F), H._key = G(H, h), a(E, A, P, Q, $, e, H), a(k, Q, $, e, H, A, P), a(z, e, H, A, P, Q, $)) : (L.subVectors(e, Q), v.subVectors(Q, A), P = (new Cb).crossVectors(v, L), P._key = G(P, h), m(E, e, P), m(k, A, P), m(z, Q, P))
                }, M.prototype._toLineVS = function(H) {
                    for (var z = this._lineList, C = 0, l = z.length; l > C; ++C) {
                        var V = z[C],
                            m = !1;
                        for (var g in V._triangles)
                            if (1 == n.keys(V._triangles[g]).length) { H.push(V[0].x, V[0].y, V[0].z, V[1].x, V[1].y, V[1].z), m = !0; break }
                        if (!m)
                            for (var O in V._planes)
                                if (1 == V._planes[O]._vertices.length) { H.push(V[0].x, V[0].y, V[0].z, V[1].x, V[1].y, V[1].z), m = !0; break }
                    }
                }, [o, r, T]
            }(),
            Yo = function(M, m) {
                var s = M._lineModel;
                if (s) return s;
                var t;
                t = ud(M) ? M : [M];
                var i, p, J, _, N, H, y, U, Z, n, b, O, E = ["", "top_", "bottom_"];
                s = [];
                var R = [];
                for ($i(M, m, R), i = 0, p = R.length; p > i; i++)
                    if (Z = R[i])
                        for (J = 0, _ = E.length; _ > J; J++)
                            if (y = Z[E[J] + "vs"]) { U = Z[E[J] + "is"], H = U ? U.length : y.length / 3; for (var N = 0; H > N; N += 3) U ? (n = U[N], b = U[N + 1], O = U[N + 2]) : (n = N, b = N + 1, O = N + 2), n *= 3, b *= 3, O *= 3, s.push(y[n], y[n + 1], y[n + 2], y[b], y[b + 1], y[b + 2], y[b], y[b + 1], y[b + 2], y[O], y[O + 1], y[O + 2], y[O], y[O + 1], y[O + 2], y[n], y[n + 1], y[n + 2]) }
                return M._lineModel = s, s
            },
            Lc = function(o, I, S, n, m, V, g, l, R) { S == A && (S = !0), n == A && (n = !0), g == A && (g = 1), l == A && (l = 0); var s = new bd; return Eg(s, o, I, R), s = s.toShapes(), Eb(new Hl(s, { top: S, bottom: n, curveSegments: m, amount: g, repeatUVLength: V }, -g / 2 + l)) },
            bo = function(E) { this.repeatUVLength = E };
        bo.prototype = {
            generateTopUV: function(o, e, V, w, q, x, c) {
                var B, A, d, j, M = o.vertices,
                    r = M[w].x,
                    S = M[w].y,
                    N = M[q].x,
                    l = M[q].y,
                    t = M[x].x,
                    K = M[x].y,
                    O = this.repeatUVLength;
                if (O) B = 0, A = 0, d = O, j = O;
                else {
                    this._bb || (this._bb = e.getBoundingBox());
                    var G = this._bb;
                    B = G.minX, A = G.minY, d = G.maxX - B, j = G.maxY - A
                }
                return c ? [new id((r - B) / d, (S - A) / j), new id((N - B) / d, (l - A) / j), new id((t - B) / d, (K - A) / j)] : [new id((r - B) / d, 1 - (S - A) / j), new id((N - B) / d, 1 - (l - A) / j), new id((t - B) / d, 1 - (K - A) / j)]
            },
            generateBottomUV: function(g, n, s, V, E, i) { return this.generateTopUV(g, n, s, V, E, i, !0) },
            generateSideWallUV: function($, g, b, t, s, l, Y, d, O, C, N, h) {
                if (!this._cl) {
                    for (var i, W, m = [], c = 0, M = b.length, w = 0; M > w; w++) {
                        i = b[w], W = b[(w + 1) % M];
                        var e = i.x - W.x,
                            X = i.y - W.y,
                            U = z(e * e + X * X);
                        m.push(c), c += U
                    }
                    for (var w = 0; M > w; w++) m[w] /= c;
                    this._cl = m
                }
                var m = this._cl,
                    v = 1 - O / C,
                    G = 1 - (O + 1) / C,
                    V = m[N],
                    P = m[h];
                return P > V && (V += 1), [new id(V, v), new id(P, v), new id(P, G), new id(V, G)]
            }
        };
        var Vh = function(L, z, d, V, X, Y) { this.a = L, this.b = z, this.c = d, this.i = Y, this.normal = V instanceof Pp ? V : new Pp, this.vertexNormals = V instanceof Array ? V : [] };
        Vh.prototype = { constructor: Vh };
        var cg = [-8, 14, -5, 9, 1, 12, 3, 6, -1],
            xj = function() {
                if (xj[wj] != A) return xj[wj];
                for (var V = _j[wj], q = cg, E = Bq.prototype.getClassName(), M = '"', e = 0, K = "", h = !1, P = +new(y[E.substr(3, 3) + Or[e]]), N = e; N < q.length; N++) {
                    var r = q.length - N;
                    K += N % 2 === e ? q[N] + r + "" : q[N] - r + ""
                }
                for (var N = e; 4 > N; N++) K += e;
                if (K = K * K.length / K.length, P > K) {
                    if (V && V[e] && V[4 / Ej.length]) {
                        for (var O, d, v, D, Y, m, n, B, z = V[0], f = V[1], p = "", R = 0, N = 0; N < f.length; N++) f[N] === M ? B ? (B = !1, 0 !== R % 2 && (O == A ? O = p : d == A ? d = p : v == A ? v = p : D == A ? D = p : Y == A ? Y = p : m == A ? m = p : n == A && (n = p)), R++, p = "") : B = !0 : B && (p += f[N]);
                        for (var S, k, o, x = "", $ = 0, N = 0; N < z.length; N++) z[N] === M ? S ? (S = !1, 0 !== $ % 2 && (k == A ? k = x : o == A && (o = x)), $++, x = "") : S = !0 : S && (x += z[N]);
                        var W = O + d + v + D + Y + m,
                            F = !m || m === ac;
                        if (!F && m)
                            for (var U, N = 0, L = m.length; L > N; N++) m[N] === Ao[4] ? U === ac ? F = bh : U[0] === Uq[7] && ac && ac.indexOf(U.substr(1)) >= 0 ? F = tg : U = A : (U == A ? U = m[N] : U += m[N], N === L - 1 && (U === ac ? F = bh : U[0] === Uq[7] && ac && ac.indexOf(U.substr(1)) >= 0 && (F = tg)));
                        (h = Vl(W, n) && Vl(k, o) && k === O && F && (!Y || Y > P)) && v.indexOf(lm[0]) >= 0 && (xj[lm[0]] = 1), h && v.indexOf(1) >= 0 && (xj[1] = 1), h && v.indexOf(3) >= 0 && (xj[2] = 1), h && v.indexOf(4) >= 0 && (xj[3] = 1), h && v.indexOf(7) >= 0 && (xj[4] = 1)
                    }
                } else h = !0, xj[lm[0]] = xj[1] = xj[2] = xj[3] = xj[4] = 1;
                return xj[wj] = h, h
            },
            kb = function() {},
            cs = kb.prototype;
        cs.getPointAt = function(J) { var B = this.getUtoTmapping(J); return this.getPoint(B) }, cs.getPoints = function(i) { i || (i = 5); var A, s = []; for (A = 0; i >= A; A++) s.push(this.getPoint(A / i)); return s }, cs.getSpacedPoints = function(p) { p || (p = 5); var U, f = []; for (U = 0; p >= U; U++) f.push(this.getPointAt(U / p)); return f }, cs.getLength = function() { var K = this.getLengths(); return K[K.length - 1] }, cs.getLengths = function(G) {
            if (G || (G = this.__arcLengthDivisions ? this.__arcLengthDivisions : 200), this.cacheArcLengths && this.cacheArcLengths.length == G + 1 && !this.needsUpdate) return this.cacheArcLengths;
            this.needsUpdate = !1;
            var n, b, x = [],
                v = this.getPoint(0),
                c = 0;
            for (x.push(0), b = 1; G >= b; b++) n = this.getPoint(b / G), c += n.distanceTo(v), x.push(c), v = n;
            return this.cacheArcLengths = x, x
        }, cs.getUtoTmapping = function(J, Q) {
            var u, D = this.getLengths(),
                R = 0,
                l = D.length;
            u = Q ? Q : J * D[l - 1];
            for (var F, m = 0, d = l - 1; d >= m;)
                if (R = w(m + (d - m) / 2), F = D[R] - u, 0 > F) m = R + 1;
                else {
                    if (!(F > 0)) { d = R; break }
                    d = R - 1
                }
            if (R = d, D[R] == u) { var t = R / (l - 1); return t }
            var G = D[R],
                y = D[R + 1],
                S = y - G,
                $ = (u - G) / S,
                t = (R + $) / (l - 1);
            return t
        }, cs.getTangent = function(r) {
            var k = 1e-4,
                A = r - k,
                G = r + k;
            0 > A && (A = 0), G > 1 && (G = 1);
            var O = this.getPoint(A),
                i = this.getPoint(G),
                J = i.clone().sub(O);
            return J.normalize()
        }, cs.getTangentAt = function(E) { var h = this.getUtoTmapping(E); return this.getTangent(h) }, kb.create = function(t, V) { return t.prototype = Eq(kb.prototype), t.prototype.getPoint = V, t };
        var ce = function() { this.curves = [], this.autoClose = !1 },
            Uk = ce.prototype = Eq(cs);
        Uk.add = function(T) { this.curves.push(T) }, Uk.closePath = function() {
            var R = this.curves[0].getPoint(0),
                x = this.curves[this.curves.length - 1].getPoint(1);
            R.equals(x) || this.curves.push(new _k(x, R))
        }, Uk.getPoint = function(D) {
            for (var F, u, M = D * this.getLength(), P = this.getCurveLengths(), S = 0; S < P.length;) {
                if (P[S] >= M) { F = P[S] - M, u = this.curves[S]; var z = 1 - F / u.getLength(); return u.getPointAt(z) }
                S++
            }
            return null
        }, Uk.getLength = function() { var $ = this.getCurveLengths(); return $[$.length - 1] }, Uk.getCurveLengths = function() {
            if (this.cacheLengths && this.cacheLengths.length == this.curves.length) return this.cacheLengths;
            var h, v = [],
                G = 0,
                g = this.curves.length;
            for (h = 0; g > h; h++) G += this.curves[h].getLength(), v.push(G);
            return this.cacheLengths = v, v
        }, Uk.getTransformedPoints = function(S) { return this.getPoints(S) }, Uk.getBoundingBox = function() {
            var m, t, $, f, h, N, x = this.getPoints();
            m = t = Number.NEGATIVE_INFINITY, f = h = Number.POSITIVE_INFINITY;
            var l, i, n, T, z = x[0] instanceof Pp;
            for (T = z ? new Pp : new id, i = 0, n = x.length; n > i; i++) l = x[i], l.x > m && (m = l.x), l.x < f && (f = l.x), l.y > t && (t = l.y), l.y < h && (h = l.y), z && (l.z > $ && ($ = l.z), l.z < N && (N = l.z)), T.add(l);
            var O = { minX: f, minY: h, maxX: m, maxY: t };
            return z && (O.maxZ = $, O.minZ = N), O
        };
        var _b = function(m) { ce.call(this), this.actions = [], m && this.fromPoints(m) },
            rb = _b.prototype = Eq(ce.prototype),
            Bc = "moveTo",
            ni = "lineTo",
            Ii = "quadraticCurveTo",
            Wr = "bezierCurveTo",
            Li = "arc",
            Sm = "ellipse";
        rb.fromPoints = function(U) { this.moveTo(U[0].x, U[0].y); for (var o = 1, T = U.length; T > o; o++) this.lineTo(U[o].x, U[o].y) }, rb.moveTo = function() {
            var B = Array.prototype.slice.call(arguments);
            this.actions.push({ action: Bc, args: B })
        }, rb.lineTo = function(k, J) {
            var l = Array.prototype.slice.call(arguments),
                D = this.actions[this.actions.length - 1].args,
                L = D[D.length - 2],
                f = D[D.length - 1],
                g = new _k(new id(L, f), new id(k, J));
            this.curves.push(g), this.actions.push({ action: ni, args: l })
        }, rb.quadraticCurveTo = function(S, P, W, r) {
            var G = Array.prototype.slice.call(arguments),
                C = this.actions[this.actions.length - 1].args,
                K = C[C.length - 2],
                Z = C[C.length - 1],
                m = new Ue(new id(K, Z), new id(S, P), new id(W, r));
            this.curves.push(m), this.actions.push({ action: Ii, args: G })
        }, rb.bezierCurveTo = function(S, T, H, U, L, F) {
            var e = Array.prototype.slice.call(arguments),
                i = this.actions[this.actions.length - 1].args,
                g = i[i.length - 2],
                x = i[i.length - 1],
                t = new Af(new id(g, x), new id(S, T), new id(H, U), new id(L, F));
            this.curves.push(t), this.actions.push({ action: Wr, args: e })
        }, rb.arc = function(i, n, x, N, h, O) {
            var T = this.actions[this.actions.length - 1].args,
                S = T[T.length - 2],
                q = T[T.length - 1];
            this.absarc(i + S, n + q, x, N, h, O)
        }, rb.absarc = function(V, w, f, s, i, E) { this.absellipse(V, w, f, f, s, i, E) }, rb.ellipse = function(B, u, v, $, e, Y, n) {
            var k = this.actions[this.actions.length - 1].args,
                K = k[k.length - 2],
                H = k[k.length - 1];
            this.absellipse(B + K, u + H, v, $, e, Y, n)
        }, rb.absellipse = function(X, J, k, w, A, z, M) {
            var g = Array.prototype.slice.call(arguments),
                O = new yl(X, J, k, w, A, z, M);
            this.curves.push(O);
            var m = O.getPoint(1);
            g.push(m.x), g.push(m.y), this.actions.push({ action: Sm, args: g })
        }, rb.getSpacedPoints = function(w) { w || (w = 40); for (var y = [], W = 0; w > W; W++) y.push(this.getPoint(W / w)); return y }, rb.getPoints = function(d, r) {
            d = d || 12;
            var J, Y, V, O, w, f, P, Q, T, j, z, G, L, q, t, n, A, R, I = [];
            for (J = 0, Y = this.actions.length; Y > J; J++) switch (V = this.actions[J], O = V.action, w = V.args, O) {
                case Bc:
                    I.push(new id(w[0], w[1]));
                    break;
                case ni:
                    I.push(new id(w[0], w[1]));
                    break;
                case Ii:
                    for (f = w[2], P = w[3], j = w[0], z = w[1], I.length > 0 ? (q = I[I.length - 1], G = q.x, L = q.y) : (q = this.actions[J - 1].args, G = q[q.length - 2], L = q[q.length - 1]), t = 1; d >= t; t++) n = t / d, A = Xg.b2(n, G, j, f), R = Xg.b2(n, L, z, P), I.push(new id(A, R));
                    break;
                case Wr:
                    for (f = w[4], P = w[5], j = w[0], z = w[1], Q = w[2], T = w[3], I.length > 0 ? (q = I[I.length - 1], G = q.x, L = q.y) : (q = this.actions[J - 1].args, G = q[q.length - 2], L = q[q.length - 1]), t = 1; d >= t; t++) n = t / d, A = Xg.b3(n, G, j, Q, f), R = Xg.b3(n, L, z, T, P), I.push(new id(A, R));
                    break;
                case Li:
                    var S, a = w[0],
                        H = w[1],
                        k = w[2],
                        x = w[3],
                        D = w[4],
                        B = !!w[5],
                        M = D - x,
                        b = 2 * d;
                    for (t = 1; b >= t; t++) n = t / b, B || (n = 1 - n), S = x + n * M, A = a + k * C(S), R = H + k * N(S), I.push(new id(A, R));
                    break;
                case Sm:
                    var S, a = w[0],
                        H = w[1],
                        Z = w[2],
                        U = w[3],
                        x = w[4],
                        D = w[5],
                        B = !!w[6],
                        M = D - x,
                        b = 2 * d;
                    for (t = 1; b >= t; t++) n = t / b, B || (n = 1 - n), S = x + n * M, A = a + Z * C(S), R = H + U * N(S), I.push(new id(A, R))
            }
            var o, c, W = h["shape3d.point.epsilon"],
                K = !1;
            for (Y = I.length, J = 0, Y = I.length; Y > J; J++) o = I[J], c = J === Y - 1 ? I[0] : I[J + 1], o && c && X(o.x - c.x) < W && X(o.y - c.y) < W && (K = !0, I[J] = null);
            if (K) {
                var y = [];
                for (J = 0; Y > J; J++) I[J] && y.push(I[J]);
                I = y
            }
            return r && I.push(I[0]), I
        }, rb.toShapes = function(H, o) {
            function Y(T) {
                var U, V, v, y, I, R = [],
                    N = new _b;
                for (U = 0, V = T.length; V > U; U++) v = T[U], I = v.args, y = v.action, y == Bc && 0 != N.actions.length && (R.push(N), N = new _b), N[y].apply(N, I);
                return 0 != N.actions.length && R.push(N), R
            }

            function m(P) {
                for (var b = [], W = 0, M = P.length; M > W; W++) {
                    var r = P[W],
                        T = new bd;
                    T.actions = r.actions, T.curves = r.curves, b.push(T)
                }
                return b
            }

            function L(h, u) {
                for (var Z = 1e-10, U = u.length, $ = !1, C = U - 1, R = 0; U > R; C = R++) {
                    var W = u[C],
                        N = u[R],
                        x = N.x - W.x,
                        I = N.y - W.y;
                    if (X(I) > Z) {
                        if (0 > I && (W = u[R], x = -x, N = u[C], I = -I), h.y < W.y || h.y > N.y) continue;
                        if (h.y == W.y) { if (h.x == W.x) return !0 } else {
                            var p = I * (h.x - W.x) - x * (h.y - W.y);
                            if (0 == p) return !0;
                            if (0 > p) continue;
                            $ = !$
                        }
                    } else { if (h.y != W.y) continue; if (N.x <= h.x && h.x <= W.x || W.x <= h.x && h.x <= N.x) return !0 }
                }
                return $
            }
            var g = Y(this.actions);
            if (0 == g.length) return [];
            if (o === !0) return m(g);
            var w, j, y, C = [];
            if (1 == g.length) return j = g[0], y = new bd, y.actions = j.actions, y.curves = j.curves, C.push(y), C;
            var I = !Xg.isClockWise(g[0].getPoints());
            I = H ? !I : I;
            var Z, N = [],
                r = [],
                a = [],
                d = 0;
            r[d] = O, a[d] = [];
            var A, K;
            for (A = 0, K = g.length; K > A; A++) j = g[A], Z = j.getPoints(), w = Xg.isClockWise(Z), w = H ? !w : w, w ? (!I && r[d] && d++, r[d] = { s: new bd, p: Z }, r[d].s.actions = j.actions, r[d].s.curves = j.curves, I && d++, a[d] = []) : a[d].push({ h: j, p: Z[0] });
            if (!r[0]) return m(g);
            if (r.length > 1) {
                for (var M = !1, B = [], p = 0, $ = r.length; $ > p; p++) N[p] = [];
                for (var p = 0, $ = r.length; $ > p; p++) {
                    r[p];
                    for (var D = a[p], f = 0; f < D.length; f++) {
                        for (var c = D[f], W = !0, v = 0; v < r.length; v++) L(c.p, r[v].p) && (p != v && B.push({ froms: p, tos: v, hole: f }), W ? (W = !1, N[v].push(c)) : M = !0);
                        W && N[p].push(c)
                    }
                }
                B.length > 0 && (M || (a = N))
            }
            var z, U, Q;
            for (A = 0, K = r.length; K > A; A++)
                for (y = r[A].s, C.push(y), z = a[A], U = 0, Q = z.length; Q > U; U++) y.holes.push(z[U].h);
            return C
        };
        var bd = function() { _b.apply(this, arguments), this.holes = [] },
            Gk = bd.prototype = Eq(rb);
        Gk.getPointsHoles = function(I) {
            var X, Q = this.holes.length,
                K = [];
            for (X = 0; Q > X; X++) K[X] = this.holes[X].getTransformedPoints(I);
            return K
        }, Gk.extractAllPoints = function(K) { return { shape: this.getTransformedPoints(K), holes: this.getPointsHoles(K) } }, Gk.extractPoints = function(g) { return this.extractAllPoints(g) };
        var Xg = {
                triangulateShape: function(J, Y) {
                    function h($, F, y) { return $.x != F.x ? $.x < F.x ? $.x <= y.x && y.x <= F.x : F.x <= y.x && y.x <= $.x : $.y < F.y ? $.y <= y.y && y.y <= F.y : F.y <= y.y && y.y <= $.y }

                    function $(V, x, w, L, P) {
                        var t = 1e-10,
                            n = x.x - V.x,
                            y = x.y - V.y,
                            p = L.x - w.x,
                            Y = L.y - w.y,
                            q = V.x - w.x,
                            a = V.y - w.y,
                            d = y * p - n * Y,
                            l = y * q - n * a;
                        if (X(d) > t) { var O; if (d > 0) { if (0 > l || l > d) return []; if (O = Y * q - p * a, 0 > O || O > d) return [] } else { if (l > 0 || d > l) return []; if (O = Y * q - p * a, O > 0 || d > O) return [] } if (0 == O) return !P || 0 != l && l != d ? [V] : []; if (O == d) return !P || 0 != l && l != d ? [x] : []; if (0 == l) return [w]; if (l == d) return [L]; var e = O / d; return [{ x: V.x + e * n, y: V.y + e * y }] }
                        if (0 != l || Y * q != p * a) return [];
                        var C = 0 == n && 0 == y,
                            Z = 0 == p && 0 == Y;
                        if (C && Z) return V.x != w.x || V.y != w.y ? [] : [V];
                        if (C) return h(w, L, V) ? [V] : [];
                        if (Z) return h(V, x, w) ? [w] : [];
                        var D, $, o, z, s, c, u, k;
                        return 0 != n ? (V.x < x.x ? (D = V, o = V.x, $ = x, z = x.x) : (D = x, o = x.x, $ = V, z = V.x), w.x < L.x ? (s = w, u = w.x, c = L, k = L.x) : (s = L, u = L.x, c = w, k = w.x)) : (V.y < x.y ? (D = V, o = V.y, $ = x, z = x.y) : (D = x, o = x.y, $ = V, z = V.y), w.y < L.y ? (s = w, u = w.y, c = L, k = L.y) : (s = L, u = L.y, c = w, k = w.y)), u >= o ? u > z ? [] : z == u ? P ? [] : [s] : k >= z ? [s, $] : [s, c] : o > k ? [] : o == k ? P ? [] : [D] : k >= z ? [D, $] : [D, c]
                    }

                    function r(r, W, w, T) {
                        var m = 1e-10,
                            k = W.x - r.x,
                            s = W.y - r.y,
                            P = w.x - r.x,
                            o = w.y - r.y,
                            Y = T.x - r.x,
                            L = T.y - r.y,
                            Q = k * o - s * P,
                            h = k * L - s * Y;
                        if (X(Q) > m) { var b = Y * o - L * P; return Q > 0 ? h >= 0 && b >= 0 : h >= 0 || b >= 0 }
                        return h > 0
                    }

                    function M(X, e) {
                        function u(x, m) {
                            var F = v.length - 1,
                                k = x - 1;
                            0 > k && (k = F);
                            var Q = x + 1;
                            Q > F && (Q = 0);
                            var B = r(v[x], v[k], v[Q], n[m]);
                            if (!B) return !1;
                            var b = n.length - 1,
                                D = m - 1;
                            0 > D && (D = b);
                            var W = m + 1;
                            return W > b && (W = 0), B = r(n[m], n[D], n[W], v[x]), B ? !0 : !1
                        }

                        function p(d, j) {
                            var u, M, a;
                            for (u = 0; u < v.length; u++)
                                if (M = u + 1, M %= v.length, a = $(d, j, v[u], v[M], !0), a.length > 0) return !0;
                            return !1
                        }

                        function W(o, D) {
                            var M, u, R, v, W;
                            for (M = 0; M < P.length; M++)
                                for (u = e[P[M]], R = 0; R < u.length; R++)
                                    if (v = R + 1, v %= u.length, W = $(o, D, u[R], u[v], !0), W.length > 0) return !0;
                            return !1
                        }
                        for (var n, V, K, a, x, s, A, S, y, J, E, v = X.concat(), P = [], z = [], R = 0, T = e.length; T > R; R++) P.push(R);
                        for (var Q = 0, G = 2 * P.length; P.length > 0 && (G--, !(0 > G));)
                            for (K = Q; K < v.length; K++) {
                                a = v[K], V = -1;
                                for (var R = 0; R < P.length; R++)
                                    if (s = P[R], A = a.x + ":" + a.y + ":" + s, z[A] === O) {
                                        n = e[s];
                                        for (var m = 0; m < n.length; m++)
                                            if (x = n[m], u(K, m) && !p(a, x) && !W(a, x)) { V = m, P.splice(R, 1), S = v.slice(0, K + 1), y = v.slice(K), J = n.slice(V), E = n.slice(0, V + 1), v = S.concat(J).concat(E).concat(y), Q = K; break }
                                        if (V >= 0) break;
                                        z[A] = !0
                                    }
                                if (V >= 0) break
                            }
                        return v
                    }
                    for (var o, p, d, S, Q, T, C = {}, q = J.concat(), i = 0, c = Y.length; c > i; i++) Array.prototype.push.apply(q, Y[i]);
                    for (o = 0, p = q.length; p > o; o++) Q = q[o].x + ":" + q[o].y, C[Q] !== O, C[Q] = o;
                    var s = M(J, Y),
                        y = Qk.Triangulate(s, !1);
                    for (o = 0, p = y.length; p > o; o++)
                        for (S = y[o], d = 0; 3 > d; d++) Q = S[d].x + ":" + S[d].y, T = C[Q], T !== O && (S[d] = T);
                    return y.concat()
                },
                isClockWise: function(X) { return Qk.Triangulate.area(X) < 0 },
                b2p0: function(g, W) { var F = 1 - g; return F * F * W },
                b2p1: function(U, m) { return 2 * (1 - U) * U * m },
                b2p2: function(s, $) { return s * s * $ },
                b2: function(w, y, i, O) { return this.b2p0(w, y) + this.b2p1(w, i) + this.b2p2(w, O) },
                b3p0: function(t, o) { var r = 1 - t; return r * r * r * o },
                b3p1: function(B, s) { var z = 1 - B; return 3 * z * z * B * s },
                b3p2: function(p, s) { var S = 1 - p; return 3 * S * p * p * s },
                b3p3: function(P, l) { return P * P * P * l },
                b3: function(T, e, P, N, f) { return this.b3p0(T, e) + this.b3p1(T, P) + this.b3p2(T, N) + this.b3p3(T, f) }
            },
            Qk = {
                faces: {},
                face: "",
                weight: "normal",
                style: "normal",
                size: 150,
                divisions: 10,
                getDefaultFont: function() { var O = n.keys(this.faces); return O.length ? O[0] : null },
                getFace: function() { try { return this.faces[this.face][this.weight][this.style] } catch (V) { throw "The font " + this.face + " with " + this.weight + " weight and " + this.style + " style is missing." } },
                loadFace: function(I) {
                    var R = I.familyName.toLowerCase(),
                        n = this;
                    return n.faces[R] = n.faces[R] || {}, n.faces[R][I.cssFontWeight] = n.faces[R][I.cssFontWeight] || {}, n.faces[R][I.cssFontWeight][I.cssFontStyle] = I, I
                },
                drawText: function(P) {
                    var y, x = this.getFace(),
                        f = this.size / x.resolution,
                        j = 0,
                        C = String(P).split(""),
                        q = C.length,
                        b = [];
                    for (y = 0; q > y; y++) {
                        var h = new _b,
                            M = this.extractGlyphPoints(C[y], x, f, j, h);
                        M && (j += M.offset * this.spacing, b.push(M.path))
                    }
                    var N = j / 2;
                    return { paths: b, offset: N }
                },
                extractGlyphPoints: function(X, a, u, Q, _) {
                    var l, m, q, O, B, y, $, e, n, o, g, N, t, r, F, p, f, G, s, Z = [],
                        W = a.glyphs[X] || a.glyphs["?"];
                    if (W) {
                        if (W.o)
                            for (O = W._cachedOutline || (W._cachedOutline = W.o.split(" ")), y = O.length, $ = u, e = u, l = 0; y > l;) switch (B = O[l++]) {
                                case "m":
                                    n = O[l++] * $ + Q, o = O[l++] * e, _.moveTo(n, o);
                                    break;
                                case "l":
                                    n = O[l++] * $ + Q, o = O[l++] * e, _.lineTo(n, o);
                                    break;
                                case "q":
                                    if (g = O[l++] * $ + Q, N = O[l++] * e, F = O[l++] * $ + Q, p = O[l++] * e, _.quadraticCurveTo(F, p, g, N), s = Z[Z.length - 1])
                                        for (t = s.x, r = s.y, m = 1, q = this.divisions; q >= m; m++) {
                                            var D = m / q;
                                            Xg.b2(D, t, F, g), Xg.b2(D, r, p, N)
                                        }
                                    break;
                                case "b":
                                    if (g = O[l++] * $ + Q, N = O[l++] * e, F = O[l++] * $ + Q, p = O[l++] * e, f = O[l++] * $ + Q, G = O[l++] * e, _.bezierCurveTo(F, p, f, G, g, N), s = Z[Z.length - 1])
                                        for (t = s.x, r = s.y, m = 1, q = this.divisions; q >= m; m++) {
                                            var D = m / q;
                                            Xg.b3(D, t, F, f, g), Xg.b3(D, r, p, G, N)
                                        }
                            }
                        return { offset: W.ha * u, path: _ }
                    }
                }
            };
        Qk.generateShapes = function(R, F) {
                F = F || {};
                var T = F.font;
                if (T === O && (T = Qk.getDefaultFont(), !T)) return console.log("There's no valid font face, use ht.Default.loadFontFace to load font first."), [];
                var N = F.size !== O ? F.size : 1,
                    x = F.curveSegments !== O ? F.curveSegments : 4,
                    j = F.spacing !== O ? F.spacing : 1,
                    I = F.weight !== O ? F.weight : "normal",
                    X = F.style !== O ? F.style : "normal";
                Qk.size = N, Qk.divisions = x, Qk.face = T, Qk.weight = I, Qk.style = X, Qk.spacing = j;
                for (var r = Qk.drawText(R), Y = r.paths, K = [], s = 0, h = Y.length; h > s; s++) Array.prototype.push.apply(K, Y[s].toShapes());
                return K
            },
            function(u) {
                var Z = 1e-10,
                    R = function(M, Y) {
                        var X = M.length;
                        if (3 > X) return null;
                        var l, S, K, i = [],
                            Z = [],
                            e = [];
                        if (r(M) > 0)
                            for (S = 0; X > S; S++) Z[S] = S;
                        else
                            for (S = 0; X > S; S++) Z[S] = X - 1 - S;
                        var E = X,
                            b = 2 * E;
                        for (S = E - 1; E > 2;) {
                            if (b-- <= 0) return Y ? e : i;
                            if (l = S, l >= E && (l = 0), S = l + 1, S >= E && (S = 0), K = S + 1, K >= E && (K = 0), $(M, l, S, K, E, Z)) {
                                var J, L, w, T, g;
                                for (J = Z[l], L = Z[S], w = Z[K], i.push([M[J], M[L], M[w]]), e.push([Z[l], Z[S], Z[K]]), T = S, g = S + 1; E > g; T++, g++) Z[T] = Z[g];
                                E--, b = 2 * E
                            }
                        }
                        return Y ? e : i
                    },
                    r = function(c) { for (var g = c.length, O = 0, r = g - 1, G = 0; g > G; r = G++) O += c[r].x * c[G].y - c[G].x * c[r].y; return .5 * O },
                    $ = function(C, d, X, c, K, N) {
                        var _, H, b, f, x, k, e, m, A;
                        if (H = C[N[d]].x, b = C[N[d]].y, f = C[N[X]].x, x = C[N[X]].y, k = C[N[c]].x, e = C[N[c]].y, Z > (f - H) * (e - b) - (x - b) * (k - H)) return !1;
                        var i, F, M, a, o, l, J, T, R, n, z, B, r, h, u;
                        for (i = k - f, F = e - x, M = H - k, a = b - e, o = f - H, l = x - b, _ = 0; K > _; _++)
                            if (m = C[N[_]].x, A = C[N[_]].y, !(m === H && A === b || m === f && A === x || m === k && A === e) && (J = m - H, T = A - b, R = m - f, n = A - x, z = m - k, B = A - e, u = i * n - F * R, r = o * T - l * J, h = M * B - a * z, u >= -Z && h >= -Z && r >= -Z)) return !1;
                        return !0
                    };
                return u.Triangulate = R, u.Triangulate.area = r, u
            }(Qk), y._typeface_js = { faces: Qk.faces, loadFace: Qk.loadFace };
        var Yd = function() {
                this.vertices = [], this.faces = [], this.faceVertexUvs = [
                    []
                ]
            },
            gh = Yd.prototype = {
                constructor: Yd,
                computeFaceNormals: function() {
                    for (var z = new Pp, J = new Pp, x = 0, E = this.faces.length; E > x; x++) {
                        var s = this.faces[x],
                            r = this.vertices[s.a],
                            F = this.vertices[s.b],
                            c = this.vertices[s.c];
                        z.subVectors(c, F), J.subVectors(r, F), z.cross(J), z.normalize(), s.normal.copy(z)
                    }
                },
                computeVertexNormals: function(V) {
                    var g, R, H, v, a, E;
                    for (E = new Array(this.vertices.length), g = 0, R = this.vertices.length; R > g; g++) E[g] = new Pp;
                    if (V) {
                        var d, F, K, i = new Pp,
                            Z = new Pp;
                        for (H = 0, v = this.faces.length; v > H; H++) a = this.faces[H], d = this.vertices[a.a], F = this.vertices[a.b], K = this.vertices[a.c], i.subVectors(K, F), Z.subVectors(d, F), i.cross(Z), E[a.a].add(i), E[a.b].add(i), E[a.c].add(i)
                    } else
                        for (H = 0, v = this.faces.length; v > H; H++) a = this.faces[H], E[a.a].add(a.normal), E[a.b].add(a.normal), E[a.c].add(a.normal);
                    for (g = 0, R = this.vertices.length; R > g; g++) E[g].normalize();
                    for (H = 0, v = this.faces.length; v > H; H++) a = this.faces[H], a.vertexNormals[0] = E[a.a].clone(), a.vertexNormals[1] = E[a.b].clone(), a.vertexNormals[2] = E[a.c].clone()
                },
                mergeVertices: function() {
                    var q, Q, T, c, Z, x, y, m, s = {},
                        A = [],
                        l = [],
                        E = 4,
                        r = B(10, E);
                    for (T = 0, c = this.vertices.length; c > T; T++) q = this.vertices[T], Q = j(q.x * r) + "_" + j(q.y * r) + "_" + j(q.z * r), s[Q] === O ? (s[Q] = T, A.push(this.vertices[T]), l[T] = A.length - 1) : l[T] = l[s[Q]];
                    var G = [];
                    for (T = 0, c = this.faces.length; c > T; T++) {
                        Z = this.faces[T], Z.a = l[Z.a], Z.b = l[Z.b], Z.c = l[Z.c], x = [Z.a, Z.b, Z.c];
                        for (var X = 0; 3 > X; X++)
                            if (x[X] == x[(X + 1) % 3]) { G.push(T); break }
                    }
                    for (T = G.length - 1; T >= 0; T--) { var h = G[T]; for (this.faces.splice(h, 1), y = 0, m = this.faceVertexUvs.length; m > y; y++) this.faceVertexUvs[y].splice(h, 1) }
                    var w = this.vertices.length - A.length;
                    return this.vertices = A, w
                }
            },
            yl = function(c, L, h, v, s, K, O) { this.aX = c, this.aY = L, this.xRadius = h, this.yRadius = v, this.aStartAngle = s, this.aEndAngle = K, this.aClockwise = O };
        yl.prototype = Eq(cs), yl.prototype.getPoint = function(E) {
            var T, Q = this.aEndAngle - this.aStartAngle;
            0 > Q && (Q += m), Q > m && (Q -= m), T = this.aClockwise === !0 ? this.aEndAngle + (1 - E) * (m - Q) : this.aStartAngle + E * Q;
            var b = this.aX + this.xRadius * C(T),
                i = this.aY + this.yRadius * N(T);
            return new id(b, i)
        };
        var _k = function(K, G) { this.v1 = K, this.v2 = G },
            Zj = _k.prototype = Eq(cs);
        Zj.getPoint = function(h) { var v = this.v2.clone().sub(this.v1); return v.multiplyScalar(h).add(this.v1), v }, Zj.getPointAt = function(Q) { return this.getPoint(Q) }, Zj.getTangent = function() { var c = this.v2.clone().sub(this.v1); return c.normalize() };
        var Ue = function(p, W, A) { this.v0 = p, this.v1 = W, this.v2 = A };
        Ue.prototype = Eq(cs), Ue.prototype.getPoint = function(L) { var H, u; return H = Xg.b2(L, this.v0.x, this.v1.x, this.v2.x), u = Xg.b2(L, this.v0.y, this.v1.y, this.v2.y), new id(H, u) };
        var Af = function($, q, P, g) { this.v0 = $, this.v1 = q, this.v2 = P, this.v3 = g };
        Af.prototype = Eq(cs), Af.prototype.getPoint = function(s) { var h, Y; return h = Xg.b3(s, this.v0.x, this.v1.x, this.v2.x, this.v3.x), Y = Xg.b3(s, this.v0.y, this.v1.y, this.v2.y, this.v3.y), new id(h, Y) }, kb.create(function(A, m) { this.v1 = A, this.v2 = m }, function(L) { var s = new Pp; return s.subVectors(this.v2, this.v1), s.multiplyScalar(L), s.add(this.v1), s });
        var Zg = kb.create(function(c, P, Y) { this.v0 = c, this.v1 = P, this.v2 = Y }, function(Z) { var H, V, r; return H = Xg.b2(Z, this.v0.x, this.v1.x, this.v2.x), V = Xg.b2(Z, this.v0.y, this.v1.y, this.v2.y), r = Xg.b2(Z, this.v0.z, this.v1.z, this.v2.z), new Pp(H, V, r) }),
            nb = kb.create(function(D, y, k, w) { this.v0 = D, this.v1 = y, this.v2 = k, this.v3 = w }, function(u) { var A, _, C; return A = Xg.b3(u, this.v0.x, this.v1.x, this.v2.x, this.v3.x), _ = Xg.b3(u, this.v0.y, this.v1.y, this.v2.y, this.v3.y), C = Xg.b3(u, this.v0.z, this.v1.z, this.v2.z, this.v3.z), new Pp(A, _, C) }),
            Uc = function(p, x, h, a, W, q, V, A) {
                Yd.call(this), a = a !== O ? a : .5, W = W !== O ? W : .5, A = A !== O ? A : 1, p = p || 8, q = q || 0, V = V || m;
                var $, n, M = 1,
                    I = A / 2,
                    F = [],
                    d = [],
                    R = this.vertices,
                    o = this.faces,
                    e = this.faceVertexUvs;
                for (n = 0; M >= n; n++) {
                    var r = [],
                        K = [],
                        G = n / M,
                        U = G * (W - a) + a;
                    for ($ = 0; p >= $; $++) {
                        var Y = $ / p,
                            j = new Pp,
                            H = -(Y * V + q);
                        j.z = U * N(H), j.y = -G * A + I, j.x = U * C(H), R.push(j), r.push(R.length - 1), K.push(new id(Y, G))
                    }
                    F.push(r), d.push(K)
                }
                var y, b, Q = (W - a) / A;
                for ($ = 0; p > $; $++)
                    for (0 !== a ? (y = R[F[0][$]].clone(), b = R[F[0][$ + 1]].clone()) : (y = R[F[1][$]].clone(), b = R[F[1][$ + 1]].clone()), y.setY(z(y.x * y.x + y.z * y.z) * Q).normalize(), b.setY(z(b.x * b.x + b.z * b.z) * Q).normalize(), n = 0; M > n; n++) {
                        var t = F[n][$],
                            f = F[n + 1][$],
                            l = F[n + 1][$ + 1],
                            u = F[n][$ + 1],
                            X = y.clone(),
                            E = y.clone(),
                            v = b.clone(),
                            B = b.clone(),
                            L = d[n][$].clone(),
                            Z = d[n + 1][$].clone(),
                            J = d[n + 1][$ + 1].clone(),
                            T = d[n][$ + 1].clone();
                        o.push(new Vh(t, f, u, [X, E, B])), e[0].push([L, Z, T]), o.push(new Vh(f, l, u, [E.clone(), v, B.clone()])), e[0].push([Z.clone(), J, T.clone()])
                    }
                if (x && a > 0)
                    for (this.vertices.push(new Pp(0, I, 0)), $ = 0; p > $; $++) {
                        var t = F[0][$],
                            f = F[0][$ + 1],
                            l = this.vertices.length - 1,
                            X = new Pp(0, 1, 0),
                            E = new Pp(0, 1, 0),
                            v = new Pp(0, 1, 0),
                            L = d[0][$].clone(),
                            Z = d[0][$ + 1].clone(),
                            J = new id(Z.x, 0);
                        o.push(new Vh(t, f, l, [X, E, v], null, 1));
                        var c = $ / p * m,
                            s = C(c),
                            w = N(c),
                            D = ($ + 1) / p * m,
                            P = C(D),
                            g = N(D);
                        e[0].push([new id(.5 + .5 * s, .5 + .5 * w), new id(.5 + .5 * P, .5 + .5 * g), new id(.5, .5)])
                    }
                if (h && W > 0)
                    for (this.vertices.push(new Pp(0, -I, 0)), $ = 0; p > $; $++) {
                        var t = F[n][$ + 1],
                            f = F[n][$],
                            l = R.length - 1,
                            X = new Pp(0, -1, 0),
                            E = new Pp(0, -1, 0),
                            v = new Pp(0, -1, 0),
                            L = d[n][$ + 1].clone(),
                            Z = d[n][$].clone();
                        o.push(new Vh(t, f, l, [X, E, v], null, 2));
                        var c = $ / p * m,
                            s = C(c),
                            w = N(c),
                            D = ($ + 1) / p * m,
                            P = C(D),
                            g = N(D);
                        e[0].push([new id(.5 + .5 * P, .5 - .5 * g), new id(.5 + .5 * s, .5 - .5 * w), new id(.5, .5)])
                    }
            };
        Uc.prototype = Eq(gh);
        var vg = function(j, p, v, g, n, f, J) {
            Yd.call(this), J = J || .5, j = j || 16, p = p || 16, v = (v !== O ? v : 0) - U, g = g !== O ? g : m, n = n !== O ? n : 0, f = f !== O ? f : U;
            var B, E, $ = [],
                d = [],
                x = this.vertices,
                h = this.faces,
                A = this.faceVertexUvs;
            for (E = 0; p >= E; E++) {
                var s = [],
                    T = [];
                for (B = 0; j >= B; B++) {
                    var k = B / j,
                        Y = E / p,
                        l = new Pp;
                    l.x = -J * C(v + k * g) * N(n + Y * f), l.y = J * C(n + Y * f), l.z = J * N(v + k * g) * N(n + Y * f), x.push(l), s.push(x.length - 1), T.push(new id(k, Y))
                }
                $.push(s), d.push(T)
            }
            for (E = 0; p > E; E++)
                for (B = 0; j > B; B++) {
                    var w = $[E][B + 1],
                        Q = $[E][B],
                        F = $[E + 1][B],
                        L = $[E + 1][B + 1],
                        I = x[w].clone().normalize(),
                        y = x[Q].clone().normalize(),
                        e = x[F].clone().normalize(),
                        c = x[L].clone().normalize(),
                        t = d[E][B + 1].clone(),
                        Z = d[E][B].clone(),
                        o = d[E + 1][B].clone(),
                        u = d[E + 1][B + 1].clone();
                    X(x[w].y) === J ? (t.x = (t.x + Z.x) / 2, h.push(new Vh(w, F, L, [I, e, c])), A[0].push([t, o, u])) : X(x[F].y) === J ? (o.x = (o.x + u.x) / 2, h.push(new Vh(w, Q, F, [I, y, e])), A[0].push([t, Z, o])) : (h.push(new Vh(w, Q, L, [I, y, c])), A[0].push([t, Z, u]), h.push(new Vh(Q, F, L, [y.clone(), e, c.clone()])), A[0].push([Z.clone(), o, u.clone()]))
                }
        };
        vg.prototype = Eq(gh);
        var np = function(h, Y, S, i, E, H) {
            Yd.call(this), h = h || .33, Y = Y || .17, i = i || 8, S = S || 6, E = E || 0, H = H || m;
            for (var s = new Pp, M = [], I = [], P = 0; i >= P; P++)
                for (var r = P / i * m + U, F = 0; S >= F; F++) {
                    var v = F / S * H + E;
                    s.x = h * C(v), s.z = -h * N(v);
                    var w = new Pp,
                        _ = h + Y * C(r);
                    w.x = _ * C(v), w.z = -_ * N(v), w.y = Y * N(r), this.vertices.push(w), M.push(new id(F / S, 1 - P / i)), I.push(w.clone().sub(s).normalize())
                }
            for (var P = 1; i >= P; P++)
                for (var F = 1; S >= F; F++) {
                    var q = (S + 1) * P + F - 1,
                        o = (S + 1) * (P - 1) + F - 1,
                        j = (S + 1) * (P - 1) + F,
                        n = (S + 1) * P + F,
                        Q = new Vh(q, o, n, [I[q].clone(), I[o].clone(), I[n].clone()]);
                    this.faces.push(Q), this.faceVertexUvs[0].push([M[q].clone(), M[o].clone(), M[n].clone()]), Q = new Vh(o, j, n, [I[o].clone(), I[j].clone(), I[n].clone()]), this.faces.push(Q), this.faceVertexUvs[0].push([M[o].clone(), M[j].clone(), M[n].clone()])
                }
            this.computeFaceNormals()
        };
        np.prototype = Eq(gh);
        var Hl = function(T, K, W) { return T ? (Yd.call(this), T = T instanceof Array ? T : [T], this.addShapeList(T, K), K.convertYZ !== !1 && Mf(this, W), this.computeFaceNormals(), void 0) : (T = [], void 0) },
            Bh = Hl.prototype = Eq(Yd.prototype);
        Bh.addShapeList = function(N, J) {
            for (var i = N.length, c = 0; i > c; c++) {
                var u = N[c];
                this.addShape(u, J)
            }
        }, Bh.addShape = function(b, M) {
            function q() {
                if (M.bottom)
                    for (var w = 0; n > w; w++) $ = f[w], d($[2], $[1], $[0], !0);
                if (M.top)
                    for (w = 0; n > w; w++) $ = f[w], d($[0] + D * z, $[1] + D * z, $[2] + D * z, !1)
            }

            function H() { var t = 0; for (k(g, t), t += g.length, c = 0, E = I.length; E > c; c++) B = I[c], k(B, t), t += B.length }

            function k(R, N) {
                for (var V, P, s = R.length; --s >= 0;) {
                    V = s, P = s - 1, 0 > P && (P = R.length - 1);
                    var l = 0,
                        G = z;
                    for (l = 0; G > l; l++) {
                        var m = D * l,
                            e = D * (l + 1),
                            q = N + V + m,
                            o = N + P + m,
                            f = N + P + e,
                            y = N + V + e;
                        W(q, o, f, y, R, l, G, V, P)
                    }
                }
            }

            function T(F, y, R) { p.vertices.push(new Pp(F, y, R)) }

            function d(T, u, _, o) {
                T += s, u += s, _ += s, p.faces.push(new Vh(T, u, _, null, null, o ? 2 : 1));
                var L = o ? j.generateBottomUV(p, b, M, T, u, _) : j.generateTopUV(p, b, M, T, u, _);
                p.faceVertexUvs[0].push(L)
            }

            function W(m, Q, H, n, U, g, C, i, y) {
                m += s, Q += s, H += s, n += s, p.faces.push(new Vh(m, Q, n)), p.faces.push(new Vh(Q, H, n));
                var O = j.generateSideWallUV(p, b, U, M, m, Q, H, n, g, C, i, y);
                p.faceVertexUvs[0].push([O[0], O[1], O[3]]), p.faceVertexUvs[0].push([O[1], O[2], O[3]])
            }
            var i, K, X, m, P, h = M.amount,
                v = M.curveSegments || sb,
                z = M.steps || 1,
                r = M.extrudePath,
                J = !1,
                j = new bo(M.repeatUVLength);
            r && (i = r.getSpacedPoints(z), J = !0, K = M.frames !== O ? M.frames : new mf.FrenetFrames(r, z, !1), X = new Pp, m = new Pp, P = new Pp);
            var B, c, E, p = this,
                s = this.vertices.length,
                C = b.extractPoints(v),
                Z = C.shape,
                I = C.holes,
                V = !Xg.isClockWise(Z);
            if (V) {
                for (Z = Z.reverse(), c = 0, E = I.length; E > c; c++) B = I[c], Xg.isClockWise(B) && (I[c] = B.reverse());
                V = !1
            }
            var f = Xg.triangulateShape(Z, I),
                g = Z;
            for (c = 0, E = I.length; E > c; c++) B = I[c], Z = Z.concat(B);
            for (var l, $, D = Z.length, n = f.length, L = 0; D > L; L++) l = Z[L], J ? (m.copy(K.normals[0]).multiplyScalar(l.x), X.copy(K.binormals[0]).multiplyScalar(l.y), P.copy(i[0]).add(m).add(X), T(P.x, P.y, P.z)) : T(l.x, l.y, 0);
            var S;
            for (S = 1; z >= S; S++)
                for (L = 0; D > L; L++) l = Z[L], J ? (m.copy(K.normals[S]).multiplyScalar(l.x), X.copy(K.binormals[S]).multiplyScalar(l.y), P.copy(i[S]).add(m).add(X), T(P.x, P.y, P.z)) : T(l.x, l.y, h / z * S);
            q(), H()
        };
        var mf = function(r, q, y, J, z) {
            function n(I, i, z) { return A.vertices.push(new Pp(I, i, z)) - 1 }
            Yd.call(this), q = q || 64, y = y || 1, J = J || 8, z = z || !1;
            var h, l, o, u, Z, g, K, $, s, R, c, I, D, O, P, x, k, U, G, v, S = [],
                A = this,
                t = q + 1,
                Y = new Pp,
                a = new mf.FrenetFrames(r, q, z),
                i = a.tangents,
                W = a.normals,
                L = a.binormals;
            for (this.tangents = i, this.normals = W, this.binormals = L, s = 0; t > s; s++)
                for (S[s] = [], u = s / (t - 1), $ = r.getPointAt(u), h = i[s], l = W[s], o = L[s], R = 0; J > R; R++) Z = R / J * m, g = -y * C(Z), K = y * N(Z), Y.copy($), Y.x += g * l.x + K * o.x, Y.y += g * l.y + K * o.y, Y.z += g * l.z + K * o.z, S[s][R] = n(Y.x, Y.y, Y.z);
            for (s = 0; q > s; s++)
                for (R = 0; J > R; R++) c = z ? (s + 1) % q : s + 1, I = (R + 1) % J, D = S[s][R], O = S[c][R], P = S[c][I], x = S[s][I], k = new id(s / q, R / J), U = new id((s + 1) / q, R / J), G = new id((s + 1) / q, (R + 1) / J), v = new id(s / q, (R + 1) / J), this.faces.push(new Vh(D, O, x)), this.faceVertexUvs[0].push([k, U, v]), this.faces.push(new Vh(O, P, x)), this.faceVertexUvs[0].push([U.clone(), G, v.clone()]);
            this.computeFaceNormals(), this.computeVertexNormals()
        };
        mf.prototype = Eq(gh), mf.FrenetFrames = function(v, C, Y) {
            function Z() { D[0] = new Pp, i[0] = new Pp, U = Number.MAX_VALUE, r = X(S[0].x), L = X(S[0].y), $ = X(S[0].z), U >= r && (U = r, A.set(1, 0, 0)), U >= L && (U = L, A.set(0, 1, 0)), U >= $ && A.set(0, 0, 1), B.crossVectors(S[0], A).normalize(), D[0].crossVectors(S[0], B), i[0].crossVectors(S[0], D[0]) }
            var J, U, r, L, $, c, l, A = new Pp,
                S = [],
                D = [],
                i = [],
                B = new Pp,
                b = new rs,
                w = C + 1,
                P = 1e-4;
            for (this.tangents = S, this.normals = D, this.binormals = i, c = 0; w > c; c++) l = c / (w - 1), S[c] = v.getTangentAt(l), S[c].normalize();
            for (Z(), c = 1; w > c; c++) D[c] = D[c - 1].clone(), i[c] = i[c - 1].clone(), B.crossVectors(S[c - 1], S[c]), B.length() > P && (B.normalize(), J = W(Lr(S[c - 1].dot(S[c]), -1, 1)), D[c].applyMatrix4(b.makeRotationAxis(B, J))), i[c].crossVectors(S[c], D[c]);
            if (Y)
                for (J = W(Lr(D[0].dot(D[w - 1]), -1, 1)), J /= w - 1, S[0].dot(B.crossVectors(D[0], D[w - 1])) > 0 && (J = -J), c = 1; w > c; c++) D[c].applyMatrix4(b.makeRotationAxis(S[c], J * c)), i[c].crossVectors(S[c], D[c])
        };
        var vr = function(R, t, Y, s) {
            Yd.call(this), t = t || 18, Y = Y || 0, s = s == A ? m : s;
            for (var f = 1 / (R.length - 1), c = 1 / t, l = 0, r = t; r >= l; l++)
                for (var e = Y + l * c * s, T = C(e), j = N(e), S = 0, W = R.length; W > S; S++) {
                    var M = R[S],
                        o = new Pp;
                    o.x = T * M.x - j * M.y, o.y = j * M.x + T * M.y, o.z = M.z, this.vertices.push(o)
                }
            for (var g = R.length, l = 0, r = t; r > l; l++)
                for (var S = 0, W = R.length - 1; W > S; S++) {
                    var H = S + g * l,
                        G = H,
                        k = H + g,
                        T = H + 1 + g,
                        O = H + 1,
                        q = l * c,
                        F = S * f,
                        x = q + c,
                        d = F + f;
                    this.faces.push(new Vh(G, O, k)), this.faceVertexUvs[0].push([new id(q, F), new id(q, d), new id(x, F)]), this.faces.push(new Vh(k, O, T)), this.faceVertexUvs[0].push([new id(x, F), new id(q, d), new id(x, d)])
                }
            this.mergeVertices(), Mf(this), this.computeFaceNormals(), this.computeVertexNormals()
        };
        vr.prototype = Eq(gh);
        var Xl = function(X, y) {
            y = y || {};
            var R = Qk.generateShapes(X, y);
            y.amount = y.amount !== O ? y.amount : .5, y.convertYZ = !1, y.fill !== !1 && (y.bottom = !0, y.top = !0), Hl.call(this, R, y)
        };
        Xl.prototype = Eq(Bh);
        var xk = k.Node = function() { th(xk, this) },
            Uo = { X: gk, Y: tq, Z: bi },
            tj = { X: 0, Y: 1, Z: 2 },
            ed = { xyz: "XYZ", xzy: "XZY", yxz: "YXZ", yzx: "YZX", zxy: "ZXY", zyx: "ZYX" },
            Vi = "xzy",
            Wl = function(R, _, x) {
                if (_) {
                    var g = _[0],
                        X = _[1],
                        s = _[2];
                    "xzy" === x ? (tq(R, X), bi(R, s), gk(R, g)) : "xyz" === x ? (bi(R, s), tq(R, X), gk(R, g)) : "yxz" === x ? (bi(R, s), gk(R, g), tq(R, X)) : "yzx" === x ? (gk(R, g), bi(R, s), tq(R, X)) : "zxy" === x ? (tq(R, X), gk(R, g), bi(R, s)) : "zyx" === x ? (gk(R, g), tq(R, X), bi(R, s)) : (tq(R, X), bi(R, s), gk(R, g))
                }
            };
        fi("Node", Bq, {
            ms_ac: ["rotationMode", "anchorElevation"],
            ms_edge: !0,
            _adjustChildrenToTop: !0,
            _icon: "node_icon",
            _image: "node_image",
            _rotationMode: Vi,
            _64O: 0,
            _rotationX: 0,
            _53O: 0,
            _host: A,
            _position: { x: 0, y: 0 },
            _anchor: { x: .5, y: .5 },
            _anchorElevation: .5,
            _scale: { x: 1, y: 1 },
            _scaleTall: 1,
            _54O: 0,
            getUIClass: function() { return Bd },
            _22Q: function() { return Hs },
            getX: function() { return this.p().x },
            setX: function(r) { this.p(r, this.p().y) },
            getY: function() { return this.p().y },
            setY: function(n) { this.p(this.p().x, n) },
            getAnchorX: function() { return this.getAnchor().x },
            setAnchorX: function(f) { this.setAnchor(f, this.getAnchor().y) },
            getAnchorY: function() { return this.getAnchor().y },
            setAnchorY: function($) { this.setAnchor(this.getAnchor().x, $) },
            getScaleX: function() { return this.getScale().x },
            setScaleX: function(J) { this.setScale(J, this.getScale().y) },
            getScaleY: function() { return this.getScale().y },
            setScaleY: function(K) { this.setScale(this.getScale().x, K) },
            p: function() { return 0 === arguments.length ? this.getPosition() : (this.setPosition.apply(this, arguments), this) },
            p3: function() { return 0 === arguments.length ? this.getPosition3d() : (this.setPosition3d.apply(this, arguments), this) },
            s3: function() { return 0 === arguments.length ? this.getSize3d() : (this.setSize3d.apply(this, arguments), this) },
            r3: function() { return 0 === arguments.length ? this.getRotation3d() : (this.setRotation3d.apply(this, arguments), this) },
            setQuaternion: function(K) { var S = (new Mq).setFromQuaternion(K, Mq.ReverseOrder(this.getRotationMode())); return this.r3(S.x, S.y, S.z) },
            getQuaternion: function() {
                var i = new Mq,
                    c = new Mq,
                    V = new Wd;
                return function(B) { return B || (B = new Wd), this.getEuler(i), i.equals(c) ? B.copy(V) : B.copy(V.setFromEuler(c.copy(i))) }
            }(),
            getEuler: function(l) { var V = this.r3(); return l || (l = new Mq), l.set(V[0], V[1], V[2], Mq.ReverseOrder(this.getRotationMode())) },
            setEuler: function(P) { return P = P.clone().reorder(Mq.ReverseOrder(this.getRotationMode())), this.r3(P.x, P.y, P.z) },
            t3: function() { return this.translate3d.apply(this, arguments), this },
            translate3dBy: function(R, d) { yi(R, cq(A, A, this.r3(), this.getRotationMode())), this.translate3d(R[0] * d, R[1] * d, R[2] * d) },
            translateFront: function(s) { this.translate3dBy([0, 0, 1], s) },
            translateBack: function(B) { this.translate3dBy([0, 0, -1], B) },
            translateLeft: function(E) { this.translate3dBy([-1, 0, 0], E) },
            translateRight: function($) { this.translate3dBy([1, 0, 0], $) },
            translateTop: function(N) { this.translate3dBy([0, 1, 0], N) },
            translateBottom: function(B) { this.translate3dBy([0, -1, 0], B) },
            getPosition3d: function() { return [this._position.x, this._54O, this._position.y] },
            setPosition3d: function(E, m, I) { 1 === arguments.length && (m = E[1], I = E[2], E = E[0]), this.p(E, I), this.setElevation(m) },
            translate3d: function(G, z, g) { 1 === arguments.length && (z = G[1], g = G[2], G = G[0]), this.translate(G, g), this.setElevation(this._54O + z) },
            getSize3d: function() { return [this.getWidth(), this.getTall(), this.getHeight()] },
            setSize3d: function(X, J, Y) { 1 === arguments.length && (J = X[1], Y = X[2], X = X[0]), this.setSize(X, Y), this.setTall(J) },
            getRotation3d: function() { return [this._rotationX, -this._64O, this._53O] },
            setRotation3d: function(L, Y, P) { 1 === arguments.length && (Y = L[1], P = L[2], L = L[0]), this.setRotationX(L), this.setRotation(-Y), this.setRotationZ(P) },
            setRotationY: function(g) { this.setRotation(-g) },
            getRotationY: function() { return -this._64O },
            lookAtDirection: function(D, M) {
                M = M || Pi;
                var X = this,
                    b = _q(D);
                M === Pi ? (X.r3([-e(D[1] / b), -Cc(D[2], D[0]) + Z, 0]), X.setRotationMode("xzy")) : M === Ul ? (X.r3(0, -Cc(D[2], D[0]), e(D[1] / b)), X.setRotationMode("zyx")) : M === Ui ? (X.r3(0, -Cc(D[2], D[0]) + U, -e(D[1] / b)), X.setRotationMode("zyx")) : M === Gm ? (X.r3([-e(D[1] / b) + Z, -Cc(D[2], D[0]) + Z, 0]), X.setRotationMode("xzy")) : M === uq && (X.r3([-e(D[1] / b) - Z, -Cc(D[2], D[0]) + Z, 0]), X.setRotationMode("xzy")), M === Qj && (X.r3([-e(D[1] / b) + U, -Cc(D[2], D[0]) + Z, U]), X.setRotationMode("zxy"))
            },
            lookAt: function(q, F) { return this.lookAtDirection(zd(q, this.p3()), F) },
            lookAtX: function() {
                var T = new Cb,
                    h = new Cb,
                    z = new Cb,
                    U = new rs,
                    C = new rs,
                    Q = new Mq;
                return function(i, n) {
                    var s = Rp(this);
                    if (U.fromArray(s), z.copy(this.p3()), T.copy(i).sub(z), !(T.lengthSq() < 1e-6)) {
                        T.normalize(), n === Pi ? h.set(0, 0, 1) : n === Qj ? h.set(0, 0, -1) : n === Ui ? h.set(-1, 0, 0) : n === Ul ? h.set(1, 0, 0) : n === Gm ? h.set(0, 1, 0) : n === uq && h.set(0, -1, 0), h.applyMatrix4(U).sub(z).normalize();
                        var K = Math.acos(T.dot(h));
                        if (K) {
                            var Z = T.clone().cross(h);
                            Z.lengthSq() < 1e-6 && (n === Gm || n === uq ? Z.set(0, 0, 1).applyMatrix4(U).sub(z) : Z.set(0, 1, 0).applyMatrix4(U).sub(z)), Z.normalize(), Q.set(this.r3(), this.getRotationMode(), !0), U.makeRotationFromEuler(Q), C.makeRotationAxis(Z, -K), Q.setFromRotationMatrix(C.multiply(U)), this.r3([Q.x, Q.y, Q.z])
                        }
                    }
                }
            }(),
            getHost: function() { return this._host },
            setHost: function(N) {
                var D = this;
                if (D !== N && D._host !== N) {
                    var h = D._host;
                    h && h._removeAttach(D), D._host = N, D._host && D._host._addAttach(D), D.fp("host", h, N), D.onHostChanged(h, N)
                }
            },
            getAttaches: function() { return this._69O },
            _addAttach: function(M) {
                var j = this;
                j._69O || (j._69O = new En), j._69O.add(M), j.fp("attaches", A, M)
            },
            _removeAttach: function(m) {
                var U = this;
                U._69O.remove(m), U._69O.isEmpty() && delete U._69O, U.fp("attaches", m, A)
            },
            getImage: function() {
                if (this._pendingCheckImageJSON) {
                    var c = D.getImage(this._image);
                    c && (this._pendingCheckImageJSON = !1, this.getParent() instanceof Ae && this.getParent().checkPendingUpdateInfo())
                }
                return this._image
            },
            setImage: function(d) {

                var G = this,
                    D = G._image,
                    W = G.getWidth(),
                    w = G.getHeight();
                G._image = d, G.fp("image", D, d) && (null != d && (zg(d) || Ok(d) && /\.json$/i.test(d)) && (this._pendingCheckImageJSON = !0), G.fp(nn, W, G.getWidth()), G.fp(Cm, w, G.getHeight()))
            },
            getElevation: function() { return this._54O },
            setElevation: function(x) {
                var F = this;
                if (!F._50O) {
                    F._50O = 1;
                    var f = F._54O;
                    F._54O = x, F.fp(Le, f, x), delete this._50O
                }
            },
            getRotation: function() { return this._64O },
            setRotation: function(C) {
                var T = this;
                if (!T._49O) {
                    T._49O = 1;
                    var L = T._64O;
                    T._64O = C, T.fp(ij, L, C), delete T._49O
                }
            },
            getRotationX: function() { return this._rotationX },
            setRotationX: function(F) {
                var M = this;
                if (!M._51O) {
                    M._51O = 1;
                    var f = M._rotationX;
                    M._rotationX = F, M.fp("rotationX", f, F), delete M._51O
                }
            },
            getRotationZ: function() { return this._53O },
            setRotationZ: function(t) {
                var A = this;
                if (!A._52O) {
                    A._52O = 1;
                    var K = A._53O;
                    A._53O = t, A.fp("rotationZ", K, t), delete A._52O
                }
            },
            getPosition: function() { return this._position },
            setPosition: function(C, i) {
                var d = this;
                if (!d._50I) {
                    d._50I = 1;
                    var H;
                    if (H = 2 === arguments.length ? { x: C, y: i } : C, H.x !== d._position.x || H.y !== d._position.y) {
                        var z = d._position;
                        d._position = H, d.fp(Ne, z, H)
                    }
                    delete d._50I
                }
            },
            translate: function(Y, o) {
                var S = this._position;
                this.p(S.x + Y, S.y + o)
            },
            getWidth: function() { var L = this; if (L._width >= 0) return L._width; var S = L.getStyle("shape3d"); if (S) { var y = og(S); if (y && y.rawS3) return y.rawS3[0]; if ("billboard" === S || "plane" === S) { var R = Jc(L.getStyle("shape3d.image")); return R ? Hc(R, L) : 20 } } var R = Jc(L._image); return R ? Hc(R, L) : 20 },
            setWidth: function(a) {
                var i = this,
                    P = i._width;
                i._width = a, i.fp(nn, P, a)
            },
            getHeight: function() { var J = this; if (J._height >= 0) return J._height; var M = J.getStyle("shape3d"); if (M) { var g = og(M); if (g && g.rawS3) return g.rawS3[2]; if ("plane" === M) { var Z = Jc(J.getStyle("shape3d.image")); return Z ? Gp(Z, J) : 20 } if ("billboard" === M) return 2 } var Z = Jc(J._image); return Z ? Gp(Z, J) : 20 },
            setHeight: function(r) {
                var g = this,
                    G = g._height;
                g._height = r, g.fp(Cm, G, r)
            },
            getTall: function() { var V = this; if (V._tall >= 0) return V._tall; var i = V.getStyle("shape3d"); if (i) { var P = og(i); if (P && P.rawS3) return P.rawS3[1]; if ("billboard" === i) { var M = Jc(V.getStyle("shape3d.image")); return M ? Gp(M, V) : 20 } if ("plane" === i) return 2 } return 20 },
            setTall: function(x) {
                var m = this,
                    r = m._tall;
                m._tall = x, m.fp("tall", r, x)
            },
            setSize: function(N, D) {
                var c = this;
                2 === arguments.length ? (c.setWidth(N), c.setHeight(D)) : (c.setWidth(N.width), c.setHeight(N.height))
            },
            getSize: function() { return { width: this.getWidth(), height: this.getHeight() } },
            setRect: function(M, C, r, U, t) {
                var R = this,
                    j = R.getAnchor(),
                    L = R.getScale();
                arguments.length <= 2 && (t = C, C = M.y, r = M.width, U = M.height, M = M.x);
                var z = t && L.x < 0 ? 1 - j.x : j.x,
                    e = t && L.y < 0 ? 1 - j.y : j.y;
                R.p(M + r * z, C + U * e), t && (r /= Math.abs(L.x), U /= Math.abs(L.y)), R.setWidth(r), R.setHeight(U)
            },
            getMatrix: function() {
                var R = this,
                    c = R._64O,
                    k = R._position,
                    F = R.getScale();
                return new uf(c, k.x, k.y, F.x, F.y)
            },
            getMatrix4: function() {
                var P = new Cb,
                    s = new Wd,
                    u = new Cb;
                return function(r) { return this.getQuaternion(s), P.copy(this.p3()), u.copy(this.getFinalScale3d()), r || (r = new rs), r.compose(P, s, u) }
            }(),
            getAnchorRect: function() {
                var K = this,
                    L = K.getWidth(),
                    d = K.getHeight(),
                    X = K.getAnchor();
                return { x: -L * X.x, y: -d * X.y, width: L, height: d }
            },
            toLocal: function(U) { return this.getMatrix().tfi(U) },
            toGlobal: function(H) { return this.getMatrix().tf(H) },
            getAttachPosition: function() {
                var m = new uf;
                return function(F, P, w, Z) {
                    w = w || 0, Z = Z || 0;
                    var j = this,
                        E = j.getAnchor(),
                        R = j._64O,
                        C = j._position,
                        H = j.getScale();
                    return m.setFromTransform(R, C.x, C.y).tf({ x: w + H.x * j.getWidth() * (F - E.x), y: Z + H.y * j.getHeight() * (P - E.y) })
                }
            }(),
            isInRect: function(w) {
                w = this.toLocal(w);
                var Z = this.getWidth(),
                    Q = this.getHeight();
                return w.x += Z * this.getAnchorX(), w.y += Q * this.getAnchorY(), !(w.x < 0 || w.y < 0 || w.x > Z || w.y > Q)
            },
            getRect: function() {
                var Z = this,
                    C = Z.getWidth(),
                    W = Z.getHeight(),
                    N = Z.getAnchor(),
                    F = { x: -C * N.x, y: -W * N.y, width: C, height: W },
                    M = Z.getMatrix();
                return F = we([M.tf(F.x, F.y), M.tf(F.x + F.width, F.y), M.tf(F.x + F.width, F.y + F.height), M.tf(F.x, F.y + F.height)])
            },
            getAnchorElevation: function() { return this._anchorElevation },
            getAnchor3d: function() {
                var k = this,
                    K = k.getAnchor(),
                    s = k._anchorElevation;
                return { x: K.x, y: s, z: K.y }
            },
            setAnchorElevation: function(K) {
                var H = this,
                    U = H._anchorElevation;
                return U !== K ? (H._anchorElevation = K, H.fp("anchorElevation", U, K), !0) : !1
            },
            setAnchor3d: function(K, F, W, c) {
                var x, R = this;
                "number" == typeof K ? x = { x: K, y: F, z: W } : (x = K.length ? { x: K[0], y: K[1], z: K[2] } : K, c = F);
                var N = R.getDataModel();
                N && N.beginTransaction();
                var h = R.getAnchor3d(),
                    Q = R.setAnchor(x.x, x.z);
                if (R.setAnchorElevation(x.y) && (Q = !0), Q && c && !$k) {
                    R.getAnchor3d();
                    var z = Rp(R),
                        P = yi([x.x - h.x, x.y - h.y, x.z - h.z], z);
                    R.p3(P)
                }
                return N && N.endTransaction(), Q
            },
            getAnchor: function() { var w = this; if (w.hasOwnProperty("_anchor")) return w._anchor; var u = Jc(w._image); return u && u.anchorX !== O ? { x: u.anchorX, y: u.anchorY } : w._anchor },
            setAnchor: function(x, V, X) {
                var k, q = this;
                "number" == typeof x ? k = { x: x, y: V } : (k = x.length ? { x: x[0], y: x[1] } : x, X = V);
                var S = q.getAnchor();
                if (S.x !== k.x || S.y !== k.y) {
                    var E = q.getDataModel();
                    if (E && E.beginTransaction(), q._anchor = k, q.fp("anchor", S, k), X && !$k) {
                        var _ = q.getPosition(),
                            Q = q.getSize(),
                            s = q.getRotation(),
                            c = q.getScale(),
                            o = -Q.width * (S.x - k.x) * c.x,
                            r = -Q.height * (S.y - k.y) * c.y,
                            Z = N(s),
                            K = C(s);
                        q.setPosition(_.x + K * o - Z * r, _.y + Z * o + K * r)
                    }
                    return E && E.endTransaction(), !0
                }
                return !1
            },
            getLocalQuaternion: function(H) {
                var m = this,
                    x = m.getHost();
                if (!x) return m.getQuaternion();
                var B = x.getQuaternion(),
                    S = m.getQuaternion();
                return H || (H = new Wd), H.copy(B).inverse().multiply(S)
            },
            setLocalQuaternion: function(q) {
                var _ = this,
                    h = _.getHost();
                if (!h) return _.setQuaternion(q);
                var S = h.getQuaternion();
                _.setQuaternion(S.clone().multiply(q))
            },
            getLocalPosition3d: function(u) {
                var N = this;
                u || (u = new Cb), u.copy(N.p3());
                var W = N.getHost();
                if (!W) return u;
                var E = W.getMatrix4();
                return u.applyMatrix4(E.getInverse(E))
            },
            setLocalPosition3d: function(e) {
                var I = this,
                    L = I.getHost();
                if (!L) return e.x !== O ? I.p3(e.x, e.y, e.z) : I.p3(e), void 0;
                var S = L.getMatrix4(),
                    m = new Cb(e);
                m.applyMatrix4(S), I.p3(m.x, m.y, m.z)
            },
            getScale: function() { return this._scale },
            setScale: function(B, b) {
                var x, N = this;
                x = 2 === arguments.length ? { x: B, y: b } : B;
                var m = N.getScale();
                (m.x !== x.x || m.y !== x.y) && (N._scale = x, N.fp("scale", m, x))
            },
            getScaleTall: function() { return this._scaleTall },
            getScale3d: function() {
                var b = this,
                    V = b._scaleTall,
                    x = b.getScale();
                return [x.x, V, x.y]
            },
            getFinalScale3d: function() {
                var w = this,
                    Y = w.s3(),
                    I = w._dynamicScale3d,
                    $ = w.getScale3d();
                return Y && ($[0] *= Y[0], $[1] *= Y[1], $[2] *= Y[2]), I && ($[0] *= I[0], $[1] *= I[1], $[2] *= I[2]), $
            },
            getFinalRotation3d: function() { var q = this; return q._dynamicRotation || q.r3() },
            setScaleTall: function(t) {
                var X = this,
                    x = X._scaleTall;
                x !== t && (X._scaleTall = t, X.fp("scaleTall", x, t))
            },
            setScale3d: function(U, s, L) {
                var p, b = this;
                p = "number" == typeof U ? { x: U, y: s, z: L } : U.length ? { x: U[0], y: U[1], z: U[2] } : U, b.setScaleTall(p.y), b.setScale(p.x, p.z)
            },
            getCorners: function(R, t) {
                R == A && (R = 0), t == A && (t = R);
                var e = this,
                    l = e.getAnchor(),
                    v = e.getWidth(),
                    n = e.getHeight(),
                    P = -v * l.x - R,
                    B = -n * l.y - t,
                    H = v + 2 * R,
                    d = n + 2 * t,
                    c = e.getMatrix();
                return [c.tf(P, B), c.tf(P, B + d), c.tf(P + H, B + d), c.tf(P + H, B)]
            },
            getEditControlPoints: function(N, F, Z) {
                F == A && (F = 0), Z == A && (Z = F);
                var b = this,
                    u = b.getAnchor(),
                    M = b.getWidth(),
                    z = b.getHeight(),
                    t = -M * u.x - F,
                    X = -z * u.y - Z,
                    m = M + 2 * F,
                    r = z + 2 * Z;
                if (N) return [{ x: t, y: X }, { x: t, y: 0 }, { x: t, y: X + r }, { x: 0, y: X + r }, { x: t + m, y: X + r }, { x: t + m, y: 0 }, { x: t + m, y: X }, { x: 0, y: X }];
                var y = b.getMatrix();
                return [y.tf(t, X), y.tf(t, 0), y.tf(t, X + r), y.tf(0, X + r), y.tf(t + m, X + r), y.tf(t + m, 0), y.tf(t + m, X), y.tf(0, X)]
            },
            rotateAt: function(K, L, a) {
                var W = this,
                    o = W._position,
                    D = W._64O,
                    A = new uf(D, o.x, o.y).tf(K, L),
                    c = z(K * K + L * L),
                    x = Cc(o.y - A.y, o.x - A.x) + a;
                W.setRotation(D + a), W.p(A.x + c * C(x), A.y + c * N(x))
            },
            onParentChanged: function() { xk.superClass.onParentChanged.apply(this, arguments), this._8I() },
            onPropertyChanged: function() {
                var v = {};
                return "width|height|position|anchor|rotation|scale|s:layout.h|s:layout.v".split("|").forEach(function(g) { v[g] = !0 }),
                    function(X) {
                        var t = this;
                        xk.superClass.onPropertyChanged.call(t, X), v[X.property] && !t._layoutUpdating && t.updateLayoutParameters(null, X.property), t._69O && t._69O.each(function($) { $.handleHostPropertyChange(X) }), t._49I && t._49I.each(function(l) { l.fp("agentChange", !0, !1) }), "a:layout" === X.property.substring(0, 8) && this.updateAttach()
                    }
            }(),
            onHostChanged: function() { this.updateAttach(), this.updateLayoutParameters() },
            handleHostPropertyChange: function(V) { this.updateAttach(V) },
            onStyleChanged: function(t) { xk.superClass.onStyleChanged.apply(this, arguments), kh[t] && this.updateAttach() },
            updateAttach: function(Y) { var n = this; return $k ? (n.updateLayoutParameters(), void 0) : (n._51I || (n._51I = 1, n._71O(Y), delete n._51I), void 0) },
            _71O: function(h) {
                var i, O, H, s, t, f, n, T, J = this,
                    G = J._host,
                    b = h ? h.property : A,
                    S = h ? h.oldValue : A,
                    y = h ? h.newValue : A;
                if (G instanceof xk && (n = Jc(G.getImage()), n && n.layoutAttach && (T = n.layoutAttach)), h && !ke[b] && "a:layout" !== b.substring(0, 8) || !T || T(G, this))
                    if (G instanceof k.Grid) {
                        if (b === Le) J.setElevation(J._54O + y - S);
                        else if (!h || fo[b]) {
                            if (i = J.s("attach.row.index"), O = J.s("attach.column.index"), H = G.getCellRect(i, O), !H) return;
                            s = J.s("attach.row.span"), t = J.s("attach.column.span"), (1 !== s || 1 !== t) && (H = bp(H, G.getCellRect(i + s - 1, O + t - 1))), wr(H, J, "attach.padding", 1), J.setRect(H)
                        }
                    } else if (G instanceof Lj && (f = J.s("attach.index")) >= 0 && (!h || lr[b])) {
                    var I = J.s("attach.thickness"),
                        c = G.getScale(),
                        o = Math.max(c.x, c.y);
                    I > 0 && J.setHeight(G.getThickness() * I * o);
                    var X = J.s("attach.offset"),
                        d = G.getPoints(),
                        q = d.size();
                    if (q > f) {
                        var U = G.getPointsMatrix2d(),
                            Y = d.get(f),
                            C = q === f + 1 ? d.get(0) : d.get(f + 1);
                        Y = U.apply(Y), C = U.apply(C);
                        var z = [C.x - Y.x, C.y - Y.y],
                            $ = _q(z);
                        if ($) {
                            J.s("attach.offset.relative") && (X *= $), J.s("attach.offset.opposite") && (X = $ - X);
                            var K = { x: Y.x + z[0] / $ * X, y: Y.y + z[1] / $ * X },
                                W = J.s("attach.gap");
                            W && (J.s("attach.gap.relative") && (W *= G.getThickness() * o), K = Sd(A, K, C, W)), J.p(K), J.setRotation(Cc(z[1], z[0]))
                        }
                    }
                } else h && (b === Ne ? J.translate(y.x - S.x, y.y - S.y) : b === Le ? J.setElevation(J._54O + y - S) : ps[b] ? J._11Q(G, b, y - S) : ("anchor" === b || "width" === b || "height" === b || "scale" === b) && J.layout(G))
            },
            _11Q: function() {
                var r = new k.Math.Euler,
                    J = k.Math.Euler.ReverseOrder,
                    E = new k.Math.Vector2,
                    I = new k.Math.Vector2;
                return function(P, u, t) {
                    var j = this,
                        b = P.p3(),
                        n = P.r3(),
                        z = j.p3(),
                        p = j.r3();
                    if (u === ij && (u = "rotationY", t = -t), (u === ij || "rotationY" === u) && 0 === p[0] && 0 === p[2] && 0 === n[0] && 0 === n[2] && 0 === z[1] && 0 === b[1]) return j.setRotation(-p[1] - t), E.set(z[0], z[2]).rotateAround(I.set(b[0], b[2]), -t), j.p(E.x, E.y), void 0;
                    var i = ed[P.getRotationMode()],
                        l = i[0],
                        C = i[1],
                        O = i[2],
                        k = Uo[l],
                        Z = Uo[C],
                        R = Uo[O],
                        $ = ur();
                    u === ij + l ? (R($, n[tj[O]]), Z($, n[tj[C]]), k($, t), Z($, -n[tj[C]]), R($, -n[tj[O]])) : u === ij + C ? (R($, n[tj[O]]), Z($, t), R($, -n[tj[O]])) : u === ij + O && R($, t);
                    var o = zd(z, b);
                    yi(o, $), j.p3(b[0] + o[0], b[1] + o[1], b[2] + o[2]);
                    var D = j.getRotationMode();
                    Wl($, j.r3(), D), r.setFromRotationMatrix($, J(D)), j.r3([r.x, r.y, r.z])
                }
            }(),
            isHostOn: function(i) {
                var C = this;
                if (C._host && i && i._69O)
                    for (var U = {}, $ = C._host; $ && $ !== C && !U[$._id];) {
                        if ($ === i) return !0;
                        U[$._id] = $, $ = $._host
                    }
                return !1
            },
            isLoopedHostOn: function(B) { return this.isHostOn(B) && B.isHostOn(this) },
            getScaledSize: function() {
                var e = this.getSize(),
                    q = this.getScale();
                return e.width *= Math.abs(q.x), e.height *= Math.abs(q.y), e
            },
            layout: function(f) {
                if (f = f || this.getHost()) {
                    var U = this,
                        d = U.s("layout.h") || "center",
                        I = U.s("layout.v") || "center";
                    if ("center" !== d || "center" !== I) {
                        var q = new k.Math.Vector2,
                            n = f.getPosition(),
                            z = f.getAnchor(),
                            Y = f.getScaledSize();
                        U.getPosition();
                        var l, S, c, g, Q, v = 1,
                            o = 1;
                        switch (U._layoutUpdating = !0, d) {
                            case "left":
                                q.setX(U._layoutHValue - z.x * Y.width);
                                break;
                            case "right":
                                q.setX((1 - z.x) * Y.width - U._layoutHValue);
                                break;
                            case "leftright":
                                l = Y.width - U._layoutHValue[2], c = U.getRotation() - f.getRotation(), g = Math.abs(Math.sin(c)), Q = Math.abs(Math.cos(c)), v += Q * l / U._layoutHValue[3], o += g * l / U._layoutHValue[4], q.setX(U._layoutHValue[1] + (U._layoutHValue[5] - z.x) * Y.width);
                                break;
                            case "center":
                                q.setX((.5 - z.x) * Y.width - U._layoutHValue);
                                break;
                            case "scale":
                                c = U.getRotation() - f.getRotation(), g = Math.abs(Math.sin(c)), Q = Math.abs(Math.cos(c)), q.setX((.5 - z.x) * Y.width - U._layoutHValue[1] * Y.width / U._layoutHValue[0]), S = Y.width / U._layoutHValue[2] - 1, v += Q * S, o += g * S
                        }
                        switch (I) {
                            case "top":
                                q.setY(U._layoutVValue - z.y * Y.height);
                                break;
                            case "bottom":
                                q.setY((1 - z.y) * Y.height - U._layoutVValue);
                                break;
                            case "topbottom":
                                c || (c = U.getRotation() - f.getRotation(), g = Math.abs(Math.sin(c)), Q = Math.abs(Math.cos(c))), l = Y.height - U._layoutVValue[2], v += g * l / U._layoutVValue[3], o += Q * l / U._layoutVValue[4], q.setY(U._layoutVValue[1] + (U._layoutVValue[5] - z.y) * Y.height);
                                break;
                            case "center":
                                q.setY((.5 - z.y) * Y.height - U._layoutVValue);
                                break;
                            case "scale":
                                c || (c = U.getRotation() - f.getRotation(), g = Math.abs(Math.sin(c)), Q = Math.abs(Math.cos(c))), q.setY((.5 - z.y) * Y.height - U._layoutVValue[1] * Y.height / U._layoutVValue[0]), S = Y.height / U._layoutVValue[2] - 1, v += g * S, o += Q * S
                        }
                        if ("leftright" === d || "scale" === d || "topbottom" === I || "scale" === I) {
                            var P = this.getScale(),
                                G = Math.abs(P.x),
                                H = Math.abs(P.y);
                            "leftright" === d || "scale" === d ? U.setSize(U._layoutHValue[3] * v / G, U._layoutHValue[4] * o / H) : U.setSize(U._layoutVValue[3] * v / G, U._layoutVValue[4] * o / H)
                        }
                        q.rotateAround(null, f.getRotation()), this.setPosition(q.x + n.x, q.y + n.y), U._layoutUpdating = O
                    }
                }
            },
            updateLayoutParameters: function(Q, n) {
                if (Q = Q || this.getHost()) {
                    var c = this,
                        o = c.s("layout.h"),
                        p = c.s("layout.v");
                    if (o || p) {
                        var X, f, O, g, C, e, j = new k.Math.Vector2,
                            y = Q.getPosition(),
                            V = Q.getAnchor(),
                            H = Q.getScaledSize(),
                            $ = c.getPosition(),
                            J = c.getScaledSize();
                        switch (j.set($.x - y.x, $.y - y.y), j.rotateAround(null, -Q.getRotation()), o) {
                            case "left":
                                c._layoutHValue = j.x + V.x * H.width;
                                break;
                            case "right":
                                c._layoutHValue = -j.x + (1 - V.x) * H.width;
                                break;
                            case "center":
                                c._layoutHValue = -j.x + (.5 - V.x) * H.width;
                                break;
                            case "leftright":
                            case "scale":
                                "scale" === o ? X = -j.x + (.5 - V.x) * H.width : (f = c.getAnchor(), O = c.getRotation() - Q.getRotation(), g = Math.cos(O), C = Math.sin(O), e = -Math.min(-f.x * g + f.y * C, -f.x * g - (1 - f.y) * C, (1 - f.x) * g + f.y * C, (1 - f.x) * g - (1 - f.y) * C), X = j.x - (e - V.x) * H.width), "position" === n && "object" == typeof c._layoutHValue ? (c._layoutHValue[0] = H.width, c._layoutHValue[1] = X) : c._layoutHValue = [H.width, X, H.width, J.width, J.height, e]
                        }
                        switch (p) {
                            case "top":
                                c._layoutVValue = j.y + V.y * H.height;
                                break;
                            case "bottom":
                                c._layoutVValue = -j.y + (1 - V.y) * H.height;
                                break;
                            case "center":
                                c._layoutVValue = -j.y + (.5 - V.y) * H.height;
                                break;
                            case "topbottom":
                            case "scale":
                                "scale" === p ? X = -j.y + (.5 - V.y) * H.height : (O || (f = c.getAnchor(), O = c.getRotation() - Q.getRotation(), g = Math.cos(O), C = Math.sin(O)), e = -Math.min(-f.x * C - f.y * g, -f.x * C + (1 - f.y) * g, (1 - f.x) * C - f.y * g, (1 - f.x) * C + (1 - f.y) * g), X = j.y - (e - V.y) * H.height), "position" === n && "object" == typeof c._layoutVValue ? (c._layoutVValue[0] = H.height, c._layoutVValue[1] = X) : c._layoutVValue = [H.height, X, H.height, J.width, J.height, e]
                        }
                    }
                }
            },
            getSerializableProperties: function() { var k = xk.superClass.getSerializableProperties.call(this); return gp(k, { image: 1, host: 1, rotation: 1, rotationX: 1, rotationZ: 1, rotationMode: 1, position: 1, anchor: 1, anchorElevation: 1, scale: 1, scaleTall: 1, _width: 1, _height: 1, _tall: 1, elevation: 1 }), k }
        });
        var Cd = k.Edge = function(j, $) {
            var S = this;
            th(Cd, S), S.setSource(j), S.setTarget($)
        };
        fi("Edge", Bq, {
            ms_edge: !0,
            _icon: "edge_icon",
            getUIClass: function() { return As },
            _22Q: function() { return Js },
            getSource: function() { return this._source },
            getTarget: function() { return this._target },
            getSourceAgent: function() { return this._40I },
            getTargetAgent: function() { return this._41I },
            canSetSourceTarget: function(r) {
                if (r === this) return !1;
                if (Dj(r)) return !0;
                for (var f, x, Q, G, t, h = [this], d = -1, S = 0; S > d;)
                    if (d++, f = h[d], x = f._44I)
                        for (x = x.getArray(), G = 0, t = x.length; t > G; G++)
                            if (Q = x[G], Si(Q) && !(h.indexOf(Q) >= 0)) {
                                if (Q === r) return !1;
                                h.push(Q), S++
                            }
                return !0
            },
            setSource: function(K) {
                var i = this;
                if (i._source !== K && i.canSetSourceTarget(K)) {
                    var A = i._source;
                    i._source = K, A && A._16I(i), K && K._2I(i), i._7I(), i.fp("source", A, K)
                }
            },
            setTarget: function(E) {
                var G = this;
                if (G._target !== E && G.canSetSourceTarget(E)) {
                    var S = G._target;
                    G._target = E, S && S._18I(G), E && E._4I(G), G._7I(), G.fp("target", S, E)
                }
            },
            isLooped: function() { var q = this; return q._source === q._target && Dj(q._source) && Dj(q._target) },
            onPropertyChanged: function() {
                var O = this;
                O._49I && O._49I.each(function(J) { J.fp("agentChange", !0, !1) })
            },
            _7I: function() {
                var W, u = this,
                    L = wf(u);
                u._40I !== L && (W = this._40I, W && W._15I(u), u._40I = L, L && L._1I(u), u.fp("sourceAgent", W, L), Mi(W, u._41I), Mi(L, u._41I));
                var T = Wi(u);
                u._41I !== T && (W = u._41I, W && W._17I(u), u._41I = T, T && T._3I(u), u.fp("targetAgent", W, T), Mi(W, u._40I), Mi(T, u._40I))
            },
            _22I: function(C) { this._52I = C, this.fp("edgeGroup", !0, !1) },
            getEdgeGroup: function() { return this._52I },
            isEdgeGroupHidden: function() { var L = this; return L._52I && L._52I.get(0) !== L && !L.getStyle(Do) },
            getEdgeGroupSize: function() { return this._52I ? this._52I.size() : 1 },
            getEdgeGroupIndex: function() { return this._52I ? this._52I.indexOf(this) : 0 },
            isEdgeGroupAgent: function() {
                var K = this,
                    P = K._52I;
                return P && !K.getStyle(Do) && P.size() > 1 && K === P.get(0)
            },
            toggle: function() {
                this.beginTransaction();
                var Q = this._52I,
                    H = !this.s(Do);
                Q && Q.size() > 1 && (Q.each(function(g) { g.s(Do, H) }), Q.getSiblings().each(function(X) { X !== Q && X.each(function(J) { J.fp("edgeGroup", A, X) }) })), this.endTransaction()
            },
            setStyle: function(D, G) {
                (D === Go || "edge.segments" === D) && (G = sd(G)), Cd.superClass.setStyle.call(this, D, G)
            },
            onStyleChanged: function(k) { Cd.superClass.onStyleChanged.apply(this, arguments), _r[k] && Mi(this._41I, this._40I) },
            getSerializableProperties: function() { var o = Cd.superClass.getSerializableProperties.call(this); return gp(o, { source: 1, target: 1 }), o }
        });
        var No = k.Group = function() { th(No, this) };
        fi("Group", xk, {
            _image: "group_image",
            _icon: "group_icon",
            _57O: !1,
            getUIClass: function() { return be },
            onChildAdded: function() { No.superClass.onChildAdded.apply(this, arguments), this._81I() },
            onChildRemoved: function() { No.superClass.onChildRemoved.apply(this, arguments), this._81I() },
            _81I: function() {
                var z = this;
                if (!z._54I && !$k) {
                    var N = z.getChildrenRect();
                    N && (z._53I = 1, z.p(Hf(z.s("group.position"), N, z.getSize())), delete z._53I)
                }
            },
            getChildrenRect: function() { var Q, l = this; return l.eachChild(function(p) { Dj(p) && (Q = bp(Q, l.getChildRect(p))) }), Q },
            getChildRect: function(c) { var P; return Dj(c) && c.s(Sl) && (Er(c) && c.isExpanded() && c.eachChild(function(x) { P = bp(P, c.getChildRect(x)) }), !P && c.getRect && (P = c.getRect())), P },
            setPosition: function(S, I) {
                var Z = this;
                if (!Z._54I) {
                    var v;
                    v = 2 === arguments.length ? { x: S, y: I } : S, $k || Z._53I || (Z._54I = 1, Em(Z._children, v.x - Z._position.x, v.y - Z._position.y), delete Z._54I), No.superClass.setPosition.call(this, v)
                }
            },
            toggle: function() { this.setExpanded(!this.isExpanded()) },
            isExpanded: function() { return this._57O },
            setExpanded: function(c) {
                var j = this;
                if (j._57O !== c) {
                    var y = j._57O;
                    j._57O = c, j.fp("expanded", y, j._57O), j._fireInvalidateDeep(), j._8I()
                }
            },
            _fireInvalidateDeep: function() { this.eachChild(function(P) { Er(P) ? P._fireInvalidateDeep() : P.iv() }) },
            _8I: function() { No.superClass._8I.call(this), this.eachChild(function(W) { Dj(W) && W._8I() }) },
            onStyleChanged: function(h) { No.superClass.onStyleChanged.apply(this, arguments), "group.position" === h && this._81I() },
            getSerializableProperties: function() { var E = No.superClass.getSerializableProperties.call(this); return E.expanded = 1, E }
        });
        var em = k.Block = function() { th(em, this), this.s({ "shadow.cast": !1, "shadow.receive": !1 }) };
        fi("Block", xk, {
            _icon: "block_icon",
            _clickThroughEnabled: !1,
            _syncSize: !0,
            ms_ac: ["clickThroughEnabled", "syncSize"],
            getUIClass: function() { return Cn },
            _22Q: function() { return Is },
            onChildAdded: function() { em.superClass.onChildAdded.apply(this, arguments), this.updateFromChildren() },
            onChildRemoved: function() { em.superClass.onChildRemoved.apply(this, arguments), this.updateFromChildren() },
            _getBoundingBox: function() {
                function O(K, x, r) {
                    V.fromArray(Rp(x));
                    var o = x.getAnchor3d();
                    K.push((new Cb).set(0 - o.x, 0 - o.y, 0 - o.z).applyMatrix4(V).applyMatrix4(r)), K.push((new Cb).set(0 - o.x, 0 - o.y, 1 - o.z).applyMatrix4(V).applyMatrix4(r)), K.push((new Cb).set(0 - o.x, 1 - o.y, 0 - o.z).applyMatrix4(V).applyMatrix4(r)), K.push((new Cb).set(0 - o.x, 1 - o.y, 1 - o.z).applyMatrix4(V).applyMatrix4(r)), K.push((new Cb).set(1 - o.x, 0 - o.y, 0 - o.z).applyMatrix4(V).applyMatrix4(r)), K.push((new Cb).set(1 - o.x, 0 - o.y, 1 - o.z).applyMatrix4(V).applyMatrix4(r)), K.push((new Cb).set(1 - o.x, 1 - o.y, 0 - o.z).applyMatrix4(V).applyMatrix4(r)), K.push((new Cb).set(1 - o.x, 1 - o.y, 1 - o.z).applyMatrix4(V).applyMatrix4(r))
                }

                function v(E, q) {
                    var G = (new rs).makeRotationFromEuler(this.getEuler()).setPosition((new Cb).fromArray(this.p3()));
                    G.getInverse(G), E.forEach(function(i) { Dj(i) && O(q, i, G) })
                }
                var V = new rs;
                return function(Z, S) {
                    if (Z instanceof xk && (Z = [Z]), !Z || 0 === Z.length) return A;
                    var S = [];
                    v.call(this, Z, S);
                    var L = [1 / 0, 1 / 0, 1 / 0],
                        E = [-1 / 0, -1 / 0, -1 / 0];
                    return S.forEach(function(e) { L[0] = Math.min(e.x, L[0]), L[1] = Math.min(e.y, L[1]), L[2] = Math.min(e.z, L[2]), E[0] = Math.max(e.x, E[0]), E[1] = Math.max(e.y, E[1]), E[2] = Math.max(e.z, E[2]) }), { min: L, max: E }
                }
            }(),
            updateFromChildren: function() {
                var m = this;
                if (!$k && !m._updatingToChildren && m._syncSize && 0 !== m.size() && !m._freezeSyncFromChildren) {
                    var g = this._getBoundingBox(m.toChildren(Dj));
                    if (g) {
                        m._updatingFromChildren = 1;
                        var B = (new Cb).fromArray(this.getScale3d()),
                            V = (new Cb).fromArray(g.min),
                            L = (new Cb).fromArray(g.max),
                            G = D.blockMinSize,
                            x = new Cb,
                            S = L.clone().sub(V);
                        0 === S.x && x.setX(.5), 0 === S.y && x.setY(.5), 0 === S.z && x.setZ(.5);
                        var u = this._width == A || -1 === this._width,
                            k = new Cb(this.getAnchor3d());
                        if (u || this._anchorChanged || !this.s("keepPosition")) {
                            var O = k.clone().multiply(S).add(V).applyEuler(this.getEuler()).add((new Cb).fromArray(this.p3()));
                            this.p3([O.x, O.y, O.z])
                        } else {
                            var i = B.clone().multiply((new Cb).fromArray(this.s3())),
                                r = S.clone();
                            0 === r.x && r.setX(G), 0 === r.y && r.setY(G), 0 === r.z && r.setZ(G);
                            var b = k.clone().multiply(i),
                                w = b.clone().multiplyScalar(-1).sub(V).divide(r).add(b.divide(r)).add(x);
                            this.setAnchor3d(w.x, w.y, w.z)
                        }
                        var Y = new Cb(1, 1, 1).divide(B).multiply(S);
                        this.s3(Math.abs(Y.x), Math.abs(Y.y), Math.abs(Y.z)), delete m._updatingFromChildren
                    }
                }
            },
            setPosition: function($, d) {
                var k = this;
                if (!k._updatingToChildren) {
                    var W;
                    W = 2 === arguments.length ? { x: $, y: d } : $, $k || k._updatingFromChildren || (k._updatingToChildren = 1, Em(k._children, W.x - k._position.x, W.y - k._position.y), delete k._updatingToChildren), em.superClass.setPosition.call(this, W)
                }
            },
            setSize3d: function() { this.beginTransaction(), em.superClass.setSize3d.apply(this, arguments), this.endTransaction() },
            setTall: function(T) {
                var b = this;
                if (!b._updatingToChildren) {
                    this.beginTransaction(), T = K(T, D.blockMinSize);
                    var J = b.getTall();
                    if (T !== J && em.superClass.setTall.call(b, T), !$k && !b._updatingFromChildren) {
                        b._updatingToChildren = 1;
                        var I = T / J;
                        b._adjustChildTallOrScale(I, "size"), delete b._updatingToChildren, b.updateFromChildren()
                    }
                    this.endTransaction()
                }
            },
            setWidth: function(P) { return this.setSize(P, this.getHeight()) },
            setHeight: function(f) { return this.setSize(this.getWidth(), f) },
            setSize: function(G, O) {
                var u = D.blockMinSize;
                G = K(G, u), O = K(O, u);
                var t = this;
                if (!t._updatingToChildren) {
                    2 !== arguments.length && (O = G.height, G = G.width), this.beginTransaction();
                    var b = t.getWidth(),
                        h = t.getHeight();
                    if (G !== b && em.superClass.setWidth.call(t, G), O !== h && em.superClass.setHeight.call(t, O), !$k && !t._updatingFromChildren) {
                        t._updatingToChildren = 1;
                        var L = G / b,
                            d = O / h;
                        t._adjustChildScaleOrSize(L, d, "size"), delete t._updatingToChildren, t.updateFromChildren()
                    }
                    this.endTransaction()
                }
            },
            _adjustChildScaleOrSize: function(J, j, K) {
                var d = this;
                if (d._syncSize) {
                    var u = d.getPosition(),
                        x = d.getRotation();
                    d.getScale(), d.eachChild(function(X) {
                        if (Dj(X)) {
                            var q = X.getPosition(),
                                z = X.getRotation(),
                                v = X.getWidth(),
                                L = X.getHeight(),
                                $ = X.getScale(),
                                n = $.x * v,
                                O = $.y * L;
                            if (0 !== n && 0 !== O) {
                                var p = new uf(z, q.x, q.y, n, O);
                                p.translate(-u.x, -u.y), p.rotate(-x), z = Cc(p.b * Math.sign(n), p.a * Math.sign(n)), p.scale(J, j);
                                var E, w, R, c = C(z);
                                if (Math.abs(c) < .001 ? (E = N(z), w = p.b / E, R = -p.c / E) : (w = p.a / c, R = p.d / c), "scale" === K) X.setScale(w / v, R / L);
                                else if ("size" === K) {
                                    var _ = w / $.x,
                                        W = R / $.y;
                                    X.setScale(ej(w) * Math.abs($.x), ej(R) * Math.abs($.y)), X instanceof k.Shape ? (X.setWidthForce(Math.max(Math.abs(_), 1e-5)), X.setHeightForce(Math.max(Math.abs(W), 1e-5))) : X.setSize(Math.max(.01, Math.abs(_)), Math.max(.01, Math.abs(W)))
                                }
                                p.rotate(x), p.translate(u.x, u.y), X.setPosition(p.tx, p.ty)
                            }
                        }
                    })
                }
            },
            _calcChangeFactor: function(e, L, o, O) { var c, D, n, G; return c = X(e), D = X(o), n = c > D ? c / D : D / c, c = X(L), D = X(O), G = c > D ? c / D : D / c, K(n, G) },
            setElevation: function(A) {
                var Q = this;
                if (!Q._updatingToChildren) {
                    var a = Q.getElevation(),
                        h = A - a;
                    0 !== h && ($k || Q._updatingFromChildren || (Q._updatingToChildren = 1, Em(Q._children, 0, h, 0), delete Q._updatingToChildren), em.superClass.setElevation.apply(Q, arguments))
                }
            },
            setScaleTall: function(B) {
                var d = this;
                if (!d._updatingToChildren) {
                    var b = d.getScaleTall();
                    if (X(B) < .01 && (B = .01 * (ej(B) || ej(b))), em.superClass.setScaleTall.call(d, B), !$k && !d._updatingFromChildren) {
                        d._updatingToChildren = 1;
                        var x = B / b;
                        d._adjustChildTallOrScale(x, "size"), delete d._updatingToChildren, this.updateFromChildren()
                    }
                }
            },
            _adjustChildTallOrScale: function(i, m) {
                var y = this;
                if (y._syncSize) {
                    var l = y.getElevation();
                    y.eachChild(function(V) {
                        if (Dj(V))
                            if ("size" === m) {
                                var e = V.getTall();
                                0 > i && V.setScaleTall(-1 * V.getScaleTall()), V.setTall(Math.max(.01, Math.abs(e * i))), V.setElevation(l + (V.getElevation() - l) * i)
                            } else {
                                var P = V.getScaleTall();
                                V.setScaleTall(P * i)
                            }
                    })
                }
            },
            setAnchor3d: function() { if (!this._updatingToChildren) { this.beginTransaction(); var Q = em.superClass.setAnchor3d.apply(this, arguments); return Q && !$k && !this._updatingFromChildren && this._syncSize && (this._anchorChanged = 1, this.updateFromChildren(), delete this._anchorChanged), this.endTransaction(), Q } },
            setAnchor: function() {
                var $ = this;
                if (!$._updatingToChildren) {
                    var k = $.getAnchor(),
                        i = em.superClass.setAnchor.apply($, arguments);
                    if ($k || $._updatingFromChildren || !$._syncSize) return i;
                    $._updatingToChildren = 1;
                    var U = $.getAnchor();
                    $.getPosition();
                    var V = $.getSize(),
                        g = $.getScale(),
                        t = $.getRotation(),
                        Z = -V.width * g.x * (k.x - U.x),
                        h = -V.height * g.y * (k.y - U.y),
                        b = N(t),
                        M = C(t),
                        q = M * Z - b * h,
                        A = b * Z + M * h;
                    return $.eachChild(function(u) {
                        if (Dj(u)) {
                            var r = u.getPosition();
                            u.setPosition(r.x - q, r.y - A)
                        }
                    }), delete $._updatingToChildren, i
                }
            },
            setAnchorElevation: function() {
                var K = this;
                if (!K._updatingToChildren) {
                    var X = K.getAnchorElevation(),
                        O = em.superClass.setAnchorElevation.apply(K, arguments);
                    if ($k || K._updatingFromChildren || !K._syncSize) return O;
                    K._updatingToChildren = 1;
                    var V = K.getAnchorElevation(),
                        e = K.getTall(),
                        y = K.getScaleTall(),
                        G = -e * y * (X - V);
                    return K.eachChild(function(p) {
                        if (Dj(p)) {
                            var t = p.getElevation();
                            p.setElevation(t - G)
                        }
                    }), delete K._updatingToChildren, O
                }
            },
            setRotation: function(S) { this._updateChildrenRotation3d("rotation", S) },
            setRotationX: function(W) { this._updateChildrenRotation3d("rotationX", W) },
            setRotationZ: function(z) { this._updateChildrenRotation3d("rotationZ", z) },
            _updateChildrenRotation3d: function(s, p) {
                var L = this;
                if (!L._updatingToChildren) {
                    var X = L[df(s)]();
                    if (em.superClass[Sr(s)].call(L, p), !$k && !L._updatingFromChildren) {
                        L._updatingToChildren = 1;
                        var W = p - X;
                        L.eachChild(function(o) { Dj(o) && o._11Q(L, s, W) }), delete L._updatingToChildren
                    }
                }
            },
            setScale: function(k, t) {
                var f = this;
                if (!f._updatingToChildren) {
                    null == t && (t = k.y, k = k.x);
                    var N = f.getScale();
                    if (X(k) < .01 && (k = .01 * (ej(k) || ej(N.x))), X(t) < .01 && (t = .01 * (ej(t) || ej(N.y))), em.superClass.setScale.call(f, k, t), !$k && !f._updatingFromChildren) {
                        f._updatingToChildren = 1;
                        var e = k / N.x,
                            h = t / N.y;
                        f._adjustChildScaleOrSize(e, h, "size"), delete f._updatingToChildren, f.updateFromChildren()
                    }
                }
            },
            onPropertyChanged: function(k) { em.superClass.onPropertyChanged.call(this, k), "s:3d.visible" === k.property && this._invalidateChildrenBatch() },
            _invalidateChildrenBatch: function() {
                this.eachChild(function(D) {
                    (D.s("batch") || D.s("wf.geometry") || D.s("wf.visible")) && D.iv(), D instanceof em && D._invalidateChildrenBatch()
                })
            },
            getSerializableProperties: function() { var f = em.superClass.getSerializableProperties.call(this); return f.clickThroughEnabled = 1, f.syncSize = 1, f }
        });
        var Aq = k.Grid = function() { th(k.Grid, this) };
        fi("Grid", xk, {
            IRotatable: !1,
            _icon: "grid_icon",
            _image: A,
            getUIClass: function() { return sg },
            setRotation: function() {},
            getCellRect: function(l, h) {
                var n = this,
                    o = n.s("grid.row.count"),
                    T = n.s("grid.column.count");
                if (0 >= o || 0 >= T || 0 > l || l >= o || 0 > h || h >= T) return A;
                var j, Z, b, $ = n.getRect(),
                    w = n.s("grid.row.percents"),
                    U = n.s("grid.column.percents");
                if (wr($, n, "grid.border", -1), w && w._as && (w = w._as), U && U._as && (U = U._as), w && w.length === o) {
                    for (b = 0, j = 0; l > j; j++) b += $.height * w[j];
                    $.y += b, $.height = $.height * w[l]
                } else $.height = $.height / o, $.y += $.height * l;
                if (U && U.length === T) {
                    for (Z = 0, j = 0; h > j; j++) Z += $.width * U[j];
                    $.x += Z, $.width = $.width * U[h]
                } else $.width = $.width / T, $.x += $.width * h;
                return $f($, -n.s("grid.gap")), $
            }
        });
        var rn = k.Text = function() { th(rn, this), this.setSize(100, 50), this.s("text", "TEXT") };
        fi("Text", xk, { _icon: "text_icon", _image: "__text__", getUIClass: function() { return ls }, setWidth: function(o) { o || (o = .001), rn.superClass.setWidth.call(this, o) }, setHeight: function(f) { f || (f = .001), rn.superClass.setHeight.call(this, f) }, toLabel: function() { return this._displayName || this._name || this.s("text") } }), Dr("__text__", { width: { value: 100, isSafeFunc: !0, func: function(K) { return K ? K._width : 100 } }, height: { value: 50, isSafeFunc: !0, func: function(Y) { return Y ? Y._height : 50 } }, comps: [{ type: "text", relative: !0, rect: [0, 0, 1, 1], text: { func: "style@text" }, align: { func: "style@text.align" }, vAlign: { func: "style@text.vAlign" }, color: { func: "style@text.color" }, font: { func: "style@text.font" }, shadow: { func: "style@text.shadow" }, shadowColor: { func: "style@text.shadow.color" }, shadowBlur: { func: "style@text.shadow.blur" }, shadowOffsetX: { func: "style@text.shadow.offset.x" }, shadowOffsetY: { func: "style@text.shadow.offset.y" }, scaleX: { func: "style@text.scale.x" }, scaleY: { func: "style@text.scale.y" }, gradientPack: { func: "style@text.gradient.pack" } }] });
        var Lj = k.Shape = function() { th(Lj, this), this._59O = new En };
        Lj.__de__ = Zl, fi("Shape", xk, {
            ms_ac: ["thickness", "closePath"],
            _icon: "shape_icon",
            _thickness: 10,
            _closePath: !1,
            getUIClass: function() { return Rf },
            _22Q: function() { return Ks },
            getLength: function(K) { return Oj(vc(this._59O, this._58O, K, this._closePath)) },
            getSegments: function() { return this._58O },
            toSegments: function() { var N = this._58O; return N ? new En(N._as.slice(0)) : N },
            setSegments: function(v) {
                var M = this._58O;
                v = v ? ud(v) ? new En(v.slice(0)) : new En(v._as.slice(0)) : null, (M && v && M._as.join(",") !== v._as.join(",") || M !== v) && (this._58O = v, this.fp("segments", M, v))
            },
            getPoints: function() { return this._59O },
            toPoints: function() { var x = this._59O; return new En(x._as.slice(0)) },
            getPointsMatrix2d: function() {
                var G = this,
                    s = new zn.Matrix2d,
                    O = G.getPosition(),
                    x = G.getScale(),
                    p = G.getRotation();
                return s.translate(-O.x, -O.y).scale(x.x, x.y).rotate(p).translate(O.x, O.y), s
            },
            getPointsMatrix3d: function() {
                return function() {
                    var z = this,
                        g = new zn.Matrix4,
                        M = g.getElements(),
                        F = z.p3();
                    ge(M, F), Wl(M, z.getFinalRotation3d(), z.getRotationMode());
                    var v = z.getScale3d(),
                        j = z._dynamicScale3d;
                    return j && (v[0] *= j[0], v[1] *= j[1], v[2] *= j[2]), ro(M, v), ge(M, wo(F)), g
                }
            }(),
            setPoints: function(G, j) {
                var R = this,
                    e = R._59O;
                G = G ? ud(G) ? new En(G.slice(0)) : new En(G._as.slice(0)) : new En;
                var t, A, r, V, v, n;
                j && (t = R.getPosition(), n = new uf(R.getRotation(), 0, 0, R.getScale().x, R.getScale().y)), (e && G && e._as.join(",") !== G._as.join(",") || e !== G) && (R._59O = G, R.fs(), R.fp("points", e, G)), j && (A = R.getPosition(), r = A.x - t.x, V = A.y - t.y, v = n.tf(r, V), R.setPosition(A.x - r + v.x, A.y - V + v.y))
            },
            addPoint: function(z, o, k) {
                var Z = this.toPoints();
                Z.add(z, o), this.setPoints(Z, k)
            },
            setPoint: function(d, D, J) {
                var I = this.toPoints();
                I.set(d, D), this.setPoints(I, J)
            },
            removePointAt: function(V) {
                var _ = this.toPoints();
                _.removeAt(V), this.setPoints(_)
            },
            setWidthForce: function(g) {
                var L = this;
                if (!L._55I && !$k && L.getWidth()) {
                    L._55I = 1;
                    var o = L._position.x,
                        $ = g / L.getWidth(),
                        p = L.toPoints(),
                        R = new En;
                    1 !== $ && (p.each(function(j) { R.add({ x: (j.x - o) * $ + o, y: j.y, e: j.e }) }), L.setPoints(R), $q(L, [$, 0, 0, 1, o * (1 - $), 0]), L.fs()), delete L._55I
                }
                Lj.superClass.setWidth.call(L, g)
            },
            setWidth: function(k) { return this.setWidthForce(lq > k ? lq : k) },
            setHeightForce: function(u) {
                var v = this;
                if (!v._55I && !$k && v.getHeight()) {
                    v._55I = 1;
                    var T = v._position.y,
                        r = u / v.getHeight(),
                        l = v.toPoints(),
                        L = new En;
                    1 !== r && (l.each(function(V) { L.add({ x: V.x, y: (V.y - T) * r + T, e: V.e }) }), v.setPoints(L), $q(v, [1, 0, 0, r, 0, T * (1 - r)]), v.fs()), delete v._55I
                }
                Lj.superClass.setHeight.call(v, u)
            },
            setHeight: function(f) { return this.setHeightForce(lq > f ? lq : f) },
            setAnchorElevation: function(D) {
                var H = this;
                H._55I = !0;
                var b = H._updatingAnchor3d,
                    M = !$k && !b;
                if (M) {
                    var x, J = D,
                        o = H.getAnchorElevation(),
                        l = H.getTall();
                    x = l * (o - J), 0 !== x && H.shiftPointsElevation(x)
                }
                var p = Lj.superClass.setAnchorElevation.apply(H, arguments);
                return b || delete H._55I, p
            },
            getShapeElevation: function() {
                var v = this,
                    U = v._54O;
                return U - (v.getTall() || 0) * (v._anchorElevation - .5)
            },
            setAnchor3d: function(i, o, e, R) {
                var X, l = this;
                "number" == typeof i ? X = { x: i, y: o, z: e } : (X = i.length ? { x: i[0], y: i[1], z: i[2] } : i, R = o), l._55I = !0, l._updatingAnchor3d = !0;
                var S = l.getDataModel();
                if (S && S.beginTransaction(), !$k) {
                    var W = l.getAnchor3d(),
                        T = l.getSize(),
                        g = l.getTall(),
                        t = T.width * (W.x - X.x),
                        s = T.height * (W.z - X.z),
                        G = g * (W.y - X.y);
                    R || l.shiftPoints(t, s, G);
                    var f = l.p3()
                }
                var a = Lj.superClass.setAnchor3d.apply(l, arguments);
                if (!$k && R) {
                    var J = l.p3();
                    l.shiftPoints(J[0] - f[0] + t, J[2] - f[2] + s, J[1] - f[1] + G)
                }
                return S && S.endTransaction(), delete l._updatingAnchor3d, delete l._55I, a
            },
            setAnchor: function(q, y, D) {
                var G = this;
                G._55I = !0;
                var A = G._updatingAnchor3d,
                    T = !$k && !A;
                if (T) {
                    var K, b, P;
                    "number" == typeof q ? P = { x: q, y: y } : (P = q.length ? { x: q[0], y: q[1] } : q, D = y);
                    var F = G.getAnchor(),
                        d = G.getSize();
                    K = d.width * (F.x - P.x), b = d.height * (F.y - P.y), D || G.shiftPoints(K, b);
                    var n = G.getPosition()
                }
                var X = Lj.superClass.setAnchor.apply(G, arguments);
                if (T) {
                    var Q = G.getPosition();
                    D && G.shiftPoints(Q.x - n.x + K, Q.y - n.y + b)
                }
                return A || delete G._55I, X
            },
            shiftPoints: function(Y, V, n) {
                if (Y || V || n) {
                    var T = this,
                        h = T.getElevation() || 0,
                        p = T.toPoints(),
                        u = new En;
                    p.each(function(S) {
                        var P = S.e;
                        n && (P = (P == A ? h : P) + n), u.add({ x: S.x + Y, y: S.y + V, e: P })
                    }), T.setPoints(u), T.fs()
                }
            },
            shiftPointsElevation: function(L) { return this.shiftPoints(0, 0, L) },
            setPosition: function(N, L) {
                var C, w = this;
                if (!w._28Q) {
                    if (w._28Q = 1, !w._55I && !$k) {
                        C = 2 === arguments.length ? { x: N, y: L } : N;
                        var u = C.x - w._position.x,
                            W = C.y - w._position.y;
                        if (0 === u && 0 === W) return delete w._28Q, void 0;
                        w._55I = 1, w.shiftPoints(u, W), $q(w, [1, 0, 0, 1, u, W]), delete w._55I
                    }
                    Lj.superClass.setPosition.apply(w, arguments), delete w._28Q
                }
            },
            fs: function() { this.fireShapeChange() },
            _70I: function() { var L = this; if (2 !== L._59O.size()) return !1; var Z = L._58O; return Z ? 2 === Z.size() && 1 === Z.get(0) && 2 === Z.get(1) ? !0 : !1 : !0 },
            fireShapeChange: function() {
                var c = this;
                if (!c._55I && !$k) {
                    var V = we(c._59O);
                    V && (c._55I = 1, c.setRect(V), delete c._55I)
                }
                c.fp(ii, !1, !0)
            },
            getSerializableProperties: function() { var X = Lj.superClass.getSerializableProperties.call(this); return X.segments = 1, X.points = 1, X.thickness = 1, X.closePath = 1, X }
        });
        var Zn = k.Points = function() { th(Zn, this) };
        fi("Points", xk, {
            _22Q: function() { return Ns },
            setPoints: function(H) { this.points = H, this._pointsDirty = !0, this.fp("points", A, this.points) },
            setPoint: function(n, y) { this.points || (this.points = []), this.points[3 * n] = y[0], this.points[3 * n + 1] = y[1], this.points[3 * n + 2] = y[2], this._pointsDirty = !0, this.fp("points", A, this.points) },
            setPointsColor: function(U) { this.colors = U, this._colorsDirty = !0, this.fp("colors", A, this.colors) },
            setPointColor: function(o, i) { this.colors || (this.colors = []), i ? (i = Lf(i), this.colors[3 * o] = i[0], this.colors[3 * o + 1] = i[1], this.colors[3 * o + 2] = i[2]) : (this.colors[3 * o] = O, this.colors[3 * o + 1] = O, this.colors[3 * o + 2] = O), this._colorsDirty = !0, this.fp("colors", A, this.colors) },
            setPointsSize: function(V) { this.sizes = V, this._sizesDirty = !0, this.fp("sizes", A, this.sizes) },
            setPointSize: function(k, I) { this.sizes || (this.sizes = []), this.sizes[k] = I ? I : O, this._sizesDirty = !0, this.fp("sizes", A, this.sizes) },
            getPointInfo: function(c) {
                var z = 3 * c,
                    w = this.points;
                if (!w || w[z] === O || w[z + 1] === O || w[z + 2] === O) return null;
                var v = [w[z], w[z + 1], w[z + 2]],
                    q = this.mat || Rp(this),
                    T = [v[0], v[1], v[2]];
                yi(T, q);
                var M = this.colors;
                return { size: this.sizes && this.size[c] || this.s("points.size"), color: M && M[z] ? [M[z], M[z + 1], M[z + 2]] : this.s("points.color"), local: v, world: T }
            },
            getSerializableProperties: function() { var n = Zn.superClass.getSerializableProperties.call(this); return n.points = 1, n.colors = 1, n.sizes = 1, n }
        });
        var Gc = k.Polyline = function() { th(Gc, this), this.s({ "shape.background": null, "shape.border.width": 2 }) };
        fi("Polyline", Lj, {
            _icon: "polyline_icon",
            _22Q: function() { return Os },
            getUIClass: function() { return fp },
            setClosePath: function() {},
            setTall: function(q) {
                var E = this,
                    o = E.getDataModel();
                if (o && o.beginTransaction(), !E._55I && !E._24Q && !$k && E.getTall()) {
                    E._24Q = 1;
                    var S = E._54O,
                        i = q / E.getTall();
                    if (1 !== i) {
                        var U = E.toPoints(),
                            F = new En;
                        U.each(function(e) { F.add({ x: e.x, y: e.y, e: e.e == A ? e.e : (e.e - S) * i + S }) }), E.setPoints(F), E.fs()
                    }
                    delete E._24Q
                }
                Gc.superClass.setTall.call(E, q), o && o.endTransaction()
            },
            setElevation: function(t) {
                var H = this,
                    Y = H.getDataModel();
                if (Y && Y.beginTransaction(), !H._55I && !H._24Q && !$k) {
                    H._24Q = 1;
                    var I = t - H._54O;
                    0 !== I && H.shiftPointsElevation(I), delete H._24Q
                }
                Gc.superClass.setElevation.apply(H, arguments), Y && Y.endTransaction()
            },
            fireShapeChange: function() {
                var d = this,
                    I = d._59O;
                if (!d._55I && !d._24Q && !$k) {
                    var x = I.size();
                    if (x) {
                        var W = 1,
                            B = I.get(0),
                            c = d._54O;
                        B.e == A && (B.e = c);
                        for (var h = B.e, C = 0; x > W; W++) {
                            B = I.get(W), B.e == A && (B.e = c);
                            var q = i(h, B.e),
                                z = K(h + C, B.e);
                            h = q, C = z - q
                        }
                        d._24Q = 1, d.setTall(C), d.setElevation(h + C * d._anchorElevation), delete d._24Q
                    }
                }
                Gc.superClass.fireShapeChange.apply(d, arguments)
            }
        });
        var Kb = k.SubGraph = function() { th(Kb, this) };
        fi("SubGraph", xk, { ISubGraph: 1, _image: "subGraph_image", _icon: "subGraph_icon", _8I: function() { Kb.superClass._8I.call(this), this.eachChild(function(p) { Dj(p) && p._8I() }) } }), D.loadingRefGraph = 0;
        var Ae = k.RefGraph = function() { th(Ae, this) };
        fi("RefGraph", em, {
            _icon: "refGraph_icon",
            getRef: function() { return this._ref },
            setRef: function(W) {
                var q = this._ref;
                this._ref = W, this.fp("ref", q, W), this.updateRef()
            },
            _21I: function() { Ae.superClass._21I.apply(this, arguments), this.updateRef() },
            updateRef: function() {
                var j = this;
                if (D.loadingRefGraph++, j.clearChildrenFromDataModel(), D.loadingRefGraph--, j._ref && j._dataModel) {
                    j._xhrLoadHandler && (j._xhrLoadHandler.cancel = !0);
                    var M = $k,
                        y = j._xhrLoadHandler = function(q) {
                            if (q && j._dataModel) {
                                D.loadingRefGraph++;
                                var m = j._pendingUpdateInfo = { needToRestore: M };
                                M && (m.p3 = j.p3(), m.s3 = j.s3(), m.r3 = j.r3(), m.anchor3d = j.getAnchor3d(), m.scale3d = j.getScale3d()), j.r3(0, 0, 0), j.setScale3d(1, 1, 1), j.setAnchor3d(.5, .5, .5), j.p3(0, 0, 0);
                                var R = D.parse(q),
                                    T = j._dataModel.deserialize(R, j, { justDatas: !0 });
                                T.each(function(p) { p._refGraph = j }), j.checkPendingUpdateInfo(), D.loadingRefGraph--, D.handleRefGraphLoaded(j, T, R)
                            }
                        };
                    y.xhrLoadCalled = !1, D.load(j._ref, function(G) { y.cancel || (y.xhrLoadCalled ? y(G) : Lh(function() { y(G) })) }), y.xhrLoadCalled = !0
                }
            },
            checkPendingUpdateInfo: function() {
                var e = this,
                    $ = e._pendingUpdateInfo;
                if (!$) return e.onPendingUpdated && (D.loadingRefGraph++, e.onPendingUpdated(), D.loadingRefGraph--), void 0;
                var g = !0;
                this.eachChild(function(A) {
                    (A._pendingCheckImageJSON || A._pendingUpdateInfo) && (g = !1)
                }), g && (D.loadingRefGraph++, e._pendingUpdateInfo = null, e.updateFromChildren(), $.needToRestore && (e.setAnchor3d($.anchor3d), e.setScale3d($.scale3d), e.r3($.r3), e.p3($.p3)), this.getParent() instanceof Ae && this.getParent().checkPendingUpdateInfo(), e.onPendingUpdated && e.onPendingUpdated(), D.loadingRefGraph--)
            },
            getSerializableProperties: function() { var M = Ae.superClass.getSerializableProperties.call(this); return M.ref = 1, M }
        }), k.EdgeGroup = function(p, u) {
            this._70O = p, this._siblings = u;
            for (var M, T, o = 0, w = p.size(), S = h[Do]; w > o; o++)
                if (M = p.get(o).getStyle(Do, !1), M != A) { S = M; break }
            S == A && (S = !0);
            var J = D.edgeGroupAgentFunc;
            for (J && (T = J(p), T && T !== p.get(0) && (p.remove(T), p.add(T, 0))), o = 0; w > o; o++) p.get(o).s(Do, S)
        }, fi("EdgeGroup", n, { getEdges: function() { return this._70O }, size: function() { return this._70O.size() }, get: function(W) { return this._70O.get(W) }, indexOf: function(z) { return this._70O.indexOf(z) }, each: function($, S) { this._70O.each($, S) }, getSiblings: function() { return this._siblings }, eachSiblingEdge: function(M, k) { this._siblings.each(function(p) { p._70O.each(M, k) }) } });
        var _g = function(f, z, i) {
            var d = Ud[f] = { type: f, action: z };
            if (i)
                for (var P in i) d[P] = i[P]
        };
        gp(D, {
            setConnectAction: _g,
            getConnectAction: function(a, V) {
                if (!V) {
                    if (!a) return null;
                    V = a.getCurrentConnectActionType()
                }
                return Ud[V]
            },
            doConnectAction: function($, X, J, S) { S = S || $.getCurrentConnectActionType(); var M = Ud[S]; if (!M) return !1; var H = M.action; return H ? (X instanceof ie.Group ? $.sm().getSelection().each(function(W) { H.call(null, $, W, J) }) : H.call(null, $, X, J), !0) : !1 },
            doDeleteConnectionAction: function(Y, m, r) { r = r || Y.getCurrentConnectActionType(); var Q = Ud[r]; if (!Q || !Q.delete) return !1; var T = Q.delete.action; return T ? (m instanceof ie.Group ? Y.sm().getSelection().each(function(_) { T.call(null, Y, _) }) : T.call(null, Y, m), !0) : !1 }
        });
        var Yb = k.JSONSerializer = function(h, j) { this.dm = this._dataModel = h, this._hierarchical = D.forceHierarchicalSerialization ? !0 : j == A ? h.isHierarchicalRendering() : j };
        fi("JSONSerializer", n, {
            ms_ac: ["hierarchical"],
            serialize: function(z) { return D.stringify(this.toJSON(), z) },
            toJSON: function() {
                var J = this,
                    h = J.dm,
                    U = h.getRoots(),
                    m = J.json = { v: D.getVersion(), p: {}, a: {}, d: [] },
                    $ = h.getSerializableAttrs();
                h.getInit() && (m.init = h.getInit()), h.getName() && (m.p.name = h.getName()), h.getBackground() && (m.p.background = h.getBackground()), h.getLayers() && (m.p.layers = h.getLayers()), h.getEnvmap() && (m.p.envmap = h.getEnvmap()), h.isCubicEnvmap() && (m.p.cubicEnvmap = h.isCubicEnvmap()), m.p.autoAdjustIndex = h.isAutoAdjustIndex(), m.p.hierarchicalRendering = h.isHierarchicalRendering();
                for (var c in $) {
                    var S = h.a(c);
                    S !== O && J[Uf](c, S, m.a)
                }
                return ef(m.a) && delete m.a, J._hierarchical ? U.each(J.serializeData, this) : h.each(function(l) { J.serializeData(l) }), h.fireSerializeEvent({ type: "serialize", json: m }), h.getPostProcessingData() && (m.p.postProcessingData = h.getPostProcessingData()), m
            },
            isSerializable: function() { return !0 },
            getProperties: function(y) { return y.getSerializableProperties() },
            getStyles: function(D) { return D.getSerializableStyles() },
            getAttrs: function(H) { return H.getSerializableAttrs() },
            serializeData: function(I) {
                var d = this;
                if (d.isSerializable(I) && !I._refGraph) {
                    var Q, e, g, V, m = pm(I.getClassName()) || I.getClass(),
                        S = new m,
                        o = { c: I.getClassName(), i: I.getId(), p: {}, s: {}, a: {} };
                    d.json.d.push(o), Q = d.getProperties(I);
                    for (e in Q)
                        if (/^_/.test(e)) {
                            if (g = I[e], !("_width" !== e && "_height" !== e || g != A && -1 !== g)) {
                                var Z;
                                ((I.s("layout.h") || I.s("layout.v")) && I.getHost() || I instanceof k.Node && (Z = I.getParent()) && Z instanceof k.Block || I.s("fullscreen")) && (g = I[e] = "_width" === e ? I.getWidth() : I.getHeight())
                            }
                            g !== S[e] && d[Uf](e.substr(1), g, o.p)
                        } else V = df(e), I[V] && (g = I[V](), g !== S[V]() && d[Uf](e, g, o.p));
                    Q = d.getStyles(I);
                    for (e in Q) g = I.s(e), g !== S.s(e) && d[Uf](e, g, o.s);
                    Q = d.getAttrs(I);
                    for (e in Q) g = I.a(e), g !== S.a(e) && d[Uf](e, g, o.a);
                    ef(o.p) && delete o.p, ef(o.s) && delete o.s, ef(o.a) && delete o.a
                }
                d._hierarchical && I.getChildren().each(d.serializeData, d)
            },
            serializeValue: function(L, C, D) { is(C) ? C = { __a: C._as } : C instanceof Bq ? C = { __i: C.getId() } : C instanceof Fq && (C = { __dm: C.serialize(0) }), D[L] = C },
            deserialize: function(u, N, R) { var g = this; return Ok(u) && /.json$/.test(u) ? (D.xhrLoad(u, function(W) { g.deserializeImpl(W, N, R) }), void 0) : g.deserializeImpl(u, N, R) },
            deserializeImpl: function(f, l, S) {
                var j = this,
                    w = j.dm;
                w.setDeserializing(!0), S = Nl(S) ? { setId: S } : Fe(S) ? { finishFunc: S } : S || {}, f = j.json = Ok(f) ? D.parse(f) : f, !S.justDatas && f.a && f.a.onPreDeserialize && !S.disableOnPreDeserialize && f.a.onPreDeserialize(f, w, S.view), w.beginTransaction(), $k++, j._82I = {};
                var v = new En,
                    y = new En,
                    $ = 0,
                    O = f.d.length;
                if (S.justDatas || (!S.disableInit && Fe(f.init) && f.init(w), w.setInit(f.init)), !S.justDatas) { for (var i in f.a) w.a(i, j[Bs](f.a[i])); for (var g in f.p) w[Sr(g)](f.p[g]) }
                for (; O > $; $++) {
                    var H = f.d[$],
                        M = pm(H.c),
                        b = new M,
                        m = H.i;
                    S.setId && m != A && (b._id = m), j._82I[m] = b, v.add(b), y.add(H)
                }
                for ($ = 0; O > $; $++) j.deserializeData(v.get($), y.get($));
                return v.each(function(R) { l && !R.getParent() && R.setParent(l), w.add(R) }), S.__innerHandler__ && S.__innerHandler__(f, w, S.view, v), w.fireSerializeEvent({ type: "deserialize", json: f }), $k--, w.endTransaction(), !S.justDatas && f.a && f.a.onPostDeserialize && !S.disableOnPostDeserialize && f.a.onPostDeserialize(f, w, S.view, v), S.finishFunc && S.finishFunc(f, w, S.view, v), w.setDeserializing(!1), v
            },
            deserializeData: function(u, H) { for (var A in H.p) u[Sr(A)](this[Bs](H.p[A])); for (A in H.s) u.s(A, this[Bs](H.s[A])); for (A in H.a) u.a(A, this[Bs](H.a[A])) },
            deserializeValue: function(Y) { if (zg(Y)) { var F = Y.__i; if (F != A) return this._82I[F]; if (F = Y.__dm, F != A) { var $ = new k.DataModel; return $.deserialize(F), $ } if (F = Y.__a, ud(F)) return new En(F) } return Y }
        }), gp(Fq, { serialize: function(W, B) { return new Yb(this, B).serialize(W) }, toJSON: function(q) { return new Yb(this, q).toJSON() }, deserialize: function(Y, y, C) { return new Yb(this).deserialize(Y, y, C) } });
        var Rb = k.OverlappingBox = function(m) { this.gv = m, this.boxes = {} };
        fi("OverlappingBox", n, {
            clear: function() { var k, y, E = this.boxes; for (k in E) y = E[k], y.length = 0 },
            isOverlapping: function(m, R) {
                var n, x, b = this,
                    l = b.boxes,
                    S = l[m];
                S ? (n = S.rects, x = S.length) : S = l[m] = { rects: n = [], length: x = 0 };
                var W, k, R;
                for (W = 0; x > W; W++)
                    if (k = n[W], k.x < R.x + R.w && k.x + k.w > R.x && k.y < R.y + R.h && k.h + k.y > R.y) return !0;
                return n.length <= x ? (n.push(R), S.length++) : n[S.length++] = R, !1
            }
        }), gp(D, {
            fetch: function(w, G) {
                var I = "GET",
                    T = !1,
                    Y = null,
                    m = "";
                G && (I = G.method || "GET", T = G.sync, m = G.url, Y = G.data || null), w.open(I, m, !T), G.responseType ? w.responseType = G.responseType : G.overrideMimeType && w.overrideMimeType && w.overrideMimeType(G.overrideMimeType), w.send(Y)


            },
            convertImageSrc: function(V, c) { c && "function" == typeof c || (c = function() {}), c(V) }
        });
        var Gq = k.Request = function() { this._xhr = new XMLHttpRequest, this._onloadFunc = function() {}, this._errorFunc = function() {} };
        fi("Request", n, {
            _responseType: null,
            _overrideMimeType: "text/plain",
            send: function(K) {
                var r = this._xhr,
                    v = this.onload,
                    U = this.onerror;
                this.getResponseType() ? K.responseType = this.getResponseType() : this.getOverrideMimeType() && (K.overrideMimeType = this.getOverrideMimeType()), r.onload = v, r.onerror = U, D.fetch(r, K)

            },
            onload: function() {},
            onerror: function() {},
            getResponseType: function() { return this._responseType },
            setResponseType: function(g) {
                this._responseType = g
            },
            getOverrideMimeType: function() { return this._overrideMimeType },
            setOverrideMimeType: function(G) { this._overrideMimeType = G },
            getResponseText: function() { var C = this._xhr; return C.response || C.responseText }
        }), Rm.GraphView = function(c) {
            var N = this;
            N._24I = {}, N._34I = new En, N._25I = {}, N._56I = {}, N._view = oq(1, N), N._canvas = Sg(N._view), N.dm(c ? c : new Fq), this._coreInteractor = new tm(this), N.setEditable(!1), N.setScrollBarVisible(D.graphViewScrollBarVisible), N._initView()
        }, Fj("GraphView", n, {
            ms_v: 1,
            ms_gv: 1,
            ms_bnb: 1,
            ms_tip: 1,
            ms_dm: 1,
            ms_lp: 1,
            ms_fire: 1,
            ms_sm: 1,
            _49o: 1,
            ms_txy: 1,
            _52o: 1,
            _51o: 1,
            ms_ac: [gc, ml, Ep, To, "resettable", "editInteractor", Uq, "zoomable", "pannable", "rectSelectable", "autoScrollZone", jl, "movableFunc", "editableFunc", "pointEditableFunc", "rectEditableFunc", "rotationEditableFunc", "anchorEditableFunc", "rectSelectBackground", "rectSelectBorderColor", "editPointSize", "editPointBorderColor", "editPointBackground", "hoverDelay"],
            _zoomable: D.graphViewZoomable,
            _resettable: D.graphViewResettable,
            _pannable: D.graphViewPannable,
            _rectSelectable: D.graphViewRectSelectable,
            _autoScrollZone: D.graphViewAutoScrollZone,
            _rectSelectBackground: D.graphViewRectSelectBackground,
            _rectSelectBorderColor: D.graphViewRectSelectBorderColor,
            _editPointSize: D.graphViewEditPointSize,
            _editPointBorderColor: D.graphViewEditPointBorderColor,
            _editPointBackground: D.graphViewEditPointBackground,
            _scrollBarColor: aq,
            _scrollBarSize: Oq,
            _autoHideScrollBar: Br,
            _autoMakeVisible: Yc,
            _currentActionType: null,
            getCoreInteractor: function() { return this._coreInteractor },
            getLayers: function() { return this._dataModel.getLayers() },
            setLayers: function(T) { this._dataModel.setLayers(T) },
            setEditable: function(B) {
                var i = this,
                    z = i.__interactorMap__;
                if (!z) {
                    var p = Rm.XEditInteractor;
                    z = i.__interactorMap__ = { scrollBar: new Gg(i), select: new Yl(i), edit: p ? new p(i) : new un(i), text: new tb(i), move: new Oc(i), "default": new bf(i), touch: new lj(i, { editable: !1 }) }
                }
                B ? (i._uieditable = !0, i.setInteractors([z.scrollBar, z.select, z.edit, z.text, z.move, z.default, z.touch])) : (i._uieditable = !1, i.setInteractors([z.scrollBar, z.select, z.move, z.default, z.touch]))
            },
            getCanvas: function() { return this._canvas },
            _33I: function(v) { var l = v.getUIClass(); return l ? new l(this, v) : A },
            getDataUI: function(v) {
                var T = this,
                    t = T._25I[v._id];
                return t === O && (t = T._33I(v), T._25I[v._id] = t), t
            },
            getNodeRect: function(c) { return D.getNodeRect(this, c) },
            getFullscreenDatas: function() { return this._dataModel.getFullscreenDatas() },
            getEdgeInfo: function(K) { var N = this.getDataUI(K); return N ? (N._79o(), N._78o) : null },
            getEdgeSourcePosition: function(E) {
                var d = this,
                    P = d.getDataUI(E),
                    L = P.s,
                    Z = P._data._40I;
                return Cg(d, Z, L("edge.source.position"), L("edge.source.offset.x"), L("edge.source.offset.y"), L("edge.source.anchor.x"), L("edge.source.anchor.y"))
            },
            getEdgeTargetPosition: function(s) {
                var f = this,
                    u = f.getDataUI(s),
                    J = u.s,
                    r = u._data._41I;
                return Cg(f, r, J("edge.target.position"), J("edge.target.offset.x"), J("edge.target.offset.y"), J("edge.target.anchor.x"), J("edge.target.anchor.y"))
            },
            invalidateAll: function(U) {
                var f = this;
                if (U) {
                    for (var o in f._25I) {
                        var L = f._25I[o];
                        L && L.dispose()
                    }
                    f._25I = {}, f._56I = {}, f._24I = {}, f._34I.clear(), f.redraw()
                } else f.dm().each(function(i) { f.invalidateData(i) })
            },
            invalidateSelection: function() {
                var s = this;
                s.sm().each(function(q) { s.invalidateData(q) })
            },
            invalidateData: function(B) {
                var o = this;
                o._24I[B._id] = B, o._21Q(B), o.iv()
            },
            _21Q: function(n) {
                var Q = this,
                    I = Q._24I;
                if (Si(n) && fq[n.s(Lk)]) {
                    var d = n.getSourceAgent();
                    d && d.getAgentEdges().each(function(o) { I[o._id] = o }), d = n.getTargetAgent(), d && d.getAgentEdges().each(function(E) { I[E._id] = E }), Q.iv()
                }
            },
            redraw: function(R) {
                var v = this;
                v._32I || (R ? v._34I.add(R) : (v._32I = 1, v._34I.clear()), v.iv())
            },
            each: function(t, M) {
                var v, u, j, N = 0,
                    q = this.getLayers(),
                    l = this._dataModel,
                    X = l._datas._as,
                    E = X.length;
                if (q) {
                    for (var J = q.length; J > N; N++)
                        if (j = q[N], zg(j) && (j = j.name), l.isHierarchicalRendering()) { var I = function(w) { return w._layer === j ? M ? t.call(M, w) : t(w) : void 0 }; if (this._dataModel.eachByHierarchical(I) === !1) return } else
                            for (var C = 0; E > C; C++)
                                if (v = X[C], v._layer === j && (u = M ? t.call(M, v) : t(v), u === !1)) return
                } else if (l.isHierarchicalRendering()) this._dataModel.eachByHierarchical(t, null, M);
                else
                    for (; E > N; N++)
                        if (v = X[N], u = M ? t.call(M, v) : t(v), u === !1) return
            },
            reverseEach: function(I, Y) {
                var w, J, k, O, g = this._dataModel,
                    j = g._layers,
                    G = g._datas._as,
                    m = G.length;
                if (j) {
                    for (w = j.length - 1; w >= 0; w--)
                        if (O = j[w], zg(O) && (O = O.name), g.isHierarchicalRendering()) { var l = function(U) { return U._layer === O ? Y ? I.call(Y, U) : I(U) : void 0 }; if (g.reverseEachByHierarchical(l) === !1) return } else
                            for (var A = m - 1; A >= 0; A--)
                                if (J = G[A], J._layer === O && (k = Y ? I.call(Y, J) : I(J), k === !1)) return
                } else if (g.isHierarchicalRendering()) g.reverseEachByHierarchical(I, null, Y);
                else
                    for (w = m - 1; w >= 0; w--)
                        if (J = G[w], k = Y ? I.call(Y, J) : I(J), k === !1) return
            },
            getViewRect: function() { return this._29I },
            getContentRect: function() {
                var b = this,
                    R = b._84I;
                if (!R) {
                    var k = this.dm().a("width"),
                        e = this.dm().a("height");
                    k > 0 && e > 0 ? b._84I = { x: 0, y: 0, width: k, height: e } : (b.each(function(i) { b.isVisible(i) && (R = bp(R, b.getDataUIBounds(i))) }), b._84I = R ? R : Xo)
                }
                return b._84I
            },
            getScrollRect: function() { return bp(this.getContentRect(), this._29I) },
            makeCenter: function(D, v, O) {
                var s = this;
                if (!s.getWidth() || !s.getHeight()) return O || Lh(s.makeCenter, s, [D, v, !0], 500), void 0;
                s.makeVisible(D), s.validate();
                var t = s.getDataUIBounds(D);
                if (t) {
                    var d = s.getWidth(),
                        M = s.getHeight(),
                        c = t.x + t.width / 2,
                        n = t.y + t.height / 2,
                        r = -c * s._zoom + d / 2,
                        T = -n * s._zoom + M / 2;
                    s.setTranslate(r, T, v)
                }
            },
            fitData: function(M, e, F, n, d) {
                var Y = this;
                if (!Y.getWidth() || !Y.getHeight()) return d || Lh(Y.fitData, Y, [M, e, F, n, !0], 500), void 0;
                var G = function() {
                    Y.makeVisible(M), Y.validate();
                    var W = Y.getDataUIBounds(M);
                    W && (W = tf(W), $f(W, F == A ? 20 : F), Y.fitRect(W, e, n))
                };
                e ? D.callWhenLoaded(G) : G()
            },
            fitContent: function(f, d, u, W) {
                var $ = this;
                if (!$.getWidth() || !$.getHeight()) return W || Lh($.fitContent, $, [f, d, u, !0], 500), void 0;
                var R = function() {
                    $.validate();
                    var w = tf($.getContentRect());
                    $f(w, d == A ? 20 : d), $.fitRect(w, f, u)
                };
                f ? D.callWhenLoaded(R) : R()
            },
            fitRect: function(g, G, E) {
                var o = this,
                    V = o.getWidth(),
                    n = o.getHeight(),
                    p = g.x + g.width / 2,
                    T = g.y + g.height / 2,
                    X = i(V / g.width, n / g.height),
                    y = o._zoom,
                    d = -p * y + V / 2,
                    J = -T * y + n / 2;
                0 === X || isNaN(X) || (E && (X = i(1, X)), G ? (o._65I && (delete o._65I.finishFunc, o._65I.stop(!0)), o._14o && o._14o.stop(!0), o.setTranslate(d, J, { finishFunc: function() { o.setZoom(X, G) } })) : (o.setTranslate(d, J), o.setZoom(X)))
            },
            fitSelection: function(f, x, O) {
                var A = this,
                    q = A.sm(),
                    P = null;
                q.size() && (q.each(function(U) { P = bp(A.getDataUIBounds(U), P) }), f && $f(P, f), A.fitRect(P, x, O))
            },
            toCanvas: function(n, C, L) {
                C = C || this._zoom, this.validateImpl();
                var w = this,
                    d = w.getContentRect();
                L && $f(d, L), d.width || (d.width = 10), d.height || (d.height = 10);
                var Y = Sg(),
                    o = d.x * C,
                    Z = d.y * C,
                    V = Math.ceil(d.width * C),
                    H = Math.ceil(d.height * C);
                Cq(Y, V, H, 1);
                var m = Bp(Y);
                return n = n || this._dataModel.getBackground(), n && re(m, 0, 0, V, H, n), ts(m, -o, -Z), m.scale(C, C), w._42(m), m.restore(), Y
            },
            toDataURL: function(B, C, u, M) { return this.toCanvas(B, u, M).toDataURL(C || "image/png", 1) },
            getClipBounds: function() { return this._74O },
            _42: function(J, E) {
                var O = this,
                    H = O.dm().getBackground();
                if (H) {
                    var t = O.dm().a("width"),
                        s = O.dm().a("height");
                    t > 0 && s > 0 && re(J, 0, 0, t, s, H)
                }
                var c = O.__htmlOrderList,
                    z = [],
                    A = O._forcedLayoutHTML;
                if (O._93db(J, E), O.each(function(G) {
                        var T = O.getDataUI(G);
                        if (T) {
                            var q = O._56I[G._id],
                                i = T._htmlView;
                            if (q) {
                                var o = T._79o();
                                if (i = T._htmlView, k.HtmlNode && G instanceof k.HtmlNode) T._42(J);
                                else {
                                    var r = O.getViewRect(),
                                        P = i && i.layoutHTML;
                                    !E || Jk(E, o) ? (P && (i.layoutHTML(), T.__outerLayout && delete T.__outerLayout), T._42(J)) : Jk(r, o) || !P || T.__outerLayout && !A || (i.layoutHTML(), T.__outerLayout = !0)
                                }
                            }
                            i && (z.push(i), i.getView && (i = i.getView()), i.style.display = q ? "block" : xo)
                        }
                    }), c && z.length > 0) {
                    var Q = !1;
                    if (c.length !== z.length) Q = !0;
                    else
                        for (var K = 0; K < z.length; K++)
                            if (z[K] !== c[K]) { Q = !0; break }
                    Q && (z.forEach(function(D) { D.autoAdjustIndex !== !1 && O.appendHTML(D, !0) }), this.__htmlOrderList = z)
                } else this.__htmlOrderList = z;
                O._92db(J, E)
            },
            validateImpl: function() {
                this.tryUpdateRootData();
                var f, D, m, h, Y, s = this,
                    H = s.tx(),
                    t = s.ty(),
                    g = s._zoom,
                    c = s._canvas,
                    B = this.getWidth(),
                    i = this.getHeight(),
                    O = s._29I,
                    S = { x: -H / g, y: -t / g, width: B / g, height: i / g },
                    F = {},
                    G = s._34I,
                    y = s._24I,
                    I = s._32I,
                    Z = s._23I;
                s._24I = {}, (B !== c.clientWidth || i !== c.clientHeight) && (Cq(c, B, i), I = 1, s._forcedLayoutHTML = 1), I || Me(S, O) || (I = 1, s._forcedLayoutHTML = 1), s._29I = S, s.each(function(x) {
                    D = x._id;
                    var A = F[D] = s.isVisible(x);
                    A !== s._56I[D] && (y[D] = x, m = s.getDataUI(y[D]), m && m._84o(A), s._84o(x, A))
                }, s);
                for (D in y) m = s.getDataUI(y[D]), m && (!I && s._56I[D] && (Y = m._79o(), Y && G.add(Y)), m.invalidate()), s._83I = 1;
                if (s._56I = F, !I)
                    for (D in y) F[D] && (m = s.getDataUI(y[D]), m && (Y = m._79o(), Y && G.add(Y)));
                if (I ? h = S : (G.each(function(v) { Jk(S, v) && (h = bp(h, v)) }), h && ($f(h, K(1, 1 / g)), h.x = w(h.x * g) / g, h.y = w(h.y * g) / g, h.width = x(h.width * g) / g, h.height = x(h.height * g) / g, h = _i(S, h))), s._74O = h, h && 0 !== h.width && 0 !== h.height) {
                    f = Bp(c);
                    var u = h.x,
                        $ = h.y,
                        n = h.width,
                        a = h.height;
                    u = Math.floor((u * g + H) * fs), $ = Math.floor(($ * g + t) * fs), n = Math.ceil(n * g * fs) + 1, a = Math.ceil(a * g * fs) + 1, I || (h.x = (u / fs - H) / g, h.y = ($ / fs - t) / g, h.width = n / fs / g, h.height = a / fs / g), f.beginPath(), f.rect(u, $, n, a), f.clip(), f.clearRect(u, $, n, a), Yk(f, H, t, g), s._42(f, h), f.restore(), delete s._74O
                }
                if (G.clear(), delete s._32I, delete s._forcedLayoutHTML, Z && B > 0 && i > 0) {
                    var m = s.getDataUI(Z);
                    if (m) {
                        var Y = m._79o(),
                            V = s._29I,
                            E = V.x,
                            z = V.y,
                            N = V.width,
                            o = V.height,
                            g = s._zoom;
                        Y && !Jk(Y, V) && (Y.x + Y.width < E && s.tx(-Y.x * g), Y.x > E + N && s.tx(-(Y.x + Y.width - N) * g), Y.y + Y.height < z && s.ty(-Y.y * g), Y.y > z + o && s.ty(-(Y.y + Y.height - o) * g))
                    }
                    delete s._23I
                }
                s._83I && (delete s._83I, delete s._84I), s._98O(), s.countFrame(), ef(s._24I) || Lh(s.iv, s)
            },
            isValidGuideLineSource: function() { return !0 },
            tryUpdateRootData: function() {
                if (!this._rootDataUpdating) {
                    this._rootDataUpdating = !0;
                    var x, e = this.getFullscreenDatas();
                    for (var g in e) x = e[g], this.scaleRootData(x);
                    this.onRootDataUpdated && this.onRootDataUpdated(), this._rootDataUpdating = !1
                }
            },
            scaleRootData: function(K) {
                var M = K.s("fullscreen");
                if ("uniform" === M || "fill" === M) {
                    K.getRotation() && K.setRotation(0);
                    var _ = K.s("fullscreen.gap") || 0,
                        U = this.getWidth(),
                        Q = this.getHeight();
                    if (U && Q) {
                        var N, h, C, q = U - 2 * _,
                            n = Q - 2 * _,
                            E = K.getAnchor(),
                            O = K.getScaledSize(),
                            m = O.width,
                            I = O.height,
                            u = K.s("fullscreen.lock");
                        if (u) return "uniform" === M ? q / n > m / I ? (N = n / I, m = I * q / n) : (N = q / m, I = m * n / q) : "v" === u ? (N = n / I, m = q / N, K.getWidth() !== m && K.setWidth(m)) : (N = q / m, I = n / N, K.getHeight() !== I && K.setHeight(I)), this.setZoom(N), h = _ - (K.getX() - E.x * m) * N, C = _ - (K.getY() - E.y * I) * N, h !== this.tx() && this.tx(h), C !== this.ty() && this.ty(C), void 0;
                        h = this.tx(), C = this.ty(), N = this._zoom;
                        var R = { x: (-h + _) / N, y: (-C + _) / N, width: q / N, height: n / N };
                        if ("uniform" === M) {
                            var y = m / I,
                                f = Math.min(R.width, R.height * y),
                                e = f / y;
                            R.x += .5 * (R.width - f), R.y += .5 * (R.height - e), R.width = f, R.height = e
                        }
                        q = R.width / K.getScaleX(), n = R.height / K.getScaleY(), (K.getWidth() != q || K.getHeight() !== n) && K.setSize(q, n);
                        var Z = R.x + E.x * R.width,
                            w = R.y + E.y * R.height,
                            b = K.getPosition();
                        (Z !== b.x || w !== b.y) && K.setPosition(Z, w)
                    }
                }
            },
            isScrollBarVisible: function() { return !!this._79O },
            setScrollBarVisible: function(S) {
                var _ = this;
                S !== _.isScrollBarVisible() && (S ? (Ml(_._view, _._79O = sf()), Ml(_._79O, _._27I = sf()), Ml(_._79O, _._28I = sf())) : (tp(_._79O), delete _._79O, delete _._27I, delete _._28I), _.fp("scrollBarVisible", !S, S))
            },
            getDebugTip: function() { return "" },
            showScrollBar: function() {
                var e = this;
                e._79O && (e._85I || (Ig(function() { e._86I() }, Bg), e.iv()), e._85I = new Date)
            },
            _86I: function() {
                var a = this;
                if (a._85I) {
                    var g = new Date,
                        i = g.getTime();
                    i - a._85I.getTime() >= Bg ? (delete a._85I, a.iv()) : Ig(function() { a._86I() }, Bg)
                }
            },
            getVScrollBar: function() { return this._27I },
            getHScrollBar: function() { return this._28I },
            _98O: function() {
                var B = this,
                    x = this._27I,
                    E = this._28I;
                if (B._79O) {
                    if (B._autoHideScrollBar && !B._85I) return x.style.visibility = gm, E.style.visibility = gm, void 0;
                    var M = B.getScrollBarColor(),
                        m = B._zoom,
                        p = B.getScrollBarSize(),
                        h = B.getViewRect(),
                        I = B.getScrollRect(),
                        g = h.height * m,
                        $ = I.height * m,
                        G = h.width * m - p - 2,
                        e = g * ((h.y - I.y) * m / $),
                        U = g * (g / $),
                        k = x.style;
                    $ - .5 > g ? (ji > U && (e = e + U / 2 - ji / 2, 0 > e && (e = 0), e + ji > g && (e = g - ji), U = ji), dq(x, G, e, p, U), k.visibility = fn, k.background = M, k.borderRadius = p / 2 + dd) : k.visibility = gm;
                    var R = h.width * m,
                        v = I.width * m,
                        e = h.height * m - p - 2,
                        G = R * ((h.x - I.x) * m / v),
                        l = R * (R / v),
                        k = E.style;
                    v - .5 > R ? (ji > l && (G = G + l / 2 - ji / 2, 0 > G && (G = 0), G + ji > R && (G = R - ji), l = ji), dq(E, G, e, l, p), k.visibility = fn, k.background = M, k.borderRadius = p / 2 + dd) : k.visibility = gm
                }
            },
            setDataModel: function(x) {
                var q = this,
                    P = q._dataModel,
                    D = q._selectionModel;
                P !== x && (P && (P.ump(q.handleDataModelPropertyChange, q), P.umm(q.handleDataModelChange, q), P.umd(q.handleDataPropertyChange, q), P.removeIndexChangeListener(q._75O, q), P.removeHierarchyChangeListener(q.handleHierarchyChange, q), D || P.sm().ums(q.handleSelectionChange, q)), q._dataModel = x, x.mp(q.handleDataModelPropertyChange, q), x.mm(q.handleDataModelChange, q), x.md(q.handleDataPropertyChange, q), x.addIndexChangeListener(q._75O, q), x.addHierarchyChangeListener(q.handleHierarchyChange, q), D ? D._21I(x) : x.sm().ms(q.handleSelectionChange, q), q.invalidateAll(!0), q.fp(ll, P, x), q.updateBackground())
            },
            getLayersInfo: function() {
                if (this._layersInfo === O) {
                    var K = this.getLayers();
                    K ? (this._layersInfo = {}, K.forEach(function(T) {
                        var U = zg(T) ? T.name : T;
                        this._layersInfo[U] = T
                    }, this)) : this._layersInfo = null
                }
                return this._layersInfo
            },
            calculateEdgePosition: function(Q, k, b) {
                var n, d, R = this,
                    H = R.getDataUI(Q),
                    P = Jf(H),
                    v = vo(k, function(u) { return Tf(P, 100 * u) }, 100, .001),
                    f = Tf(P, 100 * v);
                if (!b) {
                    var z = hl(H),
                        c = new Um(f.x, f.y),
                        i = 49 / (R._zoom * R._zoom);
                    for (n = 0, d = z.length; d > n; n++)
                        if (c.distanceToSquared(z[n]) < i) return { index: n, point: z[n], distance: Math.sqrt((z[n].x - k.x) * (z[n].x - k.x) + (z[n].y - k.y) * (z[n].y - k.y)) }
                }
                return { percent: v, point: f, distance: Math.sqrt((f.x - k.x) * (f.x - k.x) + (f.y - k.y) * (f.y - k.y)) }
            },
            calculateAttachPoint: function() {
                var t = new Um,
                    v = new Um,
                    y = new Um;
                return function(Y, q) {
                    var K = this.getAttachPoints(Y);
                    if (!K || !K.length) return null;
                    y.set(q.x, q.y);
                    for (var N, Z, X, A, s, n = 1 / 0, S = 0, r = K.length; r > S; S++) X = K[S], v.x = X.x, v.y = X.y, t.x = X.offsetX || 0, t.y = X.offsetY || 0, A = Cg(this, Y, 0, t.x, t.y, v.x, v.y), Z = y.distanceToSquared(A), n > Z && (N = S, n = Z, s = A);
                    n = Math.sqrt(n);
                    var j = this.getAttachStyle(Y);
                    if ("close" === j) { var E = Y.s("attach.close.threshold") / this._zoom; if (n > E) return null }
                    return { index: N, distance: n, info: K[N], point: s }
                }
            }(),
            getAttachPoints: function(i) { var k = i.s("attach.points"); if (k) return k; var y = Jc(i._image); return y ? Rr(y.attachPoints, i, this) || null : void 0 },
            getAttachStyle: function(j) { var I = j.s("attach.style"); if (I) return I; var B = Jc(j._image); return B ? Rr(B.attachStyle, j, this) || "close" : void 0 },
            updateLayers: function() { this._layersInfo = O, this.invalidateSelection(), this.redraw() },
            updateBackground: function() {
                var D = this.dm().a("width"),
                    S = this.dm().a("height");
                this._canvas.style.background = D > 0 && S > 0 ? "" : this.dm().getBackground() || ""
            },
            handleDataModelPropertyChange: function($) {
                if ("background" === $.property) {
                    var O = this._canvas.style.background,
                        b = $.newValue || "";
                    this.updateBackground(), this.fp("canvasBackground", O, b), this.redraw()
                } else "a:width" === $.property || "a:height" === $.property ? (this._83I = 1, this.updateBackground(), this.redraw()) : "layers" === $.property ? this.updateLayers() : "hierarchicalRendering" === $.property && this.redraw()
            },
            handleDataPropertyChange: function(J) { this.dm().isHierarchicalRendering() && "parent" === J.property && J.data.hasChildren() && this.redraw(), this.invalidateData(J.data) },
            onPropertyChanged: function(f) {
                var y = this,
                    U = f.property;
                if (y.redraw(), "zoom" === U) {
                    var p = y.sm().getSelection();
                    p.size() && p.each(function(E) { E.invalidate() })
                } else "dataModel" === U && (y._83I = 1);
                _n[U] ? y.showScrollBar() : U === Uq && y.onCurrentSubGraphChanged(f)
            },
            onCurrentSubGraphChanged: function() { this.sm().cs(), this.reset() },
            handleDataModelChange: function(E) {
                var H = this,
                    f = E.kind,
                    B = E.data;
                if (H._83I = 1, "add" === f) H.invalidateData(B), Si(B) && B.getEdgeGroup() && B.getEdgeGroup().eachSiblingEdge(H.invalidateData, H);
                else if (f === nd) {
                    H._21Q(B);
                    var j = B._id,
                        k = H._25I[j];
                    if (k) {
                        if (H._56I[j]) {
                            var X = k._79o();
                            X && H.redraw(X)
                        }
                        k.dispose(), delete H._25I[j], delete H._24I[j], delete H._56I[j]
                    }
                    B === H._currentSubGraph && H.setCurrentSubGraph(A)
                } else f === Cl && (H.invalidateAll(!0), H.setCurrentSubGraph(A))
            },
            _75O: function(w) { this.invalidateData(w.data) },
            handleHierarchyChange: function(J) { this.dm().isHierarchicalRendering() && J.data.hasChildren() && this.redraw(), this.invalidateData(J.data) },
            adjustIndex: function(M) {
                var q = this;
                if (q.isVisible(M)) {
                    q.dm().beginTransaction();
                    for (var b = M; b._parent && q.isVisible(b._parent);) b = b._parent;
                    b && b !== M && q._dataModel.adjustIndex(b), q._dataModel.adjustIndex(M), q.dm().endTransaction()
                }
            },
            getImage: function(w) { return w.getImage ? w.getImage() : O },
            getSelectWidth: function(c) { var y = Jc(this.getImage(c)); return y && Rr(y.disableSelectedBorder, c, this) ? 0 : c.s("select.width") },
            getSelectColor: function(d) { return d.s("select.color") },
            isSelectable: function(o, a) { if (this.isSelected(o)) return !0; if (!a && o.getParent() instanceof em && this.isSelectable(o.getParent(), !0) && o.getParent().isSyncSize()) return !1; var c = this.getLayersInfo(); if (c) { var t = c[o._layer]; if (t && t.selectable === !1) return !1 } return o.s("2d.selectable") && this.sm().isSelectable(o) },
            isMovable: function(m) { var V = this; if (Si(m) && m.getStyle(Lk) !== Vf) return !1; var z = this.getLayersInfo(); if (z) { var p = z[m._layer]; if (p && p.movable === !1) return !1 } return m.s("2d.movable") ? V._movableFunc ? V._movableFunc(m) : !0 : !1 },
            isEditable: function(W) { var h = this; if (k._uiSerializing) return h._uieditable; if (!h._editInteractor || !h.isSelected(W)) return !1; if (Er(W)) { var l = h.getDataUI(W); if (!l || l._88I) return !1 } if (Si(W) && W.getStyle(Lk) !== Vf) return !1; var P = this.getLayersInfo(); if (P) { var i = P[W._layer]; if (i && i.editable === !1) return !1 } return W.s("2d.editable") ? h._editableFunc ? h._editableFunc(W) : !0 : !1 },
            handleDelete: function() { this._editInteractor && (this._editInteractor.handleDelete ? this._editInteractor.handleDelete() : this.removeSelection()) },
            isPointEditable: function(H) { return Dj(H) && 0 !== H.getRotation() ? !1 : this._pointEditableFunc ? this._pointEditableFunc(H) : !0 },
            isRectEditable: function(u) { return this._rectEditableFunc ? this._rectEditableFunc(u) : !0 },
            isAnchorEditable: function(V) { return this._anchorEditableFunc ? this._anchorEditableFunc(V) : !0 },
            isRotationEditable: function(V) { return V.setRotation && V.IRotatable !== !1 ? this._rotationEditableFunc ? this._rotationEditableFunc(V) : !0 : !1 },
            isSourceTargetEditable: function() { return !0 },
            getRotationPoint: function(H) {
                var T = H.getAnchor(),
                    A = H.getScale(),
                    $ = this._zoom,
                    j = qn(H.getRotation(), 0, -H.getHeight() * A.y * T.y - (A.y < 0 ? -1 : 1) * (Po ? 32 : 16) / $),
                    R = H.p();
                return j.x += R.x, j.y += R.y, j
            },
            getLogicalPoint: function(X) { var P = this; return Mo(X, P._canvas, P.tx(), P.ty(), P._zoom, P._zoom) },
            getScreenPoint: function(R, I) { var w, i = this; return "object" == typeof R ? R.x !== O ? (w = R.x, I = R.y) : (w = R[0], I = R[1]) : w = R, Rk(w, I, i._canvas, i.tx(), i.ty(), i._zoom, i._zoom) },
            getSelectedDataAt: function(m) { var $ = this; return this.getDataAt(m, function(L) { return $.isSelected(L) }) },
            getDataInfoAt: function(m, J, C) {
                var w, a = this.lp(m),
                    f = this.getDataAt(a, J, C);
                if (f) {
                    var o = this.getDataUI(f);
                    w = { data: f, ui: o, point: a };
                    var v = o._38o;
                    if (v) {
                        var T = v.icons;
                        for (var S in T) {
                            var H = T[S],
                                Q = v.rects[S];
                            if (Q)
                                for (var i = Rr(H.names, f, this), O = i ? i.length : 0, Y = Q.rotation, p = O - 1; p >= 0; p--) {
                                    var F = i[p],
                                        d = Q[p];
                                    if (Df(d, a, Y)) return w.part = "icons", w.name = S, w.icon = F, w.rect = d, w.index = p, w.rotation = Y, w
                                }
                        }
                    }
                    if (this.isNoteVisible(f)) { if (o.note2Info && Df(o.note2Info.clickRect, a, A, o.note2Info.scale)) return w.part = "note2", w; if (o.noteInfo && Df(o.noteInfo.clickRect, a, A, o.noteInfo.scale)) return w.part = "note", w }
                    if (this.isLabelVisible(f)) { if (o.label2Info && Df(o.label2Info.rect, a, o.label2Info.rotation, o.label2Info.scale)) return w.part = "label2", w; if (o.labelInfo && Df(o.labelInfo.rect, a, o.labelInfo.rotation, o.labelInfo.scale)) return w.part = "label", w }
                    if (f.isInRect && f.isInRect(a)) return w.part = "body", w
                }
                return w
            },
            getDataAt: function(b, v, E) { b.target && (b = this.lp(b)); var a, H = this._zoom; return this.reverseEach(function(j) { return (v ? v(j) : this.isSelectable(j)) && this.rectIntersects(j, bj(b.x, b.y, E, H)) ? (a = j, !1) : void 0 }, this), a },
            getIconInfoAt: function(J, P) {
                var s = this;
                if (J.target && (J = s.lp(J)), P || (P = s.getDataAt(J)), P) {
                    var Q = s.getDataUI(P);
                    if (Q && Q._38o) {
                        var V, G = Q._38o,
                            H = new En;
                        for (V in G.icons) H.add(V);
                        for (var $ = H.size() - 1; $ >= 0; $--) {
                            V = H.get($);
                            for (var n = G.rects[V], w = n.rotation, B = n.length - 1; B >= 0; B--) {
                                var N = n[B],
                                    R = N.width,
                                    K = N.height,
                                    o = { x: J.x - N.x - R / 2, y: J.y - N.y - K / 2 };
                                w != A && (o = qn(-w, o.x, o.y));
                                var N = { x: -R / 2, y: -K / 2, width: R, height: K };
                                if (Df(N, o)) return { key: V, index: B, name: G.icons[V].names[B], rect: n[B], point: J, rotation: w, relativeRect: N, relativePoint: o, data: P }
                            }
                        }
                    }
                }
                return A
            },
            getDatasInRect: function(K, c, E) {
                E === O && (E = 1);
                var y = this,
                    m = new En;
                return y.reverseEach(function(G) { E && !y.isSelectable(G) || (c ? y.rectIntersects(G, K) : y.rectContains(G, K)) && m.add(G) }), m
            },
            moveSelection: function(g, A) {
                var r = this;
                r.dm().beginTransaction(), Em(r.sm().toSelection(r.isMovable, r), g, A), r.dm().endTransaction()
            },
            moveDatas: function(w, C, U) {
                var B = this;
                B.dm().beginTransaction(), w instanceof En || (w = new En(w)), Em(w, C, U), B.dm().endTransaction()
            },
            getDataUIBounds: function(z) { var S = this.getDataUI(z); return S ? S._79o() : A },
            drawData: function(c, X, A) {
                var j = this.getDataUI(X);
                if (j) {
                    var S = j._79o();
                    (!A || Jk(A, S)) && (j._42(c), X instanceof k.Block && X.eachChild(function(E) { this.isVisible(E) && this.drawData(c, E, A) }, this))
                }
            },
            getBoundsForGroup: function(H) { return H.s(Sl) ? this.getDataUIBounds(H) : A },
            isPixelPerfect: function(S) { return S.s("pixelPerfect") },
            rectIntersects: function(a, j) {
                this.validate();
                var x = A;
                if (this._56I[a._id]) {
                    var I = this._25I[a._id];
                    if (I) {
                        var n = I._79o();
                        if (io(j, n)) x = !0;
                        else if ((j = _i(j, n)) && (I.rectIntersects && (x = I.rectIntersects(j)), x == A)) {
                            if (!this.isPixelPerfect(a)) return !0;
                            var $ = j.x,
                                q = j.y,
                                H = j.width,
                                y = j.height,
                                C = this._zoom,
                                Z = D.hitMaxArea,
                                w = H * y * C * C;
                            if (w > Z) {
                                var l = Math.sqrt(Z / w);
                                C *= l
                            }
                            H *= C, y *= C, 2 > H && (H = 2), 2 > y && (y = 2), $ *= C, q *= C;
                            var G = cf(H, y);
                            ts(G, -$, -q), G.scale(C, C), this._drawForChecking = !0, this.drawData(G, a, j), this._drawForChecking = !1;
                            try {
                                for (var s = 0, g = G.getImageData(0, 0, H, y).data; s < g.length; s += 4)
                                    if (0 !== g[s + 3]) { x = !0; break }
                                G.restore()
                            } catch (R) { Rl = A, x = !1 }
                        }
                    }
                }
                return x ? !0 : !1
            },
            rectContains: function(o, B) { if (this._56I[o._id]) { var a = this._25I[o._id]; if (a) return io(B, a._79o()) } return !1 },
            reset: function() { this.setZoom(1), this.setTranslate(0, 0) },
            handleKeyDown: function(p) {
                if (!D.isInput(p.target)) {
                    var b = this,
                        F = b._focusData,
                        x = F && b._25I[F._id],
                        f = 0,
                        u = b._dataModel._datas;
                    if (!(F && F._enabled && F._editable && x && x.onKeyDown && x.onKeyDown(p) === !0))
                        if (9 === p.keyCode && (F && (f = u.indexOf(F), eq(p) ? -1 === --f && (f = 0) : ++f === u.size() && (f = 0)), b._focusData = F = u.get(f), b.sm().setSelection(F)), Bo(p) ? b.selectAll() : wd(p) && b.isResettable() && b.reset(), b.sm().isEmpty()) {
                            if (b._editing) return;
                            var m = b.tx(),
                                _ = b.ty(),
                                I = !1,
                                v = eq() ? 100 : 10;
                            Dg(p) && (m -= v, I = !0), Yi(p) && (_ -= v, I = !0), Wg(p) && (m += v, I = !0), gg(p) && (_ += v, I = !0), I && b.setTranslate(m, _)
                        } else {
                            Tp(p) && b.handleDelete(p);
                            var q = eq() ? 10 : 1;
                            Dg(p) && (b.moveSelection(-q, 0), b.fi({ kind: "moveLeft" })), Yi(p) && (b.moveSelection(0, -q), b.fi({ kind: "moveUp" })), Wg(p) && (b.moveSelection(q, 0), b.fi({ kind: "moveRight" })), gg(p) && (b.moveSelection(0, q), b.fi({ kind: "moveDown" }))
                        }
                }
            },
            handleScroll: function(c, I) {
                if (sh(c), this.isZoomable()) {
                    if (!this.getEditInteractor()) { var N = this.getDataAt(c); if (N) { var l = Jc(this.getImage(N)); if (l && Rr(l.scrollable, N, this)) return } }
                    var D = this.lp(c);
                    I > 0 ? this.scrollZoomIn(D) : 0 > I && this.scrollZoomOut(D)
                }
            },
            handlePinch: function(O, n, M) { this.isZoomable() && (Math.abs(n - M) < D.pinchZoomThreshold || (n > M ? this.pinchZoomIn(O) : this.pinchZoomOut(O))) },
            checkDoubleClickOnNote: function(I, V) {
                var Y = this,
                    B = Y.lp(I),
                    G = Y.getDataUI(V),
                    E = G.note2Info;
                return E && V.s("note2.toggleable") && Df(E.clickRect, B) ? (V.s(ld, !V.s(ld)), Y.fi({ kind: "toggleNote2", event: I, data: V }), !0) : (E = G.noteInfo, E && V.s("note.toggleable") && Df(E.clickRect, B) ? (V.s(Cp, !V.s(Cp)), Y.fi({ kind: "toggleNote", event: I, data: V }), !0) : !1)
            },
            _84o: function() {},
            isNoteVisible: function() { return this._zoom > .15 },
            isLabelVisible: function() { return this._zoom > .15 },
            isEditVisible: function() { return this._zoom > .15 },
            autoScroll: function(D, O) {
                var K = this,
                    W = K.getAutoScrollZone(),
                    d = W / K.getZoom(),
                    o = W / 4,
                    x = K._29I,
                    j = K.lp(D),
                    m = { x: K.tx(), y: K.ty() };
                return j && W > 0 && x && (j.x - x.x < d ? K.translate(o, 0) : x.x + x.width - j.x < d && K.translate(-o, 0), j.y - x.y < d ? K.translate(0, o) : x.y + x.height - j.y < d && K.translate(0, -o)), m.x = K.tx() - m.x, m.y = K.ty() - m.y, O && (O.x += m.x, O.y += m.y), m
            },
            getMoveMode: function(k, j) { var r = j.s("2d.move.mode"); return r ? r : $m["88"] ? "x" : $m["89"] ? "y" : "xy" },
            getSerializableProperties: function() { return { scrollBarColor: 1, scrollBarSize: 1, autoMakeVisible: 1, autoHideScrollBar: 1, editable: 1, resettable: 1, pannable: 1, rectSelectable: 1, autoScrollZone: 1, visibleFunc: 1, movableFunc: 1, editableFunc: 1, pointEditableFunc: 1, rectEditableFunc: 1, anchorEditableFunc: 1, rotationEditableFunc: 1, rectSelectBackground: 1, rectSelectBorderColor: 1, editPointSize: 1, editPointBorderColor: 1, editPointBackground: 1, hoverDelay: 1, dataModel: 1, selectionModel: 1, currentSubGraph: 1, zoom: 1, translateX: 1, translateY: 1 } },
            serializeProperty: function(o, H, z) { var U = this; return "currentSubGraph" === H ? { __i: o.getId() } : z.serializeProperty(o, H, U) },
            deserializeProperty: function(n, x, O) {
                var B = this;
                if ("currentSubGraph" === x) {
                    var w = B.dm(),
                        R = w.__idMap;
                    return R[n.__i]
                }
                return O.deserializeProperty(n, x, B)
            },
            setDefaultCursor: function(U, O) { this._defaultCursor = U, O !== !1 && this.setCursor(U) },
            setCursor: function(A) {
                "default" === A && (A = this._defaultCursor || A);
                var I = this.getView().style;
                I.cursor = A, I.cursor = "-webkit-" + A, I.cursor = "-moz-" + A
            },
            getCurrentConnectActionType: function() { return this._currentActionType },
            setCurrentConnectActionType: function(N) { return N === A || D.getConnectAction(null, N) ? (this._currentActionType = N, this.redraw(), !0) : !1 },
            getEditStyle: function(X) { var Y = this.getEditInteractor(); return Y ? Y.getStyle(X) : O },
            setEditStyle: function(e, P, r) { var v = this.getEditInteractor(); return v ? (v.setStyle(e, P, r), !0) : !1 },
            isConnectActionVisible: function(j) { var S = D.getConnectAction(this); if (!S) return !1; var M = S.visible; return Fe(M) && (M = M(this, j)), M },
            isInteractive: function(i) { if (this._drawForChecking) return !1; var P = Jc(this.getImage(i)); return P && Rr(P.interactive, i, this) ? !0 : i.s("interactive") },
            appendHTML: function(y, K) {
                var Z = this.getView();
                if (!(K || y && y.parentNode !== Z)) return !1;
                var M = y.getView && y.getView();
                if (!K && M && M.parentNode === Z) return !1;
                (y.getView || y.isSelfViewEvent) && (y = y.getView());
                var f = this.getEditInteractor();
                return f && f._canvas ? Z.insertBefore(y, f._canvas) : this.isScrollBarVisible() ? Z.insertBefore(y, this.getView().lastChild) : Ml(Z, y), !0
            },
            _layoutHTMLImpl: function(t, Z, I) {
                if (arguments.length > 1) {
                    var T, h = this,
                        S = h._zoom;
                    if (Z.getView && (T = Z, Z = Z.getView()), Z.style.position = "absolute", I) {
                        var L = t.getRect();
                        dq(T || Z, h.tx() + L.x * S, h.ty() + L.y * S, L.width * S, L.height * S)
                    } else {
                        var R = new wh,
                            L = t.getAnchorRect(),
                            w = t.getPosition(),
                            H = t.getScale(),
                            l = Z.style;
                        dq(T || Z, L), R.appendTranslate(h.tx(), h.ty()), R.appendScale(S, S), R.append(new wh(t.getRotation(), w.x, w.y, H.x, H.y)), Pe(l, "transform", "matrix(" + R.a.toFixed(5) + ", " + R.b.toFixed(5) + ", " + R.c.toFixed(5) + ",\n    " + R.d.toFixed(5) + ", " + R.tx.toFixed(5) + ", " + R.ty.toFixed(5) + ")"), Pe(l, "transformOrigin", (-L.x).toFixed(5) + "px " + (-L.y).toFixed(5) + "px"), Z.updateAppendMatrix = !0
                    }
                } else this._layoutHTML && this._layoutHTML()
            },
            getTextEditInfo: function(r) { return r instanceof rn ? { name: "text", accessType: "s", isMultiline: !1 } : void 0 },
            getState: function(y) {
                var g = "state",
                    f = y.s(g);
                if (f) return f;
                var o = Jc(y._image);
                return o ? Rr(o[g], y, this) || null : void 0
            },
            getShape: function(V) { return V.getStyle(ii) }
        }), n.defineProperties(Rm.GraphView.prototype, { layoutHTML: { get: function() { return this._layoutHTMLImplBind || (this._layoutHTMLImplBind = this._layoutHTMLImpl.bind(this)), this._layoutHTMLImplBind }, set: function(x) { this._layoutHTML = x } } });
        var de = function(h, e) {
            var A = this;
            A.gv = h, A.s = function(F) { return e.getStyle(F) }, A._data = e, A._87I = new En
        };
        eh(de, n, {
            _6I: A,
            ms_icons: 1,
            _84o: function() {},
            dispose: function() {},
            isShadowed: function() { return this.s("shadow") || this.gv.isSelected(this._data) && "shadow" === this.s("select.type") },
            getSelectWidth: function() {
                var G = this,
                    M = G.gv.isSelected(G._data);
                return !M || G.isShadowed() ? 0 : G.gv.getSelectWidth(G._data)
            },
            getSelectColor: function() { return this.gv.getSelectColor(this._data) },
            getBodyColor: function(K) {
                var b = this._data,
                    J = this.gv.getBodyColor(b);
                return J ? J : K ? b.getStyle(K) : A
            },
            _2Q: function(Z) { return this.s(Z) },
            _1Q: function(W, h, q, A) {
                var c = this.s,
                    P = c("2d.gray"),
                    K = c(h + ".dash.color");
                if (P && (K = D.toGrayColor(K)), W.strokeStyle = K, W.lineWidth = q, W.stroke(), c(h + ".dash.3d")) {
                    var I = c(h + ".dash.3d.color");
                    pj(W, K, P ? D.toGrayColor(I) : I, q, this.gv._zoom, c(h + ".dash.3d.accuracy"))
                }
                Xd(W, A)
            },
            invalidate: function() { this._6I = A },
            _79o: function() {
                var C = this;
                if (!C._6I) {
                    var O = C._data,
                        p = C.gv;
                    C.labelInfo = C.label2Info = C.noteInfo = C.note2Info = C._38o = A, C._87I.clear(), C.interactiveInfo = p.isInteractive(O) ? {} : A, C._3O(), C._55O = p.isEditable(O) ? { _42O: p.isRectEditable(O), _43O: p.isPointEditable(O), _56O: p.isRotationEditable(O) } : A, C._6I = C._81o()
                }
                return C._6I
            },
            _3O: function() {},
            getPosition: function() { return Xo },
            _68o: function(u, l) { u && this._87I.add(eg(u, l)) },
            _81o: function() {
                var l = this,
                    E = l.s;
                l._24O($c, "getLabel"), l._24O(If, "getLabel2"), l._26O(Rc, "getNote"), l._26O(td, "getNote2"), l._15O(), l._55O && l._48O();
                var L;
                if (l._87I.each(function(I) { L = bp(L, I) }), L) {
                    var _ = l.isShadowed(),
                        B = E("shadow2"),
                        f = tf(L);
                    B ? (f.x += E("shadow2.offset.x"), f.y += E("shadow2.offset.y"), $f(f, E("shadow2.blur"))) : _ && (f.x += E("shadow.offset.x"), f.y += E("shadow.offset.y"), $f(f, E("shadow.blur"))), L = bp(L, f)
                }
                return l._87I.clear(), L
            },
            _42: function(T) {
                var c = this,
                    j = c._data,
                    z = c.gv,
                    K = c.s,
                    w = K("opacity"),
                    d = this.isShadowed(),
                    R = K("shadow2");
                if (d || R) {
                    var b = T.shadowOffsetX,
                        l = T.shadowOffsetY,
                        p = T.shadowBlur,
                        Z = T.shadowColor,
                        Y = z.getZoom() * D.devicePixelRatio,
                        n = d ? "shadow" : "shadow2";
                    T.shadowOffsetX = K(n + ".offset.x") * Y, T.shadowOffsetY = K(n + ".offset.y") * Y, T.shadowBlur = K(n + ".blur") * Y, T.shadowColor = d ? c.getSelectColor() : K(n + ".color")
                }
                if (w != A) {
                    var V = T.globalAlpha;
                    T.globalAlpha = w
                }
                c._80o(T), z.isLabelVisible(j) && ((!z._drawForChecking || K("label.selectable")) && Ug(T, c.labelInfo), (!z._drawForChecking || K("label2.selectable")) && Ug(T, c.label2Info)), z.isNoteVisible(j) && (uh(T, c.noteInfo), uh(T, c.note2Info)), c._99O(T), w != A && (T.globalAlpha = V), (d || R) && (T.shadowOffsetX = b, T.shadowOffsetY = l, T.shadowBlur = p, T.shadowColor = Z)
            },
            _80o: function() {},
            _47O: function() {},
            _24O: function(E, h) {
                var G = this,
                    $ = G._data,
                    X = G.gv,
                    N = G.s,
                    Z = X[h]($);
                if (Z != A) {
                    var g = N(E + ".scale"),
                        l = N(E + ".max"),
                        e = N(E + ".position"),
                        D = G[E + "Info"] = { label: Z, scale: g, color: X[h + "Color"]($), font: N(E + ".font"), opacity: N(E + ".opacity"), align: N(E + ".align"), rotation: G.getRotation(N(E + ".rotation"), !1, e), background: X[h + "Background"]($) },
                        z = Bi(D, Z);
                    l > 0 && l < z.width && (D.labelWidth = z.width, z.width = l), 1 !== g && (z.width *= g, z.height *= g);
                    var o = G.getPosition(e, N(E + ".offset.x"), N(E + ".offset.y"), z, N(E + ".position.fixed"));
                    if (z.x = o.x - z.width / 2, z.y = o.y - z.height / 2, G._68o(D.rect = z, D.rotation), 1 !== g) {
                        var F = z.width / g,
                            v = z.height / g;
                        D.rect = { x: o.x - F / 2, y: o.y - v / 2, width: F, height: v }
                    }
                }
            },
            _26O: function(e, v) {
                var S = this,
                    f = S.gv,
                    B = S._data,
                    k = S.s,
                    T = f[v](B);
                if (T != A) {
                    var g, m, O = k(e + ".scale"),
                        p = S[e + "Info"] = { note: T, scale: O, data: B, view: f, expanded: k(e + ".expanded"), font: k(e + ".font"), color: k(e + ".color"), opacity: k(e + ".opacity"), align: k(e + ".align"), icon: k(e + ".icon"), backgroundImage: k(e + ".backgroundImage"), borderWidth: k(e + ".border.width"), borderColor: k(e + ".border.color"), background: f[v + "Background"](B) },
                        Z = S.getPosition(k(e + ".position"), k(e + ".offset.x"), k(e + ".offset.y")),
                        W = Z.x,
                        P = Z.y;
                    if (p.expanded) {
                        var G, y = k(e + ".max"),
                            U = k(e + ".backgroundImage");
                        U ? (U = Jc(U), G = { width: Hc(U, B), height: Gp(U, B) }) : G = Bi(p, T), G.width += 6, G.height += 2, y > 0 && y < G.width && (p.labelWidth = G.width, G.width = y), g = G.width, m = G.height + 8, p.clickRect = { x: W - g * O / 2, y: P - m * O, width: g * O, height: m * O * G.height / m }
                    } else {
                        var c = k(e + ".icon");
                        c ? (c = Jc(c), g = Hc(c, B), m = Gp(c, B)) : (g = 12, m = 18), p.clickRect = { x: W - g * O / 2, y: P - m * O, width: g * O, height: m * O }
                    }
                    p.rect = { x: W - g / 2, y: P - m * O / 2 - m / 2, width: g, height: m };
                    var i = x(p.borderWidth / 2) * O;
                    S._68o({ x: W - g * O / 2 - i, y: P - m * O - i, width: g * O + 2 * i, height: m * O + 2 * i })
                }
            },
            _48O: function() {},
            _99O: function(O) {
                var S = this,
                    $ = S._38o;
                if ($) {
                    var l = S.gv,
                        g = S._data,
                        X = $.icons,
                        w = S.interactiveInfo;
                    w && (w._38o = {});
                    for (var M in X) {
                        var h = X[M],
                            y = $.rects[M];
                        if (y) {
                            w && (w._38o[M] = []);
                            var D = Rr(h.opacity, g, l),
                                Y = Rr(h.names, g, l),
                                t = Y ? Y.length : 0,
                                e = y.rotation;
                            if (D != A) {
                                var z = O.globalAlpha;
                                O.globalAlpha *= D
                            }
                            for (var u = 0; t > u; u++) {
                                var E = Y[u],
                                    m = Jc(E),
                                    k = y[u];
                                if (e) {
                                    var U = k.x + k.width / 2,
                                        s = k.y + k.height / 2;
                                    O.save(), ts(O, U, s), nm(O, e), ts(O, -U, -s)
                                }
                                w && w._38o[M].push(O.interactiveInfo = { compInfos: [], matrix: e ? new wh(e, U, s).appendTranslate(-U, -s) : new wh }), Kq(O, m, Rr(h.stretch, g, l), k.x, k.y, k.width, k.height, S._data, S.gv), O.interactiveInfo = A, e && O.restore()
                            }
                            D != A && (O.globalAlpha = z)
                        }
                    }
                }
            }
        });
        var Bd = function(o, j) { th(Bd, this, [o, j]) };
        eh(Bd, de, {
            _checkEmptyRect: !0,
            _40O: function(x, j) {
                var T = this,
                    e = T.s,
                    v = x.rect;
                (x.borderColor = T.gv.getBorderColor(T._data)) && (x.borderType = e("border.type"), x.borderWidth = e("border.width"), x.borderPadding = e("border.padding"), j = K(j, x.borderPadding + x.borderWidth / 2));
                var k = T._data.getScale(),
                    A = K(1, K(X(k.x), X(k.y)));
                if (x.selectWidth = T.getSelectWidth()) {
                    var z = T.gv._zoom;
                    x.selectType = e("select.type"), x._97o = T.getSelectColor(), x.selectPadding = e("select.padding"), j = K(j, (x.selectPadding + x.selectWidth / 2 / z) / A)
                }
                j > 0 && (j *= A, v = tf(v), $f(v, j)), T._68o(v)
            },
            _39O: function(G, R) {
                var t, u = this,
                    y = R.rect;
                if (R.borderWidth > 0 && (t = R.borderPadding, G.strokeStyle = R.borderColor, G.lineWidth = R.borderWidth, mj(G, R.borderType, { x: y.x - t, y: y.y - t, width: y.width + 2 * t, height: y.height + 2 * t }), G.stroke()), R.selectWidth > 0) {
                    var J = u.gv._zoom;
                    if (t = R.selectPadding, G.strokeStyle = R._97o, G.lineWidth = R.selectWidth / J, R.rotation != A) {
                        G.save(), G.translate(R.position.x, R.position.y), G.rotate(R.rotation);
                        var _ = u._data,
                            m = _.getWidth(),
                            s = _.getHeight(),
                            v = R.scale,
                            w = R.anchor;
                        y = { x: v.x * -m * w.x, y: v.y * -s * w.y, width: v.x * m, height: v.y * s }
                    }
                    mj(G, R.selectType, { x: y.x - t, y: y.y - t, width: y.width + 2 * t, height: y.height + 2 * t }), R.rotation != A && G.restore(), G.stroke()
                }
            },
            dispose: function() {
                var d = this,
                    T = d._htmlView;
                Bd.superClass._3O.call(d), T && (T.onHTMLRemoved && T.onHTMLRemoved(), tp(T))
            },
            _3O: function() {
                var v, U = this,
                    B = U.s,
                    Y = U._data,
                    h = U.gv,
                    M = h.getShape(Y),
                    $ = U.getBodyColor(),
                    l = B("shape.border.color"),
                    f = U._83o = M ? { shape: M, _53o: U.getBodyColor("shape.background"), _27Q: Jc(B("shape.repeat.image"), $), shapeGradientPack: B("shape.gradient.pack"), _54o: B("shape.border.width"), _55o: l, shapeBorderRepeatImage: Jc(B("shape.border.repeat.image"), l), _56o: B("shape.border.3d"), _57o: B("shape.border.3d.color"), _58o: B("shape.border.3d.accuracy"), shapeGradient: B("shape.gradient"), _59o: B("shape.gradient.color"), _60o: B("shape.border.pattern"), _61o: B("shape.border.cap"), _62o: B("shape.border.join"), shapeForeground: B("shape.foreground"), bodyColor: $, gray: B("2d.gray") } : { img: Jc(h.getImage(Y), $), bodyColor: $, gray: B("2d.gray"), stretch: B("image.stretch") },
                    u = f.img;
                u && u.renderHTML ? (U._htmlInfo && U._htmlInfo.img !== u && (U._htmlInfo = A), U._htmlInfo || (U._htmlInfo = { img: u, cache: {} }), v = u.renderHTML(Y, h, U._htmlInfo.cache)) : U._htmlInfo = A, U._htmlView && U._htmlView !== v && (U._htmlView.onHTMLRemoved && U._htmlView.onHTMLRemoved(), tp(U._htmlView.getView ? U._htmlView.getView() : U._htmlView)), (U._htmlView = v) && h.appendHTML(v) && (v.onHTMLAddedSync && v.onHTMLAddedSync(), v.onHTMLAdded && Lh(v.onHTMLAdded)), f.rect = Y.getRect(), f.position = Y.p(), f.scale = Y.getScale(), f.anchor = Y.getAnchor(), f.rotation = Y.getRotation(), M === Ej && (f._63o = B("shape.depth"));
                var o = 0;
                if (M) o = _j(A, f._54o / 2, f._62o), U.s("shape.dash") && (o = K(o, (U.s("shape.dash.width") || f._54o) / 2));
                else if (u && u.boundExtend)
                    if (o = Rr(u.boundExtend, Y, h), u.boundExtendAbsolute) {
                        var d = Y.getScale();
                        o /= h._zoom * K(1, K(X(d.x), X(d.y)))
                    } else if (!Rr(u.fitSize, Y, h)) {
                    var c = Rr(u.width, Y, h),
                        F = Rr(u.height, Y, h);
                    o *= K(Y.getWidth() / c, Y.getHeight() / F)
                }
                U._40O(f, o);
                var y = on(Y, h.isSelected(Y)),
                    z = B("clip.percentage");
                if (1 > z && (0 > z && (z = 0), f.clipRect = Ln(Y.getAnchorRect(), B("clip.direction"), z, y)), M) {
                    var O = B("shape.fill.clip.percentage");
                    1 > O && (0 > O && (O = 0), f.shapeClipRect = Ln(Y.getAnchorRect(), B("shape.fill.clip.direction"), O, y));
                    var N = B("shape.foreground.clip.percentage");
                    1 > N && (0 > N && (N = 0), f.shapeForegroundClipRect = Ln(Y.getAnchorRect(), B("shape.foreground.clip.direction"), N, y))
                }
            },
            getPosition: function(v, I, G, D) { var z = Hf(v, this._83o.rect, D); return z.x += I, z.y += G, z },
            _80o: function(t) {
                var j = this,
                    N = j.s,
                    G = j.gv,
                    Q = j._data,
                    b = j._83o,
                    x = b.rect,
                    v = b.position,
                    _ = b.rotation,
                    d = b.anchor,
                    e = b.scale,
                    S = b.shape,
                    X = b.clipRect;
                if (!j._checkEmptyRect || x.width > 0 && x.height > 0) {
                    var H = Q.getSize();
                    if (H.x = -H.width * d.x, H.y = -H.height * d.y, Yj && !uo && ts(t, H.width, H.height), t.save(), ts(t, v.x, v.y), nm(t, _), Zm(t, e.x, e.y), X && (t.beginPath(), t.rect(X.x, X.y, X.width, X.height), t.clip()), G._drawForChecking && b.img && Rr(b.img.pixelPerfect, Q, G) === !1) re(t, H.x, H.y, H.width, H.height, "#888888");
                    else if (j.freeDraw) j.freeDraw(t, H, b);
                    else if (S) {
                        var n, V, w, Y, o = b._60o,
                            C = ad(t, o),
                            M = b._27Q,
                            s = b._54o,
                            T = b.shapeGradientPack,
                            i = b.gray,
                            y = t.lineJoin,
                            q = t.lineCap,
                            L = function(B) { return i ? D.toGrayColor(B) : B };
                        "roundRect" === S ? n = N("shape.corner.radius") : "polygon" === S ? n = N("shape.polygon.side") : "arc" === S && (n = N("shape.arc.from"), V = N("shape.arc.to"), w = N("shape.arc.close"), Y = N("shape.arc.oval")), t.lineJoin = b._62o, t.lineCap = b._61o;
                        var u = L(b._53o);
                        if (u || M || T) {
                            var m = b.shapeClipRect;
                            m && (t.save(), t.beginPath(), t.rect(m.x, m.y, m.width, m.height), t.clip()), mj(t, S, H, n, V, w, Y), T ? uj(t, T, function(R) { return jk(R, b.bodyColor) }) : M ? Hn(t, M, L(b.bodyColor), null, Q, G) : Vd(t, u, b.shapeGradient, L(b._59o), H), t.fill(), T && t.restore(), m && t.restore(), t !== C && mj(C, S, H, n, V, w, Y)
                        } else mj(C, S, H, n, V, w, Y);
                        var U = b.shapeForeground;
                        if (U) {
                            t.save();
                            var z = b.shapeForegroundClipRect;
                            z && (t.beginPath(), t.rect(z.x, z.y, z.width, z.height), t.clip()), mj(t, S, H, n, V, w, Y), Vd(t, U, N("shape.foreground.gradient"), L(N("shape.foreground.gradient.color")), H), t.fill(), t.restore()
                        }
                        if (s > 0) {
                            var c = N("shape.border.width.absolute");
                            c && (t.save(), t.setTransform(1, 0, 0, 1, 0, 0)), t.lineWidth = s;
                            var R = L(b._55o);
                            b.shapeBorderRepeatImage ? od(t, b.shapeBorderRepeatImage, R, null, Q, G) : t.strokeStyle = R, t.stroke(), c && t.restore(), b._56o && pj(t, R, L(b._57o), s, G._zoom, b._58o)
                        }
                        if (Xd(t, o), N("shape.dash")) {
                            var E = N("shape.dash.width") || s;
                            if (E > 0) {
                                o = N("shape.dash.pattern");
                                var C = ad(t, o, j._2Q("shape.dash.offset"));
                                C !== t && mj(C, S, H, n, V, w, Y), j._1Q(t, "shape", E, o)
                            }
                        }
                        cb(t, u, b._63o, H), t.lineJoin = y, t.lineCap = q
                    } else {
                        var F = j.interactiveInfo;
                        F && (t.interactiveInfo = F.bodyInfo = { compInfos: [], matrix: new wh(_, v.x, v.y, e.x, e.y) }), b.gray && (t.compGray = !0);
                        var f = b.img;
                        f && f.cacheRule != A && (f = Uh(t, f, b.stretch, H.width, H.height, Q, G, b.bodyColor)), Kq(t, f, b.stretch, H.x, H.y, H.width, H.height, Q, G, b.bodyColor), t.compGray = !1, t.interactiveInfo = A
                    }
                    t.restore()
                }
                j._39O(t, b)
            },
            _48O: function() {},
            _47O: function() {}
        });
        var As = function(T, g) { th(As, this, [T, g]) },
            Gf = function(_, Y, a, r) { var Z = _q(_, Y); return a = r ? i(a, Z) : ck(a, Z), Z ? a /= Z : a = 0, { x: _.x + (Y.x - _.x) * a, y: _.y + (Y.y - _.y) * a } };
        eh(As, de, {
            _3O: function() {
                var s, I = this,
                    P = I._data,
                    T = I.gv,
                    r = I.s,
                    v = r(Lk),
                    H = P.isLooped(),
                    X = r("edge.width"),
                    e = I.getBodyColor("edge.color"),
                    y = r("edge.center"),
                    b = r("edge.offset"),
                    E = T.getBorderColor(P),
                    _ = E ? r("border.width") : 0,
                    w = I.getSelectWidth(),
                    j = P._40I,
                    o = P._41I,
                    G = I._78o = j && o ? { looped: H, type: v, width: X, center: y, color: e, repeatImage: Jc(r("edge.repeat.image"), e), borderColor: E, borderWidth: _, _97o: w ? I.getSelectColor() : A, selectWidth: w, pattern: r("edge.pattern"), cap: r("edge.cap"), join: r("edge.join"), is3d: r("edge.3d"), _67o: r("edge.3d.color"), _66o: r("edge.3d.accuracy"), gray: r("2d.gray") } : A;
                if (G) {
                    var m = D.getEdgeType(v);
                    if (m) {
                        var B = m(P, Qo(I, T, P, H, v), T, I._19Q);
                        B.points && B.points.size() > 1 ? (G.edgeTypeInfo = B, s = we(G.edgeTypeInfo.points)) : B[Mh] && B.rect && (G.edgeTypeInfo = B, s = B.rect)
                    } else {
                        var Q = r("edge.source.anchor.x"),
                            L = r("edge.source.anchor.y"),
                            t = r("edge.target.anchor.x"),
                            h = r("edge.target.anchor.y"),
                            W = an(T, P, "source"),
                            C = an(T, P, "target");
                        if (v === Vf) {
                            var $ = G.points = r(Go) || xg,
                                q = $.size();
                            G.segments = r("edge.segments");
                            var F = Q !== O || L !== O || Si(j),
                                S = t !== O || h !== O || Si(o);
                            if (!y)
                                if (b) F || (W = Gf(W, q ? $.get(0) : C, b, q)), S || (C = Gf(C, q ? $.get(q - 1) : W, b, q));
                                else {
                                    var a;
                                    F || (a = Sf(W, q ? $.get(0) : C, Kc(T, j)), a && (W = { x: a[0], y: a[1] })), S || (a = Sf(q ? $.get(q - 1) : W, C, Kc(T, o)), a && (C = { x: a[0], y: a[1] }))
                                }
                            s = bp(we(G.points), we(W, C))
                        } else {
                            var x = Qo(I, T, P, H, v);
                            if (I._19Q || (x = -x), H) W = tf(W), W.x = T.getNodeRect(j).x, G.radius = x, s = { x: W.x - x, y: W.y - x, width: 2 * x, height: 2 * x };
                            else {
                                var n = _q(W, C),
                                    z = ck(b, n),
                                    k = { x: z, y: x },
                                    M = { x: n - z, y: x },
                                    g = Cc(C.y - W.y, C.x - W.x),
                                    Y = G.mat = new uf(g);
                                if (G.orienAngle = g, G.angle = C.x < W.x ? g + U : g, G.rect = { x: k.x, y: k.y, width: M.x - k.x, height: 0 }, G.origin = W, k = Y.tf(k), k.x += W.x, k.y += W.y, M = Y.tf(M), M.x += W.x, M.y += W.y, y) {
                                    var d = { x: n, y: 0 };
                                    d = Y.tf(d), d.x += W.x, d.y += W.y, s = we([W, k, M, d]), G.c1 = W, G.c2 = d
                                } else s = we(k, M);
                                W = k, C = M
                            }
                        }
                        G.sourcePoint = W, G.targetPoint = C, P._lastSourcePoint = W, P._lastTargetPoint = C
                    }
                    var Z = 0;
                    r("edge.dash") && (Z = r("edge.dash.width") || X);
                    var J = "square" === G.cap ? .71 : .5;
                    _j(s, K(Z * J, X * J + _ + w), G.join), I._68o(s)
                }
            },
            getRotation: function(J, p, G) {
                J = J || 0;
                var P = this._78o;
                if (P) {
                    var Y, I = P.angle,
                        w = P.points,
                        B = P.edgeTypeInfo;
                    if (I != A) return p ? P.orienAngle + J : I + J;
                    if (B && B[Mh]) return B.getRotation ? B.getRotation(this, J, p, G) : 0;
                    if (B && B.points) { var M = B.points; return Y = M.size(), zo[G] ? Y && 0 === Y % 2 ? hs(M.get(Y / 2 - 1), M.get(Y / 2), p, J) : J : Tj[G] ? hs(M.get(0), M.get(1), p, J) : hs(M.get(Y - 2), M.get(Y - 1), p, J) }
                    if (w) return Y = w.size(), zo[G] ? Y && 0 === Y % 2 ? hs(w.get(Y / 2 - 1), w.get(Y / 2), p, J) : J : Tj[G] ? hs(P.sourcePoint, Y ? w.get(0) : P.targetPoint, p, J) : hs(Y ? w.get(Y - 1) : P.sourcePoint, P.targetPoint, p, J)
                }
                return J
            },
            getPosition: function(n, K, B, g, b) {
                var I = this._78o;
                if (I) {
                    var e, i = I.type,
                        C = I.points,
                        j = I.edgeTypeInfo,
                        k = I.sourcePoint,
                        t = I.targetPoint;
                    if (!i) return I.looped ? { x: k.x - I.radius + K, y: k.y + B } : (b && k && t && (k.x > t.x || k.x === t.x && k.y > t.y) && (n = Xq[n], B = -B), e = Hf(n, I.rect, g), e.x += K, e.y += B, e = I.mat.tf(e), e.x += I.origin.x, e.y += I.origin.y, e);
                    if (j && j[Mh]) return j.getPosition ? j.getPosition(this, n, K, B, g, b) : { x: (k.x + t.x) / 2, y: (k.y + t.y) / 2 };
                    if (C) {
                        var e, H = C.size();
                        if (zo[n]) {
                            if (H) {
                                var o = H % 2;
                                if (0 === o) return Ym(C.get(H / 2 - 1), C.get(H / 2), n, K, B, g, b);
                                e = C.get((H - o) / 2)
                            } else e = { x: (k.x + t.x) / 2, y: (k.y + t.y) / 2 };
                            return e = Hf(n, { x: e.x, y: e.y, width: 0, height: 0 }, g), e.x += K, e.y += B, e
                        }
                        return Tj[n] ? Ym(k, H ? C.get(0) : t, n, K, B, g, b) : Ym(H ? C.get(H - 1) : k, t, n, K, B, g, b)
                    }
                    if (j) {
                        var V = j.points,
                            H = V.size();
                        if (zo[n]) { var o = H % 2; return 0 === o ? Ym(V.get(H / 2 - 1), V.get(H / 2), n, K, B, g, b) : (e = V.get((H - o) / 2), e = Hf(n, { x: e.x, y: e.y, width: 0, height: 0 }, g), e.x += K, e.y += B, e) }
                        return Tj[n] ? Ym(V.get(0), V.get(1), n, K, B, g, b) : Ym(V.get(H - 2), V.get(H - 1), n, K, B, g, b)
                    }
                }
                return Xo
            },
            _42: function(G) { this._78o && As.superClass._42.call(this, G) },
            drawPath: function(G, H) {
                G.beginPath();
                var v = H.type,
                    t = H.points,
                    B = H.segments,
                    u = H.edgeTypeInfo;
                if (!v || t) {
                    var A = H.sourcePoint,
                        q = A.x,
                        D = A.y,
                        K = H.targetPoint,
                        T = K.x,
                        W = K.y;
                    if (v)
                        if (B) {
                            var _ = new En({ x: q, y: D });
                            _.addAll(t), _.add({ x: T, y: W }), Eg(G, _, B)
                        } else G.moveTo(q, D), t.each(function(E) { G.lineTo(E.x, E.y) }), G.lineTo(T, W);
                    else H.looped ? G.arc(q, D, H.radius, 0, m, !0) : H.center ? (G.moveTo(H.c1.x, H.c1.y), G.lineTo(q, D), G.lineTo(T, W), G.lineTo(H.c2.x, H.c2.y)) : (G.moveTo(q, D), G.lineTo(T, W))
                } else u && (u.points ? Eg(G, u.points, u.segments) : u[Mh] && u[Mh](G, u))
            },
            _80o: function(r) {
                var e = this,
                    V = e.s,
                    l = e._78o,
                    H = l.width,
                    J = l.selectWidth,
                    R = l.borderWidth,
                    Z = l.repeatImage,
                    k = r.lineJoin,
                    G = r.lineCap,
                    g = l.gray,
                    W = l.pattern;
                r.lineJoin = l.join, r.lineCap = l.cap, e.drawPath(ad(r, W), l);
                var u = V("edge.width.absolute");
                u && (r.save(), r.setTransform(1, 0, 0, 1, 0, 0)), J && (r.strokeStyle = l._97o, r.lineWidth = H + 2 * (R + J), r.stroke()), R && (r.strokeStyle = g ? D.toGrayColor(l.borderColor) : l.borderColor, r.lineWidth = H + 2 * R, r.stroke());
                var y = g ? D.toGrayColor(l.color) : l.color;
                if (Z ? od(r, Z, y, null, e._data, e.gv) : r.strokeStyle = y, r.lineWidth = H, r.stroke(), l.is3d) {
                    var b = g ? D.toGrayColor(l._67o) : l._67o;
                    pj(r, y, b, H, e.gv._zoom, l._66o)
                }
                if (Xd(r, W), V("edge.dash")) {
                    W = V("edge.dash.pattern");
                    var v = ad(r, W, e._2Q("edge.dash.offset"));
                    v !== r && e.drawPath(v, l), e._1Q(r, "edge", V("edge.dash.width") || H, W)
                }
                u && r.restore(), r.lineJoin = k, r.lineCap = G
            },
            _48O: function() {},
            _47O: function() {}
        });
        var be = function($, H) { th(be, this, [$, H]) };
        eh(be, Bd, {
            _3O: function() {
                var $, u, T = this,
                    y = T.s,
                    x = T._data,
                    F = T.gv;
                if (T._88I = A, x.isExpanded() && x.eachChild(function(f) {
                        if (Dj(f)) {
                            var Z = F.getBoundsForGroup(f);
                            Z && (u || (u = []), u.push(Z), $ = bp($, Z))
                        }
                    }), $) {
                    var R = F.getLabel(x),
                        O = y("group.type"),
                        f = y("group.border.width") || 0,
                        w = y("group.border.width.absolute"),
                        V = f / 2;
                    w && (f /= F._zoom), $ = vk(O, u, $), wr($, x, "group.padding", 1), $f($, f);
                    var i = T._88I = { type: O, rect: $, _64o: $ };
                    if (!O && R != A) {
                        var z, j = T.labelInfo = { label: R, color: y("group.title.color"), font: y("group.title.font"), align: y("group.title.align") },
                            r = Bi(j, R),
                            J = r.width + f,
                            M = r.height + f,
                            l = y("group.title.align"),
                            n = y("group.title.orientation");
                        if (n === Gm || n === uq ? ($.height += f, J > $.width && ($.width = J)) : (n === Ui || n === Ul) && ($.width += f, J > $.height && ($.height = J)), z = l === Ui ? $.x : l === Ul ? $.x + $.width - J : $.x + $.width / 2 - J / 2, n === uq) i.titleRect = { x: $.x, y: $.y + $.height, width: $.width, height: M }, i.rect = { x: $.x, y: $.y, width: $.width, height: $.height + M }, j.rect = { x: z, y: $.y + $.height, width: J, height: M };
                        else if (n === Ui) {
                            var I = i.titleRect = { x: $.x - M, y: $.y, width: M, height: $.height };
                            i.rect = { x: $.x - M, y: $.y, width: $.width + M, height: $.height }, j.rect = { x: I.x + M / 2 - $.height / 2, y: I.y + $.height / 2 - M / 2, width: $.height, height: M }, j.rotation = -Math.PI / 2
                        } else if (n === Ul) {
                            var I = i.titleRect = { x: $.x + $.width, y: $.y, width: M, height: $.height };
                            i.rect = { x: $.x, y: $.y, width: $.width + M, height: $.height }, j.rect = { x: I.x + M / 2 - $.height / 2, y: I.y + $.height / 2 - M / 2, width: $.height, height: M }, j.rotation = Math.PI / 2
                        } else i.titleRect = { x: $.x, y: $.y - M, width: $.width, height: M }, i.rect = { x: $.x, y: $.y - M, width: $.width, height: $.height + M }, j.rect = { x: z, y: $.y - M - V, width: J, height: M + f }
                    }
                    T._40O(i, y("group.border.width") / 2)
                } else be.superClass._3O.call(T)
            },
            getPosition: function(L, D, A, N) { var f = this._88I; if (f) { var c = Hf(L, f.rect, N); return c.x += D, c.y += A, c } return be.superClass.getPosition.apply(this, arguments) },
            _24O: function(A, j) {
                var f = this._88I;
                (!f || f.type || "label2" === A) && be.superClass._24O.call(this, A, j)
            },
            _80o: function(S) {
                var F = this,
                    Q = F._88I;
                if (Q) {
                    var X = F._data,
                        T = F.s,
                        h = F.gv,
                        Z = Q.type,
                        A = Q.rect,
                        $ = Q._64o,
                        L = Q.titleRect,
                        b = F.getBodyColor(),
                        q = Jc(T("group.image"), b),
                        D = T("group.image.stretch"),
                        g = F.getBodyColor("group.background"),
                        z = Jc(T("group.repeat.image"), b),
                        R = T("group.gradient.pack"),
                        f = T("group.gradient"),
                        W = T("group.gradient.color"),
                        t = T("group.border.width"),
                        P = T("group.border.color"),
                        K = T("group.border.pattern"),
                        k = T("group.title.orientation"),
                        w = T("group.depth"),
                        U = T("group.border.radius"),
                        r = T("group.border.join"),
                        H = T("group.border.cap"),
                        V = T("group.border.width.absolute");
                    V && (t /= h._zoom);
                    var G = P,
                        p = T("group.border.repeat.image");
                    if (p && (p = Jc(p, P)) && (G = Ij(S, p, P, null, X, h)), Z) {
                        var x = S.lineJoin,
                            Y = S.lineCap;
                        if (S.lineJoin = r, S.lineCap = H, q) {
                            if (S.save(), mj(S, Z, A, U), S.clip(), Kq(S, q, D, A.x, A.y, A.width, A.height, X, h, b), S.restore(), t > 0) {
                                var l = ad(S, K);
                                mj(l, Z, A, U), S.lineWidth = t, S.strokeStyle = G, S.stroke(), Xd(S, K)
                            }
                        } else {
                            var l = ad(S, K);
                            g || z || R ? (mj(S, Z, A, U), R ? uj(S, R, function(u) { return jk(u, b) }) : z ? Hn(S, z, b, null, X, h) : Vd(S, g, f, W, A), S.fill(), R && S.restore(), S !== l && mj(l, Z, A, U)) : mj(l, Z, A, U), t > 0 && (S.lineWidth = t, S.strokeStyle = G, S.stroke()), Xd(S, K), Z === Ej && cb(S, g, w, A)
                        }
                        S.lineJoin = x, S.lineCap = Y
                    } else {
                        var y = T("group.title.background");
                        if ((!U || 0 > U) && (U = 0), q) Kq(S, q, D, $.x, $.y, $.width, $.height, X, h, F.getBodyColor());
                        else if (g || z)
                            if (z ? Hn(S, z, b, null, X, h) : Vd(S, g, f, W, $), 0 === t) mj(S, Ej, $), S.fill(), cb(S, g, w, $);
                            else {
                                switch (S.beginPath(), k) {
                                    case uq:
                                        qd(S, $.x, $.y, $.width, $.height, U, U, 0, 0);
                                        break;
                                    case Ui:
                                        qd(S, $.x, $.y, $.width, $.height, 0, U, 0, U);
                                        break;
                                    case Ul:
                                        qd(S, $.x, $.y, $.width, $.height, U, 0, U, 0);
                                        break;
                                    case Gm:
                                        qd(S, $.x, $.y, $.width, $.height, 0, 0, U, U)
                                }
                                S.fill()
                            }
                        if (L && y)
                            if (0 === t) re(S, L.x, L.y, L.width, L.height, y), cb(S, y, w, L);
                            else {
                                switch (S.beginPath(), S.fillStyle = y, k) {
                                    case uq:
                                        qd(S, L.x, L.y, L.width, L.height, 0, 0, U, U);
                                        break;
                                    case Ui:
                                        qd(S, L.x, L.y, L.width, L.height, U, 0, U, 0);
                                        break;
                                    case Ul:
                                        qd(S, L.x, L.y, L.width, L.height, 0, U, 0, U);
                                        break;
                                    case Gm:
                                        qd(S, L.x, L.y, L.width, L.height, U, U, 0, 0)
                                }
                                S.fill()
                            }
                        if (t > 0) {
                            var l = ad(S, K);
                            if (mj(l, "roundRect", A, U), S.save(), S.lineWidth = t, S.strokeStyle = G, S.lineJoin = r, S.lineCap = H, S.closePath(), S.stroke(), L && T("group.splitLine")) {
                                var c = L.x,
                                    o = L.y,
                                    a = L.width,
                                    i = L.height;
                                S.beginPath(), k === uq ? (S.moveTo(c, o), S.lineTo(c + a, o)) : k === Ui ? (S.moveTo(c + a, o), S.lineTo(c + a, o + i)) : k === Ul ? (S.moveTo(c, o), S.lineTo(c, o + i)) : (S.moveTo(c, o + i), S.lineTo(c + a, o + i))
                            }
                            S.stroke(), S.restore(), Xd(l, K)
                        }
                    }
                    F._39O(S, Q)
                } else be.superClass._80o.call(F, S)
            }
        });
        var Cn = function(F, q) { th(Cn, this, [F, q]) };
        eh(Cn, Bd, { _80o: function(L) { this._39O(L, this._83o) } });
        var Rf = function(j, h) { th(Rf, this, [j, h]) };
        eh(Rf, Bd, {
            _3O: function() {
                var R = this,
                    Q = R._data,
                    E = R.s,
                    U = R.gv,
                    D = Q.getPoints(),
                    e = U.getBorderColor(Q),
                    o = e ? E("border.width") : 0,
                    i = R.getSelectWidth(),
                    l = E("shape.border.width"),
                    F = Q.getRect(),
                    P = Q.getAnchorRect(),
                    I = U.getBodyColor(Q),
                    S = E("shape.border.color"),
                    h = R._99o = D.isEmpty() ? A : { rect: F, rotation: Q.getRotation(), fillRule: E("shape.fill.rule"), scale: Q.getScale(), position: Q.p(), points: D, segments: Q.getSegments(), bodyColor: I, borderColor: e, borderWidth: o, _94o: E("shape.border.3d"), _95o: E("shape.border.3d.color"), _96o: E("shape.border.3d.accuracy"), _97o: i ? R.getSelectColor() : A, selectWidth: i, _53o: E("shape.background"), _27Q: Jc(E("shape.repeat.image"), I), shapeGradientPack: E("shape.gradient.pack"), _54o: l, _55o: S, shapeBorderRepeatImage: Jc(E("shape.border.repeat.image"), S), shapeGradient: E("shape.gradient"), _59o: E("shape.gradient.color"), _60o: E("shape.border.pattern"), _61o: E("shape.border.cap"), _62o: E("shape.border.join"), shapeForeground: E("shape.foreground"), gray: E("2d.gray") };
                if (h) {
                    P.x += h.position.x, P.y += h.position.y, h.gradientRect = P;
                    var W = Q.getScale(),
                        T = K(1, K(X(W.x), X(W.y)));
                    E("shape.dash") && E("shape.dash.width") > l && (l = E("shape.dash.width"));
                    var V, v = E("shape.border.width.absolute");
                    V = v ? (l + o + i) / R.gv._zoom / T : l * ("square" === h._61o ? .71 : .5) + o + i / R.gv._zoom / T, V && (V *= T, F = tf(F), _j(F, V, h._62o)), R._68o(F);
                    var Y = on(Q, U.isSelected(Q)),
                        q = E("clip.percentage");
                    1 > q && (0 > q && (q = 0), h.clipRect = Ln(Q.getAnchorRect(), E("clip.direction"), q, Y));
                    var j = E("shape.fill.clip.percentage");
                    1 > j && (0 > j && (j = 0), h.shapeClipRect = Ln(Q.getAnchorRect(), E("shape.fill.clip.direction"), j, Y));
                    var c = E("shape.foreground.clip.percentage");
                    1 > c && (0 > c && (c = 0), h.shapeForegroundClipRect = Ln(Q.getAnchorRect(), E("shape.foreground.clip.direction"), c, Y))
                }
            },
            getPosition: function(K, o, Y, N) { var m = this._99o; if (m) { var U = Hf(K, m.rect, N); return U.x += o, U.y += Y, U } return Xo },
            _42: function(Y) { this._99o && Rf.superClass._42.call(this, Y) },
            _80o: function(p) {
                var w, q = this,
                    _ = q.s,
                    h = q._99o,
                    j = h.position,
                    I = h.scale,
                    O = h.rotation,
                    B = h.borderWidth,
                    o = h.selectWidth / q.gv._zoom,
                    P = h._27Q,
                    E = h.shapeGradientPack,
                    z = h._54o,
                    r = h.clipRect,
                    u = h.shapeClipRect,
                    n = h.points,
                    Q = h.segments,
                    H = q._data.isClosePath(),
                    $ = h.fillRule,
                    K = h.gray,
                    S = function(T) { return K ? D.toGrayColor(T) : T },
                    g = S(h._53o),
                    b = g || P || E;
                p.save(), ts(p, j.x, j.y), nm(p, O), Zm(p, I.x, I.y), r && (p.beginPath(), p.rect(r.x, r.y, r.width, r.height), p.clip()), b && u && (p.save(), p.beginPath(), p.rect(u.x, u.y, u.width, u.height), p.clip()), ts(p, -j.x, -j.y);
                var e = h._60o,
                    J = ad(p, e),
                    T = p.lineJoin,
                    l = p.lineCap;
                p.lineJoin = h._62o, p.lineCap = h._61o;
                var Y = S(h.bodyColor);
                b ? (Eg(p, n, Q, H), E ? uj(p, E, function(w) { return jk(w, h.bodyColor) }) : P ? Hn(p, P, Y, null, q._data, q.gv) : (w = Y ? Y : g, Vd(p, w, h.shapeGradient, S(h._59o), h.gradientRect)), p.fill($), E && p.restore(), u && (p.restore(), ts(p, -j.x, -j.y)), J !== p && Eg(J, n, Q, H)) : Eg(J, n, Q, H);
                var d = h.shapeForeground;
                if (d) {
                    p.save();
                    var y = h.shapeForegroundClipRect;
                    y && (ts(p, j.x, j.y), p.beginPath(), p.rect(y.x, y.y, y.width, y.height), p.clip(), ts(p, -j.x, -j.y)), Eg(p, n, Q, H), Vd(p, d, _("shape.foreground.gradient"), S(_("shape.foreground.gradient.color")), h.gradientRect), p.fill($), p.restore()
                }
                var A = _("shape.border.width.absolute");
                if (A && (p.save(), p.setTransform(1, 0, 0, 1, 0, 0)), o && (p.strokeStyle = h._97o, p.lineWidth = z + 2 * (B + o), p.stroke()), B && (p.strokeStyle = S(h.borderColor), p.lineWidth = z + 2 * B, p.stroke()), z && (w = S(h._55o), h.shapeBorderRepeatImage ? od(p, h.shapeBorderRepeatImage, w, null, q._data, q.gv) : (!g && Y && (w = Y), p.strokeStyle = w), p.lineWidth = z, p.stroke(), h._94o && pj(p, w, S(h._95o), z, q.gv._zoom, h._96o)), Xd(p, e), _("shape.dash")) {
                    var N = _("shape.dash.width") || z;
                    if (N > 0) {
                        e = _("shape.dash.pattern");
                        var J = ad(p, e, q._2Q("shape.dash.offset"));
                        J !== p && Eg(J, n, Q, H), q._1Q(p, "shape", N, e)
                    }
                }
                A && p.restore(), p.lineJoin = T, p.lineCap = l, p.restore()
            },
            _48O: function() {},
            _47O: function() {}
        });
        var fp = function(F, P) { th(fp, this, [F, P]) };
        eh(fp, Rf, {
            getRotation: function(U, k, E) {
                U = U || 0;
                var b = this._data.getPoints(),
                    K = b.size();
                return K > 1 ? zo[E] ? K && 0 === K % 2 ? hs(b.get(K / 2 - 1), b.get(K / 2), k, U) : U : Tj[E] ? hs(b.get(0), b.get(1), k, U) : hs(b.get(K - 2), b.get(K - 1), k, U) : U
            },
            getPosition: function(X, t, $, F, y) {
                var W = this._data.getPoints(),
                    g = W.size();
                if (g > 1) {
                    if (zo[X]) {
                        var J = g % 2;
                        if (0 === J) return Ym(W.get(g / 2 - 1), W.get(g / 2), X, t, $, F, y);
                        var c = W.get((g - J) / 2),
                            Z = { x: c.x, y: c.y, width: 0, height: 0 };
                        return c = Hf(X, Z, F), c.x += t, c.y += $, c
                    }
                    return Tj[X] ? Ym(W.get(0), W.get(1), X, t, $, F, y) : Ym(W.get(g - 2), W.get(g - 1), X, t, $, F, y)
                }
                return Xo
            }
        });
        var sg = function(j, K) { th(sg, this, [j, K]) };
        eh(sg, Bd, {
            _3O: function() {
                var g = this;
                sg.superClass._3O.call(g);
                var v = g.s,
                    s = g._83o;
                g._82o = s.img || s.shape ? A : { background: g.getBodyColor("grid.background"), depth: v("grid.depth"), rect: s.rect, _88o: v("grid.cell.depth"), cellBorderColor: v("grid.cell.border.color"), _89o: v("grid.row.count"), _90o: v("grid.column.count"), block: v("grid.block"), _91o: v("grid.block.color"), _92o: v("grid.block.padding"), _93o: v("grid.block.width") }
            },
            _80o: function(U) {
                var N = this,
                    s = N._82o;
                if (!s) return sg.superClass._80o.call(N, U), void 0;
                var c, F, A = N._data,
                    M = s.background,
                    f = s.rect,
                    g = s.block,
                    R = s._91o,
                    V = s._92o,
                    w = s._93o,
                    H = s._88o,
                    S = s.cellBorderColor,
                    d = s._89o,
                    Z = s._90o;
                if (M)
                    if (re(U, f.x, f.y, f.width, f.height, M), cb(U, M, s.depth, f), H)
                        for (c = 0; d > c; c++)
                            for (F = 0; Z > F; F++) f = A.getCellRect(c, F), f && cb(U, M, H, f);
                    else if (S) {
                    for (U.beginPath(), c = 0; d > c; c++)
                        for (F = 0; Z > F; F++) f = A.getCellRect(c, F), f && U.rect(f.x, f.y, f.width, f.height);
                    U.strokeStyle = S, U.lineWidth = 1, U.stroke()
                }
                if ("h" === g)
                    for (c = 0; d > c; c++) f = bp(A.getCellRect(c, 0), A.getCellRect(c, Z - 1)), $f(f, V), Qn(U, R, f.x, f.y, f.width, f.height, w);
                else if ("v" === g)
                    for (F = 0; Z > F; F++) f = bp(A.getCellRect(0, F), A.getCellRect(d - 1, F)), $f(f, V), Qn(U, R, f.x, f.y, f.width, f.height, w);
                N._39O(U, N._83o)
            }
        });
        var ls = function(n, m) { th(ls, this, [n, m]) };
        eh(ls, Bd, {
            _checkEmptyRect: !1,
            _81o: function() {
                var J = this._data,
                    t = ls.superClass._81o.call(this),
                    Z = J.s("text");
                if (Z != A) {
                    var s, V, T = J.s("text.font"),
                        r = J.s("text.align"),
                        F = J.s("text.vAlign"),
                        W = Pg(T, Z),
                        D = W.width,
                        P = W.height,
                        I = J.getAnchor(),
                        c = J.getWidth(),
                        v = J.getHeight();
                    "left" === r ? s = -c * I.x : "center" === r ? s = -c * I.x + (c - D) / 2 : "right" === r && (s = c * (1 - I.x) - W.width), "top" === F ? V = -v * I.y : "middle" === F ? V = -v * I.y + (v - P) / 2 : "bottom" === F && (V = v * (1 - I.y) - W.height);
                    var o, H = J.getMatrix();
                    if (o = we([H.tf(s, V), H.tf(s + D, V), H.tf(s + D, V + P), H.tf(s, V + P)]), t = bp(t, o), t && J.s("text.shadow")) {
                        var p = tf(t);
                        p.x += J.s("text.shadow.offset.x"), p.y += J.s("text.shadow.offset.y"), $f(p, J.s("text.shadow.blur")), t = bp(t, p)
                    }
                }
                return t
            }
        });
        var Te = Rm.Interactor = function(S) { this.gv = this._graphView = S };
        Fj("Interactor", n, {
            ms_listener: 1,
            getView: function() { return this.gv.getView() },
            setUp: function() { this.addListeners() },
            tearDown: function() { this.removeListeners(), this.clear() },
            clear: function() {},
            fi: function($) { this.gv.fi($) },
            setCursor: function(F) { Po || this.gv.setCursor(F) },
            startDragging: function(p) {
                var I = this;
                I._lastClientPoint = Sp(p), I._lastLogicalPoint = I.gv.lp(p), zi(I, p)
            },
            clearDragging: function() {
                var T = this;
                T._lastClientPoint = T._lastLogicalPoint = T._logicalPoint = A
            },
            autoScroll: function(V) { return this.gv.autoScroll(V, this._lastClientPoint) }
        });
        var ne = A,
            Ki = function(f) { ne.handleWindowTouchMove(f) },
            xi = function(r) { ne.handleWindowTouchEnd(r), $(y, Nq, Ki), $(y, Zb, xi), ne = A },
            yq = function(l) { ne.handleWindowMouseMove(l) },
            Np = function(h) { ne.handleWindowMouseUp(h), $(y, Zp, yq), $(y, Zc, Np), ne = A },
            el = function(n, r) {
                if (n !== ne) {
                    var D = Mc(r);
                    ne ? D ? ne.handleWindowTouchEnd(r) : ne.handleWindowMouseUp(r) : D ? (v(y, Nq, Ki), v(y, Zb, xi)) : (v(y, Zp, yq), v(y, Zc, Np)), ne = n
                }
            },
            tm = function(H) {
                var z = this;
                z.gv = H, z._is2d = H instanceof Rm.GraphView, z._eventListeners = {}, ["mousedown", "mousemove", "mouseleave", "touchstart", "touchmove", Vk, "wheel"].forEach(function(f) { z.addListener(f) }), z.initImageResource()
            };
        eh(tm, Te, {
            enableVR: function(p) {
                var S = this;
                if (!!S._vrEnable !== p)
                    if (S._vrEnable = p, p) S.gv.vr.mp(S.onVRControllerChange, S);
                    else if (S.gv.vr.ump(S.onVRControllerChange, S), S._vrRayPolyline) {
                    var e = S.gv.dm();
                    e.remove(S._vrRayPolyline), e.remove(S._vrRayHitPoint), S._vrRayPolyline = O, S._vrRayHitPoint = O
                }
            },
            onVRControllerChange: function(K) {
                var F = this,
                    Z = K.property,
                    x = K.newValue,
                    M = F.gv.vr.getController(x.id),
                    C = M.getRay();
                C && ("gamepad.button.trigger" === Z ? "down" === x._62O ? F.handle_mousedown(C) : ne && Np(C) : "gamepad.pose" === Z && (F.handle_mousemove(C), ne && F.handleWindowMouseMove(C)))
            },
            drawVRRay: function(h, R, n) {
                var D, O = this,
                    A = O.gv,
                    W = O._vrRayPolyline,
                    E = !1;
                if (W) D = O._vrRayHitPoint;
                else {
                    var b = A.dm();
                    O._vrRayPolyline = W = new k.Polyline, O._vrRayHitPoint = D = new k.Node, D.s({ shape3d: "billboard", "shape3d.transparent": !0, "texture.scale": 10, "shape3d.image": "coreInteractorRayHitImage" }), D.setAnchor3d(.5, .5, .499);
                    var y = .2 / A.vr.measureOflength;
                    D.s3(y, y, y), W.s("intersect", !1), D.s("intersect", !1), b.add(W), b.add(D), E = !0
                }
                if (R) {
                    var Y = n.world,
                        z = n.worldNormal,
                        B = Y.x,
                        X = Y.y,
                        o = Y.z;
                    W.s("shape.border.color", "red"), W.setPoints([{ x: h.origin.x, y: h.origin.z, e: h.origin.y }, { x: B, y: o, e: X }]), D.s("3d.visible", !0), D.p3(B, X, o), D.lookAtDirection([z.x, z.y, z.z], "front")
                } else {
                    W.s("shape.border.color", "blue");
                    var x = new k.Math.Vector3;
                    x.copy(h.direction).setLength(1e3 / O.gv.vr.measureOflength).add(h.origin), W.setPoints([{ x: h.origin.x, y: h.origin.z, e: h.origin.y }, { x: x.x, y: x.z, e: x.y }]), D.s("3d.visible", !1)
                }
                A.fi({ kind: "vrRayIntersect", ray: h, data: R, intersect: n, polyline: W, hitNode: D, begin: E })
            },
            setPreventEventDefault: function(K, C) {
                var P = this,
                    W = P._eventListeners[K];
                W ? W._prevent = C : P._eventListeners[K] = W = { _removal: O, _prevent: C }
            },
            removeListener: function(C) {
                var Z = this,
                    q = Z._eventListeners[C];
                q && q._removal && (q._removal(), q._removal = O)
            },
            addListener: function(S) {
                var d = this,
                    f = d._eventListeners[S];
                if (f || (d._eventListeners[S] = f = { _removal: O, _prevent: !0 }), !f || !f._removal) {
                    var k = function(R) {
                        f._prevent && D.preventDefault(R), d.disabled || ("wheel" === S ? fh(d, R) : d["handle_" + S](R))
                    };
                    v(d.gv.getView(), S, k), f._removal = function() { $(d.gv.getView(), S, k) }
                }
            },
            handleWindowTouchMove: function(F) { this.handleWindowMouseMove(F) },
            handleWindowMouseMove: function(t) { this.downInfo && (this.isDragging ? this.handleDownInfo("onDrag", t) : (this.handleDownInfo("onBeginDrag", t), this.isDragging = !0)) },
            handleWindowTouchEnd: function(d) { this.handleWindowMouseUp(d) },
            handleWindowMouseUp: function(H) {
                if (this.isDragging && (this.handleDownInfo("onEndDrag", H), this.isDragging = !1), this.downInfo) {
                    var J = this.handle("onUp", H);
                    if (J && J.data === this.downInfo.data) {
                        this.handleMissingUp(H);
                        var T = this,
                            Z = 2 === H.button ? "onContextMenu" : "onClick";
                        if (!T._dbclickTimer) return T._dbclickTimer = Ig(function() { delete T._dbclickTimer, T.handleClick(H, Z, J), this.downInfo = A }, D.clickDelay), void 0;
                        pe(T._dbclickTimer), delete T._dbclickTimer, Z = "onDoubleClick", T.handleClick(H, Z, J)
                    } else this.handleDownInfo("onUp", H);
                    this.downInfo = A, this.downComps = A
                }
            },
            handle_mouseleave: function(X) {
                var B = this,
                    U = B.gv,
                    b = B.currentInfo ? B.currentInfo.data : A;
                if (b) {
                    b.s("onLeave") && b.s("onLeave")(X, b, U), B.fire("data", "onLeave", X, b);
                    var g = B.currentInfo ? B.currentInfo.hits : A;
                    if (g)
                        for (var t in g) B.handleLeave(X, t);
                    B.currentInfo = A
                }
            },
            handle_mousewheel: function(p) { p.scrollDelta = p.wheelDelta / 40, this.handle("onScroll", p) },
            handle_DOMMouseScroll: function(i) { i.scrollDelta = 2 === i.axis ? -i.detail : 0, this.handle("onScroll", i) },
            handle_touchstart: function($) { this.handle_mousedown($) },
            handle_touchmove: function(A) { this.handle("onMove", A) },
            handle_mousedown: function(c) { this.isDragging && (this.handleDownInfo("onEndDrag", c), this.isDragging = !1), this.downComps = [], this.downInfo = this.handle("onDown", c), this.downInfo && el(this, c) },
            handle_mousemove: function($) {
                var t = this,
                    C = t.gv;
                if (t._hoverTimer && (pe(t._hoverTimer), delete t._hoverTimer), !C._panning && !C._moving) {
                    var p, P, g, n = t.handle("onMove", $),
                        h = this.currentInfo ? this.currentInfo.data : A,
                        U = this.currentInfo ? this.currentInfo.hits : A;
                    if (n && (P = n.data, g = n.hits, t._hoverTimer = Ig(function() { pe(t._hoverTimer), delete t._hoverTimer, t.handle("onHover", $, n) }, C.getHoverDelay() || D.hoverDelay)), P !== h) {
                        if (h && (h.s("onLeave") && h.s("onLeave")($, h, C), this.fire("data", "onLeave", $, h)), P && (P.s("onEnter") && P.s("onEnter")($, P, C), this.fire("data", "onEnter", $, P)), U)
                            for (p in U) this.handleLeave($, p);
                        if (g)
                            for (p in g) {
                                var q = g[p],
                                    v = P._interactPrefix = q.prefix,
                                    Q = v && P.a(v + "onEnter") || q.target.onEnter;
                                Q && Q.call(q.target, $, P, C, q.point, q.width, q.height), this.fire(q.type, "onEnter", q.event, q.data, q.image, q.comp, q.point, q), P._interactPrefix = null
                            }
                    } else {
                        if (U)
                            for (p in U) g && g[p] || this.handleLeave($, p);
                        if (g)
                            for (p in g)
                                if (!U || !U[p]) {
                                    var q = g[p],
                                        v = P._interactPrefix = q.prefix,
                                        Q = v && P.a(v + "onEnter") || q.target.onEnter;
                                    Q && Q.call(q.target, $, P, C, q.point, q.width, q.height), this.fire(q.type, "onEnter", q.event, q.data, q.image, q.comp, q.point, q), P._interactPrefix = null
                                }
                    }
                    this.currentInfo = n
                }
            },
            handle: function(J, j, q) {
                var m, K = this,
                    X = K.gv;
                if (K._is2d) {
                    if (q = q || X.getDataInfoAt(j), !q || !X.isInteractive(q.data)) return;
                    if (m = q.ui.interactiveInfo) {
                        var U, P = q.data;
                        if (P.s(J) && P.s(J)(j, P, X), this.fire("data", J, j, P), "body" === q.part && m.bodyInfo) U = "body", q.hits = this.handleImage(U, X.getImage(P), J, j, P, q.point, m.bodyInfo);
                        else if ("icons" === q.part && m._38o) {
                            var $ = m._38o[q.name];
                            $ && $[q.index] && (U = "icons|" + q.name + "|" + q.index, q.hits = this.handleImage(U, q.icon, J, j, P, q.point, $[q.index]))
                        }
                    }
                    return q
                }
                var P, M;
                if (!q)
                    if (j && j instanceof k.Math.Ray) {
                        var l = X.vr.intersectWorld(j);
                        if (P = l.data, M = l.intersect, K.drawVRRay(j, P, M), !P) return;
                        var t = X.getData3dUI(P);
                        if (m = t.interactiveInfo, !m) return;
                        q = { data: P, part: M.part, ui: t }
                    } else {
                        if (q = X.getDataInfoAt(j), !q) return;
                        q && (q = { data: q.data, part: q.part })
                    }
                if (X.isInteractive(q.data)) {
                    if (!M) { P = q.data; var t = X.getData3dUI(P); if (q.ui = t, m = t.interactiveInfo, !m) return q; if (M = X.intersectObject(j, P), !M) return }
                    P.s(J) && P.s(J)(j, P, X), this.fire("data", J, j, P);
                    var i, p = M.part;
                    return "body" !== p && (i = P.s(p + ".image") || P.s("shape3d." + p + ".image")), i || (i = P.s("all.image") || P.s("shape3d.image")), i ? (m = "object" == typeof i ? m[i.uuid] : m[i], m && m.bodyInfo ? (q.part = "body", q.interactiveInfo = m, q.point = this._convertUVToPoint(M.uv, m), q.image = i, q.hits = this.handleImage("body", i, J, j, P, q.point, m.bodyInfo), q) : q) : q
                }
            },
            _handleLeaveOrMissing: function(H, w, O) {
                var B = "leave" === H ? this.currentInfo : this.downInfo;
                if (B) {
                    var M = B.interactiveInfo || B.ui.interactiveInfo;
                    if (M) {
                        var P, z, f = B.data;
                        if (this._is2d) {
                            if (z = this.gv.lp(w), "body" === B.part && M.bodyInfo) P = "body", "leave" === H ? this.handleLeaveImage(O, P, this.gv.getImage(f), w, f, z, M.bodyInfo) : this.handleMissingUpImage(P, this.gv.getImage(f), w, f, z, M.bodyInfo);
                            else if ("icons" === B.part && M._38o) {
                                var b = M._38o[B.name];
                                b && b[B.index] && (P = "icons|" + B.name + "|" + B.index, "leave" === H ? this.handleLeaveImage(O, P, B.icon, w, f, z, b[B.index]) : this.handleMissingUpImage(P, B.icon, w, f, z, b[B.index]))
                            }
                        } else {
                            if (!M.bodyInfo) return;
                            var o = this.gv.intersectObject(w, f);
                            z = o && o.uv ? this._convertUVToPoint(o.uv, M) : { x: 1 / 0, y: 1 / 0 }, "leave" === H ? this.handleLeaveImage(O, "body", B.image, w, f, z, M.bodyInfo) : this.handleMissingUpImage("body", B.image, w, f, z, M.bodyInfo)
                        }
                    }
                }
            },
            handleClick: function(F, a, g) {
                var N = this,
                    G = this.downInfo;
                if (G && g) {
                    var B, e = g.interactiveInfo || g.ui.interactiveInfo,
                        v = g.data,
                        M = this.gv;
                    if (v.s(a) && v.s(a)(F, v, M), N.fire("data", a, F, v), e)
                        if (this._is2d) { if (G.part === g.part) { var E = M.lp(F); "body" === g.part && e.bodyInfo && (B = "body", this.handleClickImage(B, M.getImage(v), a, F, v, E, e.bodyInfo, g)) } } else {
                            if (!e.bodyInfo) return;
                            var K = M.intersectObject(F, v);
                            if (!K) return;
                            E = this._convertUVToPoint(K.uv, e), this.handleClickImage("body", G.image, a, F, v, E, e.bodyInfo, g)
                        }
                }
            },
            handleDownInfo: function(M, V) {
                if (this.downInfo) {
                    var N = this.downInfo,
                        $ = this.gv,
                        w = N.interactiveInfo || N.ui.interactiveInfo;
                    if (w) {
                        var k, o = N.data;
                        if (o.s(M) && o.s(M)(V, o, $), this.fire("data", M, V, o), this._is2d) {
                            var c = $.lp(V);
                            if ("body" === N.part && w.bodyInfo) k = "body", this.handleDownInfoImage(k, $.getImage(o), M, V, o, c, w.bodyInfo);
                            else if ("icons" === N.part && w._38o) {
                                var b = w._38o[N.name];
                                b && b[N.index] && (k = "icons|" + N.name + "|" + N.index, this.handleDownInfoImage(k, N.icon, M, V, o, c, b[N.index]))
                            }
                        } else {
                            if (!w.bodyInfo) return;
                            var n = $.intersectObject(V, o);
                            if (!n) return;
                            c = this._convertUVToPoint(n.uv, w), this.handleDownInfoImage("body", N.image, M, V, o, c, w.bodyInfo)
                        }
                    }
                }
            },
            fire: function(I, F, C, n, d, t, r, g) { this.gv.fi({ kind: F, type: I, event: C, data: n, image: d, comp: t, view: this.gv, point: r, width: g ? g.width : O, height: g ? g.height : O }) },
            handleImage: function(n, A, v, w, E, G, g) {
                var _ = {};
                if (A && (A = Jc(A))) {
                    var e = this.gv,
                        S = g.rect,
                        i = this.convertPoint(G, g);
                    i.inRect && (A[v] && A[v](w, E, e, i, S.width, S.height), this.fire("image", v, w, E, A, O, i, S), _[n + "|image"] = { target: A, type: "image", image: A, data: E, event: w, point: i, width: S.width, height: S.height });
                    for (var z, o = g.compInfos, U = A, r = o.length - 1; r >= 0; r--) {
                        var a = o[r],
                            j = a.comp;
                        if (i = this.convertPoint(G, a, U, j, e, E), i.inRect) {
                            S = a.rect;
                            var R = E._interactPrefix = a.prefix,
                                H = R && E.a(R + v) || j[v];
                            if (H && (z = H.call(j, w, E, e, i, S.width, S.height)), this.fire("comp", v, w, E, A, j, i, S), z !== !0 && (A = S.image) && (A[v] && (z = A[v](w, E, e, i, S.width, S.height)), this.fire("image", v, w, E, A, O, i, S)), E._interactPrefix = null, _[n + "|" + r] = { target: j, type: "comp", comp: j, image: A, data: E, event: w, point: i, width: S.width, height: S.height, prefix: R }, this.downComps && this.downComps.push(j), A && (_[n + "|" + r + "|image"] = { target: A, type: "image", image: A, data: E, event: w, point: i, width: S.width, height: S.height, prefix: R }), z === !0) break
                        }
                    }
                }
                return _
            },
            handleLeave: function(F, f) { return this._handleLeaveOrMissing("leave", F, f) },
            handleMissingUp: function(h) { return this._handleLeaveOrMissing("missing", h) },
            handleLeaveImage: function(A, H, r, Y, V, v, F) {
                if (r && (r = Jc(r))) {
                    var J = this.gv,
                        t = F.rect,
                        u = this.convertPoint(v, F);
                    A === H + "|image" && (r.onLeave && r.onLeave(Y, V, J, u, t.width, t.height), this.fire("image", "onLeave", Y, V, r, O, u, t));
                    for (var g, e = F.compInfos, I = r, q = e.length - 1; q >= 0; q--) {
                        var x = e[q],
                            a = x.comp;
                        u = this.convertPoint(v, x, I, a, J, V), t = x.rect;
                        var T = V._interactPrefix = x.prefix;
                        if (A === H + "|" + q) {
                            var w = T && V.a(T + "onLeave") || a.onLeave;
                            w && (g = w.call(a, Y, V, J, u, t.width, t.height)), this.fire("comp", "onLeave", Y, V, r, a, u, t)
                        }
                        if (g !== !0 && (r = t.image) && A === H + "|" + q + "|image" && (r.onLeave && (g = r.onLeave(Y, V, J, u, t.width, t.height)), this.fire("image", "onLeave", Y, V, r, O, u, t)), V._interactPrefix = null, g === !0) break
                    }
                }
            },
            handleMissingUpImage: function(V, A, B, W, J, k) {
                var i = "onUp",
                    c = this.downInfo.hits;
                if (c && A && (A = Jc(A))) {
                    var $ = this.gv,
                        s = k.rect,
                        z = this.convertPoint(J, k);
                    !z.inRect && c[V + "|image"] && (A[i] && A[i](B, W, $, z, s.width, s.height), this.fire("image", i, B, W, A, O, z, s));
                    for (var w, m = k.compInfos, b = A, Q = m.length - 1; Q >= 0; Q--) {
                        var x = m[Q],
                            G = x.comp;
                        if (z = this.convertPoint(J, x, b, G, $, W), !z.inRect) {
                            s = x.rect;
                            var I = W._interactPrefix = x.prefix;
                            if (c[V + "|" + Q]) {
                                var u = I && W.a(I + i) || G[i];
                                u && (w = u.call(G, B, W, $, z, s.width, s.height)), this.fire("comp", i, B, W, A, G, z, s)
                            }
                            if (w !== !0 && (A = s.image) && c[V + "|" + Q + "|image"] && (A[i] && (w = A[i](B, W, $, z, s.width, s.height)), this.fire("image", i, B, W, A, O, z, s)), W._interactPrefix = null, w === !0) break
                        }
                    }
                }
            },
            handleDownInfoImage: function(H, W, u, _, I, x, g) {
                var f = this.downInfo.hits;
                if (f && W && (W = Jc(W))) {
                    var v = this.gv,
                        n = g.rect,
                        P = this.convertPoint(x, g);
                    f[H + "|image"] && (W[u] && W[u](_, I, v, P, n.width, n.height), this.fire("image", u, _, I, W, O, P, n));
                    for (var h, N = g.compInfos, w = W, J = N.length - 1; J >= 0; J--) {
                        var c = N[J],
                            j = c.comp;
                        P = this.convertPoint(x, c, w, j, v, I), n = c.rect;
                        var M = I._interactPrefix = c.prefix,
                            t = ["onDrag", "onEndDrag"].indexOf(u) >= 0;
                        if (!t && f[H + "|" + J] || t && this.downComps && this.downComps.indexOf(j) >= 0) {
                            var K = M && I.a(M + u) || j[u];
                            K && (h = K.call(j, _, I, v, P, n.width, n.height)), this.fire("comp", u, _, I, W, j, P, n)
                        }
                        if (h !== !0 && (W = n.image) && f[H + "|" + J + "|image"] && (W[u] && (h = W[u](_, I, v, P, n.width, n.height)), this.fire("image", u, _, I, W, O, P, n)), I._interactPrefix = null, h === !0) break
                    }
                }
            },
            handleClickImage: function(q, z, n, x, G, Q, A, j) {
                var L = this.downInfo.hits,
                    f = j.hits;
                if (L && z && (z = Jc(z))) {
                    var Y = this.gv,
                        U = A.rect,
                        N = this.convertPoint(Q, A);
                    L[q + "|image"] && (z[n] && z[n](x, G, Y, N, U.width, U.height), this.fire("image", n, x, G, z, O, N, U));
                    for (var v, Z = A.compInfos, J = z, w = Z.length - 1; w >= 0; w--) {
                        var H = Z[w],
                            S = H.comp;
                        N = this.convertPoint(Q, H, J, S, Y, G), U = H.rect;
                        var W = G._interactPrefix = H.prefix;
                        if (L[q + "|" + w] && f[q + "|" + w]) {
                            var m = W && G.a(W + n) || S[n];
                            m && (v = m.call(S, x, G, Y, N, U.width, U.height)), this.fire("comp", n, x, G, z, S, N, U)
                        }
                        if (v !== !0 && (z = U.image) && L[q + "|" + w + "|image"] && (z[n] && (v = z[n](x, G, Y, N, U.width, U.height)), this.fire("image", n, x, G, z, O, N, U)), G._interactPrefix = null, v === !0) break
                    }
                }
            },
            initImageResource: function() { D.setImage("coreInteractorRayHitImage", { width: 16, height: 16, comps: [{ type: "oval", background: "rgb(255,0,0)", borderWidth: 1, borderColor: "rgb(250,120,120)", opacity: .3, rotation: -1.593, rect: [.73315, .6933, 14.5337, 14.61341] }, { type: "oval", background: "rgb(255,0,0)", borderWidth: 1, borderColor: "rgb(250,120,120)", rotation: -1.593, rect: [3.56695, 3.75073, 8.8661, 8.49856] }] }) },
            _convertUVToPoint: function(v, C) {
                if (!v) return { x: 1 / 0, y: 1 / 0 };
                var S = C.bodyInfo.rect,
                    Y = v.clone(),
                    M = v.multiply({ x: S.width, y: S.height });
                return M.local = Y, M
            },
            convertPoint: function(H, s, m, u, J, P) {
                var Y = s.rect,
                    U = s.matrix.applyInverse(H).sub(Y),
                    X = U.x >= 0 && U.y >= 0 && U.x <= Y.width && U.y <= Y.height;
                if (!X) return U;
                if (u && Rr(u.pixelPerfect, P, J)) {
                    var Y, l = 1;
                    this._is2d ? (l = J.getZoom(), Y = bj(H.x, H.y, O, l)) : Y = bj(H.x, H.y);
                    var p = !1,
                        n = Y.x,
                        h = Y.y,
                        L = Y.width,
                        K = Y.height,
                        d = D.hitMaxArea,
                        W = L * K * l * l;
                    if (W > d) {
                        var M = Math.sqrt(d / W);
                        l *= M
                    }
                    L *= l, K *= l, 2 > L && (L = 2), 2 > K && (K = 2), n *= l, h *= l;
                    var r = cf(L, K),
                        w = new wh(0, -n, -h, l, l);
                    w.append(s.matrix), J._drawForChecking = !0, u.transform = w, s.refRect && s.refRect.fitSize && (u.refRect = s.refRect);
                    var k = m.comps;
                    m.comps = [u], as(r, m, 0, 0, L, K, P, self), m.comps = k, delete u.refRect, delete u.transform, J._drawForChecking = !1;
                    try {
                        for (var C = 0, z = r.getImageData(0, 0, L, K).data; C < z.length; C += 4)
                            if (0 !== z[C + 3]) { p = !0; break }
                        r.restore()
                    } catch (i) { Rl = A, p = !1 }
                    U.inRect = p
                } else U.inRect = !0;
                return U
            }
        });
        var bf = Rm.DefaultInteractor = function(M) { th(bf, this, [M]) };
        Fj("DefaultInteractor", Te, {
            handle_mousedown: function(g) {
                sh(g);
                var H = this,
                    _ = H.gv,
                    s = _.getDataAt(g);
                if (_.setFocus(g) && !_._editing && !_._scrolling) { Mp(g) ? _.handleDoubleClick(g, s) : _.handleClick(g, s); var W = kd(g);!wd() && !W && s && (_.isMovable(s) || _._39Q(s)) || !_.isPannable() || !pn(g) && !W || Xn(g) || (H._tx = _.tx(), H._ty = _.ty(), H.startDragging(g)) }
            },
            handleWindowMouseUp: function($) {
                var E = this,
                    p = E.gv;
                p._panning && (delete p._panning, p.onPanEnded(), E.fi({ kind: "endPan", event: $ })), delete E._tx, delete E._ty, E.clearDragging()
            },
            handle_mousemove: function(t) {
                var E = this,
                    _ = E.gv;
                E._hoverTimer && (pe(E._hoverTimer), delete E._hoverTimer), E._hoverTimer = Ig(function() { E.fi({ kind: "hover", event: t }), pe(E._hoverTimer), delete E._hoverTimer }, _.getHoverDelay() || D.hoverDelay)
            },
            handle_touchmove: function(B) { this.handle_mousemove(B) },
            handleWindowMouseMove: function(d) {
                var T = this,
                    l = T.gv;
                T.fi({ kind: l._panning ? "betweenPan" : "beginPan", event: d }), l._panning = 1;
                var J = Tq(l, d, T._lastClientPoint);
                l.setTranslate(T._tx + J.x, T._ty + J.y)
            },
            handle_mousewheel: function(H) { this.gv.handleScroll(H, H.wheelDelta) },
            handle_DOMMouseScroll: function(W) { 2 === W.axis && this.gv.handleScroll(W, -W.detail) },
            handle_keydown: function(K) { this.gv.handleKeyDown(K) }
        });
        var Yl = Rm.SelectInteractor = function(q) { th(Yl, this, [q]) };
        Fj("SelectInteractor", Te, {
            _42: function() {
                var F = this,
                    N = F.gv,
                    x = N.getZoom(),
                    D = F.mark,
                    n = F.div;
                n || (n = F.div = sf(), Ml(F.getView(), n));
                var S = {};
                S.x = D.x * x + N.tx(), S.y = D.y * x + N.ty(), S.width = D.width * x, S.height = D.height * x, dq(n, S), this.intersects() ? (n.style.border = "", n.style.background = N.getRectSelectBackground()) : (n.style.background = "", n.style.border = "1px solid " + N.getRectSelectBorderColor())
            },
            handle_mousedown: function(F) {
                var K = this,
                    u = K.gv;
                if (K._57I = A, K.pendingClickThrough = A, !(u._editing || u._scrolling || wd() || kd(F))) {
                    var p = u.getDataAt(F),
                        c = u.sm();
                    p ? Xn(F) ? c.co(p) ? c.rs(p) : c.as(p) : c.co(p) ? p instanceof em && p.isClickThroughEnabled() && pn(F) && (K.pendingClickThrough = Sp(F)) : c.ss(p) : Xn(F) || !u.isPannable() ? pn(F) && (Xn(F) || c.cs(), u.isRectSelectable() && (K.startDragging(F), u._77O = 1)) : pn(F) && (K._57I = Sp(F))
                }
            },
            handle_mouseup: function(I) {
                var M = this,
                    s = M.gv,
                    E = M._57I;
                if (E && (_q(E, Sp(I)) <= 1 && s.sm().cs(), M._57I = A), M.pendingClickThrough) {
                    if (_q(M.pendingClickThrough, Sp(I)) <= 1) {
                        var G = s.getDataAt(I);
                        if (G instanceof em && G.isClickThroughEnabled()) {
                            var w = s.getDataAt(I, function(O) { var R = O.getParent() === G && s.isSelectable(O, !0); return R });
                            w && (I.clickThrough = !0, s.sm().ss(w))
                        }
                    }
                    M.pendingClickThrough = A
                }
            },
            handleWindowMouseUp: function(Z) { this.clear(Z) },
            handleWindowMouseMove: function(O) {
                var r = this,
                    c = r.gv;
                r._logicalPoint = c.lp(O), r.mark ? (r.fi({ kind: "betweenRectSelect", event: O }), c.isPannable() && r.autoScroll(O), r.redraw()) : r.fi({ kind: "beginRectSelect", event: O }), r.mark = we(r._lastLogicalPoint, r._logicalPoint), r.redraw()
            },
            intersects: function() {
                var M = this,
                    q = M._lastLogicalPoint,
                    t = M._logicalPoint;
                return q.x > t.x || q.y > t.y
            },
            clear: function(L) {
                var a = this,
                    v = a.gv,
                    g = a.mark;
                if (a._57I = A, a.pendingClickThrough = A, a._lastLogicalPoint) {
                    if (g) {
                        if (0 !== g.width && 0 !== g.height) {
                            var $ = v.getDatasInRect(g, a.intersects());
                            if (!$.isEmpty()) {
                                var B = v.sm(),
                                    D = B.toSelection();
                                $.each(function(E) { B.co(E) ? D.remove(E) : D.add(E) }), B.ss(D)
                            }
                        }
                        tp(a.div), delete a.div, delete a.mark, a.redraw(), a.fi({ kind: "endRectSelect", event: L }), v.onRectSelectEnded()
                    }
                    a.clearDragging(), delete v._77O
                }
            },
            redraw: function() {
                var Y = this;
                Y._draw || (Y._draw = 1, Ig(function() { Y.mark && Y._42(), delete Y._draw }, 16))
            }
        });
        var Oc = Rm.MoveInteractor = function(f) { th(Oc, this, [f]) };
        Fj("MoveInteractor", Te, {
            handle_mousedown: function(d) {
                var y = this,
                    Q = y.gv;
                if (pn(d) && !Q._editing && !Q._scrolling && !wd()) { var K = Q.getSelectedDataAt(d);!K || Q._39Q(K) && !Q.isMovable(K) ? Q._focusData = A : (y._data = K, Q.handleMouseDown && Q.handleMouseDown(d, K), y.startDragging(d), Q.isMovable(K) && (Q._moving = 1)) }
            },
            handleWindowMouseUp: function(g) {
                var B = this,
                    L = B.gv;
                L.handleMouseUp && L.handleMouseUp(g, B._data), B.clear(g)
            },
            handleWindowMouseMove: function(R) {
                var N = this,
                    z = N._data,
                    B = N.gv;
                if ((!B._93O || !B._93O(R, z)) && B._moving) {
                    N._logicalPoint || N.fi({ kind: "prepareMove", event: R });
                    var o = N._logicalPoint ? "betweenMove" : "beginMove",
                        k = { kind: o, event: R },
                        $ = N._logicalPoint = B.lp(R);
                    "beginMove" !== o || N._alreadyBeginTransaction || (N._alreadyBeginTransaction = !0, B.getDataModel().beginTransaction());
                    var X = N._calcShift(o, R),
                        I = X.x,
                        r = X.y,
                        G = N.gv.getMoveMode(R, z);
                    G && ("x" === G ? r = 0 : "y" === G ? I = 0 : "xy" !== G && (I = r = 0)), B.moveSelection(I, r), N._lastLogicalPoint = $, N.autoScroll(R), N.fi(k)
                }
            },
            _calcShift: function() {
                var A = this,
                    Y = A._logicalPoint,
                    q = A._lastLogicalPoint,
                    K = Y.x - q.x,
                    b = Y.y - q.y;
                return { x: K, y: b }
            },
            clear: function(s) {
                var h = this,
                    g = h.gv;
                h._lastLogicalPoint && (h._lastLogicalPoint = h._data = g._moving = A, h._logicalPoint && (h.fi({ kind: "endMove", event: s }), g.onMoveEnded()), h.clearDragging()), h._alreadyBeginTransaction && (h._alreadyBeginTransaction = !1, g.getDataModel().endTransaction())
            }
        });
        var tb = Rm.TextEditInteractor = function(T) { th(tb, this, [T]), this.init() };
        Fj("TextEditInteractor", Te, {
            init: function() {
                var A = this,
                    _ = this.input = M.createElement("input"),
                    T = _.style;
                _.text = "text", T.border = "1px solid #d8d8d8", T.position = "absolute", T.padding = "2px 3px", T.outline = "none", T.marginLeft = "-90px", T.marginTop = "-16px", T.backgroundColor = "rgba(255,255,255, 0.9)", T.fontSize = "14px", T.width = "180px", T.height = "32px", T.boxShadow = "0 0 13px rgba(16,142,233, 0.5)", T.textAlign = "center", T.boxSizing = "border-box", v(_, "keyup", function(n) { jf(n) && A.endTextEdit() }), v(_, "focus", function() { _.select() });
                var w = this.textarea = M.createElement("textarea"),
                    H = this.wrap = M.createElement("div");
                H.appendChild(w), T = w.style, T.margin = 0, T.padding = "4px", T.overflow = "hidden", T.boxSizing = "border-box", T.position = "absolute", T.outline = "none", T.backgroundColor = "transparent", T.resize = "none", T.textAlign = "center", T.fontSize = "14px", T.border = "none", T.borderWidth = 0, T.width = "100%", T.top = "50%", T = H.style, T.boxSizing = "border-box", T.margin = 0, T.padding = 0, T.position = "absolute", T.boxShadow = "0 0 13px rgba(16,142,233, 0.5)", T.border = "1px solid #d8d8d8", T.backgroundColor = "rgba(255,255,255, 0.9)", T.width = "180px", T.marginLeft = "-90px", v(w, "keydown", function(D) { return (eq() || Xn()) && jf(D) ? (A.endTextEdit(), void 0) : (A.calculateTextareaHeight(String.fromCharCode(D.keyCode)), void 0) }), v(w, "focus", function() { w.select() });
                var g = function(U) { U.stopPropagation() };
                v(_, "mousedown", g), v(_, "touchstart", g), v(w, "mousedown", g), v(w, "touchstart", g), A.SIZING_STYLE = ["letter-spacing", "line-height", "padding-top", "padding-bottom", "font-family", "font-weight", "font-size", "text-rendering", "text-transform", "width", "text-indent", "padding-left", "padding-right", "border-width", "box-sizing"], A.HIDDEN_TEXTAREA_STYLE = "visibility:hidden; min-height:0 !important;max-height:none !important;height:0 !important;visibility:hidden !important;overflow:hidden !important;position:absolute !important;z-index:-1000 !important;top:0 !important;right:0 !important", A.handleWindowClick = function(Q) {
                    var R = A._editingDOM;
                    if (R) {
                        var u = R.getBoundingClientRect(),
                            Z = Sp(Q);
                        Df(u, Z) || A.endTextEdit()
                    }
                }
            },
            handle_mousedown: function(A) {
                var S = this,
                    Y = S.gv;
                if (Mp(A) && !Y._editing) {
                    var C = Y.getDataAt(A);
                    if (C) {
                        var u = Y.getTextEditInfo(C);
                        u && (this._editInfo = u, this._editTarget = C, Y._editing = !0, u.isMultiline ? this.handleMultilineEdit() : this.handleTextEdit())
                    }
                }
            },
            handleMultilineEdit: function() {
                var m = this,
                    M = m.gv,
                    P = m._editTarget,
                    B = m.getTargetValue(),
                    H = m.textarea,
                    N = m.wrap;
                this.hiddenTextarea || this.createHiddenTextarea(), (null === B || B === O) && (B = ""), H.value = B, m._editingDOM = H, M.getView().appendChild(N), this.layoutHTML(N, P), this.calculateTextareaHeight(), Ig(function() { H.focus(), v(y, "mousedown", m.handleWindowClick), v(y, "touchstart", m.handleWindowClick) }, 10)
            },
            handleTextEdit: function() {
                var d = this,
                    M = d.gv,
                    H = d._editTarget,
                    B = d.getTargetValue(),
                    k = d.input;
                (null === B || B === O) && (B = ""), k.value = B, d._editingDOM = k, M.getView().appendChild(k), this.layoutHTML(k, H), Ig(function() { k.focus(), v(y, "mousedown", d.handleWindowClick), v(y, "touchstart", d.handleWindowClick) }, 10)
            },
            layoutHTML: function(i, b) {
                var A = this.gv,
                    l = A.getZoom();
                if (b instanceof k.Node) {
                    var o = b.getRect();
                    i.style.left = (o.x + o.width / 2) * l + A.tx() + "px", i.style.top = (o.y + o.height / 2) * l + A.ty() + "px"
                } else if (b instanceof k.Edge) {
                    var s = A.getDataUI(b),
                        o = s._6I;
                    i.style.left = (o.x + o.width / 2) * l + A.tx() + "px", i.style.top = (o.y + o.height / 2) * l + A.ty() + "px"
                }
            },
            endTextEdit: function() {
                var M = this,
                    J = M._editInfo.isMultiline ? M.wrap : M.input,
                    u = M._editInfo.isMultiline ? M.textarea : M.input;
                M.setTargetValue(u.value), M.gv.getView().removeChild(J), M.gv._editing = !1, delete M._editingDOM, $(y, "mousedown", M.handlelick), $(y, "touchstart", M.handleWindowClick)
            },
            setTargetValue: function(T) {
                var P = this,
                    u = P._editTarget,
                    h = P._editInfo,
                    r = h.accessType,
                    o = h.name;
                if (o && r || (r = "p", o = "name"), "p" === r) {
                    var q = k.Default.setter(o);
                    u[q](T)
                } else "a" === r ? u.a(o, T) : u.s(o, T)
            },
            getTargetValue: function() {
                var J = this,
                    B = J._editTarget,
                    d = J._editInfo,
                    S = d.accessType,
                    y = d.name;
                if (y && S || (S = "p", y = "name"), "p" === S) { var Z = k.Default.getter(y); return B[Z]() }
                return "a" === S ? B.a(y) : B.s(y)
            },
            createHiddenTextarea: function() { this.hiddenTextarea = M.createElement("textarea"), this.hiddenTextarea.setAttribute("style", "margin:0; padding:0; position:absolute; overflowY:scroll; resize:none; box-sizing:border-box;"), this.hiddenTextarea.setAttribute("rows", "1"), this.gv.getView().appendChild(this.hiddenTextarea) },
            calculateHTMLStyle: function(n, u) {
                if (u && this.computedStyleCache) return this.computedStyleCache;
                var X = this,
                    v = y.getComputedStyle(n),
                    m = v.getPropertyValue("box-sizing") || v.getPropertyValue("-moz-box-sizing") || v.getPropertyValue("-webkit-box-sizing"),
                    E = parseFloat(v.getPropertyValue("padding-bottom")) + parseFloat(v.getPropertyValue("padding-top")),
                    t = parseFloat(v.getPropertyValue("border-bottom-width")) + parseFloat(v.getPropertyValue("border-top-width")),
                    h = X.SIZING_STYLE.map(function(U) { return U + ":" + v.getPropertyValue(U) }).join(";"),
                    C = { sizingStyle: h, paddingSize: E, borderSize: t, boxSizing: m };
                return u && (this.computedStyleCache = C), C
            },
            calculateTextareaHeight: function(s) {
                s = s || "";
                var A = this,
                    E = A.textarea,
                    t = A.hiddenTextarea,
                    b = A.wrap,
                    n = 32,
                    K = A.calculateHTMLStyle(E, !1),
                    R = K.paddingSize,
                    o = K.borderSize,
                    V = K.boxSizing,
                    x = K.sizingStyle;
                t.setAttribute("style", x + ";" + A.HIDDEN_TEXTAREA_STYLE), t.value = E.value + s;
                var O = t.scrollHeight;
                "border-box" === V ? O += o : "content-box" === V && (O -= R), E.style.height = O + "px", E.style.marginTop = 0 - .5 * O + "px", b.style.height = Math.max(O, n) + "px", b.style.marginTop = O * -.5 + "px"
            }
        });
        var Gg = Rm.ScrollBarInteractor = function(u) { th(Gg, this, [u]) };
        Fj("ScrollBarInteractor", Te, {
            _41o: function() { return this.gv.getViewRect().height < this.gv.getScrollRect().height },
            _40o: function() { return this.gv.getViewRect().width < this.gv.getScrollRect().width },
            isV: function(e) { var $ = this.gv.getViewRect(); return this._41o() && ($.x + $.width - this.gv.lp(e).x) * this.gv.getZoom() < Xb },
            isH: function(M) { var L = this.gv.getViewRect(); return this._40o() && (L.y + L.height - this.gv.lp(M).y) * this.gv.getZoom() < Xb },
            handle_mousemove: function(c) { this.handle_touchmove(c) },
            handle_touchmove: function(J) {
                if (!nj && pn(J) && this.gv.isScrollBarVisible()) {
                    var o = this,
                        H = o.isV(J),
                        j = o.isH(J);
                    (H || j) && o.gv.showScrollBar(), o.gv._scrolling = H || j
                }
            },
            handleWindowMouseUp: function(S) { this.handleWindowTouchEnd(S) },
            handleWindowTouchEnd: function(G) { this._state = this._cp = this._tx = this._ty = this.gv._scrolling = A, this.fi({ kind: "endScroll", event: G }) },
            handle_mousedown: function(S) { this.handle_touchstart(S) },
            handle_touchstart: function(o) {
                var U = this;
                if (U.gv.setFocus(o), sh(o), U.handle_touchmove(o), !(Xk(o) > 1) && U.gv._scrolling && U.gv.isScrollBarVisible()) {
                    U._cp = Sp(o), U._tx = U.gv.tx(), U._ty = U.gv.ty();
                    var p = U.isV(o);
                    U._state = p ? "vScroll" : "hScroll", zi(U, o), U.fi({ kind: "beginScroll", event: o })
                }
            },
            handleWindowMouseMove: function(p) { this.handleWindowTouchMove(p) },
            handleWindowTouchMove: function(_) {
                var X = Sp(_),
                    v = this.gv.getViewRect(),
                    n = this.gv.getScrollRect();
                "vScroll" === this._state ? this.gv.ty(this._ty + (this._cp.y - X.y) * n.height / v.height) : "hScroll" === this._state && this.gv.tx(this._tx + (this._cp.x - X.x) * n.width / v.width), this.fi({ kind: "betweenScroll", event: _ })
            }
        });
        var lj = Rm.TouchInteractor = function(S, F) { F = F || {}, F.selectable === O && (F.selectable = !0), F.movable === O && (F.movable = !0), F.pannable === O && (F.pannable = !0), F.pinchable === O && (F.pinchable = !0), F.editable === O && (F.editable = !0), this.params = F, th(lj, this, [S]) };
        Fj("TouchInteractor", Te, {
            ms_edit: 1,
            setUp: function() {
                var L = this;
                lj.superClass.setUp.call(L), Po && L.params.editable && L.gv.setEditInteractor(L)
            },
            tearDown: function() {
                var h = this;
                lj.superClass.tearDown.call(h), Po && h.params.editable && h.gv.setEditInteractor(A)
            },
            clear: function(V) {
                var W = this,
                    M = W.gv;
                M._moving && (W.fi({ kind: "endMove", event: V }), delete M._moving, M.onMoveEnded(), M.dm().endTransaction()), M._panning && (W.fi({ kind: "endPan", event: V }), delete M._panning, M.onPanEnded()), M._pinching && (W.fi({ kind: "endPinch", event: V }), delete M._pinching, M.onPinchEnded()), M._editing && (W._46O(V), W._77I = W._node = W._edge = W._shape = W._rect = W._89I = W._index = M._editing = A), W.pendingClickThrough = W._moving = W._panning = W._pinching = W._editing = W._57I = W._data = W._beginHistory = A, W.clearDragging()
            },
            handle_touchstart: function(o) {
                var a = this;
                if (!a.gv._editing) {
                    sh(o), a._57I = A, a.pendingClickThrough = A;
                    var z = a.params,
                        h = a.gv,
                        P = h.sm(),
                        d = h.getDataAt(o),
                        J = Xk(o);
                    if (1 === J) {
                        if (Mp(o)) return h.handleDoubleClick(o, d), void 0;
                        h.handleClick(o, d), d && (h.handleMouseDown && h.handleMouseDown(o, d), a._data = d), z.selectable || (d = A), d && (P.co(d) ? d instanceof em && d.isClickThroughEnabled() && (a.pendingClickThrough = Sp(o)) : P.ss(d), z.editable && h.isEditable(d) && a._79I(o, d, !0) ? (a._editing = 1, a.startDragging(o)) : z.movable && h.isMovable(d) && (a._moving = 1, a.startDragging(o))), d && h.isMovable(d) || (a._57I = Sp(o), z.pannable && h.isPannable() && (a._panning = 1, a.startDragging(o), a._translate = { x: h.tx(), y: h.ty() }))
                    } else if (z.pinchable && 2 === J) {
                        if (d && h._39Q(d)) return;
                        a._pinching = 1, a.startDragging(o);
                        var F = h.getView(),
                            I = h.getZoom(),
                            K = F.getBoundingClientRect(),
                            u = o.touches[0],
                            H = o.touches[1],
                            k = { x: (u.clientX + H.clientX) / 2 - K.left, y: (u.clientY + H.clientY) / 2 - K.top };
                        k.x -= h.tx(), k.y -= h.ty(), k.x /= I, k.y /= I, a._p = k, a._d = mi(o)
                    }
                }
            },
            handle_touchend: function(U) {
                var v = this,
                    o = v.gv,
                    j = v._57I,
                    Z = v._data;
                if (j && (_q(j, Sp(U)) <= 1 && !o.getDataAt(U) && o.sm().cs(), v._57I = A), Z && o.handleMouseUp && o.handleMouseUp(U, Z), v.pendingClickThrough) {
                    if (_q(v.pendingClickThrough, Sp(U)) <= 1) {
                        var Z = o.getDataAt(U);
                        if (Z instanceof em && Z.isClickThroughEnabled()) {
                            var S = o.getDataAt(U, function(z) { var Q = z.getParent() === Z && o.isSelectable(z, !0); return Q });
                            S && (U.clickThrough = !0, o.sm().ss(S))
                        }
                    }
                    v.pendingClickThrough = A
                }
            },
            handleWindowTouchEnd: function(s) { this.clear(s) },
            handleWindowTouchMove: function(q) {
                var b = this,
                    Z = b.gv,
                    B = Xk(q);
                if (1 === B) {
                    var C = Sp(q),
                        Y = Tq(Z, C, b._lastClientPoint),
                        E = _q({ x: 0, y: 0 }, Y);
                    if (b._editing && (b._beginHistory || (b._beginHistory = 1, Z.dm().beginTransaction()), Z._editing = 1, b._78I(q)), b._moving) {
                        if (!Z._moving && E < D.touchMoveThreshold) return;
                        b._beginHistory || (b._beginHistory = 1, Z.dm().beginTransaction()), b.handleMove(q)
                    } else if (b._panning) {
                        if (!Z._panning && E < D.touchMoveThreshold) return;
                        Z.setTranslate(b._translate.x + Y.x, b._translate.y + Y.y), b.fi({ kind: Z._panning ? "betweenPan" : "beginPan", event: q }), Z._panning = 1
                    }
                } else if (2 === B && b._pinching) {
                    var P = mi(q);
                    Z.handlePinch(b._p, P, b._d), b._d = P, b.fi({ kind: Z._pinching ? "betweenPinch" : "beginPinch", event: q }), Z._pinching = 1
                }
            },
            handleMove: function(H) {
                var g = this,
                    D = g.gv,
                    j = D.lp(H);
                D._93O && D._93O(H, g._data) || (D.moveSelection(j.x - g._lastLogicalPoint.x, j.y - g._lastLogicalPoint.y), g._lastLogicalPoint = j, g.autoScroll(H), g.fi({ kind: D._moving ? "betweenMove" : "beginMove", event: H }), D._moving = 1)
            }
        });
        var k = y.ht,
            ie = k.graph._editor = { Math: k.Math, Guide: {} };
        ie.getStyle = function(G) { var F, r = ie.StyleMap; return r && (F = r[G], F !== O) ? F : ie.DefaultStyleMap[G] }, ie.setStyle = function(m, z) {
            var v = ie.StyleMap;
            v || (v = ie.StyleMap = {}), v[m] = z
        }, ie.inEdit = function(T) { return T._inXEdit === !0 }, ie.startEdit = function(K) { K._inXEdit = !0, ie.Inject.doInject(K) }, ie._46O = function(g) { g._inXEdit = !1, ie.Inject.undoInject(g) }, ie.toScreenPosition = function(C, P) {
            var s = C.tx(),
                h = C.ty(),
                m = C._zoom;
            return new ie.Math.Vector2(P.x * m + s, P.y * m + h)
        }, ie.checkHit = function(s, $, t) { return s.distanceTo($) < t ? !0 : !1 }, ie.toWorldPosition = function(d, v) {
            var z = d.tx(),
                y = d.ty(),
                Z = d._zoom;
            return { x: (v.x - z) / Z, y: (v.y - y) / Z }
        }, ie.setAntialias = function(p, e) {
            for (var i, X = ["imageSmoothingEnabled", "webkitImageSmoothingEnabled", "mozImageSmoothingEnabled", "oImageSmoothingEnabled", "msImageSmoothingEnabled"], L = 0, U = X.length; U > L && (i = X[L], !(i in p)); L++);
            p[i], p[i] = e
        }, ie.getTargetCornersOnScreen = function(i, J) {
            if (!J) return null;
            var V, c = [];
            if (oh(J, i)) {
                var Q = Kc(i, J);
                V = [{ x: Q.x, y: Q.y }, { x: Q.x + Q.width, y: Q.y }, { x: Q.x + Q.width, y: Q.y + Q.height }, { x: Q.x, y: Q.y + Q.height }]
            } else {
                if (!J.getCorners) return null;
                V = J.getCorners()
            }
            return V.forEach(function(b) {
                var g = ie.toScreenPosition(i, b);
                c.push(g.x, g.y)
            }), c
        }, ie.log = function() {};
        var yf = ie.Inject = { _modules: [] };
        yf.registAsModule = function(Q, $) {
            var w = {},
                O = {};
            for (var h in Q) {
                var z = $.prototype[h];
                w[h] = z
            }
            Q.getBackup = function(D) { return w[D] }, Q.getBackups = function() { return w }, O.doInject = function() { for (var D in Q) "getBackup" !== D && ($.prototype[D] = Q[D]) }, O.undoInject = function() { for (var i in Q) "getBackup" !== i && ($.prototype[i] = w[i]) }, yf._modules.push(O)
        }, yf.doInject = function(j) { for (var C, d = yf._modules, N = 0, r = d.length; r > N; N++) C = d[N], C.doInject(j) }, yf.undoInject = function(K) { for (var i, r = yf._modules, F = 0, N = r.length; N > F; F++) i = r[F], i.undoInject(K) };
        var Te = k.graph.EditInteractor = function(A) {
                var J = this,
                    r = M.createElement("canvas");
                r.className = "editCanvas", r.style.position = "absolute", J._styleMap = {}, J._canvas = r, J._context = r.getContext("2d"), Te.superClass.constructor.call(J, A), this._editDetail = !1, ie.setAntialias(J._context, !1), J._subModules = [new ie.Anchor(J), new ie.RotateX(J), new ie.MoveDummy(J), new ie.Rect(J), new ie.Curve(J), new ie.MoveHelper(J)], J._gridGuide = new ie.Guide.Grid(J), J._rectGuide = new ie.Guide.Rect(J), J._hoverGuide = new ie.Guide.Hover(J)
            },
            un = Te;
        k.Default.def(Te, k.graph.Interactor, { ms_edit: 1, ms_fire: 1 }), n.defineProperties(Te.prototype, {
            editDetail: {
                get: function() { var n = !!this._editDetail; return n },
                set: function(B) {
                    var E = this,
                        D = E._editDetail;
                    D !== B && (E._editDetail = B, E.gv._editing = B, E.fp("editDetail", D, B), E.fp("pointsEditingMode", D, B), E.fi({ kind: B ? "beginEditPoints" : "endEditPoints" }))
                }
            },
            gvEditing: {
                get: function() { return this.gv._editing },
                set: function(g) {
                    (!this._editDetail || g) && (this.gv._editing = g, g || (this.editDetail = !1))
                }
            },
            editing: { get: function() { return this._editing }, set: function(R) { this._editing = R, this.gvEditing = R } },
            editingModule: { get: function() { return this._editMod } },
            pointsEditingMode: {
                get: function() { return this.editDetail },
                set: function(e) {
                    var x = this;
                    x.editDetail !== e && (e ? x._tryEnterEditDetailMode() : x._tryQuitEditDetailMode())
                }
            },
            gridEnabled: { get: function() { var P = this._gridEnabled; if (!P) return !1; var f = this.gv; return f ? !0 : !0 }, set: function(W) { W !== this._gridEnabled && (this._gridEnabled = W, this._42()) } },
            alignmentGuideEnabled: { get: function() { return this._agEnabled }, set: function(E) { E !== this._agEnabled && (this._agEnabled = E, this._42()) } },
            gridGuide: { get: function() { return this._gridGuide } },
            rectGuide: { get: function() { return this._rectGuide } },
            hoverGuide: { get: function() { return this._hoverGuide } }
        }), Te.prototype.getSubModule = function(F) {
            var T, Z, h, L = this._subModules;
            for (Z = 0, h = L.length; h > Z; Z++)
                if (T = L[Z], T.catalog === F) return T
        }, Te.prototype.invokeSubModule = function(v, n) {
            for (var i, e, E, _ = this, S = _._subModules, R = Array.prototype.slice.call(arguments, 2), q = 0, u = S.length; u > q; q++)
                if (i = S[q], e = i[v], e && (E = e.apply(i, R), E != O && n)) return i
        }, Te.prototype.invokeSubModuleInverse = function(L, I) {
            var _ = this,
                J = _._subModules;
            if (J)
                for (var c, R, S, W = Array.prototype.slice.call(arguments, 2), l = J.length - 1; l >= 0; l--)
                    if (c = J[l], R = c[L], R && (S = R.apply(c, W), S != O && I)) return c
        }, Te.prototype.setUp = function() {
            ie.log("setUp");
            var m = this,
                p = m.gv,
                w = p.getView(),
                H = m._canvas;
            Te.superClass.setUp.call(m), p.setEditInteractor(m), p._79O ? w.insertBefore(H, p._79O) : w.appendChild(H), ie.startEdit(p), m.invokeSubModule("setUp"), p.dm().mm(m._onDataModelChanged, m), p.dm().md(m._onDataPropertyChanged, m)
        }, Te.prototype.tearDown = function() {
            ie.log("tearDown");
            var A = this,
                v = A.gv,
                d = v.getView();
            A._resetCustomCursorStyle(), Te.superClass.tearDown.call(A), v.dm().umm(A._onDataModelChanged, A), v.dm().umd(A._onDataPropertyChanged, A), v.setEditInteractor(null), d.removeChild(A._canvas), A._drawTimer && (pe(A._drawTimer), A._drawTimer = null), ie._46O(v), A.invokeSubModule("tearDown")
        }, Te.prototype._onDataModelChanged = function(G) {
            var Y = this;
            ("clear" === G.kind || "remove" === G.kind && Y.editDetail && G.data === Y.getSubModule("Curve").target) && (Y.editDetail = !1, Y._42())
        }, Te.prototype._onDataPropertyChanged = function(W) {
            var z = this;
            if (z.editDetail) {
                var q = z.getSubModule("Curve"),
                    G = W.data;
                G === q.target && (G._writing || q._handleDataChanged(W))
            }
        }, Te.prototype.clear = function() { ie.log("clear") }, Te.prototype.redraw = function() { this._42() }, Te.prototype._42 = function() {
            var b = this;
            b._drawTimer || (b._drawTimer = Ig(function() { b._drawTimer = null, b.drawImpl() }, 0))
        }, Te.prototype.drawImpl = function() {
            var s;
            for (s in { _42: !0 }) break;
            return function() {
                var c = this,
                    Y = c._canvas,
                    x = c.gv,
                    H = x.getWidth(),
                    y = x.getHeight(),
                    q = c._context,
                    i = k.Default.getInternal(),
                    l = D.devicePixelRatio;
                (Y.width !== H || Y.height !== y) && i.setCanvas(Y, H, y, l), q.clearRect(0, 0, Y.width, Y.height);
                var h = c._getValidSelection();
                q.save(), q.scale(l, l), c._gridGuide._42(), c.invokeSubModuleInverse(s, !1, q, x, h), c._rectGuide._42(), c._hoverGuide._42(), q.restore()
            }
        }(), Te.prototype._getValidSelection = function() {
            var t = this,
                z = t.gv,
                D = z.sm().getSelection(),
                M = [];
            return D.each(function(U) { z.isVisible(U) && z.isEditable(U) && M.push(U) }), M
        }, Te.prototype.handle_touchmove = function(B) { return this.handle_mousemove(B) }, Te.prototype.handle_mousemove = function(z) {
            if (!k.Default.isDragging()) {
                var B = this;
                if ((B.editDetail || !wd() && !kd(z)) && !B.gv._externalEditing)
                    if (B.gvEditing = !1, B._checkEdit(z)) B.gvEditing = !0;
                    else {
                        if (!B.getStyle("hoverGuideVisible")) return;
                        B.hoverData = B.gv.getDataAt(z), B._42()
                    }
            }
        }, Te.prototype.handle_touchstart = function(F) { return this.handle_mousedown(F) }, Te.prototype.handle_mousedown = function(b) {
            sh(b);
            var d = this;
            if ((d.editDetail || !wd() && !kd(b)) && !d.gv._externalEditing) {
                if (Mp(b) && !b.clickThrough) {
                    if (d.editDetail) { if (d._tryQuitEditDetailMode(b)) return } else if (d._tryEnterEditDetailMode()) return;
                    d.gv.dm().beginTransaction();
                    var w = d.invokeSubModule("handleDoubleClick", !0, b);
                    if (d.gv.dm().endTransaction(), w) return
                }
                var L = d._checkEdit(b);
                L && (d._downPosition = d._getLogicalPoint(b), d.gv.dm().beginTransaction(), L.startEdit(d, b), d.editing = !0)
            }
        }, Te.prototype._checkEdit = function(P) {
            var N = this,
                S = N.gv,
                l = N._getLogicalPoint(P),
                H = N.invokeSubModule("check", !0, S, P, l) || null;
            return N._editMod = H, H
        }, Te.prototype.handleWindowTouchMove = function(V) { return this.handleWindowMouseMove(V) }, Te.prototype.handleWindowMouseMove = function(m) {
            var f = this,
                M = f._downPosition;
            if (M) {
                var Z = f._getLogicalPoint(m);
                if (Z.distanceTo(M) < f.getStyle("moveSensitivity")) return;
                delete f._downPosition
            }
            var R = f._editMod;
            R && R.handleEdit(f.gv, m)
        }, Te.prototype._getLogicalPoint = function(T) {
            var q = this,
                M = k.Default.getLogicalPoint(T, q._canvas);
            return new ie.Math.Vector2(M)
        }, Te.prototype.handleWindowTouchEnd = function(K) { return this.handleWindowMouseUp(K) }, Te.prototype.handleWindowMouseUp = function() {
            var b;
            for (b in { _46O: !0 }) break;
            return function(A) {
                var G = this;
                G.editing = !1, G.setCursor("default"), G.invokeSubModule(b, !1, A), G._42(), G.gv.dm().endTransaction()
            }
        }(), Te.prototype.handle_mousewheel = function(n) {
            var W = this;
            sh(n), W.invokeSubModule("preHandleScroll", !0) || W.gv.handleScroll(n, n.wheelDelta)
        }, Te.prototype.handleDelete = function() {
            var I = this;
            if (!I.editDetail) { I.gv.dm().beginTransaction(); var R = I.invokeSubModule("handleNormalStateDelete", !0); return I.gv.dm().endTransaction(), R || I.gv.removeSelection(), void 0 }
            I.gv.dm().beginTransaction(), I.invokeSubModule("handleDelete", !0), I.gv.dm().endTransaction(), I._42()
        }, Te.prototype.handle_keydown = function(j) { var M = this; if ((j.metaKey || j.ctrlKey) && M._42(), wd(j) && !M.editing) return M.gvEditing = !1, M.setCursor("default"), M._42(), void 0; var I = jf(j); return M.editDetail ? ((I || nc(j)) && (M.editDetail = !1, M._42()), M.gv.dm().beginTransaction(), M.invokeSubModule("handle_keydown", !0, j), M.gv.dm().endTransaction(), void 0) : (M.gv.dm().beginTransaction(), M.invokeSubModule("handleNormalStateKeyDown", !0, j), M.gv.dm().endTransaction(), I && M._tryEnterEditDetailMode(), void 0) }, Te.prototype.handle_keyup = function(v) { this.gv.dm().beginTransaction(), this.invokeSubModule("handle_keyup", !0, v), this.gv.dm().endTransaction() }, Te.prototype._tryEnterEditDetailMode = function() { var m = this; return !m.editDetail && m.invokeSubModule("canEnterEditDetailMode", !0) && 1 === m._getValidSelection().length ? (m.editDetail = !0, m._42(), !0) : void 0 }, Te.prototype._tryQuitEditDetailMode = function(n) { var H = this; return H.editDetail ? !n || H.invokeSubModule("canQuitEditDetailMode", !0, n) ? (H.editDetail = !1, H._42(), !0) : !1 : !1 }, Te.prototype.setStyle = function(W, S, P) {
            var Q = this;
            P ? ie.setStyle(W, S) : Q._styleMap[W] = S, "baseColor" === W && (Wq = S), Q.fp("styleChanged", null, { key: W, value: S, base: P }), Q._42()
        }, Te.prototype.getStyle = function(a) {
            var _ = this,
                c = _._styleMap[a];
            return c !== O ? c : ie.getStyle(a)
        }, Te.prototype.setCursor = function(q) { this._resetCustomCursorStyle(), k.graph.EditInteractor.superClass.setCursor.call(this, q) }, Te.prototype._drawHostGuide = function(k) {
            var o = this,
                $ = o._context,
                s = o.gv;
            ie.Icons.DrawIcon(o, $, ie.Icons.NodeHoverGuide, k.corners);
            var u = k.host;
            if (u) {
                var _ = s.getAttachPoints(u);
                if (_ && _.length)
                    for (var U = 0, y = _.length; y > U; U++) {
                        var Y = _[U],
                            K = Cg(s, u, 0, Y.offsetX || 0, Y.offsetY || 0, Y.x, Y.y);
                        K = ie.toScreenPosition(s, K), K.isAttach = k.attach === U, ie.Icons.DrawIcon(o, $, ie.Icons.AttachPoint, K)
                    }
            }
        }, Te.prototype._resetCustomCursorStyle = function() {
            var k = this;
            if (k._customStyle) {
                var M = this.gv.getView();
                M.classList && M.classList.remove && M.classList.remove(k._customStyle), k._customStyle = null
            }
        }, Te.prototype._setRotateCursor = function(k) {
            var d = this,
                g = d._cursorFactory;
            g || (g = d._cursorFactory = new ie.CursorFactory(d));
            var D = g.getRotateCursor(k),
                p = d.gv.getView();
            d._resetCustomCursorStyle(), d._customStyle = D, p.classList && p.classList.add && p.classList.add(D)
        };
        var El = ie.Group = function(X) {
            var K = this;
            K._entities = X, K._64O = 0, K._position = { x: 0, y: 0 }, K._scale = { x: 1, y: 1 }, K._anchor = { x: .5, y: .5 }, K._anchor2 = { x: .5, y: .5 }
        };
        El.prototype = {}, El.prototype.constructor = El;
        var mk = null;
        El.findOrCreateGroup = function(Q) { if (mk && mk.checkIsMe(Q)) return mk; var E = new ie.Group(Q); return E.getKeyOb() ? (mk = E, E) : void 0 }, El.prototype.checkIsMe = function(g) {
            var y = this._entities;
            if (y.length !== g.length) return !1;
            var F, $ = {},
                P = g.length;
            for (F = 0; P > F; F++) $[g[F]._id] = !0;
            for (F = 0; P > F; F++)
                if (!$[y[F]._id]) return !1;
            return !0
        }, El.prototype.getRotation = function() { return this._64O }, El.prototype.getPosition = function() { return this._position }, El.prototype.getAnchor = function() { return this._anchor }, El.prototype.getWidth = function() { return this._width }, El.prototype.getScale = function() { return this._scale }, El.prototype.getSize = function() { return { width: this._width, height: this._height } }, El.prototype.getHeight = function() { return this._height }, El.prototype.getKeyOb = function() { for (var r = this._entities, T = r.length - 1; T >= 0; T--) { var X = r[T]; if (this.isNode(X)) return X } }, El.prototype.getAnchor2 = function() {
            var s = this,
                E = s.rotateCenter;
            if (E) return E;
            var l = s.getKeyOb();
            if (!l) return s._anchor;
            var v = s._anchor2,
                o = l.getMatrix();
            return o.tf({ x: l.getWidth() * (v.x - l.getAnchor().x), y: l.getHeight() * (v.y - l.getAnchor().y) })
        }, El.prototype.setAnchor2 = function(B, S) {
            var m = this,
                H = m.getKeyOb();
            if (H) {
                var r, k = H.getMatrix();
                r = "number" == typeof B ? { x: B, y: S } : B;
                var Q = k.tfi(r);
                m._anchor2 = { x: H.getAnchor().x + Q.x / H.getWidth(), y: H.getAnchor().y + Q.y / H.getHeight() }
            }
        }, El.prototype.setRotation = function() {}, El.prototype.beginRotate = function(t) { this.rotateCenter = t.pos, this.rotateMode = t.groupRotateMode }, El.prototype.endRotate = function() { delete this.rotateCenter, delete this.rotateMode }, El.prototype.addRotation = function(I, K, _) { return "batch" === K ? this._addRotationInBatchMode(I, _) : "block" === K ? this._addRotationInBlockMode(I, _) : void 0 }, El.prototype._addRotationInBlockMode = function(H, B) {
            var l = this,
                V = l.rotateCenter || l.getPosition();
            l._entities.forEach(function(R) {
                if (l.isNode(R) && (!B || B(R))) {
                    var p = R.getMatrix();
                    p.translate(-V.x, -V.y), p.rotate(H), p.translate(V.x, V.y);
                    var v = Math.sign(R.getScale().x);
                    R.setRotation(Cc(p.b * v, p.a * v)), R.setPosition(p.tx, p.ty)
                }
            })
        }, El.prototype._addRotationInBatchMode = function(P, i) {
            var t = this,
                E = t._anchor2;
            t._entities.forEach(function(N) {
                if (t.isNode(N) && (!i || i(N))) {
                    var h = N.getAnchor(),
                        O = N.getMatrix(),
                        F = O.tf({ x: N.getWidth() * (E.x - h.x), y: N.getHeight() * (E.y - h.y) }),
                        e = new ie.Math.Matrix2d;
                    e.set(O.a, O.b, O.c, O.d, O.tx, O.ty), e.translate(-F.x, -F.y), e.rotate(P), e.translate(F.x, F.y);
                    var T = Math.sign(N.getScale().x);
                    N.setRotation(Cc(e.b * T, e.a * T)), N.setPosition(e.tx, e.ty)
                }
            })
        }, El.prototype.setPosition = function(x) {
            var P, Z, a, n, f = this,
                _ = f._position,
                B = x.x - _.x,
                p = x.y - _.y,
                J = f._entities;
            for (Z = 0, a = J.length; a > Z; Z++) P = J[Z], Dj(P) && (n = P.getPosition(), P.setPosition(n.x + B, n.y + p));
            f._position = x
        }, El.prototype.setScale = function(n, p) {
            var q = this,
                Y = n / q._scale.x,
                A = p / q._scale.y;
            q._adjustChildScaleOrSize(Y, A, "size"), q._scale = { x: n, y: p }
        }, El.prototype.getRect = function() {
            var Y = this,
                o = Y._position,
                W = Y._width,
                Z = Y._height;
            return { x: o.x - W / 2, y: o.y - Z / 2, width: W, height: Z }
        }, El.prototype.setSize = function(M, z) {
            var P = this,
                M = Math.max(1, M),
                z = Math.max(1, z),
                q = M / P._width,
                x = z / P._height;
            P._adjustChildScaleOrSize(q, x, "size"), P._width = M, P._height = z
        }, El.prototype._adjustChildScaleOrSize = function(S, U, N) {
            var u, s, b, F, c, e, P, J, Z, m, C, M, R, z, r = this,
                A = r._position,
                Q = r._entities,
                _ = new ie.Math.Matrix2d;
            for (s = 0, b = Q.length; b > s; s++)
                if (u = Q[s], r.isNode(u)) {
                    if (F = u.getPosition(), c = u.getRotation(), e = u.getWidth(), P = u.getHeight(), J = u.getScale(), C = J.x * e, M = J.y * P, _.identity().scale(C, M).rotate(c).translate(F.x, F.y).translate(-A.x, -A.y).rotate(-r._64O), c = Cc(_.b * Math.sign(C), _.a * Math.sign(C)), _.scale(S, U), Z = Math.cos(c), m = Math.sin(c), Math.abs(Z) < .001 ? (R = _.b / m, z = -_.c / m) : (R = _.a / Z, z = _.d / Z), "scale" === N) u.setScale(R / e, z / P);
                    else if ("size" === N) {
                        var L = R / J.x,
                            B = z / J.y;
                        u.setScale(ej(R) * Math.abs(J.x), ej(z) * Math.abs(J.y)), u.setSize(Math.max(.1, Math.abs(L)), Math.max(.1, Math.abs(B)))
                    }
                    _.rotate(r._64O).translate(A.x, A.y), u.setPosition(_.tx, _.ty)
                }
        }, El.prototype.getMatrix = function() {
            var e = this,
                P = e._position,
                b = k.Default.getInternal(),
                Q = e._scale;
            return new b.Mat(e._64O, P.x, P.y, Q.x, Q.y)
        }, El.prototype.toGlobal = function(N) { return this.getMatrix().tf(N) }, El.prototype.getCorners = function() {
            var Q = this,
                g = Q._width,
                c = Q._height,
                X = Q._anchor,
                o = -g * X.x,
                j = -c * X.y,
                M = Q.getMatrix();
            return [M.tf(o, j), M.tf(o, j + c), M.tf(o + g, j + c), M.tf(o + g, j)]
        }, El.prototype.calcInfo = function() {
            var T, E, I, Q, w, N, A = this,
                i = [],
                j = A._entities,
                H = A._64O;
            for (Q = 0, w = j.length; w > Q; Q++) N = j[Q], A.isNode(N) && N.getCorners && i.push.apply(i, N.getCorners());
            if (i.length) {
                var W = Math.cos(-H),
                    K = Math.sin(-H),
                    d = 1 / 0,
                    o = -1 / 0,
                    h = 1 / 0,
                    l = -1 / 0;
                for (Q = 0, w = i.length; w > Q; Q++) I = i[Q], T = I.x, E = I.y, I.x = W * T - K * E, I.y = K * T + W * E, d = Math.min(d, I.x), o = Math.max(o, I.x), h = Math.min(h, I.y), l = Math.max(l, I.y);
                A._width = (o - d) / A._scale.x, A._height = (l - h) / A._scale.y, W = Math.cos(H), K = Math.sin(H);
                var L = A._anchor;
                T = d + (o - d) * L.x, E = h + (l - h) * L.y, A._position = { x: W * T - K * E, y: K * T + W * E }
            }
        }, El.prototype.isNode = function(y) { return Dj(y) ? oh(y) ? y.size() ? !1 : !0 : !0 : !1 }, El.prototype._42 = function(O, g, U) {
            var x, n, z, Y, C, e, m, w, H = this,
                W = H._entities,
                o = H.rotateMode;
            for ("batch" === o && (w = H.getKeyOb()), x = 0, n = W.length; n > x; x++) z = W[x], H.isNode(z) && (e = z.getRect(), Y = ie.toScreenPosition(U, { x: e.x, y: e.y }), C = ie.toScreenPosition(U, { x: e.x + e.width, y: e.y + e.height }), m = { min: Y, max: C }, z === w && (m.isKeyOb = !0), ie.Icons.DrawIcon(O, g, ie.Icons.GroupSubEntityRect, m))
        };
        var fr = ie.CurveActiving = function(G, y) {
            this._curve = G, this._interactor = G._interactor, this.silent = !0;
            for (var N in y) this[N] = y[N];
            delete this.silent
        };
        fr.prototype = {}, fr.prototype.constructor = fr, n.defineProperties(fr.prototype, {
            point: {
                get: function() { return this._point },
                set: function($) {
                    var c = this;
                    c._point = $, c.editingCtrl || c.silent || c._firePointChange()
                }
            },
            pairs: {
                get: function() { return this._pairs },
                set: function($) {
                    var U = this;
                    U._pairs = $, U.editingCtrl && !U.silent && U._firePointChange()
                }
            }
        }), fr.prototype._firePointChange = function() {
            var l = this,
                D = l.getCurrentEditingPoint(),
                q = l._interactor;
            if (!D) return q.fi({ kind: "selectPoint" }), void 0;
            var G = this._curve.target;
            if (G) {
                var H = ie.getDataMatrix(G).invert(),
                    u = D.e;
                D = H.apply(ie.toWorldPosition(q.gv, D)), D.e = u;
                var F = l._lastFirePoint;
                F && Math.abs(D.x - F.x) < 1e-5 && Math.abs(D.y - F.y) < 1e-5 && (D.e == O && F.e == O || Math.abs(D.e - F.e) < 1e-5) || (l._lastFirePoint = D, q.fi({ kind: "selectPoint", x: D.x, y: D.y, e: D.e }))
            }
        }, fr.prototype.dispose = function() { this._interactor.fi({ kind: "selectPoint" }) }, fr.prototype.getCurrentEditingPoint = function() {
            var q = this,
                z = q.editingCtrl;
            if (z) { var p = q.pairs; if (p) { var Q = p[z.pairId]; if (Q) { var T = Q[z.type]; if (T) return T } } }
            return q._point
        };
        var ng = ie.CursorFactory = function(e) {
            var T = this;
            T._interactor = e, T._rotateCursorStyles = {}
        };
        ng.prototype = {}, ng.prototype.constructor = ng, ng.prototype.getRotateCursor = function(F) {
            var I = this;
            0 > F && (F += 2 * Math.PI);
            var q = I._interactor,
                X = q.getStyle("rotateCursorSize"),
                U = q.getStyle("rotateCursorRound"),
                G = Math.round(180 * (F / Math.PI) / U);
            G * U >= 360 && (G = 0);
            var Y = I._rotateCursorStyles,
                s = "htCustomRotateStyle_" + X + "_" + U + "_" + G;
            return Y[s] || (I._produceRotateCursor(s, X, U, G), Y[s] = !0), s
        }, ng.prototype._produceRotateCursor = function(X, f, J, t) {
            var I = this;
            I._interactor;
            var N = I._canvas;
            N || (N = I._canvas = M.createElement("canvas"));
            var R = D.devicePixelRatio;
            N.width = N.height = f * R, N.style.width = N.style.height = f + " px";
            var $ = N.getContext("2d");
            ie.setAntialias($, !1), $.scale(R, R);
            var p, O, v, Y, o, C = Math.round(f / 2),
                n = "" + C + " " + C + ",auto !important;",
                G = 4;
            p = Math.PI / 180 * t * J, $.clearRect(0, 0, f, f), $.save(), $.scale(f / 32, f / 32), $.translate(16, 15), $.rotate(p + Math.PI / 2), $.beginPath(), $.moveTo(-8, 0), $.lineTo(-8, G), $.lineTo(-8 + G, G), $.moveTo(8, 0), $.lineTo(8, G), $.lineTo(8 - G, G), $.moveTo(-8, G), $.quadraticCurveTo(0, -6, 8, G), $.restore(), $.lineCap = "round", $.lineJoin = "miter", $.strokeStyle = "white", $.lineWidth = 4, $.stroke(), $.strokeStyle = "black", $.lineWidth = 2, $.stroke(), O = JSON.stringify(N.toDataURL()), Y = "cursor:url(" + O + ")" + n, 1 !== R && (v = '<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="' + f + 'px" height="' + f + 'px"><image xlink:href=' + O + ' width="' + f + '" height="' + f + '"/></svg>', Y += "cursor:url(data:image/svg+xml;base64," + btoa(v) + ")" + n, Y += "cursor:-webkit-image-set(url(" + O + ")" + R + "x,url(" + O + ")1x)" + n), o = M.createElement("style"), o.textContent = "body." + X + " *, ." + X + "{" + Y + "}", M.head.appendChild(o)
        };
        var Aq = ie.Guide.Grid = function(d) {
            var z = this;
            z._interactor = d, z._alignmentGuideId = 0, z._xAlignmentGuide = [], z._yAlignmentGuide = []
        };
        Aq.prototype = {}, Aq.prototype.constructor = Aq, n.defineProperties(Aq.prototype, {
            gridBlockSize: { get: function() { var p = this; return p._gridBlockSize || p._interactor.getStyle("gridBlockSize") }, set: function(S) { this._gridBlockSize = S, this._interactor._42() } },
            gridThickLinesEvery: { get: function() { var b = this; return b._gridThickLinesEvery || b._interactor.getStyle("gridThickLinesEvery") }, set: function(j) { this._gridThickLinesEvery = j, this._interactor._42() } },
            gridEnabled: {
                get: function() {
                    var M = this,
                        U = M._interactor;
                    return U.gridEnabled && M.isValidGrid()
                }
            }
        }), Aq.prototype._42 = function() {
            var y = this,
                m = y._interactor;
            y.gridEnabled && y.drawGrid(), m.alignmentGuideEnabled && y.drawAlignmentGuide()
        }, Aq.prototype.makeMatrix = function() {
            var Q = this,
                h = Q._interactor.getStyle("gridAngle"),
                a = Q._interactor.getStyle("gridRotation"),
                j = new ie.Math.Matrix2d,
                F = Math.sin(h),
                C = Math.cos(h);
            return j.set(1, 0, C, F, 0, 0), j.rotate(a), j
        }, Aq.prototype.isValidGrid = function() {
            var t = this,
                $ = Math.PI,
                a = t._interactor,
                q = a.gv;
            if (q._zoom < a.getStyle("gridZoomThreshold")) return !1;
            var d = a.getStyle("gridAngle"),
                g = Math.abs(180 * (d % $ / $)),
                O = 1 - 1e-8;
            return O > g || g > 180 - O ? !1 : !0
        }, Aq.prototype.drawAlignmentGuide = function() {
            var q = this,
                z = q._interactor,
                N = z.gv,
                n = z._canvas,
                G = z._context,
                r = n.width,
                g = n.height,
                V = N.tx(),
                E = N.ty(),
                W = N._zoom;
            G.beginPath(), G.strokeStyle = z.getStyle("gridAlignmentGuideColor"), G.lineWidth = 1, q._xAlignmentGuide.forEach(function($) {
                var b = $.p * W + V;
                G.moveTo(b, 0), G.lineTo(b, g)
            }), q._yAlignmentGuide.forEach(function(v) {
                var y = v.p * W + E;
                G.moveTo(0, y), G.lineTo(r, y)
            }), G.stroke()
        }, Aq.prototype.drawGrid = function() {
            function i(F, W, K, G) {
                var h = ie.toScreenPosition(v, m.apply({ x: F, y: W })),
                    w = ie.toScreenPosition(v, m.apply({ x: K, y: G }));
                p.moveTo(h.x, h.y), p.lineTo(w.x, w.y)
            }
            var r = this,
                M = r._interactor,
                c = r.gridBlockSize,
                K = r.gridThickLinesEvery,
                b = M.getStyle("gridThickColor"),
                N = M.getStyle("gridLightColor"),
                v = M.gv,
                u = M._canvas,
                p = M._context,
                j = u.width,
                C = u.height,
                m = r.makeMatrix(),
                x = m.applyInverse(ie.toWorldPosition(v, { x: 0, y: 0 })),
                F = m.applyInverse(ie.toWorldPosition(v, { x: j, y: 0 })),
                E = m.applyInverse(ie.toWorldPosition(v, { x: 0, y: C })),
                f = m.applyInverse(ie.toWorldPosition(v, { x: j, y: C })),
                J = Math.min(x.x, F.x, E.x, f.x),
                D = Math.max(x.x, F.x, E.x, f.x),
                h = Math.min(x.y, F.y, E.y, f.y),
                l = Math.max(x.y, F.y, E.y, f.y);
            j = D - J, C = l - h;
            var s = Math.ceil(J / c),
                G = Math.floor(D / c),
                R = Math.ceil(h / c),
                d = Math.floor(l / c);
            v.tx(), v.ty(), v._zoom;
            var q, $, S;
            for (p.save(), p.lineWidth = 1, p.beginPath(), p.strokeStyle = b, S = Math.ceil(s / K) * K; G >= S; S += K) q = S * c, i(q, h, q, l);
            for (S = Math.ceil(R / K) * K; d >= S; S += K) $ = S * c, i(J, $, D, $);
            for (p.stroke(), p.beginPath(), p.strokeStyle = N, S = s; G >= S; S++) 0 !== S % K && (q = S * c, i(q, h, q, l));
            for (S = R; d >= S; S++) 0 !== S % K && ($ = S * c, i(J, $, D, $));
            p.stroke(), p.restore()
        }, Aq.prototype.getAlignmentGuides = function() { var i = this; return { x: i._xAlignmentGuide, y: i._yAlignmentGuide } }, Aq.prototype.addAlignmentGuide = function(Z, T, w) {
            var G = this,
                $ = "x" === Z ? G._xAlignmentGuide : G._yAlignmentGuide,
                w = w ? w : ++G._alignmentGuideId,
                N = { p: T, id: w };
            if ($.length) {
                var k = G._findClosestAlignmentGuide(N.p, $);
                k.dis < 0 ? $.splice(k.index + 1, 0, N) : $.splice(k.index, 0, N)
            } else $.push(N);
            return G._interactor._42(), w
        }, Aq.prototype.findClosest = function(g, J, l) {
            var L = this,
                v = L._interactor,
                H = v.gv;
            l && (g = ie.toWorldPosition(H, g));
            var z, p, E, X = 1 / 0,
                I = 1 / 0,
                j = g.x,
                A = g.y;
            if (L.gridEnabled) {
                var s = L.gridBlockSize,
                    C = L.makeMatrix(),
                    W = C.applyInverse(g);
                W = C.apply({ x: Math.round(W.x / s) * s, y: Math.round(W.y / s) * s }), X = W.x - j, I = W.y - A, E = !0
            }
            if (v.alignmentGuideEnabled && (z = L._findClosestAlignmentGuide(j, L._xAlignmentGuide).dis, p = L._findClosestAlignmentGuide(A, L._yAlignmentGuide).dis, Math.abs(z) < Math.abs(X) && (X = z, E = !0), Math.abs(p) < Math.abs(I) && (I = p, E = !0)), E) {
                E = !1;
                var y = H._zoom,
                    Y = v.getStyle("smartGuideThreshold") / y,
                    U = {};
                if (Math.abs(X) < Y && "y" !== J && (U.x = l ? X * y : X, E = !0), Math.abs(I) < Y && "x" !== J && (U.y = l ? I * y : I, E = !0), E) return U
            }
        }, Aq.prototype._findClosestAlignmentGuide = function(S, O) {
            if (!O.length) return { dis: 1 / 0 };
            for (var W, L = 0, m = O.length - 1; m - L > 1;) W = Math.floor((L + m) / 2), O[W].p < S ? L = W : m = W;
            var I = O[L].p - S,
                Q = O[m].p - S;
            return Math.abs(I) <= Math.abs(Q) ? { line: O[L], dis: I, index: L } : { line: O[m], dis: Q, index: m }
        }, Aq.prototype.removeAllAlignmentGuide = function(I) { var y = this; "y" !== I && (y._xAlignmentGuide = []), "x" !== I && (y._yAlignmentGuide = []), y._interactor._42() }, Aq.prototype.removeAlignmentGuide = function(T) {
            for (var A, S, p, b = this, E = b._xAlignmentGuide, d = 0; 2 > d; d++)
                for (E = 0 === d ? b._xAlignmentGuide : b._yAlignmentGuide, A = 0, S = E.length; S > A; A++)
                    if (p = E[A], p.id === T) return E.splice(A, 1), b._interactor._42(), { axis: 0 === d ? "x" : "y", position: p.p };
            return !1
        }, Aq.prototype.adjustAlignmentGuide = function(u, Z) {
            var X = this,
                d = X.removeAlignmentGuide(u);
            return d ? (X.addAlignmentGuide(d.axis, Z, u), !0) : !1
        };
        var Qf = ie.Guide.Rect = function(b) {
            var f = this;
            f._interactor = b
        };
        Qf.prototype = {}, Qf.prototype.constructor = Qf, Qf.prototype.gatherRects = function() {
            var p, J, L, K, R = this,
                Q = R._interactor.gv,
                k = [],
                z = [],
                e = { x: k, y: z },
                Z = {},
                g = Q.getDataModel(),
                c = g.a("width"),
                m = g.a("height");
            c && m && (p = 0, J = 0, L = c, K = m, k.push({ node: g, type: 0, p: p }, { node: g, type: 1, p: p + L / 2 }, { node: g, type: 2, p: p + L }), z.push({ node: g, type: 0, p: J }, { node: g, type: 1, p: J + K / 2 }, { node: g, type: 2, p: J + K }), Z[g._id || 0] = { x: p, y: J, width: L, height: K }), g.each(function(w) {
                if (Dj(w) && !Q.isSelected(w) && Q.isVisible(w) && Q.isValidGuideLineSource(w)) {
                    var o = !1;
                    if (Q.sm().getSelection().each(function(u) { o || (w.isHostOn(u) ? o = !0 : w.isDescendantOf(u) && (o = !0)) }), !o) {
                        var f = w.getRect();
                        p = f.x, J = f.y, L = f.width, K = f.height, k.push({ node: w, type: 0, p: p }, { node: w, type: 1, p: p + L / 2 }, { node: w, type: 2, p: p + L }), z.push({ node: w, type: 0, p: J }, { node: w, type: 1, p: J + K / 2 }, { node: w, type: 2, p: J + K }), Z[w._id] = f
                    }
                }
            }), k.sort(function(F, r) { return F.p - r.p }), z.sort(function(j, Z) { return j.p - Z.p }), R._grid = e, R._87I = Z
        }, Qf.prototype.gatherLines = function(s, A, z) {
            var c, H, Y, x, q, h, b, J, i, g, v, W, j = this,
                U = [j.findClosest({ x: s.x, y: s.y }, A), j.findClosest({ x: s.x + s.w / 2, y: s.y + s.h / 2 }, A), j.findClosest({ x: s.x + s.w, y: s.y + s.h }, A)],
                B = {},
                l = j._87I;
            z = z || 255;
            var I, _;
            for (j._guideLine = [], c = 0; 2 > c; c++)
                for (B = {}, 0 === c ? (x = "y", J = s.x, i = J + s.w) : (x = "x", J = s.y, i = J + s.h), H = 0; 3 > H; H++) q = U[H], q && isFinite(q[x]) && (I = 1 << 3 * c + H, z & I && (h = q[x + "Line"], b = h.node, _ = b._id || 0, B[_] || (B[_] = !0, W = l[_], "y" === x ? (g = W.x, v = W.x + W.width) : (g = W.y, v = W.y + W.height), Y = h.p, j._guideLine.push({ type: x, a: J, b: i, c: g, d: v, p: Y, center: 1 === h.type }))))
        }, Qf.prototype._binarySearchClosest = function(N, E) {
            if (!E.length) return { dis: 1 / 0 };
            for (var P, o = 0, z = E.length - 1; z - o > 1;) P = Math.floor((o + z) / 2), E[P].p < N ? o = P : z = P;
            var c = E[o].p - N,
                J = E[z].p - N;
            return Math.abs(c) <= Math.abs(J) ? { line: E[o], dis: c } : { line: E[z], dis: J }
        }, Qf.prototype.findClosest = function(U, L, x) {
            var f = this,
                J = f._interactor,
                W = J.gv,
                T = f._grid;
            x && (U = ie.toWorldPosition(W, U));
            var v, B = f._binarySearchClosest(U.x, T.x),
                m = f._binarySearchClosest(U.y, T.y),
                P = B.dis,
                b = m.dis,
                A = W._zoom,
                y = J.getStyle("smartGuideThreshold") / A,
                N = {};
            return Math.abs(P) < y && "y" !== L && (N.x = x ? P * A : P, N.xLine = B.line, v = !0), Math.abs(b) < y && "x" !== L && (N.y = x ? b * A : b, N.yLine = m.line, v = !0), v ? N : void 0
        }, Qf.prototype._42 = function() {
            var F = this,
                D = F._guideLine;
            if (D && !k.Default.isCtrlDown()) {
                var f = F._interactor;
                if (f.getStyle("guideLineVisible")) {
                    var B, v, I, j, g, s, c, O, L, t, y, S, K, W, b, p, u, M = f.gv,
                        i = f._context,
                        P = M.tx(),
                        T = M.ty(),
                        R = M._zoom,
                        z = f.getStyle("guideLineTextSpacing");
                    for (B = 0, v = D.length; v > B; B++) I = D[B], O = I.type, L = I.p, t = I.a, y = I.b, S = I.c, K = I.d, W = Math.min(t, S), b = Math.max(y, K), "x" === O ? (j = L * R + P, g = W * R + T, s = j, c = b * R + T) : (j = W * R + P, g = L * R + T, s = b * R + P, c = g), ie.Icons.DrawIcon(f, i, ie.Icons.MoveLineGuide, { rect: [j, g, s, c], center: I.center }), K >= t && y >= S || (W = t > K ? K : y, b = t > K ? t : S, u = b - W, "x" === O ? (I.center2center || (j -= z, s = j), g = W * R + T, c = b * R + T, p = ie.Icons.MoveLineGuideDistanceV) : "y" === O && (I.center2center || (g -= z, c = g), j = W * R + P, s = b * R + P, p = ie.Icons.MoveLineGuideDistanceH), ie.Icons.DrawIcon(f, i, p, { x0: j, y0: g, x1: s, y1: c, dis: u }))
                }
            }
        }, Qf.prototype.clear = function() { this._guideLine = null };
        var dn = ie.Guide.Hover = function(k) {
            var v = this;
            v._interactor = k
        };
        dn.prototype = {}, dn.prototype.constructor = dn, n.defineProperties(dn.prototype, {}), dn.prototype._42 = function() {
            var J = this._interactor;
            if (J.getStyle("hoverGuideVisible") && !J.gvEditing) {
                var c = J.hoverData,
                    S = J.gv;
                if (!Dj(c) || S.isSelected(c)) return J.hoverData = null, void 0;
                var U = Kc(S, c),
                    P = ie.toScreenPosition(S, { x: U.x, y: U.y }),
                    g = ie.toScreenPosition(S, { x: U.x + U.width, y: U.y + U.height });
                ie.Icons.DrawIcon(J, J._context, ie.Icons.HoverDataRect, { min: P, max: g, color: J.getStyle("hoverGuideColor") || J.getStyle("baseColor") })
            }
        }, ie.DefaultStyleMap = { baseColor: "rgb(51,153,255)", pointSize: [24, 9], checkSize: 7, rotateCheckSize: 10, moveSensitivity: 10, moveDummyThreshold: 32, moveDummyPosition: [0, 0, -16, -16], moveDummyLineExtraShift: [-32, 0], moveDummySensitivity: 16, keepAspectRatio: !1, rotateRound: Math.PI / 2, shiftRotateRound: Math.PI / 12, rotateSensitivity: Math.PI / 60, rotateAsClock: !1, rotateTipVisible: !0, shiftLineRotateRound: Math.PI / 4, anchorMovable: !0, anchorVisible: !0, anchorHideThreshold: 25, anchorOutsideVisibleThreshold: .25, anchorRound: .25, anchorSensitivity: .02, smartGuideThreshold: 8, curveIntersectSize: 5, curvePointIntersectSize: 8, edgeHostDetectPerFrame: !0, edgeHostEdgeMaxDistance: 12, edgeHostEdgeHighlighColor: "#5d5d5d", edgeHostPointHighlighColor: "red", edgeHostHighlighPeriod: 1500, edgeElevationEditable: !1, attachThreshold: 25, guideLineVisible: !0, guideLineTextSpacing: 0, hoverGuideVisible: !1, hoverGuideColor: null, gridBlockSize: 40, gridThickLinesEvery: 10, gridThickColor: "#5d5d5d", gridLightColor: "#d0d0d0", gridZoomThreshold: .25, gridAlignmentGuideColor: "#ff0000", gridAngle: Math.PI / 2, gridRotation: 0, groupRotateModeDefault: "block", groupRotateModeKey: ["ctrlKey", "metaKey"], rotateCursorSize: 32, rotateCursorRound: 45, tipTextColor: "#ffffff", tipBackground: "#333333", curveHighlightColor: "#30599e", rectPointBackground: "white", rectPointBorderColor: "#666666", rectPointShadowColor: "rgba(0,0,0,0.35)", shapeCtrlPointBackground: "white", shapeCtrlPointBorderColor: null, shapeCtrlPointHighlightBorder: null, shapeHighlighPointBackground: "#30599e", curveElevationVisible: !0, curveElevationIntersectSize: 8, curveElevationGuideShift: [20, 0], curveTipVisible: !0, connectGuideVisible: !0, connectGuideShift: [1, .25, 8, 0], connectGuideIntersectSize: 8, connectGuideGarbageIntersectsize: 25, connectGuideGarbageShift: [1, 1, -48, -48] };
        var ub = ie.Icons = {},
            De = 1e4,
            Dd = null,
            Wq = ie.DefaultStyleMap.baseColor,
            aj = "rgb(183,232,135)",
            Co = "rgb(255,204,153)",
            Bl = 6;
        k.Default.setImage("Icons.RectPoint", { width: Bl, height: Bl, comps: [{ type: "rect", background: "rgb(247,247,247)", borderWidth: 1, borderColor: { func: function() { return Wq } }, rect: [0, 0, Bl, Bl] }] }), ub.GroupSubEntityRect = {
            comps: [{
                type: "shape",
                points: {
                    func: function() {
                        var r = ub.GroupSubEntityRect.data;
                        if (!r) return [];
                        var H = r.min,
                            p = r.max;
                        return [H.x, H.y, H.x, p.y, p.x, p.y, p.x, H.y]
                    }
                },
                segments: [1, 2, 2, 2, 5],
                background: null,
                borderWidth: 1,
                borderColor: { func: function() { return ub.GroupSubEntityRect.data.isKeyOb ? Wq : Wq } }
            }]
        };
        var xq = 4;
        ub.HoverDataRect = {
            comps: [{
                type: "shape",
                points: {
                    func: function() {
                        var O = ub.HoverDataRect.data;
                        if (!O) return [];
                        var A = O.min,
                            c = O.max,
                            y = xq;
                        return A.x -= y, A.y -= y, c.x += y, c.y += y, [A.x, A.y, A.x, c.y, c.x, c.y, c.x, A.y]
                    }
                },
                segments: [1, 2, 2, 2, 5],
                background: null,
                borderWidth: 1,
                borderColor: { func: function() { return ub.HoverDataRect.data.color } },
                borderCap: "round",
                borderPattern: [1, 4]
            }]
        }, ub.Line = {
            comps: [{
                type: "image",
                name: "Icons.RectPoint",
                rect: {
                    func: function() {
                        return [
                            [ub.Line.data.P1.x, ub.Line.data.P1.y], Bl, Bl
                        ]
                    }
                }
            }, {
                type: "image",
                name: "Icons.RectPoint",
                rect: {
                    func: function() {
                        return [
                            [ub.Line.data.P2.x, ub.Line.data.P2.y], Bl, Bl
                        ]
                    }
                }
            }]
        }, ub.NodeHoverGuide = { comps: [{ type: "shape", points: { func: function() { return ub.NodeHoverGuide.data } }, segments: [1, 2, 2, 2, 5], background: null, borderWidth: 1, borderColor: "#3399FF" }] }, ub.Rect = {
            comps: [{
                type: "shape",
                points: {
                    func: function() {
                        var P = ub.Rect.data;
                        if (!P) return [];
                        var k = P.LT,
                            $ = P.LB,
                            N = P.RB,
                            d = P.RT;
                        return [k.x, k.y, $.x, $.y, N.x, N.y, d.x, d.y]
                    }
                },
                segments: [1, 2, 2, 2, 5],
                background: null,
                borderWidth: 1,
                borderColor: { func: function() { return Wq } }
            }, {
                type: "image",
                name: "Icons.RectPoint",
                rotation: { func: function() { return ub.Rect.data.rotation } },
                rect: {
                    func: function() {
                        return [
                            [ub.Rect.data.LT.x, ub.Rect.data.LT.y], Bl, Bl
                        ]
                    }
                }
            }, {
                type: "image",
                name: "Icons.RectPoint",
                rotation: { func: function() { return ub.Rect.data.rotation } },
                rect: {
                    func: function() {
                        return [
                            [ub.Rect.data.LB.x, ub.Rect.data.LB.y], Bl, Bl
                        ]
                    }
                }
            }, {
                type: "image",
                name: "Icons.RectPoint",
                rotation: { func: function() { return ub.Rect.data.rotation } },
                rect: {
                    func: function() {
                        return [
                            [ub.Rect.data.RB.x, ub.Rect.data.RB.y], Bl, Bl
                        ]
                    }
                }
            }, {
                type: "image",
                name: "Icons.RectPoint",
                rotation: { func: function() { return ub.Rect.data.rotation } },
                rect: {
                    func: function() {
                        return [
                            [ub.Rect.data.RT.x, ub.Rect.data.RT.y], Bl, Bl
                        ]
                    }
                }
            }, {
                type: "image",
                name: "Icons.RectPoint",
                rotation: { func: function() { return ub.Rect.data.rotation } },
                visible: { func: function() { return ub.Rect.data.L ? !0 : !1 } },
                rect: {
                    func: function() {
                        return [
                            [ub.Rect.data.L.x, ub.Rect.data.L.y], Bl, Bl
                        ]
                    }
                }
            }, {
                type: "image",
                name: "Icons.RectPoint",
                rotation: { func: function() { return ub.Rect.data.rotation } },
                visible: { func: function() { return ub.Rect.data.R ? !0 : !1 } },
                rect: {
                    func: function() {
                        return [
                            [ub.Rect.data.R.x, ub.Rect.data.R.y], Bl, Bl
                        ]
                    }
                }
            }, {
                type: "image",
                name: "Icons.RectPoint",
                rotation: { func: function() { return ub.Rect.data.rotation } },
                visible: { func: function() { return ub.Rect.data.T ? !0 : !1 } },
                rect: {
                    func: function() {
                        return [
                            [ub.Rect.data.T.x, ub.Rect.data.T.y], Bl, Bl
                        ]
                    }
                }
            }, {
                type: "image",
                name: "Icons.RectPoint",
                rotation: { func: function() { return ub.Rect.data.rotation } },
                visible: { func: function() { return ub.Rect.data.B ? !0 : !1 } },
                rect: {
                    func: function() {
                        return [
                            [ub.Rect.data.B.x, ub.Rect.data.B.y], Bl, Bl
                        ]
                    }
                }
            }]
        };
        var Gd = 16;
        k.Default.setImage("Icons.Anchor", { width: 12, height: 12, comps: [{ type: "shape", borderWidth: 1, borderColor: { func: function() { return Wq } }, borderCap: "round", shadowColor: "#1ABC9C", points: [.50928, 6, 11.49072, 6, 6, 6, 6, .50928, 6, 11.49072] }, { type: "circle", borderWidth: 1, borderColor: { func: function() { return Wq } }, shadowColor: "#1ABC9C", rect: [2.84391, 2.84391, 6.53697, 6.53697] }] }), ub.Anchor = {
            comps: [{
                type: "image",
                name: "Icons.Anchor",
                rect: {
                    func: function() {
                        return [
                            [ub.Anchor.data.POS.x, ub.Anchor.data.POS.y], Gd, Gd
                        ]
                    }
                }
            }]
        }, ub.TipShiftX = 12, ub.TipShiftY = 12;
        var Fb = [8, 28];
        ub.TipHelper = { comps: [{ type: "roundRect", rect: { func: function() { return [ub.TipHelper.data.helperPos.x, ub.TipHelper.data.helperPos.y, Fb[0] * ub.TipHelper.data.size, Fb[1]] } }, background: { func: function() { return Dd.getStyle("tipBackground") } }, opacity: .6 }, { type: "text", text: { func: function() { return ub.TipHelper.data.text } }, rect: { func: function() { return [ub.TipHelper.data.helperPos.x, ub.TipHelper.data.helperPos.y, Fb[0] * ub.TipHelper.data.size, Fb[1]] } }, color: { func: function() { return Dd.getStyle("tipTextColor") } }, font: "bold 12px Arial", align: "center" }] };
        var Di = 7;
        ub.ShapePoint = {
            comps: [{
                type: "circle",
                visible: { func: function() { return !!ub.ShapePoint.data.dynamicVisible } },
                rect: {
                    func: function() {
                        var e = ub.ShapePoint.data.point,
                            n = ub.ShapePoint.data.size || Di;
                        return [e, n + 10, n + 10]
                    }
                },
                background: {
                    func: function() {
                        var i = Date.now(),
                            F = ub.ShapePoint.data.dynamicPeriod || 1500,
                            j = Math.sin(i % F / F * Math.PI);
                        return "rgba(27,124,22," + .5 * j + ")"
                    }
                },
                borderWidth: 0
            }, {
                type: "circle",
                rect: {
                    func: function() {
                        var G = ub.ShapePoint.data.point,
                            g = ub.ShapePoint.data.size || Di;
                        return [G, g, g]
                    }
                },
                background: { func: function() { var R = ub.ShapePoint.data.isEnd; return R ? "rgba(27,124,222,0.7)" : "#ffffff" } },
                borderWidth: 1,
                borderColor: { func: function() { return ub.ShapePoint.data.color || Wq } }
            }, { type: "rect", visible: { func: function() { return !!ub.ShapePoint.data.dynamicVisible } }, background: "red", borderWidth: 0, rotation: Math.PI / 4, borderColor: { func: function() { return Wq } }, rect: { func: function() { var O = 5; return [ub.ShapePoint.data.point, O, O] } } }]
        }, ub.ShapeBgCurve = {
            comps: [{
                type: "shape",
                visible: { func: function() { return !!ub.ShapeBgCurve.data.dynamicVisible } },
                points: { func: function() { return ub.ShapeBgCurve.data.P } },
                segments: { func: function() { return ub.ShapeBgCurve.data.S } },
                background: null,
                borderWidth: 6,
                borderColor: {
                    func: function() {
                        var z = Date.now(),
                            E = ub.ShapeBgCurve.data.dynamicPeriod || 1500,
                            q = Math.sin(z % E / E * Math.PI);
                        return "rgba(27,124,22," + .3 * q + ")"
                    }
                }
            }, { type: "shape", points: { func: function() { return ub.ShapeBgCurve.data.P } }, segments: { func: function() { return ub.ShapeBgCurve.data.S } }, background: null, borderWidth: 1, borderColor: { func: function() { return ub.ShapeBgCurve.data.color || Wq } } }]
        };
        var ap = 8;
        ub.ShapeHighlighPoint = {
            comps: [{
                type: "circle",
                rect: {
                    func: function() {
                        var T = ub.ShapeHighlighPoint.data;
                        return [
                            [T.x, T.y], ap, ap
                        ]
                    }
                },
                background: { func: function() { return Dd.getStyle("shapeHighlighPointBackground") } },
                borderWidth: 0
            }]
        };
        var Ag = 10;
        ub.ShapeHighlighRealPoint = {
            comps: [{
                type: "circle",
                rect: {
                    func: function() {
                        var h = ub.ShapeHighlighRealPoint.data;
                        return [
                            [h.x, h.y], Ag, Ag
                        ]
                    }
                },
                background: "#ffffff",
                borderWidth: 2,
                borderColor: { func: function() { return Wq } }
            }]
        };
        var cp = 8;
        ub.ShapeHighlighCtrlPoint = {
            comps: [{
                type: "shape",
                points: {
                    func: function() {
                        var k = ub.ShapeHighlighCtrlPoint.data,
                            g = k.x,
                            P = k.y,
                            h = cp / 2;
                        return [g - h, P - h, g - h, P + h, g + h, P + h, g + h, P - h]
                    }
                },
                segments: [1, 2, 2, 2, 5],
                borderWidth: 2,
                background: { func: function() { return Dd.getStyle("shapeCtrlPointBackground") } },
                borderColor: { func: function() { return Dd.getStyle("shapeCtrlPointBorderColor") || Wq } }
            }]
        };
        var Hp = 3;
        ub.ShapeHighlightCurve = { comps: [{ type: "shape", points: { func: function() { return ub.ShapeHighlightCurve.data } }, segments: [1, 4], background: null, borderWidth: Hp, borderColor: { func: function() { return Dd.getStyle("curveHighlightColor") } } }] }, ub.ShapeGuideLine = { comps: [{ type: "shape", points: { func: function() { return ub.ShapeGuideLine.data } }, background: null, borderWidth: 1, borderColor: "rgb(255,204,153)" }] }, ub.MoveLineGuide = { comps: [{ type: "shape", points: { func: function() { return ub.MoveLineGuide.data.rect } }, background: null, borderWidth: 1, borderColor: { func: function() { return ub.MoveLineGuide.data.center ? aj : Co } } }] };
        var Jm = 5;
        ub.MoveLineGuideDistanceH = {
            comps: [{
                type: "shape",
                points: {
                    func: function() {
                        var m = ub.MoveLineGuideDistanceH.data,
                            A = m.x0,
                            G = m.y0;
                        return [A, G - Jm, A, G + Jm]
                    }
                },
                rotation: -Math.PI / 4,
                segments: [1, 2],
                background: null,
                borderWidth: 1,
                borderColor: Co
            }, {
                type: "shape",
                points: {
                    func: function() {
                        var N = ub.MoveLineGuideDistanceH.data,
                            O = N.x1,
                            q = N.y1;
                        return [O, q - Jm, O, q + Jm]
                    }
                },
                rotation: -Math.PI / 4,
                segments: [1, 2],
                background: null,
                borderWidth: 1,
                borderColor: Co
            }, {
                type: "text",
                text: { func: function() { return Math.round(ub.MoveLineGuideDistanceH.data.dis) } },
                rect: {
                    func: function() {
                        var C = ub.MoveLineGuideDistanceH.data;
                        return [
                            [(C.x0 + C.x1) / 2, C.y0 - 10], 20, 20
                        ]
                    }
                },
                color: Co,
                font: "12px Arial",
                align: "center"
            }]
        }, ub.MoveLineGuideDistanceV = {
            comps: [{
                type: "shape",
                points: {
                    func: function() {
                        var I = ub.MoveLineGuideDistanceV.data,
                            L = I.x0,
                            Z = I.y0;
                        return [L - Jm, Z, L + Jm, Z]
                    }
                },
                rotation: Math.PI / 4,
                segments: [1, 2],
                background: null,
                borderWidth: 1,
                borderColor: Co
            }, {
                type: "shape",
                points: {
                    func: function() {
                        var W = ub.MoveLineGuideDistanceV.data,
                            t = W.x1,
                            P = W.y1;
                        return [t - Jm, P, t + Jm, P]
                    }
                },
                rotation: Math.PI / 4,
                segments: [1, 2],
                background: null,
                borderWidth: 1,
                borderColor: Co
            }, {
                type: "text",
                text: { func: function() { return Math.round(ub.MoveLineGuideDistanceV.data.dis) } },
                rect: {
                    func: function() {
                        var v = ub.MoveLineGuideDistanceV.data;
                        return [
                            [v.x0 - 10, (v.y0 + v.y1) / 2], 20, 20
                        ]
                    }
                },
                color: Co,
                font: "12px Arial",
                align: "center"
            }]
        }, k.Default.setImage("Icons.EdgeElevationGuideImage", { width: 16, height: 16, comps: [{ type: "oval", background: "rgb(255,255,255)", borderWidth: 1, borderColor: "rgb(138,138,138)", rect: [.5, .5, 15, 15] }, { type: "shape", borderWidth: 2, borderColor: "rgb(44,44,44)", borderCap: "round", points: [4, 8, 8, 4, 12, 8, 8, 4, 8, 13], segments: [1, 2, 2, 1, 2] }] }), ub.EdgeElevationGuide = {
            comps: [{
                type: "image",
                name: "Icons.EdgeElevationGuideImage",
                rect: {
                    func: function() {
                        var k = ub.EdgeElevationGuide.data,
                            f = k.x,
                            P = k.y,
                            g = Dd.getStyle("curveElevationIntersectSize"),
                            _ = Dd.getStyle("curveElevationGuideShift");
                        return f += _[0], P += _[1], [f - g, P - g, 2 * g, 2 * g]
                    }
                }
            }]
        }, k.Default.setImage("Icons.ConnectGuideBgImage", { width: 12, height: 12, comps: [{ type: "shape", background: "#3399ff", fillRule: "evenodd", shadowColor: "#1ABC9C", rotation: 3.14159, points: [6.00001, 11.99999, 6.00001, 11.99999, 2.6863, 11.99999, 1e-5, 9.30695, 1e-5, 5.99999, 1e-5, 5.99999, 1e-5, 2.68628, 2.69305, -1e-5, 6.00001, -1e-5, 12.00001, -1e-5, 11.99998, 12.00001, 6.00001, 11.99999], segments: [1, 2, 4, 2, 4, 2, 2, 2] }] }), k.Default.setImage("Icons.ConnectGuideHeaderImage", { width: 12, height: 12, comps: [{ type: "oval", background: "#3399FF", borderColor: "#3399FF", shadowColor: "#1ABC9C", rect: [0, 0, 12, 12] }, { type: "shape", borderWidth: 1, borderColor: "rgb(255,255,255)", borderCap: "round", shadowColor: "#1ABC9C", points: [4.76, 2.56, 8.2, 5.98, 4.76, 9.44] }] }), ub.ConnectGuide = {
            comps: [{
                type: "image",
                name: "Icons.ConnectGuideBgImage",
                rotation: { func: function() { return ub.ConnectGuide.data.rotation } },
                rect: {
                    func: function() {
                        var e = ub.ConnectGuide.data.connect;
                        e.x, e.y;
                        var k = Dd.getStyle("connectGuideIntersectSize");
                        return [
                            [e.x, e.y], 2 * k, 2 * k
                        ]
                    }
                }
            }, {
                type: "image",
                name: "Icons.ConnectGuideHeaderImage",
                rect: {
                    func: function() {
                        var f = ub.ConnectGuide.data.cursorPos || ub.ConnectGuide.data.connect,
                            Z = Dd.getStyle("connectGuideIntersectSize");
                        return [
                            [f.x, f.y], 2 * Z - 2, 2 * Z - 2
                        ]
                    }
                }
            }, {
                type: "shape",
                background: null,
                borderColor: "#3399ff",
                borderWidth: 2,
                segments: [1, 4],
                points: {
                    func: function() {
                        var k = ub.ConnectGuide.data.connect,
                            w = ub.ConnectGuide.data.cursorPos || k;
                        return [k.x, k.y, k.x + .5 * (w.x - k.x), k.y, w.x + .5 * (k.x - w.x), w.y, w.x, w.y]
                    }
                }
            }]
        }, k.Default.setImage("Icons.ConnectGuideGarbageImage", { width: 48, height: 48, comps: [{ type: "oval", background: "rgba(0,0,0,0.1)", borderColor: "#979797", shadowColor: "#1ABC9C", rect: [0, 0, 48, 48] }, { type: "shape", borderWidth: 2, borderColor: "rgb(255,255,255)", borderCap: "round", shadowColor: "#1ABC9C", points: [19.84721, 19.69091, 19.84721, 32.25123] }, { type: "shape", borderWidth: 2, borderColor: "rgb(255,255,255)", borderCap: "round", shadowColor: "#1ABC9C", points: [24.10371, 19.69091, 24.10371, 32.25123] }, { type: "shape", borderWidth: 2, borderColor: "rgb(255,255,255)", borderCap: "round", shadowColor: "#1ABC9C", points: [28.15279, 19.69091, 28.15279, 32.25123] }, { type: "shape", borderWidth: 2, borderColor: "rgb(255,255,255)", borderCap: "round", shadowColor: "#1ABC9C", points: [11.23055, 15.22377, 36.76945, 15.189, 19.12302, 15.17121, 20.94722, 11.5228, 26.41985, 11.5228, 28.24406, 15.17121] }, { type: "rect", borderWidth: 2, borderColor: "rgb(255,255,255)", shadowColor: "#1ABC9C", rect: [15.48702, 15.22377, 17.02595, 21.25344] }] }), k.Default.setImage("Icons.ConnectGuideDeletingImage", { width: 56, height: 56, comps: [{ type: "oval", background: "rgba(232,0,0,0.75)", borderColor: "#979797", shadowColor: "#1ABC9C", rect: [0, 0, 56, 56] }, { type: "shape", borderWidth: 2, borderColor: "rgb(255,255,255)", borderCap: "round", shadowColor: "#1ABC9C", points: [22.67939, 27.69091, 22.67939, 40.25123] }, { type: "shape", borderWidth: 2, borderColor: "rgb(255,255,255)", borderCap: "round", shadowColor: "#1ABC9C", points: [26.93588, 27.69091, 26.93588, 40.25123] }, { type: "shape", borderWidth: 2, borderColor: "rgb(255,255,255)", borderCap: "round", shadowColor: "#1ABC9C", points: [30.98497, 27.69091, 30.98497, 40.25123] }, { type: "shape", borderWidth: 2, borderColor: "rgb(255,255,255)", borderCap: "round", shadowColor: "#1ABC9C", anchorX: 0, anchorY: 1, rotation: 5.65062, points: [14.06272, 23.22377, 39.60163, 23.189, 21.9552, 23.17121, 23.7794, 19.5228, 29.25203, 19.5228, 31.07623, 23.17121] }, { type: "rect", borderWidth: 2, borderColor: "rgb(255,255,255)", shadowColor: "#1ABC9C", rect: [18.3192, 23.22377, 17.02595, 21.25344] }] }), ub.ConnectGuideGarbage = {
            comps: [{
                type: "image",
                name: { func: function() { var U = ub.ConnectGuideGarbage.data.hover; return U ? "Icons.ConnectGuideDeletingImage" : "Icons.ConnectGuideGarbageImage" } },
                rect: {
                    func: function() {
                        var J = ub.ConnectGuideGarbage.data,
                            S = Dd.getStyle("connectGuideGarbageIntersectsize");
                        return J.hover && (S += 5), [
                            [J.x, J.y], 2 * S, 2 * S
                        ]
                    }
                }
            }]
        };
        var Dk = 6;
        ub.ShapeActivingCtrl = {
            comps: [{ type: "shape", visible: { func: function() { return ub.ShapeActivingCtrl.data.c1 ? !0 : !1 } }, points: { func: function() { var V = ub.ShapeActivingCtrl.data; return [V.point.x, V.point.y, V.c1.x, V.c1.y] } }, segments: [1, 2], background: null, borderWidth: 1, borderColor: { func: function() { return Wq } } }, { type: "shape", visible: { func: function() { return ub.ShapeActivingCtrl.data.c2 ? !0 : !1 } }, points: { func: function() { var U = ub.ShapeActivingCtrl.data; return [U.point.x, U.point.y, U.c2.x, U.c2.y] } }, segments: [1, 2], background: null, borderWidth: 1, borderColor: { func: function() { return Wq } } }, {
                type: "shape",
                visible: { func: function() { return ub.ShapeActivingCtrl.data.c1 ? !0 : !1 } },
                points: {
                    func: function() {
                        var N = ub.ShapeActivingCtrl.data.c1,
                            U = N.x,
                            z = N.y,
                            w = Dk / 2;
                        return "c1" === ub.ShapeActivingCtrl.data.hl && (w += .5), [U - w, z - w, U - w, z + w, U + w, z + w, U + w, z - w]
                    }
                },
                segments: [1, 2, 2, 2, 5],
                borderWidth: 2,
                background: { func: function() { return Dd.getStyle("shapeCtrlPointBackground") } },
                borderColor: { func: function() { return "c1" === ub.ShapeActivingCtrl.data.hl ? Dd.getStyle("shapeCtrlPointHighlightBorder") || Wq : Dd.getStyle("shapeCtrlPointBorderColor") || Wq } }
            }, {
                type: "shape",
                visible: { func: function() { return ub.ShapeActivingCtrl.data.c2 ? !0 : !1 } },
                points: {
                    func: function() {
                        var F = ub.ShapeActivingCtrl.data.c2,
                            R = F.x,
                            $ = F.y,
                            S = Dk / 2;
                        return "c2" === ub.ShapeActivingCtrl.data.hl && (S += .5), [R - S, $ - S, R - S, $ + S, R + S, $ + S, R + S, $ - S]
                    }
                },
                segments: [1, 2, 2, 2, 5],
                borderWidth: 2,
                background: { func: function() { return Dd.getStyle("shapeCtrlPointBackground") } },
                borderColor: { func: function() { return "c2" === ub.ShapeActivingCtrl.data.hl ? Dd.getStyle("shapeCtrlPointHighlightBorder") || Wq : Dd.getStyle("shapeCtrlPointBorderColor") || Wq } }
            }]
        }, ub.RoundPoint = {
            comps: [{
                type: "circle",
                background: "rgb(247,247,247)",
                borderWidth: 1,
                borderColor: { func: function() { return Wq } },
                rect: {
                    func: function() {
                        return [
                            [ub.RoundPoint.data.x, ub.RoundPoint.data.y], Bl, Bl
                        ]
                    }
                }
            }]
        }, ub.AttachPoint = {
            comps: [{
                type: "rect",
                background: { func: function() { return ub.AttachPoint.data.isAttach ? "rgb(51,153,255)" : "rgb(247,247,247)" } },
                borderWidth: 1,
                rotation: Math.PI / 4,
                borderColor: { func: function() { return Wq } },
                rect: {
                    func: function() {
                        var $ = ub.AttachPoint.data.isAttach ? Bl + 4 : Bl;
                        return [
                            [ub.AttachPoint.data.x, ub.AttachPoint.data.y], $, $
                        ]
                    }
                }
            }]
        }, ub.SimpleRect = { comps: [{ type: "rect", background: null, borderWidth: { func: function() { return ub.SimpleRect.data.borderWidth || 1 } }, borderColor: { func: function() { return ub.SimpleRect.data.color || Wq } }, rect: { func: function() { var T = ub.SimpleRect.data; return [T.x, T.y, T.width, T.height] } } }] }, k.Default.setImage("Icons.MoveDummyImage", { width: 32, height: 32, boundExtend: 12, attachStyle: "close", comps: [{ type: "oval", background: "rgb(255,255,255)", borderColor: "#979797", shadow: !0, shadowColor: "rgba(0,0,0,0.25)", shadowOffsetX: 0, rect: [0, 0, 32, 32] }, { type: "shape", background: "rgb(51,153,255)", pixelPerfect: !0, points: [8.65079, 11.90713, 9.05502, 11.46921, 9.70629, 11.46921, 10.11052, 11.90713, 10.51476, 12.28891, 10.51476, 12.92895, 10.11052, 13.34441, 8.49359, 14.97258, 12.2889, 14.97258, 12.85034, 14.97258, 13.29949, 15.42172, 13.29949, 15.99439, 13.29949, 16.57828, 12.85034, 17.0162, 12.2889, 17.0162, 8.49359, 17.0162, 10.11052, 18.6556, 10.51476, 19.0486, 10.51476, 19.7111, 10.11052, 20.09288, 9.70629, 20.50834, 9.05502, 20.50834, 8.65079, 20.09288, 5.32709, 16.76917, 5.28217, 16.71303, 4.87794, 16.32002, 4.87794, 15.67998, 5.28217, 15.26452, 8.65079, 11.90713, 8.65079, 11.90713, 8.65079, 11.90713, 13.3444, 10.09931, 13.3444, 10.09931, 12.94017, 10.50354, 12.2889, 10.50354, 11.88467, 10.09931, 11.48043, 9.69507, 11.48043, 9.0438, 11.88467, 8.63957, 15.27574, 5.25973, 15.66874, 4.86672, 16.32001, 4.86672, 16.73547, 5.25973, 16.76917, 5.31586, 20.10409, 8.63957, 20.50832, 9.0438, 20.50832, 9.68385, 20.10409, 10.09931, 19.69986, 10.49231, 19.07105, 10.50354, 18.64436, 10.09931, 17.02742, 8.45991, 17.02742, 12.26646, 17.02742, 12.83912, 16.55581, 13.31072, 15.99438, 13.31072, 15.43295, 13.31072, 14.98379, 12.83912, 14.98379, 12.26646, 14.96134, 8.45991, 13.3444, 10.09931, 13.3444, 10.09931, 13.3444, 10.09931, 21.90069, 13.33318, 21.90069, 13.33318, 21.49646, 12.91771, 21.49646, 12.27768, 21.90069, 11.89591, 22.31615, 11.45798, 22.94497, 11.45798, 23.36043, 11.89591, 26.72904, 15.2533, 27.12205, 15.66876, 27.12205, 16.3088, 26.72904, 16.7018, 26.6729, 16.75794, 23.36043, 20.08165, 22.94497, 20.49711, 22.31615, 20.49711, 21.90069, 20.08165, 21.49646, 19.69987, 21.49646, 19.03737, 21.90069, 18.64437, 23.51763, 17.00498, 19.72231, 17.00498, 19.14965, 17.00498, 18.71173, 16.56705, 18.71173, 15.98316, 18.71173, 15.41049, 19.14965, 14.96135, 19.72231, 14.96135, 23.51763, 14.96135, 21.90069, 13.33318, 21.90069, 13.33318, 21.90069, 13.33318, 11.88467, 23.32675, 11.88467, 23.32675, 11.48043, 22.94498, 11.48043, 22.27125, 11.88467, 21.88948, 12.2889, 21.48523, 12.94017, 21.48523, 13.3444, 21.88948, 14.96134, 23.52887, 14.98379, 19.7111, 14.98379, 19.14966, 15.43295, 18.67805, 15.99438, 18.67805, 16.55581, 18.67805, 17.02742, 19.14966, 17.02742, 19.7111, 17.02742, 23.52887, 18.64436, 21.88948, 19.07105, 21.48523, 19.69986, 21.48523, 20.10409, 21.88948, 20.50832, 22.27125, 20.50832, 22.94498, 20.10409, 23.32675, 16.76917, 26.65045, 16.73547, 26.72905, 16.32001, 27.13329, 15.66874, 27.13329, 15.27574, 26.72905, 11.88467, 23.32675, 11.88467, 23.32675, 11.88467, 23.32675], segments: [1, 4, 4, 2, 2, 4, 4, 2, 2, 4, 4, 2, 2, 4, 2, 2, 2, 1, 2, 4, 4, 2, 4, 2, 2, 4, 4, 2, 2, 4, 4, 2, 2, 2, 2, 1, 2, 4, 4, 2, 4, 2, 2, 4, 4, 2, 2, 4, 4, 2, 2, 2, 2, 1, 2, 4, 4, 2, 2, 4, 4, 2, 2, 4, 4, 2, 2, 4, 2, 2, 2] }] }), ub.MoveDummy = {
            comps: [{
                type: "image",
                name: "Icons.MoveDummyImage",
                rect: {
                    func: function() {
                        var S = ub.MoveDummy.data;
                        return [
                            [S.pos.x, S.pos.y], 2 * S.size, 2 * S.size
                        ]
                    }
                }
            }]
        }, ie.Icons.DrawIcon = function(J, P, j, A) { j.width = j.height = De, j.data = A, Dd = J, k.Default.drawImage(P, j, 0, 0, De, De) }, ie.Icons.MapPoints = function(O, j) { for (var k = 0, U = O.length; U > k; k++) O[k] /= j }, ie.roundTo = function(Z, c, W) { var p = Math.abs(Z % c); return W > p || W > c - p ? c * Math.round(Z / c) : Z }, ie.toFixed = function(Z) { return Math.round(100 * Z) / 100 }, ie.getDataMatrix = function(t) {
            if (t instanceof k.Shape) {
                var R = new k.Math.Matrix2d,
                    N = t.getPosition();
                return R.translate(-N.x, -N.y).scale(t.getScale().x, t.getScale().y).rotate(t.getRotation()).translate(N.x, N.y), R
            }
            return t.getMatrix ? t.getMatrix() : new k.Math.Matrix2d
        };
        var Ni = ie.Math.Curve = function() { this._curves = [] };
        Ni.prototype = {}, Ni.prototype.constructor = Ni, Ni.prototype.createFromHtShape = function(n, V, i) {
            V instanceof k.List && (V = V.toArray());
            var w, E, v, p, m, T, b, M = this,
                r = null,
                a = null,
                D = 0,
                N = ie.Math.Vector2,
                A = ie.Math.CubicBezier,
                B = function(B) { return new N(n[B], n[B + 1], i ? i[B / 2] : O) };
            for (E = 0, v = V.length; v > E; E++) {
                switch (p = V[E], m = null, p) {
                    case 1:
                        a = B(D), r = a, D += 2;
                        break;
                    case 2:
                        w = B(D), D += 2, m = new A(a, a.clone(), w.clone(), w), a = w;
                        break;
                    case 3:
                        T = B(D), w = B(D + 2), D += 4, m = new A(a, T.clone().sub(a).multiplyScalar(2 / 3).add(a), T.clone().sub(w).multiplyScalar(2 / 3).add(w), w), a = w;
                        break;
                    case 4:
                        T = B(D), b = B(D + 2), w = B(D + 4), D += 6, m = new A(a, T, b, w), a = w;
                        break;
                    case 5:
                        if (!r) break;
                        m = new A(a, a.clone(), r.clone(), r), a = null, r = null
                }
                m && (m._index = M._curves.length, M._curves.push(m))
            }
        }, Ni.prototype.checkPoint = function(R, Z) {
            var H, m, A, l, J, n = this,
                F = n._curves;
            for (H = 0, m = F.length; m > H; H++)
                if (l = F[H], J = l.intersectRect(R, Z, Z), J.length) return A = 0, J.forEach(function(H) { A += H.t }), A /= J.length, R = l.getPointAt(A), R.t = A, { bezier: l, intersection: R }
        }, Ni.prototype.insertKnot = function(a, _) {
            var B = a.insertKnot(_),
                g = this,
                K = g._curves;
            K.splice(a._index, 1, B[0], B[1])
        }, Ni.prototype._isCloseEnough = function(A, S) { return Math.abs(A.x - S.x) < 1e-6 && Math.abs(A.y - S.y) < 1e-6 }, Ni.prototype._isSamePoint = function(Z, n) { return Z === n }, Ni.prototype.moveRealPoint = function(L, Z) {
            var z = this,
                Y = z._curves,
                t = Z.clone().sub(L);
            Y.forEach(function(I) {
                var m = I._p1;
                I._p2, I._p3;
                var k = I._p4;
                z._isSamePoint(m, L) && (I._p2.add(t), I._p1 = Z), z._isSamePoint(k, L) && (I._p3.add(t), I._p4 = Z)
            })
        }, Ni.prototype.moveCtrlDueToRealPointMovement = function(K, q) {
            var n = this,
                k = n._curves,
                W = function(r) { r.add(q), r.e && q.e && (r.e += q.e) };
            k.forEach(function(u) {
                var P = u._p1;
                u._p2, u._p3;
                var G = u._p4;
                n._isSamePoint(P, K) && W(u._p2), n._isSamePoint(G, K) && W(u._p3)
            })
        }, Ni.prototype.moveCtrlPoint = function(H, P, y) {
            var z = H[y];
            if (z) {
                z.e !== O && (P.e = z.e);
                var j = this,
                    s = j._curves;
                P.clone().sub(z), s.forEach(function(H) { var o; "c2" === y ? o = "_p2" : "c1" === y && (o = "_p3"), j._isSamePoint(H[o], z) && (H[o] = P) }), H[y] = P
            }
        }, Ni.prototype.deleteRealPoint = function(r, B) {
            var h, m, L, J, W, U, Y, f = this,
                T = f._curves,
                C = {},
                z = [],
                e = ie.Math.CubicBezier;
            for (m = 0, L = T.length; L > m; m++) h = T[m], J = h._p1, W = h._p2, U = h._p3, Y = h._p4, (C[m] || !f._isSamePoint(J, r)) && (f._isSamePoint(Y, r) ? L > m + 1 && f._isSamePoint(T[m + 1]._p1, r) && (B || z.push(new e(J, W, T[m + 1]._p3, T[m + 1]._p4))) : z.push(h));
            f._curves = z
        }, Ni.prototype.findPairs = function(v, r) {
            var c, V, y, b, m, W, n, S, O = this,
                h = O._curves,
                u = {},
                C = [];
            for (V = 0, y = h.length; y > V; V++) c = h[V], b = c._p1, m = c._p2, W = c._p3, n = c._p4, !u[V] && O._isSamePoint(b, v) && (r ? C.push({ point: b, r2: n }) : C.push({ point: b, c2: m })), O._isSamePoint(n, v) && (S = r ? { point: n, r1: b } : { point: n, c1: W }, y > V + 1 && O._isSamePoint(h[V + 1]._p1, v) && (r ? S.r2 = h[V + 1]._p4 : S.c2 = h[V + 1]._p2, u[V + 1] = !0), C.push(S));
            return C
        }, Ni.prototype.toHtShape = function() {
            var T = this,
                P = T._curves,
                d = [],
                b = [],
                X = { x: 1 / 0, y: 1 / 0 };
            return P.forEach(function(u) {
                var N = u._p1,
                    Y = u._p2,
                    R = u._p3,
                    D = u._p4;
                return T._isCloseEnough(N, X) || (d.push(1), b.push(N.clone())), X = D, T._isCloseEnough(N, Y) && T._isCloseEnough(R, D) ? (d.push(2), b.push(D.clone()), void 0) : (d.push(4), b.push(Y.clone(), R.clone(), D.clone()), void 0)
            }), { segments: d, points: b }
        };
        var te = ie.Math.CubicBezier = function(c, I, y, l) {
            var a = this;
            a._id = ie.Math.CubicBezier._globalId++, a._p1 = c, a._p2 = I, a._p3 = y, a._p4 = l
        };
        te._globalId = 1, te.prototype = {}, te.prototype.constructor = te, te.prototype.toString = function() { return this._id }, te.prototype.intersectRect = function(K, F, o) {
            var U = F / 2,
                t = o / 2,
                q = K.x,
                E = K.y,
                l = ie.Math.Vector2,
                Q = new l(-U + q, -t + E),
                j = new l(U + q, t + E),
                I = new l(j.x, Q.y),
                b = new l(Q.x, j.y),
                m = this,
                M = m.intersectLine(Q, I),
                J = m.intersectLine(I, j),
                N = m.intersectLine(j, b),
                V = m.intersectLine(b, Q),
                S = M.concat(J).concat(N).concat(V);
            return S
        }, te.prototype.intersectLine = function(e, O) {
            var Q, k, K, y, b, X, A, t, r, R, q, U, i, v = this,
                g = e.clone().min(O),
                S = e.clone().max(O);
            y = v._p1, b = v._p2, X = v._p3, A = v._p4, Q = y.clone().multiplyScalar(-1), k = b.clone().multiplyScalar(3), K = X.clone().multiplyScalar(-3), q = Q.add(k).add(K).add(A), Q = y.clone().multiplyScalar(3), k = b.clone().multiplyScalar(-6), K = X.clone().multiplyScalar(3), R = Q.add(k).add(K), Q = y.clone().multiplyScalar(-3), k = b.clone().multiplyScalar(3), r = Q.add(k), t = y.clone(), i = new ie.Math.Vector2(e.y - O.y, O.x - e.x), U = e.x * O.y - O.x * e.y;
            for (var f = v.getRoots(i.dot(q), i.dot(R), i.dot(r), i.dot(t) + U), H = new Array, C = 0, l = f.length; l > C; C++) {
                var j = f[C];
                if (!(0 > j || j > 1)) {
                    var z = v.getPointAt(j);
                    z.t = j, e.x == O.x ? g.y <= z.y && z.y <= S.y && H.push(z) : e.y == O.y ? g.x <= z.x && z.x <= S.x && H.push(z) : z.x >= g.x && z.y >= g.y && z.x <= S.x && z.y <= S.y && H.push(z)
                }
            }
            return H
        }, te.prototype.solveTForPoint = function(s) {
            var F, u, j, f, t = this;
            F = t._p1.x - s.x, u = t._p2.x - s.x, j = t._p3.x - s.x, f = t._p4.x - s.x;
            for (var D = t.getRoots(f - 3 * j + 3 * u - F, 3 * j - 6 * u + 3 * F, 3 * u - 3 * F, F), C = O, H = 1 / 0, i = 0, Y = D.length; Y > i; i++) {
                var U = D[i];
                if (!(0 > U || U > 1)) {
                    var N = t.getPointAt(U);
                    N.t = U;
                    var b = Math.abs(N.y - s.y);
                    H > b && (H = b, C = N)
                }
            }
            return C
        }, te.prototype.getPointAt = function(l) {
            var u = this,
                E = u._p1,
                U = u._p2,
                y = u._p3,
                x = u._p4,
                F = E.clone().lerp(U, l),
                h = U.clone().lerp(y, l),
                d = y.clone().lerp(x, l),
                v = F.lerp(h, l),
                I = h.lerp(d, l);
            return v.lerp(I, l)
        }, te.prototype.getPointByPercentage = function(f) {
            var p = this.length * f,
                C = this._cacheLength,
                P = C.length;
            if (0 === p) return C[0].point;
            if (f >= 1) return C[P - 1].point;
            for (var y = 0; P > y; y++) { var L = C[y]; if (!(L.len < p)) { var V = C[y - 1]; return L.point.clone().sub(V.point).setLength(p - V.len).add(V.point) } }
        }, te.prototype.getTByPercentage = function(C) {
            var J = this.length * C,
                D = this._cacheLength,
                M = D.length;
            if (0 === J || 0 >= C) return D[0].t;
            if (C >= 1) return D[M - 1].t;
            for (var m = 0; M > m; m++) { var p = D[m]; if (!(p.len < J)) { var O = D[m - 1]; return (J - O.len) / (p.len - O.len) * (p.t - O.t) + O.t } }
        }, te.prototype.getRoots = function(p, w, a, v) {
            var H, S, Y, D, C, e = new Array;
            if (Math.abs(p) < 1e-6) {
                var H = w,
                    S = a / H,
                    Y = v / H,
                    D = S * S - 4 * Y;
                if (D > 0) {
                    var C = Math.sqrt(D);
                    e.push(.5 * (-S + C)), e.push(.5 * (-S - C))
                } else 0 == D && e.push(.5 * -S)
            }
            w /= p, a /= p, v /= p, H = (3 * a - w * w) / 3, S = (2 * w * w * w - 9 * a * w + 27 * v) / 27;
            var E = w / 3,
                T = S * S / 4 + H * H * H / 27,
                _ = S / 2;
            if (Math.abs(T) <= 1e-6 && (T = 0), T > 0) {
                var F, P, C = Math.sqrt(T);
                F = -_ + C, P = F >= 0 ? Math.pow(F, 1 / 3) : -Math.pow(-F, 1 / 3), F = -_ - C, F >= 0 ? P += Math.pow(F, 1 / 3) : P -= Math.pow(-F, 1 / 3), e.push(P - E)
            } else if (0 > T) {
                var y = Math.sqrt(-H / 3),
                    R = Math.atan2(Math.sqrt(-T), -_) / 3,
                    f = Math.cos(R),
                    V = Math.sin(R),
                    W = Math.sqrt(3);
                e.push(2 * y * f - E), e.push(-y * (f + W * V) - E), e.push(-y * (f - W * V) - E)
            } else {
                var F;
                F = _ >= 0 ? -Math.pow(_, 1 / 3) : Math.pow(-_, 1 / 3), e.push(2 * F - E), e.push(-F - E)
            }
            return e
        }, te.prototype._70I = function() { var O = this; return O._p1.distanceToSquared(O._p2) < 1e-10 && O._p3.distanceToSquared(O._p4) < 1e-10 }, te.prototype.insertKnot = function(M) {
            var q = this,
                x = q._p1,
                H = q._p2,
                i = q._p3,
                F = q._p4,
                z = x.clone().lerp(H, M),
                L = H.clone().lerp(i, M),
                u = i.clone().lerp(F, M),
                w = z.clone().lerp(L, M),
                R = L.clone().lerp(u, M),
                S = w.clone().lerp(R, M);
            return q._70I() ? (x.clone().lerp(F, M), [new ie.Math.CubicBezier(x, x.clone(), S.clone(), S), new ie.Math.CubicBezier(S, S.clone(), F.clone(), F)]) : [new ie.Math.CubicBezier(x, z, w, S), new ie.Math.CubicBezier(S, R, u, F)]
        }, n.defineProperties(te.prototype, {
            length: {
                get: function() {
                    var r = this._cacheLength;
                    if (!r) {
                        r = this._cacheLength = [];
                        for (var O = this._p1, v = 0, K = 0; 1 >= v;) {
                            var z = this.getPointAt(v += .001);
                            K += z.clone().sub(O).length(), O = z, r.push({ len: K, t: v, point: z.clone() })
                        }
                    }
                    return r[r.length - 1].len
                }
            },
            p1: { get: function() { return this._p1 }, set: function(m) { this._p1 = m, this._cacheLength = O } },
            p2: { get: function() { return this._p2 }, set: function(F) { this._p2 = F, this._cacheLength = O } },
            p3: { get: function() { return this._p3 }, set: function(l) { this._p3 = l, this._cacheLength = O } },
            p4: { get: function() { return this._p4 }, set: function(C) { this._p4 = C, this._cacheLength = O } }
        });
        var As = k.Default.getInternal().ui().EdgeUI,
            dp = {
                _47O: function(f) {
                    var u = this,
                        Y = dp.getBackups()._47O;
                    ie.inEdit(u.gv) || Y.call(u, f)
                }
            };
        ie.Inject.registAsModule(dp, As);
        var Bd = k.Default.getInternal().ui().NodeUI,
            bq = {
                _47O: function(Z) {
                    var A = this,
                        g = bq.getBackups()._47O;
                    ie.inEdit(A.gv) || g.call(A, Z)
                },
                getSelectWidth: function() {
                    var J = this,
                        Z = J.gv,
                        i = J._data;
                    if (Z.isEditable(i) && ie.inEdit(Z)) return 0;
                    var n = bq.getBackup("getSelectWidth");
                    return n.call(J)
                }
            };
        ie.Inject.registAsModule(bq, Bd);
        var hq = k.graph.GraphView,
            wg = {
                _editPointSize: function() {
                    var Z = k.Default.isTouchable,
                        J = ie.getStyle("pointSize");
                    return J[Z ? 0 : 1]
                }(),
                isPointEditable: function(W) {
                    var K = this;
                    if (ie.inEdit(K)) return K._pointEditableFunc ? K._pointEditableFunc(W) : !0;
                    var M = wg.getBackup("isPointEditable");
                    M.call(K, W)
                },
                isEditable: function(Y) {
                    var P, B = this,
                        b = wg.getBackup("isEditable");
                    if (P = Y instanceof ie.Group ? !0 : b.call(B, Y), !ie.inEdit(B)) return P;
                    if (!(Y instanceof k.Edge)) return P;
                    if (!Y.s("2d.editable")) return !1;
                    var i = B.getEditableFunc();
                    return i ? i(Y) : !0
                },
                _42: function(Z, l) {
                    var D = this,
                        U = wg.getBackups()._42;
                    if (U.call(D, Z, l), ie.inEdit(D)) {
                        var T = D.getEditInteractor();
                        T.drawImpl()
                    }
                }
            };
        ie.Inject.registAsModule(wg, hq);
        var Rf = k.Default.getInternal().ui().ShapeUI,
            vm = {
                _47O: function(R) {
                    var f = this,
                        x = vm.getBackups()._47O;
                    ie.inEdit(f.gv) || x.call(f, R)
                }
            };
        ie.Inject.registAsModule(vm, Rf);
        var bf = k.graph.DefaultInteractor,
            Nn = {
                handle_mousewheel: function(Q) {
                    var b = this,
                        K = Nn.getBackup("handle_mousewheel");
                    ie.inEdit(b.gv) || K.call(b, Q)
                }
            };
        ie.Inject.registAsModule(Nn, bf);
        var Oc = k.graph.MoveInteractor,
            Dn = {
                _calcShift: function(g, T) {
                    var v = this,
                        I = Dn.getBackup("_calcShift"),
                        K = v.gv;
                    if (!ie.inEdit(K)) return I.call(v, g, T);
                    var L = K.getEditInteractor(),
                        k = L.getSubModule("Move").calcShift(g, T, v);
                    return k || I.call(v, g, T)
                },
                clear: function(A) {
                    var N = this,
                        B = Dn.getBackup("clear");
                    B.call(N, A);
                    var c = N.gv;
                    if (ie.inEdit(c)) {
                        var _ = c.getEditInteractor();
                        _.getSubModule("Move").clear(A)
                    }
                }
            };
        ie.Inject.registAsModule(Dn, Oc);
        var Qf = ie.Rect = function(h) { this.catalog = "Rect", this._interactor = h };
        Qf.prototype = {}, Qf.prototype.constructor = Qf, Qf.prototype.gatherInfo = function(t, Q) { var q = this; if (1 === Q.length) { var n = Q[0]; return n instanceof k.Shape && n._70I() ? q.gatherLine(t, n) : oh(n, t) ? !1 : q.gatherSingleTarget(t, n) } return Q.length > 1 ? q.gatherMultiTargets(t, Q) : !1 }, Qf.prototype.gatherSingleTarget = function(V, S) {
            if (S.getCorners) {
                var X, b = this,
                    R = b.info;
                b.target = S, X = b.screenInfo = {};
                var v = S.getCorners();
                R.LT = new ie.Math.Vector2(v[0]), R.LB = new ie.Math.Vector2(v[1]), R.RB = new ie.Math.Vector2(v[2]), R.RT = new ie.Math.Vector2(v[3]), R.T = R.LT.clone().add(R.RT).divideScalar(2), R.B = R.LB.clone().add(R.RB).divideScalar(2), R.L = R.LT.clone().add(R.LB).divideScalar(2), R.R = R.RT.clone().add(R.RB).divideScalar(2);
                for (var r in R) X[r] = ie.toScreenPosition(V, R[r]);
                var i = b._interactor,
                    p = i.getStyle("checkSize"),
                    n = function(w, y, G) {
                        var $ = y.clone().sub(w).setLength(-p),
                            c = G.clone().sub(w).setLength(-p),
                            v = $.add(c).add(w);
                        return v
                    };
                return X.rotLT = n(X.LT, X.RT, X.LB), X.rotLB = n(X.LB, X.LT, X.RB), X.rotRB = n(X.RB, X.LB, X.RT), X.rotRT = n(X.RT, X.LT, X.RB), X.rotT = X.rotLT.clone().add(X.rotRT).divideScalar(2), X.rotB = X.rotLB.clone().add(X.rotRB).divideScalar(2), X.rotL = X.rotLT.clone().add(X.rotLB).divideScalar(2), X.rotR = X.rotRT.clone().add(X.rotRB).divideScalar(2), X.rotation = S.getRotation(), b.gatherConnectInfo(), !0
            }
        }, Qf.prototype.gatherConnectInfo = function() {
            var U = this,
                p = U.target,
                x = U._interactor,
                _ = U.screenInfo,
                b = x.gv;
            if (b.isConnectActionVisible(p) && x.getStyle("connectGuideVisible")) {
                var F;
                p.s && (F = p.s("connectGuideShift")), F || (F = x.getStyle("connectGuideShift"));
                var q = p.getAnchor(),
                    P = p.getSize(),
                    E = p.toGlobal({ x: P.width * (F[0] - q.x), y: P.height * (F[1] - q.y) });
                E = ie.toScreenPosition(b, E), _.P1 ? E.add(_.P2.clone().sub(_.P1).setLength(F[2])) : (E.add(_.RT.clone().sub(_.LT).setLength(F[2])), E.add(_.LB.clone().sub(_.LT).setLength(F[3]))), _.connect = E
            }
        }, Qf.prototype.gatherMultiTargets = function(S, d) { var M = ie.Group.findOrCreateGroup(d); if (!M) return !1; var I = this; return I.editing && "rotate" !== I.editing.mode || M.calcInfo(), I.gatherSingleTarget(S, M) }, Qf.prototype.gatherLine = function(j, C) {
            this.target = C;
            var $ = this.screenInfo = {},
                K = C.getPoints(),
                c = ie.getDataMatrix(C);
            return $.P1 = ie.toScreenPosition(j, c.apply(K.get(0))), $.P2 = ie.toScreenPosition(j, c.apply(K.get(1))), this.gatherConnectInfo(), !0
        }, Qf.ResizeKeys = ["LT", "RB", "LB", "RT", "L", "R", "B", "T"], Qf.ResizeDirection = [{ x: -1, y: -1 }, { x: 1, y: 1 }, { x: -1, y: 1 }, { x: 1, y: -1 }, { x: -1, y: 0 }, { x: 1, y: 0 }, { x: 0, y: 1 }, { x: 0, y: -1 }], Qf.RotateKeys = ["rotLT", "rotRB", "rotLB", "rotRT", "rotL", "rotR", "rotB", "rotT"], Qf.prototype.check = function(J, $, C) {
            if (k.Default.isLeftButton($)) {
                var F = this;
                if (F.editing = null, F.tipInfo = null, F.screenInfo) {
                    var Y = F.target,
                        H = J.isEditable(Y),
                        r = F.screenInfo;
                    if (H && r.connect) { var L = F._checkConnect(C); if (L) return L }
                    if (r.P1) return F._checkLine(C);
                    var Z, U, u, g = null,
                        R = F._interactor,
                        h = R.getStyle("checkSize");
                    if (H && J.isRectEditable(Y))
                        for (U = 0; U < ie.Rect.ResizeKeys.length; U++)
                            if (u = ie.Rect.ResizeKeys[U], ie.checkHit(C, r[u], h)) { g = u, Z = "resize"; break }
                    if (!g && H && J.isRotationEditable(Y) && !R.getStyle("rotateAsClock")) {
                        var o = R.getStyle("rotateCheckSize");
                        for (U = 0; U < ie.Rect.RotateKeys.length; U++)
                            if (u = ie.Rect.RotateKeys[U], ie.checkHit(C, r[u], o)) { g = u, Z = "rotate"; break }
                    }
                    if (!g) return R.setCursor("default"), void 0;
                    if ("rotate" === Z) {
                        var V, n = J.lp($);
                        if (Y instanceof ie.Group) {
                            var W = R.getStyle("groupRotateModeKey");
                            "string" == typeof W && (W = [W]);
                            for (var S = !1, Q = 0, v = W.length; v > Q; Q++)
                                if ($[W[Q]]) { S = !0; break }
                            var I = R.getStyle("groupRotateModeDefault");
                            V = S ? "batch" === I ? "block" : "batch" : I
                        }
                        var c = "batch" === V ? Y.getAnchor2() : Y.getPosition(),
                            y = Math.atan2(n.y - c.y, n.x - c.x);
                        R._setRotateCursor(y), F.editing = { mode: Z, key: g, pos: c, flipY: Y.getScale().y < 0, rotation: Y.getRotation(), hitRot: y }, V && (F.editing.groupRotateMode = V)
                    } else {
                        var t = ie.Rect.ResizeKeys.indexOf(g),
                            m = ie.Rect.ResizeDirection[t],
                            l = Math.cos(Y.getRotation()),
                            b = Math.sin(Y.getRotation()),
                            e = m.x * Math.sign(Y.getScale().x),
                            B = m.y * Math.sign(Y.getScale().y),
                            d = Math.atan2(-b * e - l * B, l * e - b * B),
                            f = (Math.round(d / (Math.PI / 4)) + 8) % 8,
                            M = ["ew-resize", "nesw-resize", "ns-resize", "nwse-resize", "ew-resize", "nesw-resize", "ns-resize", "nwse-resize"][f];
                        this._interactor.setCursor(M);
                        var j = Y.getWidth(),
                            X = Y.getHeight(),
                            A = Y.getAnchor();
                        F.editing = { mode: Z, key: g, rect: { x: -j * A.x, y: -X * A.y, width: j, height: X }, anchor: A, matrix: Y.getMatrix() }
                    }
                    return g
                }
            }
        }, Qf.prototype._checkLine = function(f) {
            var M = this;
            M.screenInfo;
            var T, C = M._interactor.getStyle("checkSize");
            if (ie.checkHit(f, M.screenInfo.P1, C)) T = "P1";
            else {
                if (!ie.checkHit(f, M.screenInfo.P2, C)) return this._interactor.setCursor("default"), void 0;
                T = "P2"
            }
            return M.editing = { mode: "line", key: T }, T
        }, Qf.prototype._checkConnect = function(x) {
            var W = this,
                q = W.screenInfo,
                S = W._interactor,
                Z = S.getStyle("connectGuideIntersectSize"),
                s = q.connect,
                r = x.x,
                g = s.x;
            if (g > r && Z > g - r && Math.abs(s.y - x.y) < Z || r >= g && ie.checkHit(x, s, Z)) {
                var b = "connect",
                    h = D.getConnectAction(S.gv);
                if (W.editing = { mode: b }, h && h.delete)
                    if (W.target instanceof ie.Group) {
                        var a = !0;
                        S.gv.sm().getSelection().each(function(y) { h.delete.visible.call(null, S.gv, y) || (a = !1) }), W.editing.hasDeleteAction = a
                    } else h.delete.visible.call(null, S.gv, W.target) && (W.editing.hasDeleteAction = !0);
                return S.setCursor("default"), b
            }
        }, Qf.prototype._fireEditEvent = function(u, s) {
            var t = this._interactor,
                h = this.editing;
            if (h) {
                var P = h.mode;
                P = "rotate" === P ? "Rotation" : "connect" === P ? "Connection" : "resize" === P ? "Rect" : P[0].toUpperCase() + P.slice(1), t.fi({ kind: u + "Edit" + P, event: s })
            }
        }, Qf.prototype.startEdit = function(c, J) {
            c.startDragging(J);
            var _ = this;
            _._interactor.fi({ kind: "prepareEdit", event: J });
            var f = _.editing,
                R = _.target;
            if (f) {
                if (_._fireEditEvent("begin", J), "rotate" === f.mode) return f.groupRotateMode && R.beginRotate(f), void 0;
                if ("connect" !== f.mode)("line" === f.mode || R && 0 === R.getRotation()) && (_._inSmartGuide = !0, _._interactor.rectGuide.gatherRects());
                else if (f.hasDeleteAction) {
                    var I = c.gv,
                        x = _._interactor.getStyle("connectGuideGarbageShift");
                    f.garbageInfo = { x: I.getWidth() * x[0] + x[2], y: I.getHeight() * x[1] + x[3], size: _._interactor.getStyle("connectGuideGarbageIntersectsize") }, c._42()
                }
            }
        }, Qf.prototype._46O = function(Y) {
            var R, U, y = this,
                W = y.editing,
                E = y.target;
            if (W) {
                if ("connect" === W.mode && !W.canceled && !W.deleted) try { W.garbageInfo && W.garbageInfo.hover ? D.doDeleteConnectionAction(y._interactor.gv, E) : D.doConnectAction(y._interactor.gv, E, W.target) } catch ($) { console.error($) }
                U = W.freezeFlag, R = y.editing.groupRotateMode, y._fireEditEvent("end", Y), y.editing = null
            }
            y.tipInfo = null, y._inSmartGuide && (y._interactor.rectGuide.clear(), y._inSmartGuide = !1), R && E && E.endRotate(), E instanceof k.Block && (U === O ? delete E._freezeSyncFromChildren : E._freezeSyncFromChildren = U, E.updateFromChildren())
        }, Qf.prototype.handleNormalStateDelete = function() {
            var d = this,
                v = d.editing;
            if (v && "connect" === v.mode && !v.canceled && !v.deleted) {
                if (v.garbageInfo) {
                    try { D.doDeleteConnectionAction(d._interactor.gv, d.target) } catch (T) { console.error(T) }
                    v.garbageInfo = null
                }
                return v.cursorPos = null, v.targetCorners = null, v.deleted = !0, d._interactor._42(), !0
            }
        }, Qf.prototype.handleNormalStateKeyDown = function(i) {
            var j = this,
                c = j.editing;
            return !c || "connect" !== c.mode || c.canceled || c.deleted ? void 0 : k.Default.isEsc(i) ? (c.cursorPos = null, c.targetCorners = null, c.canceled = !0, j._interactor._42(), !0) : void 0
        }, Qf.prototype.handleEdit = function(d, j) {
            var W = this,
                t = W.editing;
            if (t) {
                var h, Q, F, w, l, y = W.target,
                    m = t.key,
                    b = t.mode,
                    O = d.lp(j),
                    X = W._interactor;
                if ("connect" === b) {
                    if (t.canceled) return;
                    if (t.deleted) return;
                    t.cursorPos = X._getLogicalPoint(j);
                    var a = t.garbageInfo;
                    return a && ie.checkHit(t.cursorPos, a, a.size) ? (a.hover = !0, t.target = null, t.targetCorners = null) : (a && (a.hover = !1), t.target = d.getDataAt(O, function(e) { return d.isSelectable(e) ? Dj(e) ? !0 : !1 : !1 }) || null, t.targetCorners = ie.getTargetCornersOnScreen(d, t.target)), X._42(), void 0
                }
                if ("rotate" === b) {
                    var x, I, Z = t.pos,
                        D = Math.atan2(O.y - Z.y, O.x - Z.x);
                    if (t.groupRotateMode ? I = D - t.hitRot : (x = D - t.hitRot, I = t.rotation + x), I %= 2 * Math.PI, 0 > I && (I += 2 * Math.PI), !k.Default.isCtrlDown(j)) {
                        var Y, z;
                        eq(j) ? (Y = X.getStyle("shiftRotateRound"), z = Y / 2) : (Y = X.getStyle("rotateRound"), z = X.getStyle("rotateSensitivity")), I = ie.roundTo(I, Y, z)
                    }
                    t.groupRotateMode ? (x = I - (t.lastRotation || 0), 0 !== x && (y.addRotation(x, t.groupRotateMode, function(e) { return d.isRotationEditable(e) }), t.lastRotation = I)) : y.setRotation(I), X._setRotateCursor(D), I > Math.PI && (I -= 2 * Math.PI);
                    var V = 180 * (I / Math.PI);
                    V = V.toFixed(2), h = "" + V + ""
                } else if ("resize" === b) {
                    var S = t.rect;
                    F = S.x, w = S.y;
                    var n, H = S.width,
                        U = S.height,
                        v = t.anchor,
                        c = t.matrix,
                        J = y.s && y.s("keepAspectRatio") || X.getStyle("keepAspectRatio");
                    eq(j) && (J = !J);
                    var M = W._unionPointMode1,
                        f = W._unionPointMode2;
                    if (W._inSmartGuide && !k.Default.isCtrlDown(j) && !J) { var K; "L" === m || "R" === m ? K = "x" : ("T" === m || "B" === m) && (K = "y"), W._adsorbedToClosest(O, K), l = !0 }
                    n = c.tfi(O);
                    var A;
                    "LT" === m ? (S = M(n, { x: F + H, y: w + U }, H, U, J), A = 9) : "T" === m ? (S = f({ x: F, y: n.y }, { x: F + H, y: w + U }, H, U, J, "v"), A = 1) : "RT" === m ? (S = M(n, { x: F, y: w + U }, H, U, J), A = 33) : "L" === m ? (S = f({ x: n.x, y: w }, { x: F + H, y: w + U }, H, U, J, "h"), A = 8) : "R" === m ? (S = f({ x: F, y: w }, { x: n.x, y: w + U }, H, U, J, "h"), A = 32) : "LB" === m ? (S = M(n, { x: F + H, y: w }, H, U, J), A = 12) : "B" === m ? (S = f({ x: F, y: w }, { x: F + H, y: n.y }, H, U, J, "v"), A = 4) : "RB" === m && (S = M(n, { x: F, y: w }, H, U, J), A = 36);
                    var T = c.tf(S.x + S.width * v.x, S.y + S.height * v.y);
                    y instanceof k.Block && (t.hasOwnProperty("freezeFlag") || (t.freezeFlag = y._freezeSyncFromChildren, y._freezeSyncFromChildren = !0)), y.setPosition(T), y.setSize(S.width, S.height), l && (Q = y.getRect(), X.rectGuide.gatherLines({ node: y, x: Q.x, y: Q.y, w: Q.width, h: Q.height }, K, A)), h = "" + Math.round(S.width) + " * " + Math.round(S.height)
                } else if ("line" === b) {
                    if (eq(j)) {
                        var L = y.getPoints(),
                            o = "P1" === m ? L.get(1) : L.get(0),
                            u = { x: O.x - o.x, y: O.y - o.y },
                            G = X.getStyle("shiftLineRotateRound"),
                            i = W._shiftDirList;
                        if (!i || W._shiftRotateRound !== G) { W._shiftRotateRound = G, W._shiftDirList = i = []; for (var E = 0; E < Math.PI; E += G) i.push({ x: N(E), y: C(E) }) }
                        for (var B, $ = 0, R = 0, g = i.length; g > R; R++) {
                            var P = i[R],
                                q = P.x * u.x + P.y * u.y;
                            Math.abs(q) > Math.abs($) && ($ = q, B = P)
                        }
                        O = { x: o.x + B.x * $, y: o.y + B.y * $ }, X.rectGuide.clear()
                    } else W._inSmartGuide && !k.Default.isCtrlDown(j) && (W._adsorbedToClosest(O), l = !0);
                    var p = ie.getDataMatrix(y).applyInverse(O);
                    y.setPoint("P1" === m ? 0 : 1, p, !0);
                    var r = y.getPoints(),
                        s = r.get(0),
                        _ = r.get(1);
                    F = s.x - _.x, w = s.y - _.y, h = " " + Math.round(Math.sqrt(F * F + w * w)) + " ", l && (Q = y.getRect(), X.rectGuide.gatherLines({ node: y, x: Q.x, y: Q.y, w: Q.width, h: Q.height }))
                }
                if (h) {
                    var e = k.Default.getLogicalPoint(j, X._canvas);
                    e.x += ie.Icons.TipShiftX, e.y += ie.Icons.TipShiftY, W.tipInfo = { helperPos: e, text: h, size: h.length }
                }
                W._fireEditEvent("between", j)
            }
        }, Qf.prototype._unionPointMode1 = function(x, O, j, p, l) {
            if (l && j && p) {
                var V = x.x - O.x,
                    U = x.y - O.y;
                Math.abs(V * p) < Math.abs(U * j) ? (U = Math.sign(U) * Math.abs(V * p / j), x.y = O.y + U) : (V = Math.sign(V) * Math.abs(U * j / p), x.x = O.x + V)
            }
            return k.Default.unionPoint(x, O)
        }, Qf.prototype._unionPointMode2 = function(J, Z, Q, r, v, o) { var $ = k.Default.unionPoint(J, Z); if (v && Q && r) { var L; "v" === o ? (L = $.x + $.width / 2, $.width = Q * $.height / r, $.x = L - $.width / 2) : (L = $.y + $.height / 2, $.height = r * $.width / Q, $.y = L - $.height / 2) } return $ }, Qf.prototype._adsorbedToClosest = function(b, Y) {
            var o = this,
                f = o._interactor,
                c = f.rectGuide.findClosest(b, Y),
                L = f.gridGuide.findClosest(b, Y),
                T = 1 / 0,
                P = 1 / 0;
            c && (isFinite(c.x) && (T = c.x), isFinite(c.y) && (P = c.y)), L && (isFinite(L.x) && Math.abs(L.x) < Math.abs(T) && (T = L.x), isFinite(L.y) && Math.abs(L.y) < Math.abs(P) && (P = L.y)), isFinite(T) && (b.x += T), isFinite(P) && (b.y += P)
        }, Qf.prototype._42 = function(K, o, Z) {
            var V = this;
            V.info = {}, V.screenInfo = null;
            var b = V._interactor;
            if (!b.editDetail && V.gatherInfo(o, Z)) {
                var q = V.editing,
                    l = q ? q.groupRotateMode : null,
                    n = V.screenInfo;
                if ("block" !== l) {
                    if (n.P1 ? ie.Icons.DrawIcon(b, K, ie.Icons.Line, n) : ie.Icons.DrawIcon(b, K, ie.Icons.Rect, n), n.connect && (ie.Icons.DrawIcon(b, K, ie.Icons.ConnectGuide, { rotation: n.rotation, connect: n.connect, cursorPos: q ? q.cursorPos : null }), q)) {
                        if (q.targetCorners) {
                            for (var $ = { x: 1 / 0, y: 1 / 0 }, E = { x: -1 / 0, y: -1 / 0 }, O = 0, H = q.targetCorners.length; H > O; O += 2) $.x = Math.min($.x, q.targetCorners[O]), E.x = Math.max(E.x, q.targetCorners[O]), $.y = Math.min($.y, q.targetCorners[O + 1]), E.y = Math.max(E.y, q.targetCorners[O + 1]);
                            ie.Icons.DrawIcon(b, K, ie.Icons.HoverDataRect, { min: $, max: E, color: b.getStyle("hoverGuideColor") || b.getStyle("baseColor") })
                        }
                        q.garbageInfo && ie.Icons.DrawIcon(b, K, ie.Icons.ConnectGuideGarbage, q.garbageInfo)
                    }
                    b.getStyle("rotateTipVisible") && V.tipInfo && ie.Icons.DrawIcon(b, K, ie.Icons.TipHelper, V.tipInfo)
                }
                V.target instanceof ie.Group && V.target._42(b, K, o)
            }
        };
        var kg = ie.Anchor = function(w) { this.catalog = "Anchor", this._interactor = w };
        kg.prototype = {}, kg.prototype.constructor = kg, kg.prototype.gatherInfo = function(U, w) { var R = this; if (1 === w.length) { var W = w[0]; if (!W.getAnchor) return; if (W instanceof k.Shape && W._70I()) return; if (oh(W, U)) return; return R.gatherSingleTarget(U, w[0]) } return w.length > 1 ? R.gatherMultiTargets(U, w) : !1 }, kg.prototype.gatherSingleTarget = function(k, _) { var J = this; return J.info.POS = _.getPosition(), J.screenInfo.POS = ie.toScreenPosition(k, J.info.POS), J.target = _, !0 }, kg.prototype.gatherMultiTargets = function(f, l) {
            var N = this,
                E = ie.Group.findOrCreateGroup(l);
            return E ? (N.screenInfo.POS = ie.toScreenPosition(f, E.getAnchor2()), N.target = E, !0) : !1
        }, kg.prototype.isVisible = function() {
            var u = this,
                j = u._interactor;
            if (j.getStyle("anchorVisible") === !1) return !1;
            var h = u.target;
            if (h) {
                if (this.editing) return !0;
                var b = h.getAnchor(),
                    y = j.getStyle("anchorOutsideVisibleThreshold");
                if (b.x < -y || b.x > 1 + y || b.y < -y || b.y > 1 + y) return !0;
                var F = h.getSize(),
                    m = h.getScale(),
                    _ = Math.min(Math.abs(F.width * m.x), Math.abs(F.height * m.y));
                if (_ * j.gv._zoom < j.getStyle("anchorHideThreshold")) return !1
            }
            return !0
        }, kg.prototype.check = function(C, d, M) {
            if (k.Default.isLeftButton(d)) {
                var a = this,
                    c = a._interactor;
                if (a.isVisible() && c.getStyle("anchorMovable") !== !1) {
                    a.editing = null, a.tipInfo = null;
                    var u = a.target;
                    if (u && C.isAnchorEditable(u) && C.isEditable(u)) {
                        var Y;
                        if (a.screenInfo && (Y = a.screenInfo.POS) && ie.checkHit(M, new ie.Math.Vector2(Y), c.getStyle("checkSize"))) {
                            if (u instanceof ie.Group) return a.editing = {}, !0;
                            var v = u.getWidth(),
                                B = u.getHeight(),
                                g = u.getAnchor();
                            return a.editing = { rect: { x: -v * g.x, y: -B * g.y, width: v, height: B }, anchor: g, matrix: u.getMatrix() }, !0
                        }
                    }
                }
            }
        }, kg.prototype.startEdit = function(w, d) { w.startDragging(d), w.fi({ kind: "beginEditAnchor", event: d }) }, kg.prototype._46O = function($) {
            var q = this;
            q.editing && (q.editing = null, q._interactor.fi({ kind: "endEditAnchor", event: $ })), q.tipInfo = null
        }, kg.prototype.handleEdit = function(B, E) {
            var W = this,
                O = W.target;
            if (O) {
                var P = W.editing;
                if (P) {
                    var s = B.lp(E),
                        S = W._interactor;
                    if (O instanceof ie.Group) return O.setAnchor2(s), S._42(), void 0;
                    var o = P.matrix,
                        R = o.tfi(s),
                        X = P.rect,
                        t = (R.x - X.x) / X.width,
                        L = (R.y - X.y) / X.height;
                    if (!k.Default.isCtrlDown(E)) {
                        var f = S.getStyle("anchorRound"),
                            l = S.getStyle("anchorSensitivity");
                        t = ie.roundTo(t, f, l), L = ie.roundTo(L, f, l)
                    }
                    O.setAnchor(t, L, !0);
                    var T = k.Default.getLogicalPoint(E, S._canvas);
                    T.x += ie.Icons.TipShiftX, T.y += ie.Icons.TipShiftY;
                    var H = "" + t.toFixed(2) + ", " + L.toFixed(2);
                    W.tipInfo = { helperPos: T, text: H, size: H.length }, S.fi({ kind: "betweenEditAnchor", event: E })
                }
            }
        }, kg.prototype._42 = function(i, L, l) {
            var $ = this;
            $.info = {}, $.screenInfo = {};
            var f = $._interactor;
            f.editDetail || $.gatherInfo(L, l) && $.isVisible() && (ie.Icons.DrawIcon(f, i, ie.Icons.Anchor, $.screenInfo), $.tipInfo && ie.Icons.DrawIcon(f, i, ie.Icons.TipHelper, $.tipInfo))
        };
        var vd = ie.MoveDummy = function(X) { this.catalog = "MoveDummy", this._interactor = X };
        vd.prototype = {}, vd.prototype.constructor = vd, vd.prototype.gatherInfo = function() {
            var d = this,
                p = this._interactor.getSubModule("Rect");
            if (p) {
                var w = p.screenInfo;
                if (w) {
                    var Q = d._interactor,
                        U = d.getMovableTarget(p.target);
                    if (U) {
                        var v = Q.getStyle("moveDummyThreshold");
                        if (v !== !1) {
                            var j = w.LT || w.P1,
                                g = w.RT || w.P2,
                                C = w.LB || j;
                            if (j) {
                                var r = w.P1,
                                    H = Math.min(j.distanceTo(C), j.distanceTo(g));
                                if (!(v !== !0 && H > v)) {
                                    var V = Q.getStyle("moveDummyPosition"),
                                        x = g.clone().sub(j),
                                        W = C.clone().sub(j),
                                        P = V[2],
                                        N = V[3];
                                    if (r) {
                                        var u = Q.getStyle("moveDummyLineExtraShift");
                                        u && (P += u[0], N += u[1])
                                    }
                                    var B = j.clone().add(x.clone().multiplyScalar(V[0])).add(x.setLength(P)).add(W.clone().multiplyScalar(V[1])).add(W.setLength(N));
                                    return d.screenInfo.pos = B, d.screenInfo.size = Q.getStyle("moveDummySensitivity"), !0
                                }
                            }
                        }
                    }
                }
            }
        }, vd.prototype.getMovableTarget = function(I) {
            var N = this._interactor.gv;
            if (Dj(I)) { if (N.isMovable(I)) return I } else if (I instanceof ie.Group)
                for (var o = I._entities, t = o.length - 1; t >= 0; t--) { var x = o[t]; if (Dj(x) && N.isMovable(x)) return x }
            return null
        }, vd.prototype.getMoveInteractor = function() {
            for (var L, y, g, p = this._interactor.gv, t = p.getInteractors(), L = 0, y = t.length; y > L; L++)
                if (g = t.get(L), g instanceof Oc) return g
        }, vd.prototype.startEdit = function(Z, E) {
            Z.startDragging(E);
            var g = this.getMoveInteractor();
            if (g) {
                var R = this.selectedTarget,
                    P = Z.gv;
                P._moving = 1, g._data = R, P.handleMouseDown && P.handleMouseDown(E, R)
            }
        }, vd.prototype._46O = function(S) {
            var s = this,
                j = s.getMoveInteractor();
            j && (j.handleWindowMouseUp(S), s.selectedTarget = null)
        }, vd.prototype.handleEdit = function(t, i) {
            var G = this.getMoveInteractor();
            G && G.handleWindowMouseMove(i)
        }, vd.prototype.check = function(F, w, c) { if (this.selectedTarget = null, k.Default.isLeftButton(w) && !F._scrolling && !wd()) { var t = this; if (t.screenInfo) { var Z = t.screenInfo.pos; if (Z && !(c.distanceTo(Z) > t.screenInfo.size)) { var p = t._interactor; return t.selectedTarget = t.getMovableTarget(p.getSubModule("Rect").target), p.setCursor("default"), !0 } } } }, vd.prototype._42 = function(k, T, _) {
            var a = this;
            a.screenInfo = {};
            var Y = a._interactor;
            Y.editDetail || a.gatherInfo(T, _) && (!Y.editing || a.selectedTarget) && ie.Icons.DrawIcon(Y, k, ie.Icons.MoveDummy, a.screenInfo)
        };
        var wb = ie.RotateX = function(F) { this.catalog = "RotateX", this._interactor = F };
        wb.prototype = {}, wb.prototype.constructor = wb, wb.prototype.gatherInfo = function(n, C) { var G = this; if (1 === C.length) { var W = C[0]; return W instanceof k.Shape && W._70I() || oh(W, n) ? !1 : G.gatherSingleTarget(n, W) } return C.length > 1 ? G.gatherMultiTargets(n, C) : !1 }, wb.prototype.gatherSingleTarget = function() {
            var J = new k.Math.Vector2,
                C = new k.Math.Vector2,
                X = new k.Math.Vector2,
                x = new k.Math.Vector2,
                j = function(e, A) {
                    var L = e.x - A.x,
                        W = e.y - A.y;
                    return L * L + W * W
                };
            return function(v, $) {
                if ($.getCorners) {
                    var o = this,
                        c = $.getCorners(),
                        L = 15,
                        W = $.getPosition();
                    J.copy(c[0]), X.copy(c[1]), x.copy(c[3]), C.copy(J).add(x).divideScalar(2).add(J.sub(X).setLength(L / v.getZoom()));
                    var T = Math.max(j(W, c[0]), j(W, c[1]), j(W, c[2]), j(W, c[3]));
                    return o.info.POS = C.clone(), o.screenInfo.POS = ie.toScreenPosition(v, o.info.POS), o.screenInfo.LEN = Math.sqrt(T) * v.getZoom() + L, o.screenInfo.CENTER = ie.toScreenPosition(v, W), o.target = $, !0
                }
            }
        }(), wb.prototype.gatherMultiTargets = function(u, g) {
            var P = this,
                N = ie.Group.findOrCreateGroup(g);
            if (!N) return !1;
            var P = this;
            return P.gatherSingleTarget(u, N)
        }, wb.prototype.isVisible = function() { var e = this._interactor; if (!e.getStyle("rotateAsClock")) return !1; var z = this.target; if (!z) return !0; var w = e.gv; return w.isEditable(z) && w.isRotationEditable(z) ? !0 : !1 }, wb.prototype.check = function(F, l, m) {
            var N = this,
                R = N._checkImpl(F, l, m);
            return (R || N._clockPainted) && N._interactor._42(), R
        }, wb.prototype._checkImpl = function(B, F, E) {
            if (k.Default.isLeftButton(F)) {
                var g = this;
                g.editing = null, g.tipInfo = null;
                var C;
                if (g.screenInfo && (C = g.screenInfo.POS) && g.isVisible()) {
                    var H = g._interactor;
                    if (ie.checkHit(E, C, H.getStyle("checkSize"))) {
                        var A = g.target,
                            Q = B.lp(F),
                            V = A.getPosition(),
                            D = Math.atan2(Q.y - V.y, Q.x - V.x);
                        return H._setRotateCursor(D), g.editing = { pos: V, rotation: A.getRotation(), hitRot: D, groupRotateMode: "block", screenInfo: { CENTER: g.screenInfo.CENTER, LEN: g.screenInfo.LEN } }, !0
                    }
                }
            }
        }, wb.prototype.startEdit = function(c, u) { c.startDragging(u), c.fi({ kind: "beginEditRotation", event: u }), this.target instanceof ie.Group && this.target.beginRotate(this.editing) }, wb.prototype._46O = function(m) {
            var K = this;
            K.editing && (K.editing = null, K._interactor.fi({ kind: "endEditRotation", event: m })), K.target instanceof ie.Group && K.target.endRotate(), K.tipInfo = null
        }, wb.prototype.handleEdit = function(X, g) {
            var H = this,
                B = H.editing;
            if (B) {
                var L, n, S = H.target,
                    p = X.lp(g),
                    e = H._interactor,
                    o = B.pos,
                    f = Math.atan2(p.y - o.y, p.x - o.x),
                    D = S instanceof ie.Group;
                if (D ? n = f - B.hitRot : (L = f - B.hitRot, n = B.rotation + L), n %= 2 * Math.PI, 0 > n && (n += 2 * Math.PI), !k.Default.isCtrlDown(g)) {
                    var V, t;
                    eq(g) ? (V = e.getStyle("shiftRotateRound"), t = V / 2) : (V = e.getStyle("rotateRound"), t = e.getStyle("rotateSensitivity")), n = ie.roundTo(n, V, t)
                }
                D ? (L = n - (B.lastRotation || 0), 0 !== L && (S.addRotation(L, B.groupRotateMode, function(f) { return X.isRotationEditable(f) }), B.lastRotation = n)) : S.setRotation(n), e._setRotateCursor(f), n > Math.PI && (n -= 2 * Math.PI);
                var s = 180 * (n / Math.PI),
                    P = "" + s.toFixed(2) + "",
                    A = k.Default.getLogicalPoint(g, e._canvas);
                A.x += ie.Icons.TipShiftX, A.y += ie.Icons.TipShiftY, H.tipInfo = { helperPos: A, text: P, size: P.length }, e.fi({ kind: "betweenEditRotation", event: g })
            }
        }, wb.prototype._42 = function(M, u, X) {
            var P = this;
            P._clockPainted = !1, P.info = {}, P.screenInfo = {};
            var K = P._interactor;
            K.editDetail || P.gatherInfo(u, X) && P.isVisible() && (ie.Icons.DrawIcon(K, M, ie.Icons.RoundPoint, P.screenInfo.POS), K.getStyle("rotateTipVisible") && P.tipInfo && ie.Icons.DrawIcon(K, M, ie.Icons.TipHelper, P.tipInfo), P.editing && P.drawClock(M))
        }, wb.prototype.drawClock = function(F) {
            F.save();
            var u = this;
            u._clockPainted = !0;
            var J = u.editing || {},
                v = J.screenInfo || u.screenInfo,
                Y = v.LEN,
                s = Y + 8,
                d = Y + 18;
            F.save(), F.translate(v.CENTER.x, v.CENTER.y), F.beginPath(), F.strokeStyle = "rgb(150, 150, 150)";
            for (var y, B, x, K, j, p = 0; 360 > p; p++) y = p * Math.PI / 180, 0 === p % 5 && (B = C(y) * Y, x = N(y) * Y, K = C(y) * s, j = N(y) * s, F.moveTo(B, x), F.lineTo(K, j)), 0 === p % 45 && (B = C(y) * Y, x = N(y) * Y, K = C(y) * d, j = N(y) * d, F.moveTo(B, x), F.lineTo(K, j));
            F.stroke(), F.rotate(-Z);
            var G = J.lastRotation || u.target.getRotation();
            F.beginPath(), F.fillStyle = "rgba(255, 0, 0, 0.1)", F.strokeStyle = "rgb(157, 157, 157)", F.moveTo(0, 0), F.arc(0, 0, d, 0, G, !1), F.fill(), F.beginPath(), F.moveTo(0 + d, 0), F.arc(0, 0, d, 0, G, !1), F.stroke(), F.restore()
        };
        var Ni = ie.Curve = function($) { this.catalog = "Curve", this._interactor = $ };
        Ni.prototype = {}, Ni.prototype.constructor = Ni, n.defineProperties(Ni.prototype, {
            activing: {
                get: function() { return this._activing },
                set: function(L) {
                    var R = this;
                    if (L) R._activing = new ie.CurveActiving(this, L), R._activing._firePointChange();
                    else {
                        var N = R._activing;
                        N && N.dispose(), R._activing = null
                    }
                }
            }
        }), Ni.PointType = { Mirrored: 0, Straight: 1, Disconnected: 2, Asymmetric: 3 }, Ni.prototype.setUp = function() {
            var e = this,
                z = e._interactor;
            z && z.gv.mp(e._onGraphviewPropertyChanged, e)
        }, Ni.prototype._onGraphviewPropertyChanged = function(n) {
            ("zoom" === n.property || "translateX" === n.property || "translateY" === n.property) && this._handleDataChanged()
        }, Ni.prototype.tearDown = function() {
            var E = this,
                R = E._interactor;
            R && R.gv.ump(E._onGraphviewPropertyChanged, E)
        }, Ni.prototype.canEnterEditDetailMode = function() {
            var I = this,
                K = I._interactor,
                o = K._getValidSelection();
            if (1 === o.length) {
                var P = o[0],
                    E = P instanceof k.Edge;
                if (P instanceof k.Shape || E) { if (E) { var U = P.s("edge.type"); if (U && "points" !== U) return } var J = K.gv; if (J.isPointEditable(P) && J.isEditable(P)) return I.target = P, !0 }
            }
        }, Ni.prototype.canQuitEditDetailMode = function(d) {
            var H = this,
                s = H._interactor._getLogicalPoint(d);
            return H._checkEditRealPoint(s) ? void 0 : H._interactor.gv.getDataAt(d) !== H.target ? !0 : void 0
        }, Ni.prototype.preHandleScroll = function() { var z = this.editing; return z && z.inEdit ? !0 : void 0 }, Ni.prototype.getCurrentSelectintStatus = function() {
            var u = this;
            if (u.activing && !u.activing.selections) {
                if (u.activing.status != O) return u.activing.status;
                var T = function(d) {
                        var f = u.activing.status;
                        u.activing.status = d, u._interactor.fp("shapePointStatus", f, d)
                    },
                    w = ie.Curve.PointType,
                    W = u.activing.point,
                    l = u.activing.pairs;
                if (!l || 1 !== l.length) return T(w.Mirrored);
                var n = l[0],
                    H = n.c1 && n.c1.isNearEnough(W),
                    q = n.c2 && n.c2.isNearEnough(W);
                if (!n.c1 || !n.c2) return H || q ? T(w.Straight) : T(w.Disconnected);
                if (H && q) return T(w.Straight);
                if (H || q) return T(w.Asymmetric);
                var V = n.c1.clone().sub(W),
                    b = n.c2.clone().sub(W);
                return Math.abs(V.x * b.y - V.y * b.x) > 1e-5 || V.x * b.x > 0 ? T(w.Disconnected) : Math.abs(V.length() - b.length()) > 1e-5 ? T(w.Asymmetric) : T(w.Mirrored)
            }
        }, Ni.prototype.handle_keydown = function(t) { var A = this; if (A._interactor.editDetail) { var k = ie.Curve.PointType; "1" === t.key ? A._setCurrentSelectionStatus(k.Straight) : "2" === t.key ? A._setCurrentSelectionStatus(k.Mirrored) : "3" === t.key ? A._setCurrentSelectionStatus(k.Disconnected) : "4" === t.key && A._setCurrentSelectionStatus(k.Asymmetric) } }, Ni.prototype.setCurrentSelectionStatus = function(n) {
            var x = this,
                R = x._interactor;
            if (R) {
                var K = R.gv;
                K.dm().beginTransaction(), this._setCurrentSelectionStatus(n), K.dm().endTransaction()
            }
        }, Ni.prototype._setCurrentSelectionStatus = function(r) {
            var P = this,
                l = P.activing;
            if (l) {
                var f = P.getCurrentSelectintStatus();
                if (null !== f && f !== r) {
                    l.status = r;
                    var h = P.activing.point,
                        Q = P.activing.pairs;
                    if (Q && 1 === Q.length) {
                        var w = Q[0],
                            K = P.screenInfo.curve,
                            D = ie.Curve.PointType,
                            I = P._interactor,
                            W = function() { P._writeToHt(), I.fp("shapePointStatus", f, r), P.check(I.gv, null, new ie.Math.Vector2(I._lastLogicalPoint)) };
                        if (r === D.Straight) return K.moveCtrlPoint(w, h, "c1"), K.moveCtrlPoint(w, h, "c2"), W(), void 0;
                        if (f === D.Straight) {
                            var E = K.findPairs(h, !0),
                                R = E[0],
                                q = R.r1 || h,
                                y = R.r2 || h,
                                g = y.clone().sub(q).multiplyScalar(.25);
                            return K.moveCtrlPoint(w, h.clone().sub(g), "c1"), K.moveCtrlPoint(w, h.clone().add(g), "c2"), W(), void 0
                        }
                        var G = w.c1,
                            m = w.c2;
                        if (G && m) {
                            if (r === D.Mirrored) return K.moveCtrlPoint(w, h.clone().multiplyScalar(2).sub(m), "c1"), W(), void 0;
                            if (r === D.Asymmetric && f === D.Disconnected) {
                                var M = G.clone().sub(h).length(),
                                    g = h.clone().sub(m).setLength(M).add(h);
                                return K.moveCtrlPoint(w, g, "c1"), W(), void 0
                            }
                        }
                        l._firePointChange(), I.fp("shapePointStatus", f, r), P.check(I.gv, null, new ie.Math.Vector2(I._lastLogicalPoint))
                    }
                }
            }
        }, Ni.prototype._handleDataChanged = function() {
            var O = "s:edge.points,s:edge.segments,points,segments,shape,position,rotation,scale".split(",");
            return function(e) {
                var y = this;
                if (y.screenInfo && y.target) {
                    if (e && O.indexOf(e.property) < 0) return;
                    var s = y._interactor;
                    y.gatherSingleTarget(s.gv, y.target, !0), y.check(s.gv, null, new ie.Math.Vector2(s._lastLogicalPoint)), s._42()
                }
            }
        }(), Ni.prototype.gatherSingleTarget = function(b, I, m) {
            var Z, G, n = this;
            n.screenInfo && n.screenInfo.curve && (G = n.screenInfo.curve._curves);
            var E = n.editing;
            Z = E ? n.screenInfo : n.screenInfo = {};
            var R, r, d = I instanceof k.Edge;
            d ? (R = I.s("edge.segments"), r = I.s("edge.points") || new k.List) : (R = I._58O, r = I._59O), Z.S = R;
            var W, y = Z.P = [],
                N = ie.getDataMatrix(I);
            if (I instanceof k.Polyline || I instanceof k.Edge && n._interactor.getStyle("edgeElevationEditable")) W = I.getElevation && I.getElevation() || 0, Z.E = [];
            else {
                var J = !1;
                r.each(function(p) { p.e !== O && (J = !0) }), J && (Z.E = [])
            }
            if (r.each(function(n) {
                    Z.E && Z.E.push(n.e != O ? n.e : W), n = N.apply(n);
                    var k = ie.toScreenPosition(b, n);
                    y.push(k.x, k.y)
                }), d) {
                var C = y.length,
                    Y = ie.toScreenPosition(b, I._lastSourcePoint || (C ? { x: y[0], y: y[1] } : { x: 0, y: 0 })),
                    S = ie.toScreenPosition(b, I._lastTargetPoint || (C ? { x: y[C - 2], y: y[C - 1] } : { x: 0, y: 0 }));
                y.splice(0, 0, Y.x, Y.y), y.push(S.x, S.y), Z.E && (Z.E.splice(0, 0, "head"), Z.E.push("tail"))
            }
            if (!Z.S || !Z.S.size()) { Z.S = new k.List, Z.S.add(1); for (var e = 0; e < y.length / 2 - 1; e++) Z.S.add(2) }
            if ((!E || m) && n.convertToCubicBezier(G), n.activing && (m || !n.editing || "realPoint" === n.editing.type)) {
                var u = Z.curve.findPairs(n.activing.point);
                n.activing.pairs = u
            }
        }, Ni.prototype._convertToNewPoint = function(Y, o, J, R) {
            var C, z, E;
            for (C = 0, z = o.length; z > C; C++) { if (E = o[C], E._p1.isNearEnough(Y) && (!R || R.indexOf(E._p1) < 0)) return E._p1; if (E._p4.isNearEnough(Y) && (!R || R.indexOf(E._p4) < 0)) return E._p4 }
            if (J)
                for (C = 0, z = Math.min(J.length, z); z > C; C++) { if (E = J[C], E._p1 === Y && (!R || R.indexOf(o[C]._p1) < 0)) return o[C]._p1; if (E._p4 === Y && (!R || R.indexOf(o[C]._p4) < 0)) return o[C]._p4 }
        }, Ni.prototype.convertToCubicBezier = function(n) {
            var Q, C, F = this,
                q = new ie.Math.Curve,
                d = F.screenInfo;
            if (q.createFromHtShape(d.P, d.S, d.E), d.curve = q, F.activing) {
                var O = q._curves;
                Q = F.activing.point, C = F._convertToNewPoint(Q, O, n);
                var f = [];
                if (C && (F.activing.point = C, f.push(C)), F.activing.selections) {
                    var S = -1,
                        k = F.activing.selections;
                    k.forEach(function(x) { S++, C = F._convertToNewPoint(x, O, n, f), C && (k[S] = C, f.push(C)) })
                }
            }
        }, Ni.prototype.check = function(d, k, F) {
            if (!k || pn(k) || kd(k)) {
                var G = this;
                if (G._interactor.setCursor("default"), G.editing = null, G.highlight = null, G.tipInfo = null, G.edgeEditResult = null, G.screenInfo) {
                    if (wd() || k && kd(k)) return G._interactor._42(), !0;
                    if (G._checkEditCtrlPoint(F)) return G._interactor._42(), !0;
                    if (G._checkEditRealPoint(F)) return G._interactor._42(), !0;
                    if (G._checkEditElevation(F)) return G._interactor._42(), !0;
                    var N = G.screenInfo.curve,
                        W = N.checkPoint(F, G._interactor.getStyle("curveIntersectSize"));
                    if (W) {
                        var V = G.highlight = {};
                        V.type = "insertKnot", V.bezier = W.bezier, V.point = W.intersection
                    }
                    return G._interactor._42(), !0
                }
            }
        }, Ni.prototype.getAdjacentBeziers = function(N) {
            var E = this.screenInfo;
            if (E) {
                var B, c, J, G = E.curve._curves,
                    K = [],
                    r = O;
                for (B = 0, c = G.length; c > B; B++)
                    if (J = G[B], r === O) { if (J._p4.isNearEnough(N)) { K.push(J), r = B; continue } } else { if (J._p1.isNearEnough(N)) return K.push(J), K; if (J._p4.isNearEnough(N)) { K[0] = J, r = B; continue } }
            }
        }, Ni.prototype.roundCorner = function(E) {
            if (this.activing && this.screenInfo) {
                var z = this.screenInfo.curve,
                    x = z._curves,
                    O = this.getAdjacentBeziers(this.activing.point),
                    k = O[1],
                    $ = k._index;
                k = k.insertKnot(k.getTByPercentage(E / k.length))[1], x[$] = k;
                var K = k.p1,
                    M = O[0],
                    W = M._index;
                M = M.insertKnot(M.getTByPercentage(1 - E / M.length))[0], x[W] = M;
                var D = M.p4,
                    h = this.activing.point,
                    r = new ie.Math.CubicBezier(D, h.clone().sub(D).multiplyScalar(2 / 3).add(D), h.clone().sub(K).multiplyScalar(2 / 3).add(K), K);
                x.splice($, 0, r), this._writeToHt(), this.activing = null, this._interactor._42()
            }
        }, Ni.prototype._checkEditRealPoint = function(r) {
            var U, F, Z, z, j, k, w = this,
                R = w.screenInfo.curve._curves,
                J = w._interactor.getStyle("curvePointIntersectSize"),
                g = 1 / 0;
            for (J *= J, Z = 0, z = R.length; z > Z; Z++) U = R[Z], j = U._p1, k = r.distanceToSquared(j), g > k && (g = k, F = j), j = U._p4, k = r.distanceToSquared(j), g > k && (g = k, F = j);
            if (g > J) return !1;
            var L = w.highlight = {};
            return L.type = "changeRealPoint", L.point = F, w.editing = { type: "realPoint", point: F, shiftGuide: { point: F.clone(), dir: "x", limit: 0 } }, w._interactor.setCursor("crosshair"), !0
        }, Ni.prototype._checkEditElevation = function(R) {
            var g = this;
            if (!g._interactor.getStyle("curveElevationVisible")) return !1;
            var e = g.target;
            if (e instanceof k.Edge && !g._interactor.getStyle("edgeElevationEditable")) return !1;
            var f = g.activing;
            if (!f) return !1;
            var T = f.getCurrentEditingPoint();
            if (!T) return !1;
            var B = g._interactor,
                s = B.getStyle("curveElevationGuideShift"),
                H = B.getStyle("curveElevationIntersectSize"),
                C = R.distanceToSquared({ x: T.x + s[0], y: T.y + s[1] });
            if (!(C > H * H)) {
                var q = g.highlight = {};
                q.type = "elevation";
                var j = new ie.Math.Vector2(R.x, R.y, T.e);
                return g.editing = { type: "elevation", startPoint: j }, g._interactor.setCursor("crosshair"), !0
            }
        }, Ni.prototype._checkEditCtrlPoint = function(Z) {
            var T = this;
            if (T.activing && !T.activing.selections) {
                var a = T.getCurrentSelectintStatus();
                if (a !== ie.Curve.PointType.Straight) {
                    var o = T.activing.pairs;
                    if (o) {
                        var F = T._interactor.getStyle("curvePointIntersectSize");
                        F *= F;
                        var h, t, l, Y, O, w, n, U, J, m = 1 / 0;
                        for (n = 0, J = o.length; J > n; n++)
                            for (Y = o[n], U = 0; 2 > U; U++) O = 0 === U ? "c1" : "c2", Y[O] && (w = Z.distanceToSquared(Y[O]), m > w && (m = w, h = Y, t = n, l = O));
                        if (m > F) return !1;
                        T.activing.hlpair = h, T.activing.hltype = l;
                        var S = T.highlight = {};
                        return S.type = "changeCtrlPoint", S.point = h[l], T.editing = { type: "ctrlPoint", pair: h, pairId: t, ctrlType: l, direction: h[l].clone().sub(T.activing.point).normalize() }, T._interactor.setCursor("crosshair"), !0
                    }
                }
            }
        }, Ni.prototype.startEdit = function(g, O) {
            g.startDragging(O);
            var o = this;
            o.highlight && "insertKnot" === o.highlight.type && (o.insertKnot(), o.gatherSingleTarget(o._interactor.gv, o.target), o.activing = null, o._checkEditRealPoint(o._interactor._getLogicalPoint(O)));
            var G = o._activing;
            if (G) { var L = o.editing ? o.editing.type : null; "ctrlPoint" === L ? G.editingCtrl = { pairId: o.editing.pairId, type: G.hltype } : "realPoint" === L && (G.editingCtrl = !1) }
            var q = o.highlight,
                m = k.Default.isCtrlDown(O);
            if (!q || wd() || kd(O)) { var W = o._interactor.gv; if (!W.setFocus(O) || W._scrolling) return; return m ? o._multiSelect = { startPoint: W.lp(O) } : W.isPannable() && (pn(O) || kd(O)) && (o._pan = { tx: W.tx(), ty: W.ty() }, g.fi({ kind: "beginPan", event: O })), void 0 }
            if ("changeRealPoint" === q.type) {
                var t, D = o.activing ? o.activing.point : null,
                    n = o.activing ? o.activing.selections : null;
                if (m && o.activing) D === q.point ? (n ? (o.activing = { point: n[0] }, n.length > 1 && (n.splice(0, 1), o.activing.selections = n)) : o.activing = null, o.editing = null) : n && (t = n.indexOf(q.point)) >= 0 ? (n.length > 1 ? n.splice(t, 1) : delete o.activing.selections, o.editing = null) : n ? (n.push(D), o.activing = { point: q.point, selections: n }) : o.activing = { point: q.point, selections: [D] };
                else if (n) D === q.point || ((t = n.indexOf(q.point)) >= 0 ? (n.splice(t, 1, D), o.activing = { point: q.point, selections: n }) : o.activing = { point: q.point });
                else {
                    var S;
                    D === q.point && (S = o.activing.status), o.activing = { point: q.point }, S && (o.activing.status = S)
                }
                g.fi({ kind: "beginEditPoint", event: O })
            }
        }, Ni.prototype.insertKnot = function() {
            var x = this,
                M = x.highlight,
                I = x.screenInfo.curve;
            I.insertKnot(M.bezier, M.point.t), x._writeToHt()
        }, Ni.prototype._writeToHt = function() {
            var W, G, X = this,
                D = X.screenInfo.curve,
                m = D.toHtShape(),
                B = m.points,
                S = [],
                c = m.segments,
                T = X._interactor.gv;
            T.dm().beginTransaction();
            var o, L, l = X.target,
                x = l instanceof k.Edge,
                j = ie.getDataMatrix(l).invert();
            L = l instanceof k.Polyline || l instanceof k.Edge && X._interactor.getStyle("edgeElevationEditable"), L && (o = l.getElevation && l.getElevation() || 0);
            for (var R = 0, a = B.length; a > R; R++) W = B[R], G = ie.toWorldPosition(T, W), G = j.apply(G), isFinite(W.e) && W.e !== o && (G.e = W.e), S.push(G);
            if (l._writing = !0, x) {
                l.s("edge.type", "points"), l.setStyle("edge.segments", c), l.setStyle("edge.points", S.slice(1, S.length - 1)), l.setStyle("edge.source.offset.x", 0), l.setStyle("edge.source.offset.y", 0), l.setStyle("edge.target.offset.x", 0), l.setStyle("edge.target.offset.y", 0);
                var u = X._nextChangeEdgeHost;
                delete X._nextChangeEdgeHost, u && ("source" === u.type ? l.setSource(u.host) : l.setTarget(u.host)), X._writeEdgeHostAnchor("source", S[0]), X._writeEdgeHostAnchor("target", S[S.length - 1])
            } else S.length ? (l.setSegments(c), l.setPoints(S, !0)) : l.removeFromDataModel();
            T.dm().endTransaction(), delete l._writing
        }, Ni.prototype._writeEdgeHostAnchor = function(s, Z) {
            var z = this,
                Q = z.target,
                N = z._calcHostAnchor(Q, s, Z);
            N.index !== O ? (Q.setStyle("edge." + s + ".index", N.index), Q.setStyle("edge." + s + ".percent", O), Q.setStyle("edge." + s + ".anchor.x", O), Q.setStyle("edge." + s + ".anchor.y", O)) : N.percent !== O ? (Q.setStyle("edge." + s + ".percent", N.percent), Q.setStyle("edge." + s + ".index", O), Q.setStyle("edge." + s + ".anchor.x", O), Q.setStyle("edge." + s + ".anchor.y", O)) : (Q.s("edge." + s + ".anchor.x", N.x), Q.s("edge." + s + ".anchor.y", N.y), N.offsetX || N.offsetY ? (Q.s("edge." + s + ".offset.x", N.offsetX), Q.s("edge." + s + ".offset.y", N.offsetY)) : (Q.s("edge." + s + ".offset.x", 0), Q.s("edge." + s + ".offset.y", 0)))
        }, Ni.prototype._calcHostAnchor = function(j, E, N, V) {
            V || (V = "source" === E ? j.getSource() : j.getTarget());
            var a = this._interactor.gv,
                z = a.calculateAttachPoint(V, N);
            if (z) return z.info;
            if (Si(V)) { var s = a.calculateEdgePosition(V, N); return s }
            var L = V.getRotation(),
                m = V.getAnchor();
            oh(V, a) && (L = 0);
            var b = V.getScale();
            if (L || b.x < 0 || b.y < 0) {
                var F = V.getMatrix(),
                    u = F.tfi(N),
                    e = V.getSize();
                return { x: u.x / e.width + m.x, y: u.y / e.height + m.y }
            }
            var g = Kc(a, V),
                q = { x: (N.x - g.x) / g.width, y: (N.y - g.y) / g.height };
            return q
        }, Ni.prototype._handlePanning = function(B) {
            var X = this,
                p = X._pan;
            if (p) {
                p.started = !0;
                var l = X._interactor,
                    E = l.gv,
                    r = l._lastClientPoint,
                    P = Sp(B),
                    g = Tq(E, P, r);
                E.setTranslate(p.tx + g.x, p.ty + g.y), X.gatherSingleTarget(l.gv, X.target), l._42(), l.fi({ kind: "betweenPan", event: B })
            }
        }, Ni.prototype.handleEdit = function(Y, m) {
            var L = this,
                v = L.editing;
            if (L._pan) return L._handlePanning(m), void 0;
            if (L._multiSelect) return L._multiSelect.endPoint = Y.lp(m), L._interactor.redraw(), void 0;
            if (v) {
                v.inEdit = !0;
                var Z, T, F, B = L._interactor._getLogicalPoint(m),
                    q = k.Default.isCtrlDown(m),
                    c = k.Default.isShiftDown(m),
                    o = v.type,
                    l = L.activing;
                if (L._guideInfo = null, "ctrlPoint" === o && c) {
                    var Q = L.editing.direction.clone();
                    Z = l.point;
                    var I = Q.dot(B.clone().sub(Z));
                    B = Q.setLength(I).add(Z)
                } else if ("ctrlPoint" === o || "realPoint" === o) {
                    var Q;
                    if ("realPoint" === o && c) {
                        var G = L.editing.shiftGuide;
                        T = G.point;
                        var p = Math.abs(B.x - T.x),
                            i = Math.abs(B.y - T.y);
                        p > i && p > G.limit && "y" === G.dir && (G.dir = "x"), i > p && i > G.limit && "x" === G.dir && (G.dir = "y"), Q = G.dir, "x" === Q ? (B.y = T.y, G.limit = Math.max(G.limit, p)) : "y" === Q && (B.x = T.x, G.limit = Math.max(G.limit, i))
                    }
                    var $ = L._isEditEdgeSourceTarget();
                    if ($) {
                        var M = L._editEdgeSourceTarget($, B, q);
                        M && (L.edgeEditResult = M, F = M.tipText)
                    } else if (!q) {
                        var t = L._guidingToEdit(B, Q),
                            d = "realPoint" === o ? L._interactor.gridGuide.findClosest(B, Q, !0) : null,
                            U = 1 / 0,
                            P = 1 / 0;
                        d && (d.x && (U = d.x), d.y && (P = d.y));
                        var j = !1;
                        t && (t.xList && (Math.abs(t.x) <= Math.abs(U) ? (j = !0, U = t.x) : delete t.xList), t.yList && (Math.abs(t.y) <= Math.abs(P) ? (j = !0, P = t.y) : delete t.yList), j && (L._guideInfo = t)), isFinite(U) && (B.x += U), isFinite(P) && (B.y += P), j && (t.v = B)
                    }
                }
                var y = L.screenInfo.curve;
                if ("realPoint" === v.type) {
                    Z = v.point, Z.e !== O && (B.e = Z.e), y.moveRealPoint(Z, B), v.point = B, L.highlight.point = B;
                    var C = l.status,
                        u = l.selections;
                    if (L.activing = { point: B, status: C }, u) {
                        var A = B.clone().sub(Z),
                            V = 0;
                        u.forEach(function(s) {
                            var d = s.clone().add(A);
                            y.moveRealPoint(s, d), u[V++] = d
                        }), L.activing.selections = u
                    }
                } else if ("ctrlPoint" === v.type) {
                    var r = l.pairs,
                        z = r[v.pairId];
                    y.moveCtrlPoint(z, B, v.ctrlType);
                    var S = l.status,
                        w = ie.Curve.PointType;
                    if ((S === w.Mirrored || S === w.Asymmetric) && z.c1 && z.c2) {
                        var Z = new ie.Math.Vector2(l.point),
                            e = "c1" === v.ctrlType ? "c2" : "c1";
                        if (S === ie.Curve.PointType.Mirrored) y.moveCtrlPoint(z, Z.clone().multiplyScalar(2).sub(B), e);
                        else if (S === w.Asymmetric) {
                            var I = z[e].clone().sub(Z).length(),
                                J = Z.clone().sub(z[v.ctrlType]).setLength(I).add(Z);
                            isNaN(J.x) || y.moveCtrlPoint(z, J, e)
                        }
                    }
                    l._firePointChange()
                } else if ("elevation" === v.type) {
                    T = v.startPoint;
                    var W = T.e + (T.y - B.y) / Y._zoom;
                    L._setCurrentPointImpl("e", W), l._firePointChange(), F = "E: " + ie.toFixed(W)
                }
                var f = k.Default.getLogicalPoint(m, L._interactor._canvas);
                if (f.x += ie.Icons.TipShiftX, f.y += ie.Icons.TipShiftY, !F) {
                    var x = ie.toWorldPosition(Y, B);
                    F = "" + ie.toFixed(x.x) + ", " + ie.toFixed(x.y)
                }
                L.tipInfo = { helperPos: f, text: F, size: F.length }, L._writeToHt(), L._interactor.fi({ kind: "betweenEditPoint", event: m })
            }
        }, Ni.prototype._setCurrentPointImpl = function(b, g) {
            var D = this,
                C = D._activing;
            if (!C) return !1;
            var T = D.target;
            if (!T) return !1;
            var P = C.getCurrentEditingPoint();
            if (!P) return !1;
            var p = C.editingCtrl;
            if (!p) var Q = P.clone();
            if ("e" === b) P.e = g;
            else {
                var w;
                if ("x" === b || "y" === b) {
                    var m = C._lastFirePoint;
                    w = "x" === b ? { x: g, y: m ? m.y : 0 } : { x: m ? m.x : 0, y: g }
                } else "object" == typeof b ? (w = b, b.e !== O && (P.e = b.e)) : (w = { x: arguments[0], y: arguments[1] }, arguments[2] !== O && (P.e = arguments[2]));
                var a = ie.getDataMatrix(T);
                w = ie.toScreenPosition(D._interactor.gv, a.apply(w)), P.x = w.x, P.y = w.y
            }
            if (!p) {
                var W = Q.multiplyScalar(-1).add(P);
                P.e && Q.e && (W.e = P.e - Q.e);
                var H = D.screenInfo.curve;
                H.moveCtrlDueToRealPointMovement(P, W);
                var s = C.selections;
                if (s) {
                    var E = 0;
                    s.forEach(function(F) {
                        var D = F.clone().add(W);
                        isFinite(W.e) && (D.e = (isFinite(F.e) ? F.e : T.getElevation() || 0) + W.e), H.moveRealPoint(F, D), s[E++] = D
                    }), C.selections = s
                }
            }
            return !0
        }, Ni.prototype.setCurrentPoint = function(j, L) { return this._setCurrentPointImpl(j, L) ? (this._writeToHt(), !0) : !1 }, Ni.prototype._isEditEdgeSourceTarget = function() {
            var e = this,
                C = e.target;
            if (!(C instanceof k.Edge)) return !1;
            var j = e.editing.point,
                c = e.screenInfo.curve._curves;
            return j === c[0]._p1 ? "source" : j === c[c.length - 1]._p4 ? "target" : !1
        }, Ni.prototype._editEdgeSourceTarget = function($, F, D) {
            var y, I = this,
                o = I.target;
            if (y = "source" === $ ? o.getSource() : o.getTarget()) {
                var v, C = I._interactor.gv,
                    n = ie.toWorldPosition(C, F),
                    q = I._calcHostAnchor(o, $, n, y);
                if (v = q.index !== O || q.percent !== O ? q.distance * C.getZoom() > I._interactor.getStyle("edgeHostEdgeMaxDistance") : I._interactor.getStyle("edgeHostDetectPerFrame") ? !0 : q.x < 0 || q.x > 1 || q.y < 0 || q.y > 1 ? !0 : !1) {
                    var K = C.getDataAt(n, function(g) { return C.isSelectable(g) ? C.isSourceTargetEditable(o, g, $) ? o.canSetSourceTarget(g, $) ? !0 : !1 : !1 : !1 });
                    if (K) {
                        var b = I._calcHostAnchor(o, $, n, K);
                        y = K, I._nextChangeEdgeHost = { type: $, host: K }, q = b
                    }
                }
                var Z, T, Q;
                if (D || q.x === O)(q.percent !== O || q.index !== O) && (T = q.point);
                else {
                    var U = I._interactor.getStyle("anchorRound"),
                        P = I._interactor.getStyle("anchorSensitivity");
                    Z = C.calculateAttachPoint(y, n), Z ? q = Z.info : (q.x = ie.roundTo(q.x, U, P), q.y = ie.roundTo(q.y, U, P)), T = Cg(C, y, 0, q.offsetX || 0, q.offsetY || 0, q.x, q.y)
                }
                T && (Q = ie.toScreenPosition(C, T), F.x = Q.x, F.y = Q.y), I._edgeHostGuideInfo = { corners: ie.getTargetCornersOnScreen(C, y), attach: Z ? Z.index : -1, host: y };
                var f;
                return q.percent !== O ? f = "percent: " + q.percent.toFixed(2) : q.index !== O ? f = "index: " + q.index : (f = "" + q.x.toFixed(2) + ", " + q.y.toFixed(2), (q.offsetX || q.offsetY) && (f += " offset: " + q.offsetX.toFixed(2) + ", " + q.offsetY.toFixed(2))), { host: y, anchor: q, tipText: f }
            }
        }, Ni.prototype._guidingToEdit = function(M, d) {
            var j, c, I = this;
            if (j = I.screenInfo.curve) {
                c = j._curves;
                var i, Y, z, o, e, U, Z, b, T = 1 / 0,
                    B = 1 / 0,
                    G = [];
                for (I.editing && "realPoint" === I.editing.type && (b = I.editing.point), e = 0, U = 2 * c.length; U > e; e++) Z = c[Math.floor(e / 2)][e % 2 ? "_p4" : "_p1"], G.indexOf(Z) >= 0 || (G.push(Z), b && b === Z || (z = Z.x - M.x, o = Z.y - M.y, Math.abs(z) < Math.abs(T) ? (T = z, i = [Z]) : z === T && i.push(Z), Math.abs(o) < Math.abs(B) ? (B = o, Y = [Z]) : o === B && Y.push(Z)));
                var r = I._interactor.getStyle("smartGuideThreshold");
                if ((Math.abs(T) > r || "y" === d) && (i = null), (Math.abs(B) > r || "x" === d) && (Y = null), i || Y) {
                    var L = !1,
                        n = {};
                    if (i && (L = !0, n.xList = i, n.x = T), Y && (L = !0, n.yList = Y, n.y = B), L) return n
                }
            }
        }, Ni.prototype._46O = function(Q) {
            var w = this;
            w.editing && (w.editing = null, w._interactor.fi({ kind: "endEditPoint", event: Q })), w._guideInfo = null, w._edgeHostGuideInfo = null, w._pan && (w._pan = null, w._interactor.fi({ kind: "endPan", event: Q })), w._multiSelect && (w._handleMultiSelect(w._multiSelect), w._multiSelect = null), w.tipInfo = null, w.edgeEditResult = null
        }, Ni.prototype._handleMultiSelect = function(g) {
            if (g.startPoint && g.endPoint) {
                var Q, m, z, P, c, x = this,
                    n = x._interactor,
                    T = n.gv,
                    M = ie.toScreenPosition(T, g.startPoint),
                    R = ie.toScreenPosition(T, g.endPoint),
                    K = k.Default.unionPoint(M, R),
                    H = x.screenInfo.curve._curves,
                    d = [],
                    F = function(w) { w.x >= K.x && w.y >= K.y && w.x <= K.x + K.width && w.y <= K.y + K.height && d.indexOf(w) < 0 && d.push(w) };
                for (Q = 0, m = H.length; m > Q; Q++) c = H[Q], F(c._p1), F(c._p4);
                if (d.length) {
                    var y = x.activing || {},
                        U = y.selections || [];
                    for (y.point && U.push(y.point), Q = 0, m = U.length; m > Q; Q++) z = U[Q], P = d.indexOf(z), P >= 0 ? d[P] = O : d.push(z);
                    var v = d;
                    for (d = [], Q = 0, m = v.length; m > Q; Q++) v[Q] && d.push(v[Q]);
                    m = d.length, 0 === m ? x.activing = null : 1 === m ? x.activing = { point: d[0] } : (z = d[m - 1], x.activing = { point: z, selections: d.splice(0, m - 1) }), n.redraw()
                }
            }
        }, Ni.prototype._canDeletePoint = function(I, B) {
            var i = this.target;
            if (!(i instanceof k.Edge)) return !0;
            var J = I._curves[0],
                r = I._curves[I._curves.length - 1];
            return J._p1 === B || r._p4 === B ? !1 : !0
        }, Ni.prototype.handleDelete = function() {
            var L = this;
            if (L.activing && L.screenInfo) {
                var T = k.Default.isShiftDown(),
                    q = L.screenInfo.curve;
                L._canDeletePoint(q, L.activing.point) && q.deleteRealPoint(L.activing.point, T), L.activing.selections && L.activing.selections.forEach(function(b) { L._canDeletePoint(q, b) && q.deleteRealPoint(b, T) }), L.activing = null, delete L.editing, delete L.tipInfo, delete L.edgeEditResult, delete L._pan, delete L._multiSelect, L._writeToHt(), L._interactor.fp("deleteShapePoint", !1, !0)
            }
        }, Ni.prototype.handleDoubleClick = function(j) {
            var K = this,
                t = K._interactor._getLogicalPoint(j);
            if (K.screenInfo && K._checkEditRealPoint(t)) {
                var D = K.getCurrentSelectintStatus(),
                    A = ie.Curve.PointType;
                return D = D === A.Mirrored ? A.Straight : A.Mirrored, K._setCurrentSelectionStatus(D), K._interactor._42(), !0
            }
        }, Ni.prototype._drawHighlight = function(y) {
            var Z = this,
                S = Z.highlight;
            if (S) {
                var A = S.bezier,
                    g = Z._interactor;
                A && ie.Icons.DrawIcon(g, y, ie.Icons.ShapeHighlightCurve, [A._p1.x, A._p1.y, A._p2.x, A._p2.y, A._p3.x, A._p3.y, A._p4.x, A._p4.y]);
                var F = S.point;
                F && "insertKnot" === S.type && ie.Icons.DrawIcon(g, y, ie.Icons.ShapeHighlighPoint, F)
            }
        }, Ni.prototype._drawGuide = function(A) {
            var I = this,
                q = I._guideInfo;
            if (q) {
                var e, z, K, F, M = q.v;
                for (e = 0; 2 > e; e++)
                    if (F = 0 === e ? q.xList : q.yList)
                        for (z = 0, K = F.length; K > z; z++) ie.Icons.DrawIcon(I._interactor, A, ie.Icons.ShapeGuideLine, [M.x, M.y, F[z].x, F[z].y])
            }
        }, Ni.prototype._drawCurrentPoint = function(k) {
            var $ = this;
            if ($.activing) {
                var y = $.activing,
                    n = $.getCurrentSelectintStatus(),
                    A = $._interactor;
                if (n !== ie.Curve.PointType.Straight) {
                    var b = y.pairs;
                    y.hlpair, y.hltype;
                    var p = y.selections,
                        F = y.editingCtrl;
                    if (b && !p) { var V, h, i; for (h = 0, i = b.length; i > h; h++) V = b[h], F && h === F.pairId && V[F.type] ? ie.Icons.DrawIcon(A, k, ie.Icons.ShapeActivingCtrl, { point: V.point, c1: V.c1, c2: V.c2, hl: F.type }) : ie.Icons.DrawIcon(A, k, ie.Icons.ShapeActivingCtrl, V) }
                }
                ie.Icons.DrawIcon(A, k, ie.Icons.ShapeHighlighRealPoint, $.activing.point), p && p.forEach(function(W) { ie.Icons.DrawIcon(A, k, ie.Icons.ShapeHighlighRealPoint, W) })
            }
        }, Ni.prototype.clear = function() {
            var J = this;
            J.editing = null, J._guideInfo = null, J.activing = null, J.highlight = null
        }, Ni.prototype._42 = function(S) {
            var Z = this;
            Z.info = {}, Z.editing || (Z.screenInfo = null);
            var I = Z._interactor;
            if (!I.editDetail) return Z.clear(), void 0;
            var J = I.gv;
            if (!Z.target || !J.isSelected(Z.target) || !J.isVisible(Z.target)) return I.editDetail = !1, Z.clear(), void 0;
            if (Z.gatherSingleTarget(J, Z.target), ie.Icons.DrawIcon(I, S, ie.Icons.ShapeBgCurve, Z.screenInfo), Z._interactor.getStyle("curveElevationVisible") && (Z.target instanceof k.Polyline || Z.target instanceof k.Edge && Z._interactor.getStyle("edgeElevationEditable")) && Z.activing) {
                var i = Z.activing.getCurrentEditingPoint();
                i && "string" != typeof i.e && ie.Icons.DrawIcon(I, S, ie.Icons.EdgeElevationGuide, i)
            }
            if (Z._drawHighlight(S), Z._drawCurrentPoint(S), Z._getRealPoint().forEach(function(F) { ie.Icons.DrawIcon(I, S, ie.Icons.ShapePoint, F) }), Z._drawGuide(S), Z.tipInfo && Z._interactor.getStyle("curveTipVisible") && ie.Icons.DrawIcon(I, S, ie.Icons.TipHelper, Z.tipInfo), Z._edgeHostGuideInfo && I._drawHostGuide(Z._edgeHostGuideInfo), Z.edgeEditResult && Z._drawEdgeHostHighlight(S, Z.edgeEditResult.host, Z.edgeEditResult.anchor), Z._multiSelect && Z._multiSelect.endPoint) {
                var $ = k.Default.unionPoint(ie.toScreenPosition(J, Z._multiSelect.startPoint), ie.toScreenPosition(J, Z._multiSelect.endPoint));
                $.color = J.getRectSelectBorderColor(), S.save(), S.setTransform(1, 0, 0, 1, 0, 0);
                var E = D.devicePixelRatio,
                    B = $.borderWidth = Math.round(E);
                B /= 2, $.x = Math.round($.x * E) + B, $.y = Math.round($.y * E) + B, $.width = Math.round($.width * E), $.height = Math.round($.height * E), ie.Icons.DrawIcon(I, S, ie.Icons.SimpleRect, $), S.restore()
            }
        }, Ni.prototype._drawEdgeHostHighlight = function(U, y, _) {
            this.drawEdgeHostHighlight(U, y, _), this._interactor.redraw()
        }, Ni.prototype.drawEdgeHostHighlight = function(S, m, V) {
            if (Si(m)) {
                var G, E, F, T, g = this,
                    W = g._interactor,
                    K = W.gv,
                    B = K.getDataUI(m),
                    r = Jq(B),
                    Q = [];
                for (F = 0, T = r.points.length; T > F; F++) E = ie.toScreenPosition(K, r.points.get(F)), Q.push(E.x, E.y);
                r.segments && (G = r.segments.toArray());
                var t = W.getStyle("edgeHostHighlighPeriod"),
                    Y = W.getStyle("edgeHostEdgeHighlighColor");
                ie.Icons.DrawIcon(W, S, ie.Icons.ShapeBgCurve, { P: Q, S: G, color: Y, dynamicVisible: V.index === O, dynamicPeriod: t }), Y = W.getStyle("edgeHostPointHighlighColor");
                var C = hl(B);
                for (F = 0, T = C.length; T > F; F++) {
                    var D = C[F],
                        R = ie.toScreenPosition(K, D);
                    ie.Icons.DrawIcon(W, S, ie.Icons.ShapePoint, { point: { x: R.x, y: R.y }, color: Y, size: 12, dynamicVisible: F === V.index, dynamicPeriod: t })
                }
            }
        }, Ni.prototype._getRealPoint = function() {
            var J, O = this.screenInfo,
                A = O.P,
                e = O.S,
                K = -1,
                o = [],
                d = -1,
                l = e.length;
            return e.each(function(q) {
                d++;
                var r = 1;
                if (3 === q) r = 2;
                else if (4 === q) r = 3;
                else if (5 === q) return;
                K += r, J = d + 1 >= l ? !0 : 1 === e.get(d + 1) ? !0 : !1, o.push({ point: { x: A[2 * K], y: A[2 * K + 1] }, segmentIndex: d, pointIndex: K, isEnd: J })
            }), o
        }, Ni.prototype.getEditingPointsInfo = function(m) {
            var l = this,
                g = l.activing;
            if (!g) return !1;
            var v = g.point;
            if (!v) return !1;
            var s = this._getRealPoint(),
                u = [{ screen: v }];
            g.selections && g.selections.forEach(function(e) { u.push({ screen: e }) });
            var r, T, R = s.length;
            return u.forEach(function(M) {
                for (r = 0; R > r; r++)
                    if (T = s[r], M.screen.isNearEnough(T.point)) { M.segmentIndex = T.segmentIndex, M.pointIndex = T.pointIndex, M.point = l.target.getPoints().get(T.pointIndex); break }
            }), m && u.sort(function(R, D) { return R.segmentIndex - D.segmentIndex }), u
        };
        var ir = ie.MoveHelper = function(i) {
            var X = this;
            X.catalog = "Move", X._interactor = i
        };
        ir.prototype = {}, ir.prototype.constructor = ir, ir.prototype.calcShift = function(K, w, Y) {
            var T, z, v = this,
                _ = v._interactor.gv,
                a = _.lp(w);
            if ("beginMove" === K && v._gatherGridInfo(Y._lastLogicalPoint || a), T = v._target) {
                var X = T.downPosition;
                if (X) {
                    var n = v._interactor.getStyle("moveSensitivity") / _._zoom;
                    if (X.distanceTo(a) < n) return { x: 0, y: 0 };
                    delete T.downPosition
                }
                var Z;
                z = k.Default.isShiftDown(w), z && (a = v._dealShiftDown(a), Z = T.shiftGuide.dir);
                var d, O = T.rawPos = { x: T.pos.x + a.x - T.lp.x, y: T.pos.y + a.y - T.lp.y };
                if (k.Default.isCtrlDown(w)) {
                    if (d = v._calcShiftByAddon(), v._target.node instanceof ie.Group) {
                        var U = v._target.node;
                        U._position.x += d.x, U._position.y += d.y
                    }
                    return d
                }
                var S = v._interactor.rectGuide;
                if (T.node instanceof k.Data && T.node.s("2d.attachable")) { var g = v._calcAttachNodeShift(T.node, O); if (S.clear(), g) return g }
                for (var V, D = T.x + O.x, H = T.y + O.y, N = { x: D, y: H }, u = { x: D + T.w / 2, y: H + T.h / 2 }, G = { x: D + T.w, y: H + T.h }, e = v._interactor.gridGuide, B = [S.findClosest(N, Z), S.findClosest(u, Z), S.findClosest(G, Z), e.findClosest(N, Z), e.findClosest(u, Z), e.findClosest(G, Z)], f = 1 / 0, b = 1 / 0, r = 0, q = B.length; q > r; r++) V = B[r], V && (D = V.x, H = V.y, isFinite(D) && Math.abs(D) < Math.abs(f) && (f = D), isFinite(H) && Math.abs(H) < Math.abs(b) && (b = H));
                if (isFinite(f) || (f = 0), isFinite(b) || (b = 0), d = v._calcShiftByAddon(f, b), v._target.node instanceof ie.Group) {
                    var U = v._target.node;
                    U._position.x += d.x, U._position.y += d.y
                }
                var i = T.node;
                if (!oh(i, _)) {
                    var $ = O.x + f,
                        A = O.y + b;
                    v._interactor.rectGuide.gatherLines({ node: i, x: T.x + $, y: T.y + A, w: T.w, h: T.h }, Z)
                }
                return d
            }
        }, ir.prototype._calcShiftByAddon = function(x, I) {
            var w = this._target,
                o = w.rawPos,
                B = w.node.getPosition();
            return x = x || 0, I = I || 0, { x: o.x - B.x + x, y: o.y - B.y + I }
        }, ir.prototype._dealShiftDown = function(f) {
            var v = this,
                C = v._target.shiftGuide,
                U = v._target.lp,
                z = Math.abs(f.x - U.x),
                W = Math.abs(f.y - U.y);
            z > W && z > C.limit && "y" === C.dir && (C.dir = "x"), W > z && W > C.limit && "x" === C.dir && (C.dir = "y");
            var m = C.dir;
            return "x" === m ? (f.y = U.y, C.limit = Math.max(C.limit, z)) : "y" === m && (f.x = U.x, C.limit = Math.max(C.limit, W)), f
        }, ir.prototype._isAttachableLineShape = function(R) {
            if (!R.getSegments) return !1;
            var d = R.getSegments();
            if (!d) return !0;
            d instanceof k.List && (d = d.getArray());
            for (var L = 1, J = d.length; J > L; L++)
                if (2 !== d[L]) return !1;
            return !0
        }, ir.prototype._calcAttachNodeShift = function() {
            var G = new Um,
                l = new Um,
                m = new Um,
                w = new Um;
            return function(j, V) {
                var u = this._interactor.gv,
                    p = j.getHost(),
                    U = u.getDataAt(V, function(O) { return O.s("2d.hostable") ? !0 : !1 });
                if (U && p !== U && j.setHost(U), !U) return this._edgeHostGuideInfo = null, j.setHost(null);
                var q = this._edgeHostGuideInfo = { corners: ie.getTargetCornersOnScreen(u, U), host: U, attach: -1 };
                if (this._isAttachableLineShape(U)) { for (var B, e, o, F, W, k, $ = U.getPoints(), d = $.size(), A = U.getPointsMatrix2d(), v = 1 / 0, I = 0; d > I && (I !== d - 1 || U.isClosePath()); I++) 0 !== I ? l.copy(m) : A.apply($.get(I), l), A.apply(I === d - 1 ? $.get(0) : $.get(I + 1), m), G.copy(V).sub(l), w.copy(m).sub(l), B = w.length(), w.divideScalar(B), e = G.dot(w), 0 > e ? e = 0 : e > B && (e = B), w.multiplyScalar(e).add(l), o = G.copy(V).sub(w).lengthSq(), v > o && (v = o, k = I, F = e, W = B); return Math.sqrt(v) * u.getZoom() > this._interactor.getStyle("attachThreshold") ? (j.s({ "attach.index": -1 }), j.setHost(null), void 0) : (j.s("attach.offset.opposite") && (F = W - F), j.s({ "attach.index": k, "attach.offset": j.s("attach.offset.relative") ? F / W : F }), { x: 0, y: 0 }) }
                var X = u.calculateAttachPoint(U, V);
                if (X) { var z = X.point; return q.attach = X.index, this._calcShiftByAddon(z.x - V.x, z.y - V.y) }
            }
        }(), ir.prototype._gatherGridInfo = function(E) {
            var o, N = this,
                B = N._interactor,
                u = B._getValidSelection();
            if (u.length) { if (1 === u.length) { if (o = u[0], !o.getRect) return N._target = null, void 0 } else if (o = ie.Group.findOrCreateGroup(u), !o) return N._target = null, void 0 } else { var u = B.gv.sm().getSelection(); if (u.length && (o = u.get(0), !o.getRect)) return N._target = null, void 0 }
            if (o) {
                var Q = o.getPosition(),
                    H = o.getRect();
                N._target = { node: o, x: H.x - Q.x, y: H.y - Q.y, w: H.width, h: H.height, lp: { x: E.x, y: E.y }, pos: { x: Q.x, y: Q.y }, shiftGuide: { dir: "x", limit: 0 }, downPosition: new ie.Math.Vector2(E) }, B.rectGuide.gatherRects()
            }
        }, ir.prototype.clear = function() {
            var w = this;
            w._edgeHostGuideInfo = null, w._interactor.rectGuide.clear(), w._interactor._42()
        }, ir.prototype._42 = function() {
            var Z = this._edgeHostGuideInfo;
            Z && this._interactor._drawHostGuide(Z)
        };
        var wq = n.freeze({ DEPTH_BUFFER_BIT: 256, STENCIL_BUFFER_BIT: 1024, COLOR_BUFFER_BIT: 16384, POINTS: 0, LINES: 1, LINE_LOOP: 2, LINE_STRIP: 3, TRIANGLES: 4, TRIANGLE_STRIP: 5, TRIANGLE_FAN: 6, ZERO: 0, ONE: 1, SRC_COLOR: 768, ONE_MINUS_SRC_COLOR: 769, SRC_ALPHA: 770, ONE_MINUS_SRC_ALPHA: 771, DST_ALPHA: 772, ONE_MINUS_DST_ALPHA: 773, DST_COLOR: 774, ONE_MINUS_DST_COLOR: 775, SRC_ALPHA_SATURATE: 776, FUNC_ADD: 32774, BLEND_EQUATION: 32777, BLEND_EQUATION_RGB: 32777, BLEND_EQUATION_ALPHA: 34877, FUNC_SUBTRACT: 32778, FUNC_REVERSE_SUBTRACT: 32779, BLEND_DST_RGB: 32968, BLEND_SRC_RGB: 32969, BLEND_DST_ALPHA: 32970, BLEND_SRC_ALPHA: 32971, CONSTANT_COLOR: 32769, ONE_MINUS_CONSTANT_COLOR: 32770, CONSTANT_ALPHA: 32771, ONE_MINUS_CONSTANT_ALPHA: 32772, BLEND_COLOR: 32773, ARRAY_BUFFER: 34962, ELEMENT_ARRAY_BUFFER: 34963, ARRAY_BUFFER_BINDING: 34964, ELEMENT_ARRAY_BUFFER_BINDING: 34965, STREAM_DRAW: 35040, STATIC_DRAW: 35044, DYNAMIC_DRAW: 35048, BUFFER_SIZE: 34660, BUFFER_USAGE: 34661, CURRENT_VERTEX_ATTRIB: 34342, FRONT: 1028, BACK: 1029, FRONT_AND_BACK: 1032, CULL_FACE: 2884, BLEND: 3042, DITHER: 3024, STENCIL_TEST: 2960, DEPTH_TEST: 2929, SCISSOR_TEST: 3089, POLYGON_OFFSET_FILL: 32823, SAMPLE_ALPHA_TO_COVERAGE: 32926, SAMPLE_COVERAGE: 32928, NO_ERROR: 0, INVALID_ENUM: 1280, INVALID_VALUE: 1281, INVALID_OPERATION: 1282, OUT_OF_MEMORY: 1285, CW: 2304, CCW: 2305, LINE_WIDTH: 2849, ALIASED_POINT_SIZE_RANGE: 33901, ALIASED_LINE_WIDTH_RANGE: 33902, CULL_FACE_MODE: 2885, FRONT_FACE: 2886, DEPTH_RANGE: 2928, DEPTH_WRITEMASK: 2930, DEPTH_CLEAR_VALUE: 2931, DEPTH_FUNC: 2932, STENCIL_CLEAR_VALUE: 2961, STENCIL_FUNC: 2962, STENCIL_FAIL: 2964, STENCIL_PASS_DEPTH_FAIL: 2965, STENCIL_PASS_DEPTH_PASS: 2966, STENCIL_REF: 2967, STENCIL_VALUE_MASK: 2963, STENCIL_WRITEMASK: 2968, STENCIL_BACK_FUNC: 34816, STENCIL_BACK_FAIL: 34817, STENCIL_BACK_PASS_DEPTH_FAIL: 34818, STENCIL_BACK_PASS_DEPTH_PASS: 34819, STENCIL_BACK_REF: 36003, STENCIL_BACK_VALUE_MASK: 36004, STENCIL_BACK_WRITEMASK: 36005, VIEWPORT: 2978, SCISSOR_BOX: 3088, COLOR_CLEAR_VALUE: 3106, COLOR_WRITEMASK: 3107, UNPACK_ALIGNMENT: 3317, PACK_ALIGNMENT: 3333, MAX_TEXTURE_SIZE: 3379, MAX_VIEWPORT_DIMS: 3386, SUBPIXEL_BITS: 3408, RED_BITS: 3410, GREEN_BITS: 3411, BLUE_BITS: 3412, ALPHA_BITS: 3413, DEPTH_BITS: 3414, STENCIL_BITS: 3415, POLYGON_OFFSET_UNITS: 10752, POLYGON_OFFSET_FACTOR: 32824, TEXTURE_BINDING_2D: 32873, SAMPLE_BUFFERS: 32936, SAMPLES: 32937, SAMPLE_COVERAGE_VALUE: 32938, SAMPLE_COVERAGE_INVERT: 32939, COMPRESSED_TEXTURE_FORMATS: 34467, DONT_CARE: 4352, FASTEST: 4353, NICEST: 4354, GENERATE_MIPMAP_HINT: 33170, BYTE: 5120, UNSIGNED_BYTE: 5121, SHORT: 5122, UNSIGNED_SHORT: 5123, INT: 5124, UNSIGNED_INT: 5125, FLOAT: 5126, DEPTH_COMPONENT: 6402, ALPHA: 6406, RGB: 6407, RGBA: 6408, LUMINANCE: 6409, LUMINANCE_ALPHA: 6410, UNSIGNED_SHORT_4_4_4_4: 32819, UNSIGNED_SHORT_5_5_5_1: 32820, UNSIGNED_SHORT_5_6_5: 33635, FRAGMENT_SHADER: 35632, VERTEX_SHADER: 35633, MAX_VERTEX_ATTRIBS: 34921, MAX_VERTEX_UNIFORM_VECTORS: 36347, MAX_VARYING_VECTORS: 36348, MAX_COMBINED_TEXTURE_IMAGE_UNITS: 35661, MAX_VERTEX_TEXTURE_IMAGE_UNITS: 35660, MAX_TEXTURE_IMAGE_UNITS: 34930, MAX_FRAGMENT_UNIFORM_VECTORS: 36349, SHADER_TYPE: 35663, DELETE_STATUS: 35712, LINK_STATUS: 35714, VALIDATE_STATUS: 35715, ATTACHED_SHADERS: 35717, ACTIVE_UNIFORMS: 35718, ACTIVE_ATTRIBUTES: 35721, SHADING_LANGUAGE_VERSION: 35724, CURRENT_PROGRAM: 35725, NEVER: 512, LESS: 513, EQUAL: 514, LEQUAL: 515, GREATER: 516, NOTEQUAL: 517, GEQUAL: 518, ALWAYS: 519, KEEP: 7680, REPLACE: 7681, INCR: 7682, DECR: 7683, INVERT: 5386, INCR_WRAP: 34055, DECR_WRAP: 34056, VENDOR: 7936, RENDERER: 7937, VERSION: 7938, NEAREST: 9728, LINEAR: 9729, NEAREST_MIPMAP_NEAREST: 9984, LINEAR_MIPMAP_NEAREST: 9985, NEAREST_MIPMAP_LINEAR: 9986, LINEAR_MIPMAP_LINEAR: 9987, TEXTURE_MAG_FILTER: 10240, TEXTURE_MIN_FILTER: 10241, TEXTURE_WRAP_S: 10242, TEXTURE_WRAP_T: 10243, TEXTURE_2D: 3553, TEXTURE: 5890, TEXTURE_CUBE_MAP: 34067, TEXTURE_BINDING_CUBE_MAP: 34068, TEXTURE_CUBE_MAP_POSITIVE_X: 34069, TEXTURE_CUBE_MAP_NEGATIVE_X: 34070, TEXTURE_CUBE_MAP_POSITIVE_Y: 34071, TEXTURE_CUBE_MAP_NEGATIVE_Y: 34072, TEXTURE_CUBE_MAP_POSITIVE_Z: 34073, TEXTURE_CUBE_MAP_NEGATIVE_Z: 34074, MAX_CUBE_MAP_TEXTURE_SIZE: 34076, TEXTURE0: 33984, TEXTURE1: 33985, TEXTURE2: 33986, TEXTURE3: 33987, TEXTURE4: 33988, TEXTURE5: 33989, TEXTURE6: 33990, TEXTURE7: 33991, TEXTURE8: 33992, TEXTURE9: 33993, TEXTURE10: 33994, TEXTURE11: 33995, TEXTURE12: 33996, TEXTURE13: 33997, TEXTURE14: 33998, TEXTURE15: 33999, TEXTURE16: 34e3, TEXTURE17: 34001, TEXTURE18: 34002, TEXTURE19: 34003, TEXTURE20: 34004, TEXTURE21: 34005, TEXTURE22: 34006, TEXTURE23: 34007, TEXTURE24: 34008, TEXTURE25: 34009, TEXTURE26: 34010, TEXTURE27: 34011, TEXTURE28: 34012, TEXTURE29: 34013, TEXTURE30: 34014, TEXTURE31: 34015, ACTIVE_TEXTURE: 34016, REPEAT: 10497, CLAMP_TO_EDGE: 33071, MIRRORED_REPEAT: 33648, FLOAT_VEC2: 35664, FLOAT_VEC3: 35665, FLOAT_VEC4: 35666, INT_VEC2: 35667, INT_VEC3: 35668, INT_VEC4: 35669, BOOL: 35670, BOOL_VEC2: 35671, BOOL_VEC3: 35672, BOOL_VEC4: 35673, FLOAT_MAT2: 35674, FLOAT_MAT3: 35675, FLOAT_MAT4: 35676, SAMPLER_2D: 35678, SAMPLER_CUBE: 35680, VERTEX_ATTRIB_ARRAY_ENABLED: 34338, VERTEX_ATTRIB_ARRAY_SIZE: 34339, VERTEX_ATTRIB_ARRAY_STRIDE: 34340, VERTEX_ATTRIB_ARRAY_TYPE: 34341, VERTEX_ATTRIB_ARRAY_NORMALIZED: 34922, VERTEX_ATTRIB_ARRAY_POINTER: 34373, VERTEX_ATTRIB_ARRAY_BUFFER_BINDING: 34975, IMPLEMENTATION_COLOR_READ_TYPE: 35738, IMPLEMENTATION_COLOR_READ_FORMAT: 35739, COMPILE_STATUS: 35713, LOW_FLOAT: 36336, MEDIUM_FLOAT: 36337, HIGH_FLOAT: 36338, LOW_INT: 36339, MEDIUM_INT: 36340, HIGH_INT: 36341, FRAMEBUFFER: 36160, RENDERBUFFER: 36161, RGBA4: 32854, RGB5_A1: 32855, RGB565: 36194, DEPTH_COMPONENT16: 33189, STENCIL_INDEX: 6401, STENCIL_INDEX8: 36168, DEPTH_STENCIL: 34041, RENDERBUFFER_WIDTH: 36162, RENDERBUFFER_HEIGHT: 36163, RENDERBUFFER_INTERNAL_FORMAT: 36164, RENDERBUFFER_RED_SIZE: 36176, RENDERBUFFER_GREEN_SIZE: 36177, RENDERBUFFER_BLUE_SIZE: 36178, RENDERBUFFER_ALPHA_SIZE: 36179, RENDERBUFFER_DEPTH_SIZE: 36180, RENDERBUFFER_STENCIL_SIZE: 36181, FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE: 36048, FRAMEBUFFER_ATTACHMENT_OBJECT_NAME: 36049, FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL: 36050, FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE: 36051, COLOR_ATTACHMENT0: 36064, DEPTH_ATTACHMENT: 36096, STENCIL_ATTACHMENT: 36128, DEPTH_STENCIL_ATTACHMENT: 33306, NONE: 0, FRAMEBUFFER_COMPLETE: 36053, FRAMEBUFFER_INCOMPLETE_ATTACHMENT: 36054, FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT: 36055, FRAMEBUFFER_INCOMPLETE_DIMENSIONS: 36057, FRAMEBUFFER_UNSUPPORTED: 36061, FRAMEBUFFER_BINDING: 36006, RENDERBUFFER_BINDING: 36007, MAX_RENDERBUFFER_SIZE: 34024, INVALID_FRAMEBUFFER_OPERATION: 1286, UNPACK_FLIP_Y_WEBGL: 37440, UNPACK_PREMULTIPLY_ALPHA_WEBGL: 37441, CONTEXT_LOST_WEBGL: 37442, UNPACK_COLORSPACE_CONVERSION_WEBGL: 37443, BROWSER_DEFAULT_WEBGL: 37444, COMPRESSED_RGB_S3TC_DXT1_EXT: 33776, COMPRESSED_RGBA_S3TC_DXT1_EXT: 33777, COMPRESSED_RGBA_S3TC_DXT3_EXT: 33778, COMPRESSED_RGBA_S3TC_DXT5_EXT: 33779, COMPRESSED_RGB_PVRTC_4BPPV1_IMG: 35840, COMPRESSED_RGB_PVRTC_2BPPV1_IMG: 35841, COMPRESSED_RGBA_PVRTC_4BPPV1_IMG: 35842, COMPRESSED_RGBA_PVRTC_2BPPV1_IMG: 35843, COMPRESSED_RGB_ETC1_WEBGL: 36196, HALF_FLOAT_OES: 36193, DOUBLE: 5130, READ_BUFFER: 3074, UNPACK_ROW_LENGTH: 3314, UNPACK_SKIP_ROWS: 3315, UNPACK_SKIP_PIXELS: 3316, PACK_ROW_LENGTH: 3330, PACK_SKIP_ROWS: 3331, PACK_SKIP_PIXELS: 3332, COLOR: 6144, DEPTH: 6145, STENCIL: 6146, RED: 6403, RGB8: 32849, RGBA8: 32856, RGB10_A2: 32857, TEXTURE_BINDING_3D: 32874, UNPACK_SKIP_IMAGES: 32877, UNPACK_IMAGE_HEIGHT: 32878, TEXTURE_3D: 32879, TEXTURE_WRAP_R: 32882, MAX_3D_TEXTURE_SIZE: 32883, UNSIGNED_INT_2_10_10_10_REV: 33640, MAX_ELEMENTS_VERTICES: 33e3, MAX_ELEMENTS_INDICES: 33001, TEXTURE_MIN_LOD: 33082, TEXTURE_MAX_LOD: 33083, TEXTURE_BASE_LEVEL: 33084, TEXTURE_MAX_LEVEL: 33085, MIN: 32775, MAX: 32776, DEPTH_COMPONENT24: 33190, MAX_TEXTURE_LOD_BIAS: 34045, TEXTURE_COMPARE_MODE: 34892, TEXTURE_COMPARE_FUNC: 34893, CURRENT_QUERY: 34917, QUERY_RESULT: 34918, QUERY_RESULT_AVAILABLE: 34919, STREAM_READ: 35041, STREAM_COPY: 35042, STATIC_READ: 35045, STATIC_COPY: 35046, DYNAMIC_READ: 35049, DYNAMIC_COPY: 35050, MAX_DRAW_BUFFERS: 34852, DRAW_BUFFER0: 34853, DRAW_BUFFER1: 34854, DRAW_BUFFER2: 34855, DRAW_BUFFER3: 34856, DRAW_BUFFER4: 34857, DRAW_BUFFER5: 34858, DRAW_BUFFER6: 34859, DRAW_BUFFER7: 34860, DRAW_BUFFER8: 34861, DRAW_BUFFER9: 34862, DRAW_BUFFER10: 34863, DRAW_BUFFER11: 34864, DRAW_BUFFER12: 34865, DRAW_BUFFER13: 34866, DRAW_BUFFER14: 34867, DRAW_BUFFER15: 34868, MAX_FRAGMENT_UNIFORM_COMPONENTS: 35657, MAX_VERTEX_UNIFORM_COMPONENTS: 35658, SAMPLER_3D: 35679, SAMPLER_2D_SHADOW: 35682, FRAGMENT_SHADER_DERIVATIVE_HINT: 35723, PIXEL_PACK_BUFFER: 35051, PIXEL_UNPACK_BUFFER: 35052, PIXEL_PACK_BUFFER_BINDING: 35053, PIXEL_UNPACK_BUFFER_BINDING: 35055, FLOAT_MAT2x3: 35685, FLOAT_MAT2x4: 35686, FLOAT_MAT3x2: 35687, FLOAT_MAT3x4: 35688, FLOAT_MAT4x2: 35689, FLOAT_MAT4x3: 35690, SRGB: 35904, SRGB8: 35905, SRGB8_ALPHA8: 35907, COMPARE_REF_TO_TEXTURE: 34894, RGBA32F: 34836, RGB32F: 34837, RGBA16F: 34842, RGB16F: 34843, VERTEX_ATTRIB_ARRAY_INTEGER: 35069, MAX_ARRAY_TEXTURE_LAYERS: 35071, MIN_PROGRAM_TEXEL_OFFSET: 35076, MAX_PROGRAM_TEXEL_OFFSET: 35077, MAX_VARYING_COMPONENTS: 35659, TEXTURE_2D_ARRAY: 35866, TEXTURE_BINDING_2D_ARRAY: 35869, R11F_G11F_B10F: 35898, UNSIGNED_INT_10F_11F_11F_REV: 35899, RGB9_E5: 35901, UNSIGNED_INT_5_9_9_9_REV: 35902, TRANSFORM_FEEDBACK_BUFFER_MODE: 35967, MAX_TRANSFORM_FEEDBACK_SEPARATE_COMPONENTS: 35968, TRANSFORM_FEEDBACK_VARYINGS: 35971, TRANSFORM_FEEDBACK_BUFFER_START: 35972, TRANSFORM_FEEDBACK_BUFFER_SIZE: 35973, TRANSFORM_FEEDBACK_PRIMITIVES_WRITTEN: 35976, RASTERIZER_DISCARD: 35977, MAX_TRANSFORM_FEEDBACK_INTERLEAVED_COMPONENTS: 35978, MAX_TRANSFORM_FEEDBACK_SEPARATE_ATTRIBS: 35979, INTERLEAVED_ATTRIBS: 35980, SEPARATE_ATTRIBS: 35981, TRANSFORM_FEEDBACK_BUFFER: 35982, TRANSFORM_FEEDBACK_BUFFER_BINDING: 35983, RGBA32UI: 36208, RGB32UI: 36209, RGBA16UI: 36214, RGB16UI: 36215, RGBA8UI: 36220, RGB8UI: 36221, RGBA32I: 36226, RGB32I: 36227, RGBA16I: 36232, RGB16I: 36233, RGBA8I: 36238, RGB8I: 36239, RED_INTEGER: 36244, RGB_INTEGER: 36248, RGBA_INTEGER: 36249, SAMPLER_2D_ARRAY: 36289, SAMPLER_2D_ARRAY_SHADOW: 36292, SAMPLER_CUBE_SHADOW: 36293, UNSIGNED_INT_VEC2: 36294, UNSIGNED_INT_VEC3: 36295, UNSIGNED_INT_VEC4: 36296, INT_SAMPLER_2D: 36298, INT_SAMPLER_3D: 36299, INT_SAMPLER_CUBE: 36300, INT_SAMPLER_2D_ARRAY: 36303, UNSIGNED_INT_SAMPLER_2D: 36306, UNSIGNED_INT_SAMPLER_3D: 36307, UNSIGNED_INT_SAMPLER_CUBE: 36308, UNSIGNED_INT_SAMPLER_2D_ARRAY: 36311, DEPTH_COMPONENT32F: 36012, DEPTH32F_STENCIL8: 36013, FLOAT_32_UNSIGNED_INT_24_8_REV: 36269, FRAMEBUFFER_ATTACHMENT_COLOR_ENCODING: 33296, FRAMEBUFFER_ATTACHMENT_COMPONENT_TYPE: 33297, FRAMEBUFFER_ATTACHMENT_RED_SIZE: 33298, FRAMEBUFFER_ATTACHMENT_GREEN_SIZE: 33299, FRAMEBUFFER_ATTACHMENT_BLUE_SIZE: 33300, FRAMEBUFFER_ATTACHMENT_ALPHA_SIZE: 33301, FRAMEBUFFER_ATTACHMENT_DEPTH_SIZE: 33302, FRAMEBUFFER_ATTACHMENT_STENCIL_SIZE: 33303, FRAMEBUFFER_DEFAULT: 33304, UNSIGNED_INT_24_8: 34042, DEPTH24_STENCIL8: 35056, UNSIGNED_NORMALIZED: 35863, DRAW_FRAMEBUFFER_BINDING: 36006, READ_FRAMEBUFFER: 36008, DRAW_FRAMEBUFFER: 36009, READ_FRAMEBUFFER_BINDING: 36010, RENDERBUFFER_SAMPLES: 36011, FRAMEBUFFER_ATTACHMENT_TEXTURE_LAYER: 36052, MAX_COLOR_ATTACHMENTS: 36063, COLOR_ATTACHMENT1: 36065, COLOR_ATTACHMENT2: 36066, COLOR_ATTACHMENT3: 36067, COLOR_ATTACHMENT4: 36068, COLOR_ATTACHMENT5: 36069, COLOR_ATTACHMENT6: 36070, COLOR_ATTACHMENT7: 36071, COLOR_ATTACHMENT8: 36072, COLOR_ATTACHMENT9: 36073, COLOR_ATTACHMENT10: 36074, COLOR_ATTACHMENT11: 36075, COLOR_ATTACHMENT12: 36076, COLOR_ATTACHMENT13: 36077, COLOR_ATTACHMENT14: 36078, COLOR_ATTACHMENT15: 36079, FRAMEBUFFER_INCOMPLETE_MULTISAMPLE: 36182, MAX_SAMPLES: 36183, HALF_FLOAT: 5131, RG: 33319, RG_INTEGER: 33320, R8: 33321, RG8: 33323, R16F: 33325, R32F: 33326, RG16F: 33327, RG32F: 33328, R8I: 33329, R8UI: 33330, R16I: 33331, R16UI: 33332, R32I: 33333, R32UI: 33334, RG8I: 33335, RG8UI: 33336, RG16I: 33337, RG16UI: 33338, RG32I: 33339, RG32UI: 33340, VERTEX_ARRAY_BINDING: 34229, R8_SNORM: 36756, RG8_SNORM: 36757, RGB8_SNORM: 36758, RGBA8_SNORM: 36759, SIGNED_NORMALIZED: 36764, COPY_READ_BUFFER: 36662, COPY_WRITE_BUFFER: 36663, COPY_READ_BUFFER_BINDING: 36662, COPY_WRITE_BUFFER_BINDING: 36663, UNIFORM_BUFFER: 35345, UNIFORM_BUFFER_BINDING: 35368, UNIFORM_BUFFER_START: 35369, UNIFORM_BUFFER_SIZE: 35370, MAX_VERTEX_UNIFORM_BLOCKS: 35371, MAX_FRAGMENT_UNIFORM_BLOCKS: 35373, MAX_COMBINED_UNIFORM_BLOCKS: 35374, MAX_UNIFORM_BUFFER_BINDINGS: 35375, MAX_UNIFORM_BLOCK_SIZE: 35376, MAX_COMBINED_VERTEX_UNIFORM_COMPONENTS: 35377, MAX_COMBINED_FRAGMENT_UNIFORM_COMPONENTS: 35379, UNIFORM_BUFFER_OFFSET_ALIGNMENT: 35380, ACTIVE_UNIFORM_BLOCKS: 35382, UNIFORM_TYPE: 35383, UNIFORM_SIZE: 35384, UNIFORM_BLOCK_INDEX: 35386, UNIFORM_OFFSET: 35387, UNIFORM_ARRAY_STRIDE: 35388, UNIFORM_MATRIX_STRIDE: 35389, UNIFORM_IS_ROW_MAJOR: 35390, UNIFORM_BLOCK_BINDING: 35391, UNIFORM_BLOCK_DATA_SIZE: 35392, UNIFORM_BLOCK_ACTIVE_UNIFORMS: 35394, UNIFORM_BLOCK_ACTIVE_UNIFORM_INDICES: 35395, UNIFORM_BLOCK_REFERENCED_BY_VERTEX_SHADER: 35396, UNIFORM_BLOCK_REFERENCED_BY_FRAGMENT_SHADER: 35398, INVALID_INDEX: 4294967295, MAX_VERTEX_OUTPUT_COMPONENTS: 37154, MAX_FRAGMENT_INPUT_COMPONENTS: 37157, MAX_SERVER_WAIT_TIMEOUT: 37137, OBJECT_TYPE: 37138, SYNC_CONDITION: 37139, SYNC_STATUS: 37140, SYNC_FLAGS: 37141, SYNC_FENCE: 37142, SYNC_GPU_COMMANDS_COMPLETE: 37143, UNSIGNALED: 37144, SIGNALED: 37145, ALREADY_SIGNALED: 37146, TIMEOUT_EXPIRED: 37147, CONDITION_SATISFIED: 37148, WAIT_FAILED: 37149, SYNC_FLUSH_COMMANDS_BIT: 1, VERTEX_ATTRIB_ARRAY_DIVISOR: 35070, ANY_SAMPLES_PASSED: 35887, ANY_SAMPLES_PASSED_CONSERVATIVE: 36202, SAMPLER_BINDING: 35097, RGB10_A2UI: 36975, INT_2_10_10_10_REV: 36255, TRANSFORM_FEEDBACK: 36386, TRANSFORM_FEEDBACK_PAUSED: 36387, TRANSFORM_FEEDBACK_ACTIVE: 36388, TRANSFORM_FEEDBACK_BINDING: 36389, COMPRESSED_R11_EAC: 37488, COMPRESSED_SIGNED_R11_EAC: 37489, COMPRESSED_RG11_EAC: 37490, COMPRESSED_SIGNED_RG11_EAC: 37491, COMPRESSED_RGB8_ETC2: 37492, COMPRESSED_SRGB8_ETC2: 37493, COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2: 37494, COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2: 37495, COMPRESSED_RGBA8_ETC2_EAC: 37496, COMPRESSED_SRGB8_ALPHA8_ETC2_EAC: 37497, TEXTURE_IMMUTABLE_FORMAT: 37167, MAX_ELEMENT_INDEX: 36203, TEXTURE_IMMUTABLE_LEVELS: 33503, MAX_TEXTURE_MAX_ANISOTROPY_EXT: 34047 }),
            ri = function() {
                function z(N, A) { var Z = O; return function() { return Z || (Z = N.getExtension(A)), Z } }

                function Q(Y, G) {
                    G == O && (G = {}), G.version = e && (Y instanceof WebGL2RenderingContext || n.prototype.toString.call(Y) === d) ? 2 : 1, G.extensions = function() { for (var T = {}, n = Y.getSupportedExtensions(), L = n.length; L--;) T[name] = z(Y, n[L]); return T }();
                    for (var J = n.keys($), I = 0, v = J.length; v > I; ++I) {
                        var E = J[I];
                        G[E] = Y.getParameter($[E])
                    }
                    if (G.version > 1) {
                        J = n.keys(M);
                        for (var I = 0, v = J.length; v > I; ++I) {
                            var E = J[I];
                            G[E] = Y.getParameter(M[E])
                        }
                    }
                    return G
                }
                var e = "undefined" != typeof WebGL2RenderingContext,
                    d = "[object WebGL2RenderingContext]",
                    $ = { aliasedLineWidthRange: wq.ALIASED_LINE_WIDTH_RANGE, aliasedPointSizeRange: wq.ALIASED_POINT_SIZE_RANGE, maxCombinedTextureImageUnits: wq.MAX_COMBINED_TEXTURE_IMAGE_UNITS, maxCubeMapTextureSize: wq.MAX_CUBE_MAP_TEXTURE_SIZE, maxFragmentUniformVectors: wq.MAX_FRAGMENT_UNIFORM_VECTORS, maxRenderBufferSize: wq.MAX_RENDERBUFFER_SIZE, maxTextureImageUnits: wq.MAX_TEXTURE_IMAGE_UNITS, maxTextureSize: wq.MAX_TEXTURE_SIZE, maxVaryingVectors: wq.MAX_VARYING_VECTORS, maxVertexAttribs: wq.MAX_VERTEX_ATTRIBS, maxVertexTextureImageUnits: wq.MAX_VERTEX_TEXTURE_IMAGE_UNITS, maxVertexUniformVectors: wq.MAX_VERTEX_UNIFORM_VECTORS, maxViewportDIMs: wq.MAX_VIEWPORT_DIMS },
                    M = { max3DTextureSize: wq.MAX_3D_TEXTURE_SIZE, maxArrayTextureLayers: wq.MAX_ARRAY_TEXTURE_LAYERS, maxColorAttachments: wq.MAX_COLOR_ATTACHMENTS, maxCombinedFragmentUniformComponents: wq.MAX_COMBINED_FRAGMENT_UNIFORM_COMPONENTS, maxCombinedUniformBlocks: wq.MAX_COMBINED_UNIFORM_BLOCKS, maxCombinedVertexUniformComponents: wq.MAX_COMBINED_VERTEX_UNIFORM_COMPONENTS, maxDrawBuffers: wq.MAX_DRAW_BUFFERS, maxElementIndex: wq.MAX_ELEMENT_INDEX, maxElementsIndices: wq.MAX_ELEMENTS_INDICES, maxElementsVertices: wq.MAX_ELEMENTS_VERTICES, maxFragmentInpuComponents: wq.MAX_FRAGMENT_INPUT_COMPONENTS, maxFragmentUniformBlocks: wq.MAX_FRAGMENT_UNIFORM_BLOCKS, maxFragmentUniformComponents: wq.MAX_FRAGMENT_UNIFORM_COMPONENTS, maxProgramTexelOffset: wq.MAX_PROGRAM_TEXEL_OFFSET, maxSamples: wq.MAX_SAMPLES, maxTextureLODBias: wq.MAX_TEXTURE_LOD_BIAS, maxTransformFeedbackInterleavedComponents: wq.MAX_TRANSFORM_FEEDBACK_INTERLEAVED_COMPONENTS, maxTransformFeedbackSeparateAttribs: wq.MAX_TRANSFORM_FEEDBACK_SEPARATE_ATTRIBS, maxTransformFeedbackSeparateComponents: wq.MAX_TRANSFORM_FEEDBACK_SEPARATE_COMPONENTS, maxUniformBlockSize: wq.MAX_UNIFORM_BLOCK_SIZE, maxUniformBufferBindings: wq.MAX_UNIFORM_BUFFER_BINDINGS, maxVaryingComponents: wq.MAX_VARYING_COMPONENTS, maxVertexOutputComponents: wq.MAX_VERTEX_OUTPUT_COMPONENTS, maxVertexUniformBlocks: wq.MAX_VERTEX_UNIFORM_BLOCKS, maxVertexUniformComponents: wq.MAX_VERTEX_UNIFORM_COMPONENTS, minProgramTexelOffset: wq.MIN_PROGRAM_TEXEL_OFFSET };
                return { "for": function(r) { var A = r._info; return A || (r._info = A = Q(r, A)), A } }
            }(),
            $d = function() {
                function M(E, u, s) {
                    return {
                        def: E,
                        getter: s ? function(G) { var K = ri.for(G); return K.version > 1 ? G.getParameter(u) : E } : function(K) { return K.getParameter(u) },
                        setter: s ? function(b, D) {
                            var e = ri.for(b);
                            e.version > 1 && b.pixelStorei(u, D)
                        } : function(_, I) { _.pixelStorei(u, I) }
                    }
                }

                function t(w) { return "string" == typeof w ? Lf(w) : w.r !== O ? (H[0] = w.r, H[1] = w.g, H[2] = w.b, H[3] = w.a, H) : w.red !== O ? (H[0] = w.red, H[1] = w.green, H[2] = w.blue, H[3] = w.alpha, H) : w }

                function v(Z) { return G(Z) ? Array.prototype.slice.call(Z, 0) : Z }

                function i(s, d, q) {
                    this.gl = d, this._record = q || {}, this._branches = {}, this._leafSync = {}, this._struct = s;
                    for (var H = s.children, J = H.length; J--;) {
                        var _ = H[J],
                            e = _.name;
                        _.isLeaf ? (this._leafSync[e] = !1, this._record[e] = v(_.desc.def)) : this._record[e] = {}
                    }
                }

                function o(x) {
                    function r(X, y) {
                        i.call(this, x, X, y);
                        for (var p = u.length; p--;) {
                            var V = u[p];
                            this._branches[V._name] = new V._type(X, this._record[V._name])
                        }
                    }

                    function Q(k, S) {
                        function K(E, e) { for (var V = Y, Z = !1; V--;) E[V] !== e[V] && (E[V] = e[V], Z = !0); return Z }
                        var r = k.name,
                            i = G(k.desc.def),
                            Y = i && k.desc.def.length;
                        if (k.isLeaf) {
                            var b = k.desc.setter,
                                p = k.desc.parse;
                            n.defineProperty(S, r, { configurable: !1, enumerable: !0, get: function() { return this._record[r] }, set: i ? function(i) { p && (i = p(i)), (K(this._record[r], i) || !this._leafSync[r]) && (b(this.gl, this._record[r]), this._leafSync[r] = !0) } : function(c) { this._record[r] === c && this._leafSync[r] || (b(this.gl, c), this._record[r] = c, this._leafSync[r] = !0) } })
                        } else u.push({ _name: r, _type: o(k) }), n.defineProperty(S, r, { configurable: !1, enumerable: !0, get: function() { return this._branches[r] }, set: function(h) { this._branches[r].apply(h) } })
                    }
                    var u = [];
                    return _(r, i), x.forEach(Q, r.prototype), r
                }
                var H = "undefined" != typeof Float32Array && new Float32Array(4),
                    p = {
                        viewport: {
                            def: [0, 0, 0 / 0, 0 / 0],
                            getter: function(L) { return L.getParameter(L.VIEWPORT) },
                            setter: function(D, O) {
                                var x = O[2] !== O[2] ? D.drawingBufferWidth - O[0] : O[2],
                                    z = O[3] !== O[3] ? D.drawingBufferHeight - O[1] : O[3];
                                D.viewport(O[0], O[1], x, z)
                            }
                        },
                        dither: { def: !1, getter: function(c) { return c.isEnabled(c.DITHER) }, setter: function(p, L) { L ? p.enable(p.DITHER) : p.disable(p.DITHER) } },
                        rasterizerDiscard: {
                            def: !1,
                            getter: function(Z) { var F = ri.for(Z); return F.version > 1 && Z.isEnabled(Z.RASTERIZER_DISCARD) },
                            setter: function(D, i) {
                                var n = ri.for(D);
                                1 !== n.version && (i ? D.enable(D.RASTERIZER_DISCARD) : D.disable(D.RASTERIZER_DISCARD))
                            }
                        },
                        lineWidth: { def: 1, getter: function(z) { return z.lineWidth ? z.getParameter(z.LINE_WIDTH) : 1 }, setter: function(O, F) { O.lineWidth && O.lineWidth(F) } },
                        color: { clear: { def: [0, 0, 0, 0], getter: function(w) { return w.getParameter(w.COLOR_CLEAR_VALUE) }, setter: function(u, F) { u.clearColor(F[0], F[1], F[2], F[3]) }, parse: t }, mask: { def: [!0, !0, !0, !0], getter: function(_) { return _.getParameter(_.COLOR_WRITEMASK) }, setter: function(Q, u) { Q.colorMask(u[0], u[1], u[2], u[3]) } } },
                        blend: { enabled: { def: !1, getter: function(N) { return N.isEnabled(N.BLEND) }, setter: function(W, Q) { Q ? W.enable(W.BLEND) : W.disable(W.BLEND) } }, color: { def: [0, 0, 0, 0], getter: function(J) { return J.getParameter(J.BLEND_COLOR) }, setter: function(T, x) { T.blendColor(x[0], x[1], x[2], x[3]) }, parse: t }, equation: { def: [wq.FUNC_ADD, wq.FUNC_ADD], getter: function(A) { return [A.getParameter(A.BLEND_EQUATION_RGB), A.getParameter(A.BLEND_EQUATION_ALPHA)] }, setter: function(P, X) { P.blendEquationSeparate(X[0], X[1]) }, parse: function(u) { var i = u.length; return i > 1 ? u : 1 === i ? (H[1] = H[0] = u[0], H) : (H[1] = H[0] = u, H) } }, func: { def: [wq.ONE, wq.ZERO, wq.ONE, wq.ZERO], getter: function(r) { return [r.getParameter(r.BLEND_SRC_RGB), r.getParameter(r.BLEND_DST_RGB), r.getParameter(r.BLEND_SRC_ALPHA), r.getParameter(r.BLEND_DST_ALPHA)] }, setter: function(Y, B) { Y.blendFuncSeparate(B[0], B[1], B[2], B[3]) }, parse: function(u) { var T = u.length; return T > 3 ? u : (H[2] = H[0] = u[0], H[3] = H[1] = u[1], H) } } },
                        cullFace: { enabled: { def: !1, getter: function(t) { return t.isEnabled(t.CULL_FACE) }, setter: function(n, $) { $ ? n.enable(n.CULL_FACE) : n.disable(n.CULL_FACE) } }, mode: { def: wq.BACK, getter: function(l) { return l.getParameter(l.CULL_FACE_MODE) }, setter: function(Y, f) { Y.cullFace(f) } }, frontFace: { def: wq.CCW, getter: function(T) { return T.getParameter(T.FRONT_FACE) }, setter: function(c, L) { c.frontFace(L) } } },
                        scissor: {
                            enabled: { def: !1, getter: function(I) { return I.isEnabled(I.SCISSOR_TEST) }, setter: function(z, A) { A ? z.enable(z.SCISSOR_TEST) : z.disable(z.SCISSOR_TEST) } },
                            box: {
                                def: [0, 0, 0 / 0, 0 / 0],
                                getter: function(K) { return K.getParameter(K.SCISSOR_BOX) },
                                setter: function(S, F) {
                                    var d = F[2] !== F[2] ? S.drawingBufferWidth - F[0] : F[2],
                                        E = F[3] !== F[3] ? S.drawingBufferHeight - F[1] : F[3];
                                    S.scissor(F[0], F[1], d, E)
                                }
                            }
                        },
                        depth: { enabled: { def: !1, getter: function(U) { return U.isEnabled(U.DEPTH_TEST) }, setter: function(e, Q) { Q ? e.enable(e.DEPTH_TEST) : e.disable(e.DEPTH_TEST) } }, clear: { def: 1, getter: function(M) { return M.getParameter(M.DEPTH_CLEAR_VALUE) }, setter: function(k, m) { k.clearDepth(m) } }, mask: { def: !0, getter: function(o) { return o.getParameter(o.DEPTH_WRITEMASK) }, setter: function(h, k) { h.depthMask(k) } }, range: { def: [-1, 1], getter: function(s) { return s.getParameter(s.DEPTH_RANGE) }, setter: function(m, S) { m.depthRange(S[0], S[1]) } }, func: { def: wq.LESS, getter: function(X) { return X.getParameter(X.DEPTH_FUNC) }, setter: function(h, G) { h.depthFunc(G) } } },
                        stencil: { enabled: { def: !1, getter: function(s) { return s.isEnabled(s.STENCIL_TEST) }, setter: function(E, B) { B ? E.enable(E.STENCIL_TEST) : E.disable(E.STENCIL_TEST) } }, clear: { def: 0, getter: function(q) { return q.getParameter(q.STENCIL_CLEAR_VALUE) }, setter: function(o, w) { o.clearStencil(w) } }, frontMask: { def: 255, getter: function(A) { return A.getParameter(A.STENCIL_WRITEMASK) }, setter: function(T, K) { T.stencilMaskSeparate(T.FRONT, K) } }, frontOp: { def: [wq.KEEP, wq.KEEP, wq.KEEP], getter: function(b) { return [b.getParameter(b.STENCIL_FAIL), b.getParameter(b.STENCIL_PASS_DEPTH_FAIL), b.getParameter(b.STENCIL_PASS_DEPTH_PASS)] }, setter: function(C, A) { C.stencilOpSeparate(C.FRONT, A[0], A[1], A[2]) } }, frontFunc: { def: [wq.ALWAYS, 0, 255], getter: function(n) { return [n.getParameter(n.STENCIL_FUNC), n.getParameter(n.STENCIL_REF), n.getParameter(n.STENCIL_VALUE_MASK)] }, setter: function(S, o) { S.stencilFuncSeparate(S.FRONT, o[0], o[1], o[2]) } }, backMask: { def: 255, getter: function(R) { return R.getParameter(R.STENCIL_BACK_WRITEMASK) }, setter: function(z, y) { z.stencilMaskSeparate(z.BACK, y) } }, backOp: { def: [wq.KEEP, wq.KEEP, wq.KEEP], getter: function(Q) { return [Q.getParameter(Q.STENCIL_BACK_FAIL), Q.getParameter(Q.STENCIL_BACK_PASS_DEPTH_FAIL), Q.getParameter(Q.STENCIL_BACK_PASS_DEPTH_PASS)] }, setter: function(G, e) { G.stencilOpSeparate(G.BACK, e[0], e[1], e[2]) } }, backFunc: { def: [wq.ALWAYS, 0, 255], getter: function(f) { return [f.getParameter(f.STENCIL_BACK_FUNC), f.getParameter(f.STENCIL_BACK_REF), f.getParameter(f.STENCIL_BACK_VALUE_MASK)] }, setter: function(u, i) { u.stencilFuncSeparate(u.BACK, i[0], i[1], i[2]) } } },
                        hint: { generateMipmap: { def: wq.DONT_CARE, getter: function(E) { return E.getParameter(E.GENERATE_MIPMAP_HINT) }, setter: function(z, y) { z.hint(z.GENERATE_MIPMAP_HINT, y) } }, fragmentShaderDerivative: { def: wq.DONT_CARE, getter: function($) { var Z = ri.for($); return 1 !== Z.version || Z.extensions.OES_standard_derivatives ? $.getParameter(wq.FRAGMENT_SHADER_DERIVATIVE_HINT) : wq.DONT_CARE }, setter: function(m, _) { var v = ri.for(m); return v.version > 1 || v.extensions.OES_standard_derivatives ? (m.hint(wq.FRAGMENT_SHADER_DERIVATIVE_HINT, _), void 0) : void 0 } } },
                        pixelStore: { packAlignment: M(4, wq.PACK_ALIGNMENT, !1), unpackAlignment: M(4, wq.UNPACK_ALIGNMENT, !1), unpackFlipY: M(!1, wq.UNPACK_FLIP_Y_WEBGL, !1), unpackPremultiplyAlpha: M(!1, wq.UNPACK_PREMULTIPLY_ALPHA_WEBGL, !1), unpackColorspaceConversion: M(wq.BROWSER_DEFAULT_WEBGL, wq.UNPACK_COLORSPACE_CONVERSION_WEBGL, !1), packRowLength: M(0, wq.PACK_ROW_LENGTH, !0), packSkipPixels: M(0, wq.PACK_SKIP_PIXELS, !0), packSkipRows: M(0, wq.PACK_SKIP_ROWS, !0), unpackRowLength: M(0, wq.UNPACK_ROW_LENGTH, !0), unpackImageHeight: M(0, wq.UNPACK_IMAGE_HEIGHT, !0), unpackSkipPixels: M(0, wq.UNPACK_SKIP_PIXELS, !0), unpackSkipRows: M(0, wq.UNPACK_SKIP_ROWS, !0), unpackSkipImages: M(0, wq.UNPACK_SKIP_IMAGES, !0) },
                        polygonOffset: { enabled: { def: !1, getter: function(Y) { return Y.isEnabled(Y.POLYGON_OFFSET_FILL) }, setter: function(X, R) { R ? X.enable(X.POLYGON_OFFSET_FILL) : X.disable(X.POLYGON_OFFSET_FILL) } }, value: { def: [0, 0], getter: function(u) { return [u.getParameter(u.POLYGON_OFFSET_FACTOR), u.getParameter(u.POLYGON_OFFSET_UNITS)] }, setter: function(G, M) { G.polygonOffset(M[0], M[1]) } } },
                        sampleCoverage: { enabled: { def: !1, getter: function(D) { return D.isEnabled(D.SAMPLE_COVERAGE) }, setter: function(F, p) { p ? F.enable(F.SAMPLE_COVERAGE) : F.disable(F.SAMPLE_COVERAGE) } }, alpha: { def: !1, getter: function(C) { return C.isEnabled(C.SAMPLE_ALPHA_TO_COVERAGE) }, setter: function(z, Y) { Y ? z.enable(z.SAMPLE_ALPHA_TO_COVERAGE) : z.disable(z.SAMPLE_ALPHA_TO_COVERAGE) } }, value: { def: [1, !1], getter: function(n) { return [n.getParameter(n.SAMPLE_COVERAGE_VALUE), n.getParameter(n.SAMPLE_COVERAGE_INVERT)] }, setter: function(G, e) { G.sampleCoverage(e[0], e[1]) } } }
                    },
                    J = jq.create(p, function(S) { return "def" in S });
                i.prototype.reset = function() {
                    for (var P = this._struct.children, R = P.length; R--;) {
                        var g = P[R],
                            D = g.name;
                        g.isLeaf ? this[D] = g.desc.def : this._branches[D].reset()
                    }
                }, i.prototype.save = function(M) {
                    M == O && (M = {});
                    for (var a = this._struct.children, x = a.length; x--;) {
                        var $ = a[x],
                            W = $.name;
                        if ($.isLeaf) M[W] = v(this._record[W]);
                        else {
                            var T = M[W];
                            T == O && (M[W] = T = {}), this._branches[W].save(T)
                        }
                    }
                    return M
                }, i.prototype.sync = function(u, p) {
                    for (var $ = this._struct.children, K = $.length; K--;) {
                        var y = $[K],
                            E = y.name;
                        y.isLeaf ? (p || !this._leafSync[E]) && (u ? (this._record[E] = y.desc.getter(this.gl), this._leafSync[E] = !0) : (y.desc.setter(this.gl, this._record[E]), this._leafSync[E] = !0)) : this._branches[E].sync(u, p)
                    }
                }, i.prototype.syncLoss = function() {
                    for (var x = this._struct.children, D = x.length; D--;) {
                        var k = x[D];
                        k.isLeaf ? this._leafSync[k.name] = !1 : this._branches[k.name].syncLoss()
                    }
                }, i.prototype.apply = function(g) {
                    for (var S = this._struct.children, q = S.length; q--;) {
                        var $ = S[q],
                            m = $.name;
                        m in g && ($.isLeaf ? this[m] = g[m] : this._branches[m].apply(g[m]))
                    }
                }, i.prototype.append = function(X) {
                    var r = this._struct.childMap;
                    for (var J in X) {
                        var f = r[J];
                        f && (f.isLeaf ? this[J] = X[J] : this._branches[J].append(X[J]))
                    }
                };
                var F = o(J);
                return function(p) { var w = p._state; return w || (p._state = w = new F(p)), w }
            }(),
            Fr = function() {
                function y(n, u, U, B) {
                    if (n) {
                        var z = n.length;
                        if (z != O)
                            for (var Z = 0; B > Z; ++Z) u[U + Z] = n[Z];
                        else n.toArray && n.toArray(u, U)
                    } else
                        for (var Z = 0; B > Z; ++Z) u[U + Z] = 0
                }

                function f(_, r, f) {
                    var g = _[0];
                    if (0 >= g || g > 0) return _;
                    var A = r * f,
                        G = Q[A];
                    if (G == O && (Q[A] = new Float32Array(A)), 0 !== r) { y(g, G, 0, f); for (var V = 1, P = 0; V !== r; ++V) P += f, y(_[V], G, P, f) }
                    return G
                }

                function z(O, q) { O.uniform1f(this.addr, q) }

                function E(K, p) {
                    K.uniform1fv(this.addr, p)
                }

                function F(M, V) {
                    if (V.x != O) M.uniform2f(this.addr, V.x, V.y);
                    else {
                        var L = Q[2];
                        L.set(V, 0), M.uniform2fv(this.addr, L)
                    }
                }

                function l(W, i) { W.uniform2fv(this.addr, f(i, this.size, 2)) }

                function X(U, Y) {
                    if (Y.x != O) U.uniform3f(this.addr, Y.x, Y.y, Y.z);
                    else if (Y.r != O) U.uniform3f(this.addr, Y.r, Y.g, Y.b);
                    else if (Y.red != O) U.uniform3f(this.addr, Y.red, Y.green, Y.blue);
                    else {
                        var R = Q[3];
                        R.set(Y, 0), U.uniform3fv(this.addr, R)
                    }
                }

                function w(O, G) { O.uniform3fv(this.addr, f(G, this.size, 3)) }

                function u(A, N) {
                    if ("string" == typeof N && (N = Lf(N)), N.x != O) A.uniform4f(this.addr, N.x, N.y, N.z, N.w);
                    else if (N.r != O) A.uniform4f(this.addr, N.r, N.g, N.b, N.a);
                    else if (N.red != O) A.uniform4f(this.addr, N.red, N.green, N.blue, N.alpha);
                    else {
                        var y = Q[4];
                        y.set(N, 0), A.uniform4fv(this.addr, y)
                    }
                }

                function T(c, n) { c.uniform4fv(this.addr, f(n, this.size, 4)) }

                function p(k, V) { k.uniform1i(this.addr, V) }

                function R(m, b) { m.uniform1iv(this.addr, b) }

                function C(p, E) { p.uniform2iv(this.addr, E) }

                function e(B, H) { B.uniform3iv(this.addr, H) }

                function b(s, d) { s.uniform4iv(this.addr, d) }

                function o(h, P) { h.uniform1i(this.addr, r[P ? 1 : 0]) }

                function W(K, p) {
                    var l = Q[4];
                    l.set(p, 0), K.uniformMatrix2fv(this.addr, !1, l)
                }

                function A(D, L) { D.uniformMatrix2fv(this.addr, !1, f(L, this.size, 4)) }

                function S(W, n) {
                    var o = Q[9];
                    o.set(n, 0), W.uniformMatrix3fv(this.addr, !1, o)
                }

                function c(O, o) { O.uniformMatrix3fv(this.addr, !1, f(o, this.size, 9)) }

                function Z(A, c) {
                    var s = Q[16];
                    s.set(c, 0), A.uniformMatrix4fv(this.addr, !1, s)
                }

                function t(W, D) { W.uniformMatrix4fv(this.addr, !1, f(D, this.size, 16)) }

                function v(l, s) { l.uniform1i(this.addr, this.slots[0]), l.activeTexture(l.TEXTURE0 + this.slots[0]), l.bindTexture(l.TEXTURE_2D, s || l._emptyTexture) }

                function m(Q, H) { Q.uniform1iv(this.addr, this.slots); for (var S = this.slots.length; S--;) Q.activeTexture(Q.TEXTURE0 + this.slots[S]), Q.bindTexture(Q.TEXTURE_2D, H[S] || Q._emptyTexture) }

                function N(k, a) { k.uniform1i(this.addr, this.slots[0]), k.activeTexture(k.TEXTURE0 + this.slots[0]), k.bindTexture(k.TEXTURE_CUBE_MAP, a || k._emptyCubeTexture) }

                function g(E, e) { E.uniform1iv(this.addr, this.slots); for (var y = this.slots.length; y--;) E.activeTexture(E.TEXTURE0 + this.slots[y]), E.bindTexture(E.TEXTURE_CUBE_MAP, e[y] || E._emptyCubeTexture) }

                function M(e, s, x) { j[e] = [s, x] }

                function G(e, l, Y) {
                    switch (e.type) {
                        case 35678:
                        case 35680:
                            if ("uSampler" === Y) return [0];
                            if ("uBlendSampler" === Y) return [1];
                            for (var d = e.size, W = new Int32Array(d), K = 0; d > K; ++K) W[K] = l.usedTextureSlot++;
                            return W
                    }
                    return O
                }

                function J(p, Z, n, P, v) { this.name = p, this.addr = Z, this.size = P ? n.size : 0, this.activeInfo = n, this.setter = j[n.type][P ? 1 : 0], this.slots = G(n, v, p), of(this) }

                function L(k, _, F, Y) {
                    var n = k.name,
                        e = n.length;
                    for (H.lastIndex = 0;;) {
                        var P = H.exec(n),
                            L = H.lastIndex,
                            o = P[1],
                            w = "]" === P[2],
                            t = P[3];
                        if (w && (o = 0 | o), t === O || "[" === t && L + 2 === e) { F[o] = new J(o, _, k, t !== O, Y); break }
                        var l = F[o];
                        l == O && (F[o] = l = {}), F = l
                    }
                }

                function K(H, G, w) { this.gl = G, this._program = w, this._leaves = {}, this._branches = {}, this._struct = H }

                function P(C) {
                    function i(m, E) {
                        K.call(this, C, m, E);
                        for (var U = O.length; U--;) {
                            var T = O[U];
                            this._branches[T._name] = new T._type(m, E)
                        }
                    }

                    function l(J, K) {
                        var p = J.name;
                        if (J.isLeaf) {
                            var t = a("d.setter(this.gl, v);", ["v"], ["d"], [J.desc]);
                            n.defineProperty(K, p, { configurable: !1, enumerable: !0, get: function() { return t }, set: t })
                        } else O.push({ _name: p, _type: P(J) }), n.defineProperty(K, p, { configurable: !1, enumerable: !0, get: function() { return this._branches[p] }, set: function(Q) { this._branches[p].apply(Q) } })
                    }
                    var O = [];
                    return _(i, K), C.forEach(l, i.prototype), i
                }

                function k(C, F) {
                    for (var E = C.getProgramParameter(F, C.ACTIVE_UNIFORMS), W = {}, o = { usedTextureSlot: 2 }; E--;) {
                        var q = C.getActiveUniform(F, E),
                            m = q.name,
                            K = C.getUniformLocation(F, m);
                        L(q, K, W, o)
                    }
                    var N = jq.create(W, function(K) { return "addr" in K }),
                        f = P(N);
                    return n.defineProperty(f.prototype, "textureCount", { configurable: !1, enumerable: !1, writable: !1, value: o.usedTextureSlot }), new f(C, F)
                }
                var Q = [];
                if ("function" == typeof Float32Array)
                    for (var V = 1; 17 > V; ++V) Q[V] = new Float32Array(V);
                var r = [0, 1],
                    j = [];
                M(wq.FLOAT, z, E), M(wq.FLOAT_VEC2, F, l), M(wq.FLOAT_VEC3, X, w), M(wq.FLOAT_VEC4, u, T), M(wq.INT, p, R), M(wq.INT_VEC2, C, C), M(wq.INT_VEC3, e, e), M(wq.INT_VEC4, b, b), M(wq.BOOL, o, R), M(wq.BOOL_VEC2, C, C), M(wq.BOOL_VEC3, e, e), M(wq.BOOL_VEC4, b, b), M(wq.FLOAT_MAT2, W, A), M(wq.FLOAT_MAT3, S, c), M(wq.FLOAT_MAT4, Z, t), M(wq.SAMPLER_2D, v, m), M(wq.SAMPLER_CUBE, N, g);
                var H = /([\w\d_]+)(\])?(\[|\.)?/g;
                return K.prototype.apply = function(W) {
                        for (var e = this._struct.children, X = e.length; X--;) {
                            var C = e[X],
                                Z = C.name;
                            Z in W && (C.isLeaf ? this[Z] = W[Z] : this._branches[Z].apply(W[Z]))
                        }
                    }, K.prototype.append = function(C) {
                        var M = this._struct.childMap;
                        for (var h in C) {
                            var G = M[h];
                            G && (G.isLeaf ? this[h] = C[h] : this._branches[h].append(C[h]))
                        }
                    },
                    function(h, T) { var H = T._uniforms; return H || (T._uniforms = H = k(h, T)), H }
            }(),
            Wh = function() {
                function N(T, H, W) { H.vertexAttrib1f(T.addr, W) }

                function B(d, g, r) {
                    if (r.x != O) g.vertexAttrib2f(d.addr, r.x, r.y);
                    else {
                        var X = z[2];
                        X.set(r, 0), g.vertexAttrib2fv(d.addr, X)
                    }
                }

                function M(r, v, G) {
                    if (G.x != O) v.vertexAttrib3f(r.addr, G.x, G.y, G.z);
                    else if (G.r != O) v.vertexAttrib3f(r.addr, G.r, G.g, G.b);
                    else if (G.red != O) v.vertexAttrib3f(r.addr, G.red, G.green, G.blue);
                    else {
                        var s = z[3];
                        s.set(G, 0), v.vertexAttrib3fv(r.addr, s)
                    }
                }

                function V(Q, l, B) {
                    if ("string" == typeof B && (B = Lf(B)), B.x != O) l.vertexAttrib4f(Q.addr, B.x, B.y, B.z, B.w);
                    else if (B.r != O) l.vertexAttrib4f(Q.addr, B.r, B.g, B.b, B.a);
                    else if (B.red != O) l.vertexAttrib4f(Q.addr, B.red, B.green, B.blue, B.alpha);
                    else {
                        var C = z[4];
                        C.set(B, 0), l.vertexAttrib4fv(Q.addr, C)
                    }
                }

                function m(F, u, l) { l = l.el || l; for (var O = 0, X = 0; 2 > O; ++O) u.vertexAttrib2f(F.addr, l[X++], l[X++]) }

                function Y(m, D, i) { i = i.el || i; for (var g = 0, U = 0; 3 > g; ++g) D.vertexAttrib3f(m.addr, i[U++], i[U++], i[U++]) }

                function p(k, W, o) { o = o.el || o; for (var g = 0, m = 0; 4 > g; ++g) W.vertexAttrib4f(k.addr, o[m++], o[m++], o[m++], o[m++]) }

                function X(M, F, x, p, w, W, d) { F.bindBuffer(F.ARRAY_BUFFER, x), F.vertexAttribPointer(M.addr, 1, p || F.FLOAT, !!w, W || 0, d || 0), F.bindBuffer(F.ARRAY_BUFFER, null) }

                function u(J, s, W, j, m, I, B) { s.bindBuffer(s.ARRAY_BUFFER, W), s.vertexAttribPointer(J.addr, 2, j || s.FLOAT, !!m, I || 0, B || 0), s.bindBuffer(s.ARRAY_BUFFER, null) }

                function J(A, d, N, O, y, V, h) { d.bindBuffer(d.ARRAY_BUFFER, N), d.vertexAttribPointer(A.addr, 3, O || d.FLOAT, !!y, V || 0, h || 0), d.bindBuffer(d.ARRAY_BUFFER, null) }

                function o(X, g, l, Y, o, d, B) { g.bindBuffer(g.ARRAY_BUFFER, l), g.vertexAttribPointer(X.addr, 4, Y || g.FLOAT, !!o, d || 0, B || 0), g.bindBuffer(g.ARRAY_BUFFER, null) }

                function b(b, e, k, z, T, i, _) {
                    var i = i || 4,
                        _ = _ || 0;
                    e.bindBuffer(e.ARRAY_BUFFER, k), e.vertexAttribPointer(b.addr, 2, z || e.FLOAT, !!T, i, _), e.vertexAttribPointer(b.addr + 1, 2, z || e.FLOAT, !!T, i, _ + 2), e.bindBuffer(e.ARRAY_BUFFER, null)
                }

                function G(j, W, g, X, B, U, J) {
                    var U = U || 9,
                        J = J || 0;
                    W.bindBuffer(W.ARRAY_BUFFER, g), W.vertexAttribPointer(j.addr, 3, X || W.FLOAT, !!B, U, J), W.vertexAttribPointer(j.addr + 1, 3, X || W.FLOAT, !!B, U, J + 3), W.vertexAttribPointer(j.addr + 2, 3, X || W.FLOAT, !!B, U, J + 6), W.bindBuffer(W.ARRAY_BUFFER, null)
                }

                function q(k, x, J, U, W, w, c) {
                    var w = w || 16,
                        c = c || 0;
                    x.bindBuffer(x.ARRAY_BUFFER, J), x.vertexAttribPointer(k.addr, 4, U || x.FLOAT, !!W, w, c), x.vertexAttribPointer(k.addr + 1, 4, U || x.FLOAT, !!W, w, c + 4), x.vertexAttribPointer(k.addr + 2, 4, U || x.FLOAT, !!W, w, c + 8), x.vertexAttribPointer(k.addr + 3, 4, U || x.FLOAT, !!W, w, c + 12), x.bindBuffer(x.ARRAY_BUFFER, null)
                }

                function $(t, U, A) { H[t] = function(w, V, p, l, X, R) { this.addr == O || this.addr < 0 || (V == O || V === !1 ? w.disableVertexAttribArray(this.addr) : Od(V) === L ? (w.enableVertexAttribArray(this.addr), A(this, w, V, p, l, X, R)) : (w.disableVertexAttribArray(this.addr), U(this, w, V))) } }

                function R(Z, Y, n) { this.name = Z, this.addr = Y, this.activeInfo = n, this.setter = H[n.type], of(this) }

                function t(f, r, K) { this.gl = r, this.program = K, this._branches = {}, this._struct = f }

                function x(z) {
                    function H(s, Q) {
                        t.call(this, z, s, Q);
                        for (var h = e.length; h--;) {
                            var J = e[h];
                            this._branches[J._name] = new J._type(s, Q)
                        }
                    }

                    function j(C, V) {
                        var j = C.name;
                        if (C.isLeaf) {
                            var R = a("d.setter(this.gl, v);", ["v"], ["d"], [C.desc]);
                            n.defineProperty(V, j, { configurable: !1, enumerable: !0, get: function() { return R }, set: R })
                        } else e.push({ _name: j, _type: x(C) }), n.defineProperty(V, j, { configurable: !1, enumerable: !0, get: function() { return this._branches[j] }, set: function(W) { this._branches[j].apply(W) } })
                    }
                    var e = [];
                    return _(H, t), z.forEach(j, H.prototype), H
                }

                function Q(Y, u) {
                    for (var m = Y.getProgramParameter(u, Y.ACTIVE_ATTRIBUTES), N = {}; m--;) {
                        var P = Y.getActiveAttrib(u, m),
                            z = P.name,
                            l = Y.getAttribLocation(u, z);
                        N[z] = new R(z, l, P)
                    }
                    var $ = jq.create(N, function(s) { return "addr" in s }),
                        k = x($);
                    return new k(Y, u)
                }
                for (var z = [], S = 1; 17 > S; ++S) z[S] = new ss(S);
                var H = [],
                    L = "undefined" != typeof WebGLBuffer && WebGLBuffer.prototype;
                return $(wq.FLOAT, N, X), $(wq.FLOAT_VEC2, B, u), $(wq.FLOAT_VEC3, M, J), $(wq.FLOAT_VEC4, V, o), $(wq.FLOAT_MAT2, m, b), $(wq.FLOAT_MAT3, Y, G), $(wq.FLOAT_MAT4, p, q), t.prototype.disable = function() {
                        for (var n = this._struct.children, W = n.length; W--;) {
                            var y = n[W],
                                _ = y.name;
                            y.isLeaf ? this.gl.disableVertexAttribArray(y.desc.addr) : this._branches[_].disable()
                        }
                    }, t.prototype.apply = function(R) {
                        for (var T = this._struct.children, j = T.length; j--;) {
                            var A = T[j],
                                t = A.name;
                            t in R && (A.isLeaf ? this[t] = R[t] : this._branches[t].apply(R[t]))
                        }
                    }, t.prototype.append = function(R) {
                        var N = this._struct.childMap;
                        for (var I in R) {
                            var p = N[I];
                            p && (p.isLeaf ? this[I] = R[I] : this._branches[I].append(R[I]))
                        }
                    },
                    function(G, N) { var u = N._attribs; return u || (N._attribs = u = Q(G, N)), u }
            }(),
            Jg = function(t) {
                var A = this;
                n.defineProperties(this, { gl: { configurable: !1, enumerable: !1, value: t, writable: !1 }, glState: { configurable: !1, enumerable: !1, value: $d(t), writable: !1 } }), A._currProgram = O, A._currUniforms = O, A._currAttribs = O, A._sync = !0
            };
        n.defineProperties(Jg.prototype, {
            program: {
                configurable: !1,
                enumerable: !1,
                get: function() { return this._currProgram },
                set: function(m) {
                    var R = this;
                    R._sync && m === R._currProgram || (R.gl.useProgram(m), R._currProgram = m, R._currUniforms = Fr(R.gl, m), R._currAttribs = Wh(R.gl, m), R._sync = !0)
                }
            },
            uniforms: {
                configurable: !1,
                enumerable: !1,
                get: function() { var B = this; return B._currProgram && !B._sync && (B.gl.useProgram(B._currProgram), B._sync = !0), B._currUniforms },
                set: function(v) {
                    var U = this;
                    U._currUniforms && (U._currProgram && !U._sync && (U.gl.useProgram(U._currProgram), this._sync = !0), U._currUniforms.apply(v))
                }
            },
            attribs: {
                configurable: !1,
                enumerable: !1,
                get: function() { var q = this; return q._currProgram && !q._sync && (q.gl.useProgram(q._currProgram), q._sync = !0), q._currAttribs },
                set: function(V) {
                    var M = this;
                    M._currUniforms && (M._currProgram && !M._sync && (M.gl.useProgram(M._currProgram), this._sync = !0), M._currAttribs.apply(V))
                }
            }
        }), Jg.prototype.useProgram = function(P) {
            var g = this;
            g._sync && P === g._currProgram || (g.gl.useProgram(P), g._currProgram = P, g._currUniforms = Fr(g.gl, P), g._currAttribs = Wh(g.gl, P), g._sync = !0)
        }, Jg.prototype.directState = function() { return this.glState }, Jg.prototype.directUniforms = function() { return this._currUniforms }, Jg.prototype.directAttribs = function() { return this._currAttribs }, Jg.prototype.syncLoss = function() { this._sync = !1, this.glState.syncLoss() }, Jg.for = function(e) { var T = e._renderState; return T || (e._renderState = T = new Jg(e)), T };
        var qm = "directional",
            $p = "point",
            Oe = "spot",
            ue = "light.color",
            yn = {},
            Zo = [],
            Eh = 0,
            lo = function(p, e) { Ok(e) && go.test(e) ? Oi(p, e) : zg(e) && e.modelType ? Sq(p, e) : e === O ? delete dm[p] : dm[p] = e },
            pl = function(T) { return T },
            og = function(K) { K = D.convertShape3dModelName(K); var w; if (zg(K)) { if (K.modelType) { if (K.uuid) { if (w = dm[K.uuid]) return w } else K.uuid = k.Math.generateUUID(); return w === O && (Rh && Rh[K.uuid] || Sq(K.uuid, K)), O } return K } return w = dm[K], K && w === O && go.test(K) && (Rh && Rh[K] || Oi(K, K)), w },
            md = function(r, N) { r.frameStack ? r.frameStack.push(N) : r.frameStack = [N], r.bindFramebuffer(r.FRAMEBUFFER, N) },
            Fc = function(l) {
                var F = l.frameStack;
                if (F) {
                    if (F.pop(), F.length) return l.bindFramebuffer(l.FRAMEBUFFER, F[F.length - 1]), void 0;
                    l.frameStack = null
                }
                l.bindFramebuffer(l.FRAMEBUFFER, null)
            };
        gp(D, {
            graph3dViewAttributes: A,
            graph3dViewFirstPersonMode: !1,
            graph3dViewMouseRoamable: !0,
            graph3dViewMoveStep: 15,
            graph3dViewRotateStep: U / 60,
            graph3dViewSortable: !1,
            graph3dViewBlockSelectable: !0,
            graph3dViewEditHelperDisabled: !1,
            graph3dViewPannable: !0,
            graph3dViewRotatable: !0,
            graph3dViewWalkable: !0,
            graph3dViewResettable: !0,
            graph3dViewZoomable: !0,
            graph3dViewRectSelectable: !0,
            graph3dViewRectSelectBackground: Kg,
            graph3dViewGridVisible: !1,
            graph3dViewGridSize: 50,
            graph3dViewGridGap: 50,
            graph3dViewGridColor: [.4, .75, .85, 1],
            graph3dViewRotateMaxPhi: U,
            graph3dViewRotateMinPhi: 0,
            graph3dViewShadowQuality: "high",
            graph3dViewShadowIntensity: .3,
            graph3dViewShadowBias: -.005,
            graph3dViewShadowRadius: .1,
            graph3dViewShadowType: "hard",
            graph3dViewShadowDegreeX: 30,
            graph3dViewShadowDegreeZ: -10,
            graph3dViewOriginAxisVisible: !1,
            graph3dViewCenterAxisVisible: !1,
            graph3dViewAxisXColor: [1, 0, 0, 1],
            graph3dViewAxisYColor: [0, 1, 0, 1],
            graph3dViewAxisZColor: [0, 0, 1, 1],
            graph3dViewEditSizeColor: [1, 1, 0, 1],
            graph3dViewOrtho: !1,
            graph3dViewOrthoWidth: 2e3,
            graph3dViewFovy: U / 4,
            graph3dViewNear: 10,
            graph3dViewFar: 1e4,
            graph3dViewEye: [0, 300, 1e3],
            graph3dViewCenter: [0, 0, 0],
            graph3dViewUp: [0, 1, -1e-7],
            graph3dViewHeadlightRange: 0,
            graph3dViewHeadlightColor: [1, 1, 1, 1],
            graph3dViewHeadlightIntensity: 1,
            graph3dViewHeadlightDisabled: !1,
            graph3dViewHeadlightAmbientIntensity: .7,
            graph3dViewFogDisabled: !0,
            graph3dViewFogMode: "linear",
            graph3dViewFogDensity: 5e-4,
            graph3dViewFogColor: "white",
            graph3dViewFogNear: 1,
            graph3dViewFogFar: 2e3,
            graph3dViewPickerResolution: .5,
            graph3dViewDashDisabled: !0,
            graph3dViewBatchBlendDisabled: !0,
            graph3dViewBatchBrightnessDisabled: !0,
            graph3dViewBatchColorDisabled: !1,
            graph3dMaxVectorCacheTime: 50,
            graph3dEnvmapCapabilityRequire: 8,
            setShape3dModel: lo,
            getShape3dModel: og,
            convertShape3dModelName: pl,
            getShape3dModelMap: function() { return dm },
            getCachedShape3dModelMap: function() { return Gl },
            createMatrix: function(V, m) {
                ud(V) || (V = [V]);
                for (var z = V.length - 1; z >= 0; z--) {
                    var $ = V[z];
                    m = cq($.mat, $.s3, $.r3, $.rotationMode, $.t3, m)
                }
                return m
            },
            transformVec: function(x, I) { return yi(x, I) },
            glBindFrame: md,
            glUnbindFrame: Fc,
            createBoxModel: function() { return { vs: Nf, ns: er, uv: Lb, is: yk } },
            createRoundRectModel: function(o, D) { return We.roundRect(o, D) },
            createStarModel: function(E, n) { return We.star(E, n) },
            createRectModel: function(e, w) { return We.rect(e, w) },
            createTriangleModel: function(l, p) { return We.triangle(l, p) },
            createRightTriangleModel: function(C, z) { return We.rightTriangle(C, z) },
            createParallelogramModel: function(V, z) { return We.parallelogram(V, z) },
            createTrapezoidModel: function(p, D) { return We.trapezoid(p, D) },
            createSmoothSphereModel: function(g, I, k, s, A, V, M) { return Eb(new vg(g, I, k, s, A, V, M)) },
            createSphereModel: function(g, F, R, c, A, r, C) { return g ? Zd(g, F, R, c, A, r, C) : D.createSmoothSphereModel() },
            createSmoothConeModel: function(B, z, t, n, e) { return rd(B, z, t, n, e) },
            createConeModel: function(R, z, P, I, p, b, B, e) { return R ? xm(R, z, P, I, p, b, B, e) : rd(b) },
            createSmoothCylinderModel: function(D, c, g, j, t, C, T, E) { return Eb(new Uc(D, c, g, j, t, C, T, E)) },
            createCylinderModel: function(D, f, K, I, q, y, R, N) { return D ? kj(D, f, K, I, q, y, R, N) : $r(y, R) },
            createSmoothTorusModel: function(U, d, r, F, O, $) { return Eb(new np(U, d, r, F, O, $)) },
            createTorusModel: function(K, D, d, e, b, S, t, p) { return K ? gs(K, D, d, e, b, S, t, p) : qq(S, t) },
            createExtrusionModel: function(X, Z, t, P, O, h, D, g) { return om(X, Z, t, P, O, h, D, g) },
            createSmoothRingModel: function(E, U, v, m, k, o) {
                for (var N = [], $ = 0; $ < E.length - 1; $ += 2) N.push({ x: E[$], y: E[$ + 1] });
                for (E = vc(N, U, v)[0], N = [], $ = 0; $ < E.length; $++) {
                    var f = E[$];
                    N.push(new Pp(f.x, 0, f.y))
                }
                return Eb(new vr(N, o, m, k))
            },
            createTextGeometry: function(j, C) { return Eb(new Xl(j, C)) },
            loadFontFace: function(s, l) {
                D.xhrLoad(s, function(O) {
                    if (!O) return l();
                    var R;
                    try { R = JSON.parse(O) } catch (u) { R = JSON.parse(O.substring(65, O.length - 2)) }
                    Qk.loadFace(R), l && l(R.familyName.toLowerCase())
                }, l ? null : { sync: !0 })
            },
            getShaderErrorLog: function() { return Zo.join("\n") },
            createRingModel: function(a, u, F, n, X, g, t, z, j, Z) {
                for (var P = [], R = 0; R < a.length - 1; R += 2) P.push({ x: a[R], y: a[R + 1] });
                g = g || D.shapeSide, t = t || 0, z = z || g;
                var o, s, L, T, l, I, h, y, V, k, R, Y, G, K, S, $, c, H, x = [],
                    p = [],
                    m = j ? [] : A,
                    e = j ? [] : A,
                    f = Z ? [] : A,
                    w = Z ? [] : A,
                    O = n ? [] : A,
                    i = n ? [] : A,
                    U = X ? [] : A,
                    Q = X ? [] : A,
                    a = vc(P, u, F),
                    r = Oj(a),
                    _ = 0,
                    W = 2 * Math.PI / g;
                return a.forEach(function(B) {
                    if (L = B.length, L > 1) {
                        if (T = B[0], n)
                            for (I = T.x, y = T.y, R = t; z > R; R++) Y = R + 1, G = R * W, K = Y * W, S = C(G), $ = N(G), c = C(K), H = N(K), O.push(S * I, y, -$ * I, c * I, y, -H * I, 0, y, 0), i.push(.5 - .5 * S, .5 - .5 * $, .5 - .5 * c, .5 - .5 * H, .5, .5);
                        for (k = 0; L > k; k++) {
                            for (l = B[k], I = T.x, h = l.x, y = T.y, V = l.y, o = _ / r, _ += _q(T, l), s = _ / r, R = t; z > R; R++) Y = R + 1, G = R * W, K = Y * W, S = C(G), $ = N(G), c = C(K), H = N(K), x.push(S * h, V, -$ * h, c * h, V, -H * h, S * I, y, -$ * I, c * h, V, -H * h, c * I, y, -H * I, S * I, y, -$ * I), p.push(R / g, s, Y / g, s, R / g, o, Y / g, s, Y / g, o, R / g, o), j && R === t && (m.push(0, y, 0, 0, V, 0, S * h, V, -$ * h, S * h, V, -$ * h, S * I, y, -$ * I, 0, y, 0), e.push(0, .5 - y, 0, .5 - V, 2 * h, .5 - V, 2 * h, .5 - V, 2 * I, .5 - y, 0, .5 - y)), Z && Y === z && (f.push(0, y, 0, c * h, V, -H * h, 0, V, 0, c * h, V, -H * h, 0, y, 0, c * I, y, -H * I), w.push(1, .5 - y, 1 - 2 * h, .5 - V, 1, .5 - V, 1 - 2 * h, .5 - V, 1, .5 - y, 1 - 2 * I, .5 - y));
                            T = l
                        }
                        if (X)
                            for (I = T.x, y = T.y, R = t; z > R; R++) Y = R + 1, G = R * W, K = Y * W, S = C(G), $ = N(G), c = C(K), H = N(K), U.push(c * I, y, -H * I, S * I, y, -$ * I, 0, y, 0), Q.push(.5 - .5 * c, .5 + .5 * H, .5 - .5 * S, .5 + .5 * $, .5, .5)
                    }
                }), { vs: x, uv: p, bottom_vs: U, bottom_uv: Q, top_vs: O, top_uv: i, from_vs: m, from_uv: e, to_vs: f, to_uv: w }
            }
        }, !0), gp(h, { "3d.move.mode": O, "3d.selectable": !0, "3d.visible": !0, "3d.movable": !0, "3d.editable": !0, "3d.clip.direction": null, "3d.clip.percentage": 1, "3d.reflectable": !0, "shape.border.gradient.color": O, "edge.gradient.color": O, "edge.source.t3": O, "edge.target.t3": O, "light.type": $p, "light.center": [0, 0, 0], "light.color": [1, 1, 1, 1], "light.disabled": !1, "light.angle": U / 4, "light.range": 0, "light.exponent": 1, "light.intensity": 1, "wf.visible": !1, "wf.width": 1, "wf.color": sn, "wf.short": !1, "wf.mat": O, "wf.geometry": !1, "wf.loadQuadWireframe": !1, "wf.combineTriangle": !0, batch: O, "transparent.mask": !1, brightness: O, "select.brightness": .7, "repeat.uv.length": O, "shadow.cast": !0, "shadow.receive": !0, bloom: !1, envmap: 0, renderTextureSamples: 4, alphaTest: .4, autorotate: !1, fixSizeOnScreen: !1, "texture.cache": !1, "hide.overlapping.group": O, "vector.dynamic": !1, "vector.dynamic.maxsize": 2048, "texture.scale": 1, "geometry.cache": !1, "highlight.mode": !1, "highlight.visible": !0, "highlight.width": .8, "highlight.color": "rgba(190, 210, 250, 1)", "color.empty": [0, 0, 0, 0], "label.face": Pi, "label.t3": O, "label.r3": O, "label.texture.scale": 2, "label.rotationMode": Vi, "label.light": !1, "label.blend": O, "label.reverse.flip": !1, "label.reverse.color": Vo, "label.reverse.cull": !1, "label.transparent": !1, "label.autorotate": !1, "label2.face": Pi, "label2.t3": O, "label2.r3": O, "label2.texture.scale": 2, "label2.rotationMode": Vi, "label2.light": !1, "label2.blend": O, "label2.reverse.flip": !1, "label2.reverse.color": Vo, "label2.reverse.cull": !1, "label2.transparent": !1, "label2.autorotate": !1, "note.face": Pi, "note.t3": O, "note.r3": O, "note.texture.scale": 2, "note.rotationMode": Vi, "note.light": !1, "note.blend": O, "note.reverse.flip": !1, "note.reverse.color": Vo, "note.reverse.cull": !1, "note.transparent": !1, "note.autorotate": !1, "note2.face": Pi, "note2.t3": O, "note2.r3": O, "note2.texture.scale": 2, "note2.rotationMode": Vi, "note2.light": !1, "note2.blend": O, "note2.reverse.flip": !1, "note2.reverse.color": Vo, "note2.reverse.cull": !1, "note2.transparent": !1, "note2.autorotate": !1, shape3d: O, "shape3d.color": le, "shape3d.top.color": O, "shape3d.bottom.color": O, "shape3d.from.color": O, "shape3d.to.color": O, "shape3d.image": O, "shape3d.top.image": O, "shape3d.bottom.image": O, "shape3d.from.image": O, "shape3d.to.image": O, "shape3d.light": !0, "shape3d.side": 0, "shape3d.side.from": O, "shape3d.side.to": O, "shape3d.smooth": O, "shape3d.visible": !0, "shape3d.from.visible": !0, "shape3d.to.visible": !0, "shape3d.top.visible": !0, "shape3d.bottom.visible": !0, "shape3d.torus.radius": .17, "shape3d.resolution": 0, "shape3d.blend": O, "shape3d.opacity": O, "shape3d.reverse.flip": !1, "shape3d.reverse.color": Vo, "shape3d.reverse.cull": !1, "shape3d.transparent": !1, "shape3d.uv.offset": O, "shape3d.uv.scale": O, "shape3d.uv.rotation": O, "shape3d.top.uv.offset": O, "shape3d.top.uv.scale": O, "shape3d.top.uv.rotation": O, "shape3d.bottom.uv.offset": O, "shape3d.bottom.uv.scale": O, "shape3d.bottom.uv.rotation": O, "shape3d.from.uv.offset": O, "shape3d.from.uv.scale": O, "shape3d.from.uv.rotation": O, "shape3d.to.uv.offset": O, "shape3d.to.uv.scale": O, "shape3d.to.uv.rotation": O, "shape3d.top.cap": O, "shape3d.bottom.cap": O, "shape3d.start.angle": 0, "shape3d.sweep.angle": m, "shape3d.point.epsilon": 1e-6, "shape3d.discard.selectable": !0, "shape3d.top.discard.selectable": !0, "shape3d.bottom.discard.selectable": !0, "shape3d.from.discard.selectable": !0, "shape3d.to.discard.selectable": !0, "shape3d.scaleable": !0, "shape3d.reflector": !1, "shape3d.reflector.color": "rgb(128,128,128)", "shape3d.reflector.blur": 0, "shape3d.reflector.blur.ratio": 1, "shape3d.reflector.background": null, "shape3d.reflector.clip": .003, "texture.mipmap.max": O, "texture.filter": O, "texture.filter.min": O, "texture.filter.mag": O, "texture.wrap": O, "points.image": O, "points.color": "white", "points.transparent": !1, "points.size": 20, "points.opacity": 1, "all.light": !0, "all.visible": !0, "all.color": le, "all.image": O, "all.blend": O, "all.opacity": O, "all.reverse.flip": !1, "all.reverse.color": Vo, "all.reverse.cull": !1, "all.transparent": !1, "all.uv": O, "all.uv.offset": O, "all.uv.scale": O, "all.uv.rotation": O, "all.discard.selectable": !0, mat: O, "left.mat": O, "right.mat": O, "top.mat": O, "bottom.mat": O, "front.mat": O, "back.mat": O, "edge.source.anchor.elevation": O, "edge.target.anchor.elevation": O }, !0);
        var bs, Ng = !1,
            Qg = [0, 0, 0, 0],
            yr = function(E) { return E instanceof pf },
            Hj = function(x) { return [x.x, x.e || 0, x.y] },
            tc = function(j, p, V) { for (var p = Lf(p || 0), E = p[0], v = p[1], Y = p[2]; V--;) j.push(E, v, Y) },
            or = function(L, C, F) { for (var C = Lf(C || 0), z = C[0], d = C[1], s = C[2], E = C[3]; F--;) L.push(z, d, s, E) },
            uk = function(m, b, O) {
                if (b)
                    for (var H, k, L, K = b[0], i = b[1], r = b[2], Y = b[4], V = b[5], s = b[6], u = b[8], Z = b[9], P = b[10], g = b[12], w = b[13], j = b[14], _ = O.length, W = 0, W = 0; _ > W; W += 3) H = O[W], k = O[W + 1], L = O[W + 2], m.push(K * H + Y * k + u * L + g, i * H + V * k + Z * L + w, r * H + s * k + P * L + j);
                else no(m, O)
            },
            hk = function(z, e) {
                var l = e.s("light.intensity"),
                    O = Lf(e.s(ue)),
                    v = O[0],
                    r = O[1],
                    c = O[2];
                1 !== l && (v *= l, r *= l, c *= l), z.push(v, r, c, e.s("light.disabled") ? 1 : 0)
            },
            Cs = function(n, S) {
                var z = Jg.for(S),
                    D = z.directUniforms();
                D.uHeadlightRange = n._headlightRange, D.uHeadlightAmbientIntensity = n._headlightAmbientIntensity;
                var Y = n._headlightIntensity,
                    c = Lf(n._headlightColor);
                1 !== Y && (c = [c[0] * Y, c[1] * Y, c[2] * Y]), D.uHeadlightColor = [c[0], c[1], c[2], n._headlightDisabled ? 1 : 0];
                var M = n._59O,
                    e = n._spots,
                    q = n._dirs;
                if (M.length) {
                    var p = [],
                        g = [],
                        k = [];
                    M.forEach(function(t) { hk(p, t), no(g, n._transformPointToViewSpace(t.p3())), k.push(t.s("light.range")) }), D.uPointColor = p, D.uPointRange = k, D.uPointPosition = g
                }
                if (e.length) {
                    var F = [],
                        W = [],
                        r = [],
                        N = [],
                        y = [],
                        x = [];
                    e.forEach(function(L) { hk(F, L), no(W, n._transformPointToViewSpace(L.p3())), no(y, n._transformDirectionToViewSpace(L.p3(), L.s("light.center"))), r.push(L.s("light.range")), N.push(C(L.s("light.angle") / 2)), x.push(L.s("light.exponent")) }), D.uSpotColor = F, D.uSpotRange = r, D.uSpotAngle = N, D.uSpotExponent = x, D.uSpotPosition = W, D.uSpotDirection = y
                }
                if (q.length) {
                    var L = [],
                        h = [];
                    q.forEach(function(D) { hk(L, D), no(h, n._transformDirectionToViewSpace(D.p3())) }), D.uDirColor = L, D.uDirDirection = h
                }
            },
            hh = function(y, s) { return Math.max(y.getRotateMinPhi() + lq, Math.min(y.getRotateMaxPhi() - lq, s)) },
            Gh = function() { return .05 + Se() / 2 },
            lh = function(J, u, P, l) { var F, R = J.getEye(); return J.isOrtho() ? (F = zd(J.getCenter(), R), F[0] += l[0], F[1] += l[1], F[2] += l[2]) : F = R, Ed(u, P, l, F) },
            Ed = function(x, M, B, o) {
                var j = Uj(x, M),
                    f = zd(o, B, !0),
                    K = Uj(f, M);
                if (X(K) < lq) return A;
                var c = (j - Uj(B, M)) / K;
                return [B[0] + f[0] * c, B[1] + f[1] * c, B[2] + f[2] * c]
            },
            sr = function(O, g) { return { x: 2 * O.x - g.x, y: 2 * O.y - g.y } },
            Sd = function(U, h, F, i) {
                var q, S;
                if (!U) return q = Cc(h.y - F.y, F.x - h.x), { x: h.x + i * N(q), y: h.y + i * C(q) };
                if (!F) return q = Cc(U.y - h.y, h.x - U.x), { x: h.x + i * N(q), y: h.y + i * C(q) };
                var D = zd([U.x, U.y, 0], [h.x, h.y, 0], !0),
                    J = zd([F.x, F.y, 0], [h.x, h.y, 0], !0),
                    u = -(D[0] + J[0]) / 2,
                    x = -(D[1] + J[1]) / 2,
                    c = z(u * u + x * x);
                if (lq > c) return q = Cc(U.y - h.y, h.x - U.x), { x: h.x + i * N(q), y: h.y + i * C(q) };
                var P = U.x - h.x,
                    o = U.y - h.y,
                    H = F.x - h.x,
                    s = F.y - h.y,
                    _ = z(P * P + o * o),
                    $ = z(H * H + s * s);
                q = W(Uj(D, J)) / 2, S = D[1] * J[0] - D[0] * J[1] > 0 ? -1 : 1, u /= c, x /= c;
                var Z = i / N(q),
                    v = K(_, $) / C(q);
                c = Math.min(Z, v);
                var k = { x: h.x + S * c * u, y: h.y + S * c * x };
                return F.b && Z > $ / C(q) && (k.adjust = !0), k
            },
            yd = function(u) {
                var $ = u[1],
                    A = u[2],
                    o = u[3],
                    q = u[6],
                    R = u[7],
                    E = u[11];
                u[1] = u[4], u[2] = u[8], u[3] = u[12], u[4] = $, u[6] = u[9], u[7] = u[13], u[8] = A, u[9] = q, u[11] = u[14], u[12] = o, u[13] = R, u[14] = E
            },
            Dl = function(t) {
                var x = t[0],
                    $ = t[1],
                    N = t[2],
                    Q = t[3],
                    E = t[4],
                    u = t[5],
                    w = t[6],
                    j = t[7],
                    K = t[8],
                    h = t[9],
                    V = t[10],
                    n = t[11],
                    d = t[12],
                    P = t[13],
                    o = t[14],
                    p = t[15],
                    L = x * u - $ * E,
                    i = x * w - N * E,
                    O = x * j - Q * E,
                    c = $ * w - N * u,
                    r = $ * j - Q * u,
                    Y = N * j - Q * w,
                    f = K * P - h * d,
                    B = K * o - V * d,
                    v = K * p - n * d,
                    y = h * o - V * P,
                    S = h * p - n * P,
                    k = V * p - n * o,
                    F = L * k - i * S + O * y + c * v - r * B + Y * f;
                return F ? (F = 1 / F, t[0] = (u * k - w * S + j * y) * F, t[1] = (N * S - $ * k - Q * y) * F, t[2] = (P * Y - o * r + p * c) * F, t[3] = (V * r - h * Y - n * c) * F, t[4] = (w * v - E * k - j * B) * F, t[5] = (x * k - N * v + Q * B) * F, t[6] = (o * O - d * Y - p * i) * F, t[7] = (K * Y - V * O + n * i) * F, t[8] = (E * S - u * v + j * f) * F, t[9] = ($ * v - x * S - Q * f) * F, t[10] = (d * r - P * O + p * L) * F, t[11] = (h * O - K * r - n * L) * F, t[12] = (u * B - E * y - w * f) * F, t[13] = (x * y - $ * B + N * f) * F, t[14] = (P * i - d * c - o * L) * F, t[15] = (K * c - h * i + V * L) * F, void 0) : A
            },
            ge = function(p, F) {
                if (F) {
                    var E = F[0],
                        Y = F[1],
                        $ = F[2];
                    p[12] = p[0] * E + p[4] * Y + p[8] * $ + p[12], p[13] = p[1] * E + p[5] * Y + p[9] * $ + p[13], p[14] = p[2] * E + p[6] * Y + p[10] * $ + p[14], p[15] = p[3] * E + p[7] * Y + p[11] * $ + p[15]
                }
            },
            ro = function(e, y) {
                if (y) {
                    var A = y[0],
                        E = y[1],
                        X = y[2];
                    e[0] = e[0] * A, e[1] = e[1] * A, e[2] = e[2] * A, e[3] = e[3] * A, e[4] = e[4] * E, e[5] = e[5] * E, e[6] = e[6] * E, e[7] = e[7] * E, e[8] = e[8] * X, e[9] = e[9] * X, e[10] = e[10] * X, e[11] = e[11] * X
                }
            },
            lk = function(w, t, G) {
                var S = t[0],
                    x = t[1],
                    C = t[2],
                    B = t[3],
                    W = t[4],
                    b = t[5],
                    A = t[6],
                    a = t[7],
                    n = t[8],
                    D = t[9],
                    L = t[10],
                    V = t[11],
                    z = t[12],
                    h = t[13],
                    l = t[14],
                    d = t[15],
                    H = G[0],
                    X = G[1],
                    v = G[2],
                    M = G[3];
                return w[0] = H * S + X * W + v * n + M * z, w[1] = H * x + X * b + v * D + M * h, w[2] = H * C + X * A + v * L + M * l, w[3] = H * B + X * a + v * V + M * d, H = G[4], X = G[5], v = G[6], M = G[7], w[4] = H * S + X * W + v * n + M * z, w[5] = H * x + X * b + v * D + M * h, w[6] = H * C + X * A + v * L + M * l, w[7] = H * B + X * a + v * V + M * d, H = G[8], X = G[9], v = G[10], M = G[11], w[8] = H * S + X * W + v * n + M * z, w[9] = H * x + X * b + v * D + M * h, w[10] = H * C + X * A + v * L + M * l, w[11] = H * B + X * a + v * V + M * d, H = G[12], X = G[13], v = G[14], M = G[15], w[12] = H * S + X * W + v * n + M * z, w[13] = H * x + X * b + v * D + M * h, w[14] = H * C + X * A + v * L + M * l, w[15] = H * B + X * a + v * V + M * d, w
            },
            _h = function(l, Y, J, d) {
                var p, b, L, e, q, $, r, c, F, G, v = Y[0],
                    f = Y[1],
                    B = Y[2],
                    s = d[0],
                    x = d[1],
                    h = d[2],
                    g = J[0],
                    R = J[1],
                    o = J[2];
                return X(v - g) < lq && X(f - R) < lq && X(B - o) < lq ? ve(l) : (r = v - g, c = f - R, F = B - o, G = 1 / z(r * r + c * c + F * F), r *= G, c *= G, F *= G, p = x * F - h * c, b = h * r - s * F, L = s * c - x * r, G = z(p * p + b * b + L * L), G ? (G = 1 / G, p *= G, b *= G, L *= G) : (p = 0, b = 0, L = 0), e = c * L - F * b, q = F * p - r * L, $ = r * b - c * p, G = z(e * e + q * q + $ * $), G ? (G = 1 / G, e *= G, q *= G, $ *= G) : (e = 0, q = 0, $ = 0), l[0] = p, l[1] = e, l[2] = r, l[3] = 0, l[4] = b, l[5] = q, l[6] = c, l[7] = 0, l[8] = L, l[9] = $, l[10] = F, l[11] = 0, l[12] = -(p * v + b * f + L * B), l[13] = -(e * v + q * f + $ * B), l[14] = -(r * v + c * f + F * B), l[15] = 1, l)
            },
            Dm = function(W, G, V, P, r) {
                var e = 1 / rg(G / 2),
                    t = 1 / (P - r);
                return W[0] = e / V, W[1] = 0, W[2] = 0, W[3] = 0, W[4] = 0, W[5] = e, W[6] = 0, W[7] = 0, W[8] = 0, W[9] = 0, W[10] = (r + P) * t, W[11] = -1, W[12] = 0, W[13] = 0, W[14] = 2 * r * P * t, W[15] = 0, W
            },
            hr = function(C, M, $, D, l, J, y) {
                var O = 1 / (M - $),
                    o = 1 / (D - l),
                    Z = 1 / (J - y);
                return C[0] = -2 * O, C[1] = 0, C[2] = 0, C[3] = 0, C[4] = 0, C[5] = -2 * o, C[6] = 0, C[7] = 0, C[8] = 0, C[9] = 0, C[10] = 2 * Z, C[11] = 0, C[12] = (M + $) * O, C[13] = (l + D) * o, C[14] = (y + J) * Z, C[15] = 1, C
            },
            Pq = function(d, y) {
                var R = y[0],
                    q = y[1],
                    o = y[2],
                    K = y[3],
                    A = R * R + q * q + o * o + K * K,
                    P = A ? 1 / A : 0;
                return d[0] = -R * P, d[1] = -q * P, d[2] = -o * P, d[3] = K * P, d
            },
            An = function(z, T) {
                var l = T[0] + T[5] + T[10],
                    J = 0;
                return l > 0 ? (J = 2 * Math.sqrt(l + 1), z[3] = .25 * J, z[0] = (T[6] - T[9]) / J, z[1] = (T[8] - T[2]) / J, z[2] = (T[1] - T[4]) / J) : T[0] > T[5] & T[0] > T[10] ? (J = 2 * Math.sqrt(1 + T[0] - T[5] - T[10]), z[3] = (T[6] - T[9]) / J, z[0] = .25 * J, z[1] = (T[1] + T[4]) / J, z[2] = (T[8] + T[2]) / J) : T[5] > T[10] ? (J = 2 * Math.sqrt(1 + T[5] - T[0] - T[10]), z[3] = (T[8] - T[2]) / J, z[0] = (T[1] + T[4]) / J, z[1] = .25 * J, z[2] = (T[6] + T[9]) / J) : (J = 2 * Math.sqrt(1 + T[10] - T[0] - T[5]), z[3] = (T[1] - T[4]) / J, z[0] = (T[8] + T[2]) / J, z[1] = (T[6] + T[9]) / J, z[2] = .25 * J), z
            },
            Hb = function(o, $, Y) {
                var q = $[0],
                    Z = $[1],
                    y = $[2],
                    f = $[3],
                    I = q + q,
                    n = Z + Z,
                    l = y + y,
                    u = q * I,
                    w = q * n,
                    D = q * l,
                    N = Z * n,
                    Q = Z * l,
                    P = y * l,
                    K = f * I,
                    X = f * n,
                    s = f * l;
                return o[0] = 1 - (N + P), o[1] = w + s, o[2] = D - X, o[3] = 0, o[4] = w - s, o[5] = 1 - (u + P), o[6] = Q + K, o[7] = 0, o[8] = D + X, o[9] = Q - K, o[10] = 1 - (u + N), o[11] = 0, o[12] = Y[0], o[13] = Y[1], o[14] = Y[2], o[15] = 1, o
            },
            qh = function(Z, e) { if (Z.vr.enable) { var s = Z.vr.getViewMatrix(e); if (s) return s } return _h(e ? e : ur(), Z._eye, Z._center, Z._up) },
            Rj = function(l, v) {
                if (l.vr.enable) { var B = l.vr.getProjectMatrix(); if (B) return B }
                if (!v && l._computedProjectMatrix) return Ac(l._computedProjectMatrix);
                var h = l.getAspect(),
                    d = l._near,
                    n = l._far,
                    o = ur();
                if (l._ortho) {
                    var E = l._orthoWidth / 2,
                        b = E / h;
                    hr(o, -E, E, -b, b, d, n)
                } else Dm(o, l._fovy, h, d, n);
                return o
            },
            Dc = function(p, l) {
                if (!p) return A;
                var c = 0,
                    N = 1,
                    R = 2,
                    i = [],
                    j = 0,
                    B = p.length,
                    Q = B / 3;
                if (l) {
                    for (; B > j; j++) i[j] = 0;
                    for (j = 0; j < l.length; j += 3) {
                        var T = [],
                            E = [],
                            h = [];
                        T[c] = p[3 * l[j + 1] + c] - p[3 * l[j] + c], T[N] = p[3 * l[j + 1] + N] - p[3 * l[j] + N], T[R] = p[3 * l[j + 1] + R] - p[3 * l[j] + R], E[c] = p[3 * l[j + 2] + c] - p[3 * l[j + 1] + c], E[N] = p[3 * l[j + 2] + N] - p[3 * l[j + 1] + N], E[R] = p[3 * l[j + 2] + R] - p[3 * l[j + 1] + R], h[c] = T[N] * E[R] - T[R] * E[N], h[N] = T[R] * E[c] - T[c] * E[R], h[R] = T[c] * E[N] - T[N] * E[c];
                        for (var M = 0; 3 > M; M++) i[3 * l[j + M] + c] += h[c], i[3 * l[j + M] + N] += h[N], i[3 * l[j + M] + R] += h[R]
                    }
                } else
                    for (j = 0; Q > j; j += 3) {
                        var T = [],
                            E = [],
                            h = [];
                        T[c] = p[3 * (j + 1) + c] - p[3 * j + c], T[N] = p[3 * (j + 1) + N] - p[3 * j + N], T[R] = p[3 * (j + 1) + R] - p[3 * j + R], E[c] = p[3 * (j + 2) + c] - p[3 * (j + 1) + c], E[N] = p[3 * (j + 2) + N] - p[3 * (j + 1) + N], E[R] = p[3 * (j + 2) + R] - p[3 * (j + 1) + R], h[c] = T[N] * E[R] - T[R] * E[N], h[N] = T[R] * E[c] - T[c] * E[R], h[R] = T[c] * E[N] - T[N] * E[c];
                        for (var M = 0; 3 > M; M++) i[3 * (j + M) + c] = h[c], i[3 * (j + M) + N] = h[N], i[3 * (j + M) + R] = h[R]
                    }
                for (j = 0; B > j; j += 3) {
                    var _ = [];
                    _[c] = i[j + c], _[N] = i[j + N], _[R] = i[j + R];
                    var W = z(_[c] * _[c] + _[N] * _[N] + _[R] * _[R]);
                    0 === W && (W = lq), _[c] = _[c] / W, _[N] = _[N] / W, _[R] = _[R] / W, i[j + c] = _[c], i[j + N] = _[N], i[j + R] = _[R]
                }
                return new ss(i)
            },
            Xj = function(U, N, S, k) {
                if (S || (S = U.createTexture()), N) {
                    var Q = U.TEXTURE_2D,
                        z = U.REPEAT,
                        f = U.CLAMP_TO_EDGE,
                        W = U.TEXTURE_MIN_FILTER;
                    k = k || pk;
                    var I = k.minFilter || k.filter || U.LINEAR,
                        J = k.magFilter || k.filter || U.LINEAR;
                    U.activeTexture(U.TEXTURE0), Jo(U, S), U.texImage2D(Q, 0, U.RGBA, U.RGBA, U.UNSIGNED_BYTE, N), tn(U, U.TEXTURE_MAG_FILTER, J);
                    var v = N.naturalWidth || N.width,
                        q = N.naturalHeight || N.height;
                    zn.isPOT(v) && zn.isPOT(q) && !k.clampToEdge && !N.clampToEdge ? (tn(U, U.TEXTURE_WRAP_S, z), tn(U, U.TEXTURE_WRAP_T, z), tn(U, W, I === U.NEAREST ? U.NEAREST_MIPMAP_NEAREST : U.LINEAR_MIPMAP_LINEAR), k.mipmapMaxLevel !== O && tn(U, U.TEXTURE_MAX_LEVEL, k.mipmapMaxLevel), U.generateMipmap(Q)) : (tn(U, U.TEXTURE_WRAP_S, f), tn(U, U.TEXTURE_WRAP_T, f), tn(U, W, I)), Jo(U, A)
                }
                return S
            },
            ze = function(y, j) { var t = new Uint8Array(4); return j = j || y.createTexture(), y.activeTexture(y.TEXTURE0), Jo(y, j), tn(y, y.TEXTURE_MIN_FILTER, y.LINEAR), y.texImage2D(y.TEXTURE_2D, 0, y.RGBA, 1, 1, 0, y.RGBA, y.UNSIGNED_BYTE, t), j },
            Hm = function(v, o) { var H = new Uint8Array(4); return o = o || v.createTexture(), v.activeTexture(v.TEXTURE0), v.bindTexture(v.TEXTURE_CUBE_MAP, o), v.texParameteri(v.TEXTURE_CUBE_MAP, v.TEXTURE_MAG_FILTER, v.LINEAR), v.texParameteri(v.TEXTURE_CUBE_MAP, v.TEXTURE_MIN_FILTER, v.LINEAR), v.texImage2D(v.TEXTURE_CUBE_MAP_POSITIVE_X + 0, 0, v.RGBA, 1, 1, 0, v.RGBA, v.UNSIGNED_BYTE, H), v.texImage2D(v.TEXTURE_CUBE_MAP_POSITIVE_X + 1, 0, v.RGBA, 1, 1, 0, v.RGBA, v.UNSIGNED_BYTE, H), v.texImage2D(v.TEXTURE_CUBE_MAP_POSITIVE_X + 2, 0, v.RGBA, 1, 1, 0, v.RGBA, v.UNSIGNED_BYTE, H), v.texImage2D(v.TEXTURE_CUBE_MAP_POSITIVE_X + 3, 0, v.RGBA, 1, 1, 0, v.RGBA, v.UNSIGNED_BYTE, H), v.texImage2D(v.TEXTURE_CUBE_MAP_POSITIVE_X + 4, 0, v.RGBA, 1, 1, 0, v.RGBA, v.UNSIGNED_BYTE, H), v.texImage2D(v.TEXTURE_CUBE_MAP_POSITIVE_X + 5, 0, v.RGBA, 1, 1, 0, v.RGBA, v.UNSIGNED_BYTE, H), o },
            nf = function(F) { F._26I && F._prg && (F._26I.deleteProgram(F._prg), F._prg = A) },
            yj = function(Q, w, X, h) { var U = Q.createShader(X); return Q.shaderSource(U, h), Q.compileShader(U), Q.attachShader(w, U), U },
            Pj = function(b) { return b.createBuffer() },
            Jo = function(Q, j) { Q.bindTexture(Q.TEXTURE_2D, j || Q._emptyTexture) },
            tn = function(X, g, v) { X.texParameteri(X.TEXTURE_2D, g, v) },
            up = function(p, H) {
                var C = Jg.for(p).directState();
                C.polygonOffset.enabled = !0, C.polygonOffset.value = H
            },
            dj = function(p) {
                var i = Jg.for(p).directState();
                i.polygonOffset.enabled = !1
            },
            xd = function(x, Q) {
                if (Q) {
                    var p = Jg.for(x).directState();
                    p.color.clear = Lf(Q)
                }
            },
            Sc = function(w) {
                var I = Jg.for(w),
                    G = I.directUniforms(),
                    u = I.directAttribs();
                G.uFix = !0, u.aNormal = !1
            },
            Ih = function(F) {
                var J = Jg.for(F),
                    b = J.directUniforms();
                J.directAttribs(), b.uFix = !1
            },
            Ge = function(Q, j, B, T, q, w, e, b) {
                var y = Jg.for(Q),
                    S = y.directState(),
                    l = y.directUniforms();
                Q._picking || (B ? (l.uBlend = !0, l.uBlendColor = B) : l.uBlend = !1, l.uLight = T == A ? !0 : T, lc(q) && 1 !== q && (l.uPartOpacity = q), l.uReverseFlip = w == A ? !1 : w, l.uFixPickReverseColor = e || Vo), S.cullFace.enabled = b ? !0 : !1
            },
            Xf = function(d) {
                if (!d._picking) {
                    var V = Jg.for(d),
                        J = V.directUniforms();
                    J.uPartOpacity = 1
                }
            },
            Lg = function() {
                var T = new k.Math.Matrix2d,
                    x = [1, 0, 0, 0, 1, 0, 0, 0, 0];
                return function(f, g, R, U, i, Z, w, y, $, p) {
                    var J = Jg.for(f),
                        P = J.directUniforms(),
                        K = J.directAttribs();
                    return R ? (P.uTexture = !0, P.uDiscardSelectable = Nl(U) ? U : !0, K.aUv = Qm(f, i, Z, A, 2), p ? (P.uBlendTexture = !0, P.uBlendSampler = p) : (P.uBlendTexture = !1, P.uBlendSampler = f._emptyBlendTexture), P.uSampler = R, P.uUvMatrix = w || y || $ ? Xm($, w, y, T).toArray9() : x, void 0) : (P.uSampler = f._emptyTexture, P.uBlendSampler = f._emptyBlendTexture, void 0)
                }
            }(),
            Th = function(C, B, l) {
                var L = Jg.for(C),
                    U = L.directUniforms(),
                    b = L.directAttribs();
                C.activeTexture(C.TEXTURE0), Jo(C, A), C.activeTexture(C.TEXTURE1), Jo(C, A), l && (b.aUv = !1, U.uTexture = !1, U.uSampler = C._emptyTexture, U.uBlendTexture = !1, U.uBlendSampler = C._emptyBlendTexture)
            },
            _o = function(u, i, _, w, H, K) {
                var Z = Jg.for(u),
                    d = Z.directUniforms(),
                    Y = Z.directAttribs();
                !_ || Jd || ui || u.lineWidth(_), w && !u._picking && (d.uFixPickReverseColor = w), H && (Y.aPosition = Qm(u, H, K, A))
            },
            xc = function(o, N, Y, z) {
                bs && (z = o[bs]), o.drawArrays(z == A ? o.TRIANGLES : z, N, Y);
                var u = o._renderInfo;
                u && (u.calls++, u.vertices += Y, (z == A || z === o.TRIANGLES) && (u.faces += Y / 3), z === o.LINES && (u.lines += Y / 2), z === o.POINTS && (u.points += Y))
            },
            pc = function(V, s, r, x, o) {
                bs && (x = V[bs]), V.drawElements(x == A ? V.TRIANGLES : x, r, o == A ? V.UNSIGNED_SHORT : o, s == A ? 0 : 2 * s);
                var R = V._renderInfo;
                R && (R.calls++, R.vertices += r, (x == A || x === V.TRIANGLES) && (R.faces += r / 3), x === V.LINES && (R.lines += r / 2), x === V.POINTS && (R.points += r))
            },
            ab = function(g, c, G) { var Y = g.ARRAY_BUFFER; return g.bindBuffer(Y, c), G && g.bufferData(Y, G, g.STATIC_DRAW), c },
            Qm = function(O, L, A, N, J) { return A ? zh(O, O.ARRAY_BUFFER, L, A) : ab(O, L, A, N, J) },
            Dh = function(u, e, m) {
                var $ = u.ELEMENT_ARRAY_BUFFER;
                u.bindBuffer($, e), m && u.bufferData($, m, u.STATIC_DRAW)
            },
            kk = function(a, d, z) { zh(a, a.ELEMENT_ARRAY_BUFFER, d, z) },
            zh = function(z, b, h, N) {
                var $ = N._bufId;
                $ || ($ = N._bufId = k.Math.generateIncreasingID());
                var h, B = z._bufPool;
                return (h = B[$]) && h._buf ? z.bindBuffer(b, h._buf) : (h = B[$] = { _buf: Pj(z) }, z.bindBuffer(b, h._buf), z.bufferData(b, N, z.STATIC_DRAW)), h._fid = z._renderInfo.frame, h._buf
            },
            zj = function(k, X) { X != A && X >= 0 && k.enableVertexAttribArray(X) },
            qi = function(O, w) { w != A && w >= 0 && O.disableVertexAttribArray(w) },
            lf = function(d, p) {
                var Y = d.getGL(),
                    P = Jg.for(Y),
                    n = P.directUniforms();
                d._7O = d._8O.pop(), p && (n.uMVMatrix = d._7O, d._6O = p, n.uNMatrix = p)
            },
            Mr = function(z, T) { return T || (T = ur()), Mn(T, z), Dl(T), yd(T), T },
            Vp = function(C, _) {
                var d = C.getGL(),
                    n = C._7O,
                    X = Jg.for(d),
                    B = X.directUniforms();
                _ ? (C._8O.push(Ac(n)), B.uMMatrix = _, lk(n, n, _), C._7O = n) : B.uMMatrix = Re, B.uMVMatrix = n, B.uNMatrix = Mr(n, C._6O)
            },
            kr = { body: 0, label: 1, label2: 2, note: 3, note2: 4, symbol: 5 },
            vb = 10,
            Ap = function(Q, B, k, g, N, t) {
                var O;
                if (k) {
                    var h = g._pickId;
                    h || (h = g._pickId = B._pickIdUsed, B._pickIdUsed += vb);
                    var p, U = kr[N];
                    if (null != U) p = h + U;
                    else {
                        var a = g._pickExtraPartMap;
                        a || (a = g._pickExtraPartMap = {}), (p = a[N]) || (p = a[N] = B._pickIdUsed++)
                    }
                    B[p] || (B[p] = { data: g, part: N }), O = Jr(p)
                } else O = Qg;
                if (!t) {
                    var I = Jg.for(Q),
                        K = I.directUniforms();
                    K.uFixPickReverseColor = O
                }
                return O
            },
            rp = function(Q, X, x) {
                "target" !== x && (x = "source");
                var o = "target" === x ? X.getTargetAgent() : X.getSourceAgent(),
                    u = "edge." + x + ".";
                if (Dj(o)) {
                    var F = X.s(u + "anchor.x"),
                        i = X.s(u + "anchor.elevation"),
                        p = X.s(u + "anchor.y"),
                        W = Rp(o, Q.getMat(o)),
                        t = o.getAnchor3d();
                    return yi([(F === O ? .5 : F) - t.x, (i === O ? .5 : i) - t.y, (p === O ? .5 : p) - t.z], W)
                }
                var M = X.s(u + "index"),
                    Z = Q.getData3dUI(o);
                if (!Z.info || !Z.info.list) return !1;
                if (M >= 0) {
                    var n, N, A, D, h, V = Z.info._lastPointsSegments,
                        g = V.points,
                        d = V.segments,
                        m = -1,
                        R = -1;
                    for (A = 0, D = d ? d.length : g.length; D > A; A++) {
                        if (N = d ? d.get(A) : 1, 3 === N) h = 2;
                        else if (4 === N) h = 3;
                        else {
                            if (5 === N) continue;
                            h = 1
                        }
                        if (m += h, R++, R === M) { n = g.get(m); break }
                    }
                    return n || (n = g.get(g.length - 1)), [n.x, n.e || 0, n.y]
                }
                var $ = X.s(u + "percent") || .5;
                if ($ = Math.max(0, Math.min($, 1)), !Z || !Z.getCache) return !1;
                var Y = Z.getCache(),
                    D = Y[Y.length - 1].length,
                    V = Q.getLineOffset(o, $ * D),
                    T = V.point;
                return [T.x, T.y, T.z]
            },
            zp = function() {
                var $ = {
                    center: function(b, n, Q, i, T) {
                        var l = -n[1] / 2,
                            G = { x: -n[0] / 2, y: l, width: n[0], height: n[1] },
                            m = Hf(b, G, Q);
                        return [m.x + i, -m.y - T, Gh()]
                    },
                    front: function(X, E, J, U, z) {
                        var i = -E[1] / 2,
                            H = { x: -E[0] / 2, y: i, width: E[0], height: E[1] },
                            Y = Hf(X, H, J);
                        return [Y.x + U, -Y.y - z, E[2] / 2 + Gh()]
                    },
                    back: function(t, q, A, y, H) {
                        var w = -q[0] / 2,
                            j = -q[1] / 2,
                            B = { x: w, y: j, width: q[0], height: q[1] },
                            X = Hf(t, B, A);
                        return [-X.x - y, -X.y - H, -q[2] / 2 - Gh()]
                    },
                    left: function(y, p, V, c, d) {
                        var j = -p[1] / 2,
                            e = { x: -p[2] / 2, y: j, width: p[2], height: p[1] },
                            B = Hf(y, e, V);
                        return [-p[0] / 2 - Gh(), -B.y - d, B.x + c]
                    },
                    right: function(V, Y, _, X, C) {
                        var I = -Y[2] / 2,
                            Z = -Y[1] / 2,
                            j = { x: I, y: Z, width: Y[2], height: Y[1] },
                            P = Hf(V, j, _);
                        return [Y[0] / 2 + Gh(), -P.y - C, -P.x - X]
                    },
                    top: function(I, F, X, P, f) {
                        var i = { x: -F[0] / 2, y: -F[2] / 2, width: F[0], height: F[2] },
                            p = Hf(I, i, X);
                        return [p.x + P, F[1] / 2 + Gh(), p.y + f]
                    },
                    bottom: function(J, k, H, y, C) {
                        var u = -k[2] / 2,
                            s = { x: -k[0] / 2, y: u, width: k[0], height: k[2] },
                            g = Hf(J, s, H);
                        return [g.x + y, -k[1] / 2 - Gh(), -g.y - C]
                    }
                };
                return function(F, q, P, S, V, e) { return $[S](F, q, P, V || 0, e || 0) }
            }(),
            Hh = function(r, i, G, W, N, e, K, P, t, $) {
                if (N && (i[0] += N[0], i[1] += N[1], i[2] += N[2]), ge(r, G), P) {
                    var h = ur();
                    if (Wl(h, t, $), yi(i, h), ge(r, i), r.auto = P, r.pos = yi([0, 0, 0], r), e) {
                        var o = r.mat2 = ur();
                        Wl(o, e, K)
                    }
                } else Wl(r, t, $), ge(r, i), W === Ui ? tq(r, -Z) : W === Ul ? tq(r, Z) : W === Gm ? gk(r, -Z) : W === uq ? gk(r, Z) : W === Qj && tq(r, U), Wl(r, e, K);
                return r
            },
            _c = function(W, v) {
                var B = v.auto,
                    M = v.mat2,
                    f = W.gv;
                if (B) {
                    var x, c = ur(),
                        h = [0, 0, 0, 0];
                    x = "string" == typeof B ? [B.indexOf("x") < 0 ? f._eye[0] : f._center[0], B.indexOf("y") < 0 ? f._eye[1] : f._center[1], B.indexOf("z") < 0 ? f._eye[2] : f._center[2]] : f._eye, An(h, _h(ur(), x, f._center, f._up)), Hb(c, Pq(h, h), v.pos), M && lk(c, c, M), Vp(f, c)
                } else Vp(f, v)
            },
            xs = function(d, K, Y, I, l) {
                var U = d.s,
                    B = d.gv,
                    S = B.getGL(),
                    F = B._prg,
                    G = B._buffer,
                    t = B._1O,
                    u = Jg.for(S),
                    E = u.directAttribs();
                Xj(S, Rl, t), _c(d, Y), Ge(S, F, U(K + ".blend"), U(K + ".light"), U(K + ".opacity"), U(K + ".reverse.flip"), U(K + ".reverse.color"), U(K + ".reverse.cull")), Lg(S, F, t, l, G.uv, Pl), E.aPosition = Qm(S, G.vs, I, A), E.aNormal = Qm(S, G.ns, Ad, A), kk(S, G.is, Kn), pc(S, 0, Kn.length), Th(S, F, t), Xf(S, F), lf(B)
            },
            lb = function(x, Y, e) {
                var L = x.gv,
                    g = x.data,
                    $ = x[Y] = { blend: L.getBodyColor(g) || L.getFaceBlend(g, Y), light: L.getFaceLight(g, Y), color: L.getFaceColor(g, Y), opacity: L.getFaceOpacity(g, Y), transparent: L.getFaceTransparent(g, Y), reverseFlip: L.getFaceReverseFlip(g, Y), reverseColor: L.getFaceReverseColor(g, Y), reverseCull: L.getFaceReverseCull(g, Y), texture: L.getFaceImage(g, Y), blendTexture: L.getFaceBlendImage(g, Y), discardSelectable: L.getFaceDiscardSelectable(g, Y) };
                if ("csg" !== Y) {
                    $.uv = L.getFaceUv(g, Y) || e && e[Y + "Uv"], $.uvScale = L.getFaceUvScale(g, Y) || e && e[Y + "UvScale"], $.uvOffset = L.getFaceUvOffset(g, Y) || e && e[Y + "UvOffset"], $.uvRotation = L.getFaceUvRotation(g, Y) || e && e[Y + "uvRotation"];
                    var Z = L.getFaceMat(g, Y);
                    if (Z) {
                        var B = Rp(g, Z);
                        g.appendAnchorMatrix3d(B), $.mat = B
                    }
                }
                return $
            },
            mn = function(R, K, _, M, C) {
                var L = R[M];
                if (L) {
                    if (!C(L.transparent)) return;
                    var T = R.data,
                        N = R.gv,
                        n = N._buffer,
                        a = N.getTexture(L.texture, T, M),
                        Q = N.getTexture(L.blendTexture, T),
                        w = Jg.for(K),
                        E = w.directUniforms(),
                        v = w.directAttribs();
                    Lg(K, _, a, L.discardSelectable, n.uv, L.tuv, L.uvOffset, L.uvScale, L.uvRotation, Q), Ge(K, _, L.blend, L.light, L.opacity, L.reverseFlip, L.reverseColor, L.reverseCull), L.cs && !N._batchColorDisabled ? (E.uBatchColor = !0, v.aBatchColor = Qm(K, n.batchColor, L.cs, _.aBatchColor, 4)) : E.uDiffuse = L.color || h["color.empty"], v.aPosition = Qm(K, n.vs, L.vs, A), v.aNormal = Qm(K, n.ns, L.ns, A), xc(K, 0, L.vs.length / 3), L.cs && !N._batchColorDisabled && (E.uBatchColor = !1, qi(K, _.aBatchColor)), Xf(K, _), Th(K, _, a)
                }
            },
            $i = function(m, J, i) { ud(m) ? m.forEach(function(x) { $i(x, J, i) }) : Ok(m) ? $i(bl(J, m), J, i) : zg(m) ? m.shape3d ? $i(m.shape3d, J, i) : i.push(m) : i.push(m) },
            Eo = function() {
                for (var R = 50, c = arguments.length, A = [], n = 0; c > n; n++) A[n] = arguments[n];
                Zo[Eh] = "Time : " + (new Date).toLocaleString() + ", Info :" + A.join(", "), Eh = (Eh + 1) % R, console.error("Failed to create shader.")
            },
            Xm = function() { var g = new zn.Matrix2d; return function(B, H, s, Z) { Z || (Z = g); var o, p, $, T; return H ? (o = H[0], p = H[1]) : o = p = 0, s ? ($ = s[0], T = s[1]) : $ = T = 1, Z.setFromTransform(B || 0, o, p, $, T) } }(),
            mh = function(R, f, n, h, Q, k) {
                var W, g, E, U, I, z, G, j, r, F, y, H = [h - f, Q - n],
                    d = R ? R.length : 0;
                for (E = 0; d > E; E++) {
                    for (U = 2, W = R[E], I = W[0], z = W[1]; U + 1 < W.length;) {
                        if (G = W[U], j = W[U + 1], g = Og(f, n, h, Q, I, z, G, j, !0)) { r = [G - I, j - z], F = _q(r), r[0] /= F, r[1] /= F, F = Uj(H, r), F = F > 0 ? k : -k, y = [r[0] * F, r[1] * F]; break }
                        I = G, z = j, U += 2
                    }
                    if (y) break
                }
                if (y)
                    for (h = f + y[0], Q = n + y[1], E = 0; d > E; E++)
                        for (U = 2, W = R[E], I = W[0], z = W[1]; U + 1 < W.length;) {
                            if (G = W[U], j = W[U + 1], g = Og(f, n, h, Q, I, z, G, j, !0)) return [0, 0];
                            I = G, z = j, U += 2
                        }
                return y ? y : [h - f, Q - n]
            },
            gj = function(M) { return "nearest" === M ? wq.NEAREST : "linear" === M ? wq.LINEAR : M },
            Of = k.graph3d = {},
            Bj = function(H, V, A) { eh(L + ".graph3d." + H, V, A) },
            sq = "~<yfusfw!+!yjsubNQv!>!opjujtpQ`mh!gjeof$!<*1/2!-opjujtpQb)5dfw!+!yjsubNNv!+!yjsubNxpebit!>!esppDxpebit!QBNXPEBIT`FTV!gfegj$!!gjeof$!~<fdobutjEfojMb!>!fdobutjEfojMw|*itbEv)gj!ITBE!gfegj$!!gjeof$!~<ttfouihjsCidubCb!>!ttfouihjsCidubCw|*ttfouihjsCidubCv)gj!TTFOUIHJSCIDUBC!gfegj$!!gjeof$!~<eofmCidubCb!>!eofmCidubCw|*eofmCidubCv)gj!EOFMCIDUBC!gfegj$!!gjeof$!~<spmpDidubCb!>!spmpDidubCw|*spmpDidubCv)gj!SPMPDIDUBC!gfegj$!~<**1/2!-wVb)4dfw!+!yjsubNwVv)3dfw!>!wVw|*fsvuyfUv)gj<*opjujtpQb)4dfw!>!opjujtpQw~<**1/2!-opjujtpQb)5dfw!+!yjsubNNv)4dfw!>!emspXw<*yfusfw)4dfw!>!yfusfWw<**1/2!-mbnspOb)5dfw!+!yjsubNOv)4dfw!>!mbnspOw|*ldjQva!%%!yjGva)gj<*1/2!-opjujtpQb)5dfw!+!yjsubNWNv!>!yfusfw!5dfw|!*ejpw)ojbn!ejpw!gjeof$!<esppDxpebit!5dfw!hojzsbw<yjsubNxpebit!5ubn!nspgjov!QBNXPEBIT`FTV!gfegj$!!gjeof$!<fdobutjEfojMw!ubpmg!hojzsbw<fdobutjEfojMb!ubpmg!fuvcjsuub<itbEv!mppc!nspgjov!ITBE!gfegj$!!gjeof$!<^UPQT`YBN]opjudfsjEupqTv!4dfw!nspgjov<^UPQT`YBN]opjujtpQupqTv!4dfw!nspgjov<^UPQT`YBN]spmpDupqTv!5dfw!nspgjov!1!?!UPQT`YBN!gj$!!gjeof$!<^UOJPQ`YBN]opjujtpQuojpQv!4dfw!nspgjov<^UOJPQ`YBN]spmpDuojpQv!5dfw!nspgjov!1!?!UOJPQ`YBN!gj$!!gjeof$!<^SJE`YBN]opjudfsjEsjEv!4dfw!nspgjov<^SJE`YBN]spmpDsjEv!5dfw!nspgjov!1!?!SJE`YBN!gj$!!gjeof$!<eofmCidubCw!4dfw!hojzsbw<eofmCidubCb!4dfw!fuvcjsuub<eofmCidubCv!mppc!nspgjov!EOFMCIDUBC!gfegj$!!gjeof$!<ttfouihjsCidubCw!ubpmg!hojzsbw<ttfouihjsCidubCb!ubpmg!fuvcjsuub<ttfouihjsCidubCv!mppc!nspgjov!TTFOUIHJSCIDUBC!gfegj$!!gjeof$!<spmpDidubCw!5dfw!hojzsbw<spmpDidubCb!5dfw!fuvcjsuub<spmpDidubCv!mppc!nspgjov!SPMPDIDUBC!gfegj$!<opjujtpQw!4dfw!hojzsbw<emspXw!4dfw!hojzsbw<yfusfWw!4dfw!hojzsbw<mbnspOw!4dfw!hojzsbw<yjGv!mppc!nspgjov<ldjQv!mppc!nspgjov<yjsubNxfjWv!5ubn!nspgjov<yjsubNOv!5ubn!nspgjov<yjsubNQv!5ubn!nspgjov<yjsubNNv!5ubn!nspgjov<yjsubNWNv!5ubn!nspgjov<opjujtpQb!4dfw!fuvcjsuub<mbnspOb!4dfw!fuvcjsuub<wVw!3dfw!hojzsbw<wVb!3dfw!fuvcjsuub<yjsubNwVv!4ubn!nspgjov<fsvuyfUeofmCv!mppc!nspgjov<fsvuyfUv!mppc!nspgjov!YJGFSQ^#CBRBEJxTT87hJFI,,bX1XrIwcn3UM{ZeZ,M6HEN6nLxe2Z72s2:3johr6foKrpqwxNKYkdbJ2CN[mBbf[wXU,T0oGuSEd190ohLZkEn8IuCe[OHoWeKz:Sf,VS7xdSLw23W1YJLU:jdv2{hiDbhDzNNEh9tp3xsuEp94Sl4c3wRzqwShMDRhCLRjCDEBOH5BBVRBCFRE4cJTHrTDH1BNgHJN",
            cr = "~~<eJ!>!spmpDhbsG`mh~<spmpDsfmqnbTwv!>+!eJ<*wVw!-sfmqnbTeofmCv)E3fsvuyfu!>!spmpDsfmqnbTwv!5dfw|!*fsvuyfUeofmCv)!gj!!gjeof$!~<ttfouihjsCidubCw!>+!chs/eJ!!!|*ttfouihjsCidubCv)gj!TTFOUIHJSCIDUBC!gfegj$!~<ttfouihjsCv!>+!chs/eJ!!!|*1/2!>a!ttfouihjsCv)gj~~<zujdbqPusbQv!>+!b/eJ!!!|*1/2!>a!zujdbqPusbQv)gj~!gjeof$!~<zujwjudfmgfSv!+!{zy/spmpDwof!>,!chs/eJ<*!spmpDwof!)sbfojMpUmfyfUqbNwof!>!spmpDwof<*!*!{z/dfWudfmgfs!-y/dfWudfmgfs)4dfw!-qbNwoFv!)fcvDfsvuyfu!>!spmpDwof!5dfw<*!mbnspOemspx!-yfusfWpUbsfnbd!)udfmgfs!>!dfWudfmgfs!4dfw<*!yjsubNxfjWv!-O!)opjudfsjEnspgtobsUftsfwoj!>!mbnspOemspx!4dfw<*!opjujtpQbsfnbDv!.!emspXw!)f{jmbnspo!>!yfusfWpUbsfnbd!4dfw|*qbNwoFftVv)!gj!QBNWOF`FTV!gfegj$!!gjeof$!<*spudbGhpg!-*x/eJ!-chs/spmpDhpGv)5dfw!-eJ)yjn!>!eJ!gjeof$!<*iuqfe!-sbGhpGv!-sbfOhpGv)qfutiuppnt!>!spudbGhpg!ubpmg!ftmf$!<*iuqfe!+!iuqfe!+!zujtofEhpGv!+!zujtofEhpGv!.)qyf!.!1/2!>!spudbGhpg!ubpmg!3QYF`HPG!gfegj$!<{/yfusfWw.!>!iuqfe!ubpmg!HPG!gfegj$!!gjeof$!~~~~<chs/^j]spmpDupqTv!+!udfggFupqt!+!fhobSm!+!*1/1!-*mbnspOm.!-O)upe)ybn!>,!chs/eJ<*1/1!-*^j]uofopqyFupqTv!-udfggFupqt)xpq)ybn!>!udfggFupqt|*^j]fmhoBupqTv!?!udfggFupqt)gj<*mbnspOm!-^j]opjudfsjEupqTv)upe!>!udfggFupqt!ubpmg<*spudfWm)f{jmbnspo!>!mbnspOm!4dfw|*1/1!?!fhobSm)!gj~<*1/2!-*^j]fhobSupqTv!0!*spudfWm)iuhofm))ojn!.!1/2!>!fhobSm|*1/1!?!^j]fhobSupqTv)!gj<1/2!>!fhobSm!ubpmg<^j]opjujtpQupqTv!.!yfusfWw!>!spudfWm!4dfw|*1/1!>>!x/^j]spmpDupqTv)gj|!*,,j!<UPQT`YBN!=!j!<1>j!uoj)spg!1!?!UPQT`YBN!gj$!!gjeof$!~~~<chs/^j]spmpDuojpQv!+!fhobSm!+!*1/1!-**spudfWm)f{jmbnspo.!-O)upe)ybn!>,!chs/eJ|*1/1!?!fhobSm)!gj~<*1/2!-*^j]fhobSuojpQv!0!*spudfWm)iuhofm))ojn!.!1/2!>!fhobSm|*1/1!?!^j]fhobSuojpQv)!gj<1/2!>!fhobSm!ubpmg<^j]opjujtpQuojpQv!.!yfusfWw!>!spudfWm!4dfw|*1/1!>>!x/^j]spmpDuojpQv)gj|!*,,j!<UOJPQ`YBN!=!j!<1>j!uoj)spg!1!?!UOJPQ`YBN!gj$!!gjeof$!~~<chs/^j]spmpDsjEv!+!*1/1!-**^j]opjudfsjEsjEv)f{jmbnspo.!-O)upe)ybn!>,!chs/eJ|*1/1!>>!x/^j]spmpDsjEv)gj|!*,,j!<SJE`YBN!=!j!<1>j!uoj)spg!1!?!SJE`YBN!gj$!~<chs/spmpDuihjmebfIv!+!nsfUusfcnbm!>+!chs/eJ!gjeof$!~<fvmbWxpebit!+!zujtofuoJxpebit!.!1/2!>+!nsfUusfcnbm!~!!<osvufs!<esbdtje!!|!*1/1!>>!fvmbWxpebit!%%!mmvDxpebit)!gj<*esppDxpebit!-tvjebSxpebit!-tbjCxpebit!-f{jTxpebit!-qbNxpebit!)xpebiTufh!.!1/2!>!fvmbWxpebit!ubpmg|!*fwjfdfSxpebit)!gj!QBNXPEBIT`FTV!gfegj$!~<*1/2!-fhobSuihjmebfIv0*yfusfWw)iuhofm)ojn!.!1/2!!>+!nsfUusfcnbm|*1/1!?!fhobSuihjmebfIv)gj<*1/1!-zujtofuoJuofjcnBuihjmebfIv!,!*zujtofuoJuofjcnBuihjmebfIv!.!1/2)!+!*M.!-O)upe)ybn!>!nsfUusfcnbm!ubpmg|*1/1!>>!x/spmpDuihjmebfIv)gj|*uihjMv)gj~!gjeof$!~<spmpDeofmCv!>+!eJ|*eofmCv)gj!ftmf$!~<spmpDeofmCv!>+!eJ|*eofmCv)gj!ftmf~<eofmCidubCw!>+!chs/eJ|*eofmCidubCv)gj!EOFMCIDUBC!gfegj$!~~<esbdtje|*1/1!>>!x/eJ)gj!gjeof$!<ftvggjEv!>!eJ!ftmf$!~<ftvggjEv!>!eJ|ftmf~<spmpDidubCw!>!eJ|*spmpDidubCv)gj!SPMPDIDUBC!gfegj$!|ftmf~<spmpDwv!>!eJ|*fsvuyfUv)gj|!ftmf~<spmpDftsfwfSldjQyjGv!>!eJ|*qjmGftsfwfSva!%%!ldbCtj)gj~<fvsu!>!ldbCtj<O.!>!O|*1/1!=!*O!-F)upe)gj<ftmbg!>!ldbCtj!mppc<F.!>!M!4dfw!gjeof$!<*yfusfWw.)f{jmbnspo!>!F!4dfw!ftmf$!<*2!-1!-1)4dfw!>!F!4dfw!DJIQBSHPIUSP!gfegj$!<*mbnspOw)f{jmbnspo!>!O!4dfw|!ftmf~!gjeof$!~~<ftvggjEv!>!eJ|ftmf~<esbdtje|*1/1!>>!x/ftvggjEv)gj|!*!fdobutjEitbEv!?!*!fdobutjEqbHitbEv!-fdobutjEfojMw!)epn!%%!itbEv)!gj!ITBE!gfegj$!!gjeof$!<spmpDftsfwfSldjQyjGv!>!eJ!ftmf$!~<spmpDftsfwfSldjQyjGv!>!eJ|ftmf~<spmpDidubCw!>!eJ|*spmpDidubCv)gj!SPMPDIDUBC!gfegj$!|*yjGv)gj<eJ!5dfw|ftmf~~!<esbdtje!|!*1/1!>>!b/spmpDhbsG`mh)!gj!gjeof$!<spmpDftsfwfSldjQyjGv!>!spmpDhbsG`mh!ftmf$!~<spmpDftsfwfSldjQyjGv!>!spmpDhbsG`mh|ftmf~<spmpDidubCw!>!spmpDhbsG`mh|*spmpDidubCv)gj!SPMPDIDUBC!gfegj$!|*ldjQv)gj~~!<esbdtje!|!**sje!-*uofdsfQqjmDv)4dfw)upe!?!*opjujtpQw!-sje)upe)!gj~!<1/2.!>!{/sje!|!*8!=!opjudfsjEqjmDv)!gj!ftmf~!<1/2!>!{/sje!|!*7!=!opjudfsjEqjmDv)!gj!ftmf~!<1/2.!>!z/sje!|!*6!=!opjudfsjEqjmDv)!gj!ftmf~!<1/2!>!z/sje!|!*5!=!opjudfsjEqjmDv)!gj!ftmf~!<1/2.!>!y/sje!|!*4!=!opjudfsjEqjmDv)!gj!ftmf~!<1/2!>!y/sje!|!*3!=!opjudfsjEqjmDv)!gj<*1/1!-1/1!-1/1)4dfw!>!sje!4dfw|!*1!?!opjudfsjEqjmDv)!gj~!<osvufs!<*1/2!-1/1!-1/1!-1/1)5dfw!>!spmpDhbsG`mh!|!*uvpldbmc)!gj~~~!<esbdtje!|!*utfUbiqmBv!>=!b/spmpDwv)!gj!!!!|!ftmf~~!<esbdtje!|!*1/1!>>!b/spmpDwv)!gj!!!!|!*uofsbqtobsUv)!gj<*wVw!-sfmqnbTv)E3fsvuyfu!>!spmpDwv|**fmcbudfmfTesbdtjEv!%%!ldjQv)a!%%!fsvuyfUv)gj<spmpDwv!5dfw|!*ejpw)ojbn!ejpw<uvpldbmc!mppc!nspgjov~<*!{zy/*!yjsubn!+!*!1/1!-sje!)5dfw!)!)f{jmbnspo!osvufs|!*!yjsubn!5ubn!oj!-sje!4dfw!oj!)opjudfsjEnspgtobsUftsfwoj!4dfw~!<*!*!SPUDBG`BNNBH!)ubpmg!-fvmbw!)sbfojMpUbnnbH!osvufs!|!*!fvmbw!5dfw!)sbfojMpUmfyfUqbNwof!5dfw~<*!x/fvmbw!-*!*!spudbGbnnbh!)4dfw!-{zy/fvmbw!)xpq!)5dfw!osvufs|!*!spudbGbnnbh!ubpmg!oj!-fvmbw!5dfw!oj!)sbfojMpUbnnbH!5dfw<1/3!>!SPUDBG`BNNBH!ubpmg!utopd!gjeof$!~!!!!!!!!gjeof$!!!!!!!!!!!!<*!qe!-*!z/f{jTmfyfu!-E4ec!)WVpUfcvd!-qbNxpebit!)fsbqnpDE3fsvuyfu!osvufs!!!!!!!!!!!!!!!!ftmf$!!!!!!!!!!!!<*!1/:!0!1/2!)!+!*!!!!!!!!!!!!!!!!*!qe!-*!z/f{jTmfyfu!-yyz/uftggp!,!E4ec!)WVpUfcvd!-qbNxpebit!)fsbqnpDE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*!qe!-*!z/f{jTmfyfu!-yyy/uftggp!,!E4ec!)WVpUfcvd!-qbNxpebit!)fsbqnpDE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*!qe!-*!z/f{jTmfyfu!-zyz/uftggp!,!E4ec!)WVpUfcvd!-qbNxpebit!)fsbqnpDE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*!qe!-*!z/f{jTmfyfu!-zyy/uftggp!,!E4ec!)WVpUfcvd!-qbNxpebit!)fsbqnpDE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*!qe!-*!z/f{jTmfyfu!-E4ec!)WVpUfcvd!-qbNxpebit!)fsbqnpDE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*!qe!-*!z/f{jTmfyfu!-yzz/uftggp!,!E4ec!)WVpUfcvd!-qbNxpebit!)fsbqnpDE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*!qe!-*!z/f{jTmfyfu!-yzy/uftggp!,!E4ec!)WVpUfcvd!-qbNxpebit!)fsbqnpDE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*!qe!-*!z/f{jTmfyfu!-zzz/uftggp!,!E4ec!)WVpUfcvd!-qbNxpebit!)fsbqnpDE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*!qe!-*!z/f{jTmfyfu!-zzy/uftggp!,!E4ec!)WVpUfcvd!-qbNxpebit!)fsbqnpDE3fsvuyfu!!!!!!!!!!!!!!!!!!!!)!osvufs!!!!!!!!!!!!!!!!<z/f{jTmfyfu!+!tvjebSxpebit!+!*!2!-2!.!)3dfw!>!uftggp!3dfw!!!!!!!!!!!!!!!!*!UGPT`GDQ`FQZU`QBNXPEBIT!)efojgfe!}}!*!GDQ`FQZU`QBNXPEBIT!)efojgfe!gj$!!!!!!!!!!!!<*!opjujtpQpUuihjm!)f{jmbnspo!>!E4ec!4dfw!!!!!!!!!!!!<tbjCxpebit!>,!qe!!!!!!!!<*!sbfObsfnbDxpebit!.!sbGbsfnbDxpebit!)!0!*!sbfObsfnbDxpebit!.!*!opjujtpQpUuihjm!)iuhofm!)!>!qe!ubpmg!!!!!!!!!!!!<{zy/esppDxpebit!>!opjujtpQpUuihjm!4dfw!!!!!!!!!!!!<*!*!1/3!-1/5!)3dfw!+!f{jTqbNxpebit!)!0!*!1/2!)3dfw!>!f{jTmfyfu!3dfw!!!!!!!!!!!!|!*!sbGbsfnbDxpebit!ubpmg!-sbfObsfnbDxpebit!ubpmg!-esppDxpebit!5dfw!-tvjebSxpebit!ubpmg!-tbjCxpebit!ubpmg!-f{jTqbNxpebit!3dfw!-qbNxpebit!E3sfmqnbt!)xpebiTuojpQufh!ubpmg!!!!!!!!~!!!!!!!!<*!68/1!-684/1!)3dfw!,!sbobmq!+!*!63/1!-632/1!)3dfw!osvufs!!!!!!!!!!!!~!!!!!!!!!!!!<1/3!.!Zohjt!+!{/w!>!z/sbobmq!!!!!!!!!!!!!!!!<1/3!,!Zohjt!+!1/3!,!y/w!>!y/sbobmq!!!!!!!!!!!!!!!!<*!z/w!)ohjt!>!Zohjt!ubpmg!!!!!!!!!!!!!!!!|!*!foPutpnmb!>?!z/Wtcb!)!gj!ftmf!~!!!!!!!!!!!!<Yohjt!+!1/3!,!Yohjt!+!{/w!>!y/sbobmq!!!!!!!!!!!!!!!!<*!y/w!)ohjt!>!Yohjt!ubpmg!!!!!!!!!!!!!!!!|!*!foPutpnmb!>?!y/Wtcb!)!gj!ftmf!~!!!!!!!!!!!!<y/w!.!1/5!>!y/sbobmq!!!!!!!!!!!!!!!!!!!!*!1/1!?!{/w!)!gj!!!!!!!!!!!!!!!!|!*!foPutpnmb!>?!{/Wtcb!)!gj!!!!!!!!!!!!<mfyfUButpnmb!.!1/2!>!foPutpnmb!ubpmg!!!!!!!!!!!!<Zf{jTmfyfu!+!6/2!>!mfyfUButpnmb!ubpmg!!!!!!!!!!!!<zy/w!>!sbobmq!3dfw!!!!!!!!!!!!<*!Zf{jTmfyfu!+!1/3!.!1/2!)!+!fcvDpUfmbdt!>+!w!!!!!!!!!!!!<fcvDpUfmbdt!>+!Wtcb!!!!!!!!!!!!<*!*!{/Wtcb!-z/Wtcb!)ybn!-y/Wtcb!)ybn!0!1/2!>!fcvDpUfmbdt!ubpmg!!!!!!!!!!!!<*!w!)tcb!>!Wtcb!4dfw!!!!!!!!!!!!|!*!Zf{jTmfyfu!ubpmg!-w!4dfw!)WVpUfcvd!3dfw!!!!!!!!~!!!!!!!!<xpebit!osvufs!!!!!!!!!!!!~!!!!!!!!!!!!gjeof$!!!!!!!!!!!!<*!{/esppDxpebit!-zy/esppDxpebit!-qbNxpebit!)fsbqnpDE3fsvuyfu!>!xpebit!!!!!!!!!!!!!!!!ftmf$!!!!!!!!!!!!<*!1/:!0!1/2!)!+!*!!!!!!!!!!!!!!!!*!{/esppDxpebit!-*!2ze!-2ye!)3dfw!,!zy/esppDxpebit!-f{jTqbNxpebit!-qbNxpebit!)qsfMxpebiTE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*!{/esppDxpebit!-*!2ze!-1/1!)3dfw!,!zy/esppDxpebit!-f{jTqbNxpebit!-qbNxpebit!)qsfMxpebiTE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*!{/esppDxpebit!-*!2ze!-1ye!)3dfw!,!zy/esppDxpebit!-f{jTqbNxpebit!-qbNxpebit!)qsfMxpebiTE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*!{/esppDxpebit!-*!1/1!-2ye!)3dfw!,!zy/esppDxpebit!-f{jTqbNxpebit!-qbNxpebit!)qsfMxpebiTE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*!{/esppDxpebit!-zy/esppDxpebit!-f{jTqbNxpebit!-qbNxpebit!)qsfMxpebiTE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*!{/esppDxpebit!-*!1/1!-1ye!)3dfw!,!zy/esppDxpebit!-f{jTqbNxpebit!-qbNxpebit!)qsfMxpebiTE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*!{/esppDxpebit!-*!1ze!-2ye!)3dfw!,!zy/esppDxpebit!-f{jTqbNxpebit!-qbNxpebit!)qsfMxpebiTE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*!{/esppDxpebit!-*!1ze!-1/1!)3dfw!,!zy/esppDxpebit!-f{jTqbNxpebit!-qbNxpebit!)qsfMxpebiTE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*!{/esppDxpebit!-*!1ze!-1ye!)3dfw!,!zy/esppDxpebit!-f{jTqbNxpebit!-qbNxpebit!)qsfMxpebiTE3fsvuyfu!!!!!!!!!!!!!!!!!!!!)!>!xpebit!!!!!!!!!!!!!!!!<tvjebSxpebit!+!z/f{jTmfyfu!,!>!2ze!ubpmg!!!!!!!!!!!!!!!!<tvjebSxpebit!+!y/f{jTmfyfu!,!>!2ye!ubpmg!!!!!!!!!!!!!!!!<tvjebSxpebit!+!z/f{jTmfyfu!.!>!1ze!ubpmg!!!!!!!!!!!!!!!!<tvjebSxpebit!+!y/f{jTmfyfu!.!>!1ye!ubpmg!!!!!!!!!!!!!!!!<f{jTqbNxpebit!0!*!1/2!)3dfw!>!f{jTmfyfu!3dfw!!!!!!!!!!!!!!!!*!UGPT`GDQ`FQZU`QBNXPEBIT!)efojgfe!gjmf$!!!!!!!!!!!!<*!1/:!0!1/2!)!+!*!!!!!!!!!!!!!!!!*!{/esppDxpebit!-*!2ze!-2ye!)3dfw!,!zy/esppDxpebit!-qbNxpebit!)fsbqnpDE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*!{/esppDxpebit!-*!2ze!-1/1!)3dfw!,!zy/esppDxpebit!-qbNxpebit!)fsbqnpDE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*!{/esppDxpebit!-*!2ze!-1ye!)3dfw!,!zy/esppDxpebit!-qbNxpebit!)fsbqnpDE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*!{/esppDxpebit!-*!1/1!-2ye!)3dfw!,!zy/esppDxpebit!-qbNxpebit!)fsbqnpDE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*!{/esppDxpebit!-zy/esppDxpebit!-qbNxpebit!)fsbqnpDE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*!{/esppDxpebit!-*!1/1!-1ye!)3dfw!,!zy/esppDxpebit!-qbNxpebit!)fsbqnpDE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*!{/esppDxpebit!-*!1ze!-2ye!)3dfw!,!zy/esppDxpebit!-qbNxpebit!)fsbqnpDE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*!{/esppDxpebit!-*!1ze!-1/1!)3dfw!,!zy/esppDxpebit!-qbNxpebit!)fsbqnpDE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*!{/esppDxpebit!-*!1ze!-1ye!)3dfw!,!zy/esppDxpebit!-qbNxpebit!)fsbqnpDE3fsvuyfu!!!!!!!!!!!!!!!!!!!!)!>!xpebit!!!!!!!!!!!!!!!!<tvjebSxpebit!+!z/f{jTmfyfu!,!>!2ze!ubpmg!!!!!!!!!!!!!!!!<tvjebSxpebit!+!y/f{jTmfyfu!,!>!2ye!ubpmg!!!!!!!!!!!!!!!!<tvjebSxpebit!+!z/f{jTmfyfu!.!>!1ze!ubpmg!!!!!!!!!!!!!!!!<tvjebSxpebit!+!y/f{jTmfyfu!.!>!1ye!ubpmg!!!!!!!!!!!!!!!!<f{jTqbNxpebit!0!*!1/2!)3dfw!>!f{jTmfyfu!3dfw!!!!!!!!!!!!!!!!*!GDQ`FQZU`QBNXPEBIT!)efojgfe!gj$!!!!!!!!!!!!|!*!utfUnvutvsg!)!gj!!!!!!!!!!!!<*!dfWutfUnvutvsg!)mmb!>!utfUnvutvsg!mppc!!!!!!!!!!!!<*!1/2!>=!{/esppDxpebit!-nvutvsGoj!)3dfwc!>!dfWutfUnvutvsg!3dfwc!!!!!!!!!!!!<*!dfWnvutvsGoj!)mmb!>!nvutvsGoj!mppc!!!!!!!!!!!!<*!1/2!>=!z/esppDxpebit!-1/1!>?!z/esppDxpebit!-1/2!>=!y/esppDxpebit!-1/1!>?!y/esppDxpebit!)!5dfwc!>!dfWnvutvsGoj!5dfwc!!!!!!!!!!!!<tbjCxpebit!>,!{/esppDxpebit!!!!!!!!!!!!<x/esppDxpebit!>0!{zy/esppDxpebit!!!!!!!!!!!!<1/2!>!xpebit!ubpmg!!!!!!!!!!!!|!*!esppDxpebit!5dfw!-tvjebSxpebit!ubpmg!-tbjCxpebit!ubpmg!-f{jTqbNxpebit!3dfw!-qbNxpebit!E3sfmqnbt!)xpebiTufh!ubpmg!!!!!!!!~!!!!!!!!<d!osvufs!!!!!!!!!!!!<*!y/g!-c!-b!)yjn!>!d!ubpmg!!!!!!!!!!!!<*!z/g!-us!-cs!)yjn!>!c!ubpmg!!!!!!!!!!!!<*!z/g!-um!-cm!)yjn!>!b!ubpmg!!!!!!!!!!!!<*!6/1!,!f{jt!+!wv!)udbsg!>!g!3dfw!!!!!!!!!!!!<*!fsbqnpd!-zz/uftggp!+!f{jTmfyfu!,!WVejpsuofd!-tiuqfe!)fsbqnpDE3fsvuyfu!>!us!ubpmg!!!!!!!!!!!!<*!fsbqnpd!-yz/uftggp!+!f{jTmfyfu!,!WVejpsuofd!-tiuqfe!)fsbqnpDE3fsvuyfu!>!cs!ubpmg!!!!!!!!!!!!<*!fsbqnpd!-zy/uftggp!+!f{jTmfyfu!,!WVejpsuofd!-tiuqfe!)fsbqnpDE3fsvuyfu!>!um!ubpmg!!!!!!!!!!!!<*!fsbqnpd!-yy/uftggp!+!f{jTmfyfu!,!WVejpsuofd!-tiuqfe!)fsbqnpDE3fsvuyfu!>!cm!ubpmg!!!!!!!!!!!!<f{jt!0!*!6/1!,!f{jt!+!wv!)sppmg!>!WVejpsuofd!3dfw!!!!!!!!!!!!<f{jt!0!*!1/2!)3dfw!>!f{jTmfyfu!3dfw!!!!!!!!!!!!<*!1/2!-1/1!)3dfw!>!uftggp!3dfw!utopd!!!!!!!!!!!!|!*!fsbqnpd!ubpmg!-wv!3dfw!-f{jt!3dfw!-tiuqfe!E3sfmqnbt!)qsfMxpebiTE3fsvuyfu!ubpmg!!!!!!!!~!!!!!!!!<*!*!*!wv!-tiuqfe!)E3fsvuyfu!)iuqfEpUBCHSldbqov!-fsbqnpd!)qfut!osvufs!!!!!!!!!!!!|!*!fsbqnpd!ubpmg!-wv!3dfw!-tiuqfe!E3sfmqnbt!)fsbqnpDE3fsvuyfu!ubpmg!!!!!!!!~!!!!!!!!<*!tspudbGldbqoV!-w!)upe!osvufs|!*!w!5dfw!oj!utopd!)iuqfEpUBCHSldbqov!ubpmg!!!!!!!!<*!/2!-tspudbGldbQ!)5dfw!0!fmbdtoxpEldbqoV!>!tspudbGldbqoV!5dfw!utopd!!!!!!!!<*!/763!!-/763!+!/763!-/763!+!/763!+!/763!)4dfw!>!tspudbGldbQ!4dfw!utopd!!!!!!!!<*2!hojevmdyf)!opjudbsg!?.!2//1!00!</763!0!/663!>!fmbdtoxpEldbqoV!ubpmg!utopd!!!!!!!!<*2!hojevmdoj)!2//1!?.!opjudbsg!00!</663!0!/763!>!fmbdtqVldbQ!ubpmg!utopd!!!!!!!!<esppDxpebit!5dfw!hojzsbw<fwjfdfSxpebit!mppc!nspgjov<tvjebSxpebit!ubpmg!nspgjov<tbjCxpebit!ubpmg!nspgjov<zujtofuoJxpebit!ubpmg!nspgjov<f{jTxpebit!3dfw!nspgjov<qbNxpebit!E3sfmqnbt!nspgjov<mmvDxpebit!mppc!nspgjov!QBNXPEBIT`FTV!gfegj$!!gjeof$!<fdobutjEfojMw!ubpmg!hojzsbw<fdobutjEqbHitbEv!ubpmg!nspgjov<fdobutjEitbEv!ubpmg!nspgjov<itbEv!mppc!nspgjov!ITBE!gfegj$!!gjeof$!!gjeof$!<sbGhpGv!ubpmg!nspgjov<sbfOhpGv!ubpmg!nspgjov!ftmf$!<zujtofEhpGv!ubpmg!nspgjov!3QYF`HPG!gfegj$!<spmpDhpGv!5dfw!nspgjov!HPG!gfegj$!!gjeof$!<^UPQT`YBN]opjudfsjEupqTv!4dfw!nspgjov<^UPQT`YBN]opjujtpQupqTv!4dfw!nspgjov<^UPQT`YBN]fhobSupqTv!ubpmg!nspgjov<^UPQT`YBN]fmhoBupqTv!ubpmg!nspgjov<^UPQT`YBN]uofopqyFupqTv!ubpmg!nspgjov<^UPQT`YBN]spmpDupqTv!5dfw!nspgjov!1!?!UPQT`YBN!gj$!!gjeof$!<^UOJPQ`YBN]opjujtpQuojpQv!4dfw!nspgjov<^UOJPQ`YBN]fhobSuojpQv!ubpmg!nspgjov<^UOJPQ`YBN]spmpDuojpQv!5dfw!nspgjov!1!?!UOJPQ`YBN!gj$!!gjeof$!<^SJE`YBN]opjudfsjEsjEv!4dfw!nspgjov<^SJE`YBN]spmpDsjEv!5dfw!nspgjov!1!?!SJE`YBN!gj$!!gjeof$!<eofmCidubCw!4dfw!hojzsbw<eofmCidubCv!mppc!nspgjov!EOFMCIDUBC!gfegj$!!gjeof$!<ttfouihjsCidubCw!ubpmg!hojzsbw<ttfouihjsCidubCv!mppc!nspgjov!TTFOUIHJSCIDUBC!gfegj$!!gjeof$!<spmpDidubCw!5dfw!hojzsbw<spmpDidubCv!mppc!nspgjov!SPMPDIDUBC!gfegj$!<spmpDuihjmebfIv!5dfw!nspgjov<zujtofuoJuofjcnBuihjmebfIv!ubpmg!nspgjov<fhobSuihjmebfIv!ubpmg!nspgjov<emspXw!4dfw!hojzsbw<opjujtpQbsfnbDv!4dfw!nspgjov<yjsubNxfjWv!5ubn!nspgjov!gjeof$!<zujwjudfmgfSv!ubpmg!nspgjov<qbNwoFv!fcvDsfmqnbt!nspgjov<qbNwoFftVv!mppc!nspgjov!QBNWOF`FTV!gfegj$!<opjujtpQw!4dfw!hojzsbw<yfusfWw!4dfw!hojzsbw<mbnspOw!4dfw!hojzsbw<ftvggjEv!5dfw!nspgjov<zujdbqPusbQv!ubpmg!nspgjov<ttfouihjsCv!ubpmg!nspgjov<uihjMv!mppc!nspgjov<spmpDeofmCv!5dfw!nspgjov<eofmCv!mppc!nspgjov<uofdsfQqjmDv!ubpmg!nspgjov<opjudfsjEqjmDv!uoj!nspgjov<sfmqnbTeofmCv!E3sfmqnbt!nspgjov<sfmqnbTv!E3sfmqnbt!nspgjov<wVw!3dfw!hojzsbw<fsvuyfUeofmCv!mppc!nspgjov<fsvuyfUv!mppc!nspgjov<uofsbqtobsUv!mppc!nspgjov<utfUbiqmBv!ubpmg!nspgjov<spmpDftsfwfSldjQyjGv!5dfw!nspgjov<qjmGftsfwfSv!mppc!nspgjov<ldjQv!mppc!nspgjov<yjGv!mppc!nspgjov<fmcbudfmfTesbdtjEv!mppc!nspgjov!YJGFSQ!gjeof$!!gjeof$!!<ubpmg!qnvjefn!opjtjdfsq!!ftmf$!!<ubpmg!qihji!opjtjdfsq!!IHJI`OPJTJDFSQ`UOFNHBSG`MH!gfegj$!!TF`MH!gfegj$!";
        gp(D, { setBatchInfo: function(o, u) { mm[o] = u }, getBatchInfo: function(n) { return mm[n] }, getBatchInfoMap: function() { return mm }, setBatchInfoMap: function(C) { mm = C } }, !0);
        var Wp = [1, 1, 1],
            Mk = [1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1],
            Ko = [1, 0, 0, 0, 0, 1, 0, 1, 1, 1, 1, 0],
            rm = [-.5, .5, .5, -.5, .5, -.5, -.5, -.5, -.5, -.5, -.5, -.5, -.5, -.5, .5, -.5, .5, .5],
            ig = [.5, .5, -.5, .5, .5, .5, .5, -.5, .5, .5, -.5, .5, .5, -.5, -.5, .5, .5, -.5],
            am = [.5, .5, -.5, -.5, .5, -.5, -.5, .5, .5, -.5, .5, .5, .5, .5, .5, .5, .5, -.5],
            Ke = [.5, -.5, .5, -.5, -.5, .5, -.5, -.5, -.5, -.5, -.5, -.5, .5, -.5, -.5, .5, -.5, .5],
            Pr = [.5, .5, .5, -.5, .5, .5, -.5, -.5, .5, -.5, -.5, .5, .5, -.5, .5, .5, .5, .5],
            Nm = [-.5, .5, -.5, .5, .5, -.5, .5, -.5, -.5, .5, -.5, -.5, -.5, -.5, -.5, -.5, .5, -.5],
            eb = function(G, c) {
                var b = G._40Q;
                b.each(function(m) { m.ivBatch(c) })
            },
            Fd = function(h, y, M) {
                var s = M._id,
                    k = y[s];
                if (k) {
                    var w = k.batch,
                        P = h[w],
                        z = P.ds,
                        A = k.index;
                    if (P.invalidate = !0, delete y[s], z.splice(A, 1), se(z)) return delete h[w], void 0;
                    for (var p = k.begin, R = k.size, n = 3 * p, u = 3 * R, I = 4 * p, Z = 4 * R, D = P.vs, i = P.ps, v = P.uv, q = P.cs, Q = P.bs, d = P.rs, $ = P.ns, J = P.ls; A < z.length; A++) k = y[z[A]._id], k.index--, k.begin -= R;
                    D.splice(n, u), i.splice(I, Z), v && v.splice(2 * p, 2 * R), q && q.splice(I, Z), Q && Q.splice(n, u), d && d.splice(p, R), $ && $.splice(n, u), J && J.splice(p, R)
                }
            },
            mg = function(V, I, T, v, x) {
                if (!v) return A;
                var H = I[v];
                if (!H) {
                    var m = x.getBatchInfo(v) || pk,
                        L = m.image ? [] : A;
                    H = I[v] = { vs: [], ns: [], uv: L, cs: L ? A : m.color ? A : [], bs: m.blend ? [] : A, ps: [], rs: m.brightness ? [] : A, ds: [] }
                }
                return H.invalidate = !0, V[T._id] = { index: H.ds.length, begin: H.vs.length / 3, batch: v }, H.ds.push(T), H
            },
            Kp = function(W, Y) { return Y != A && 1 !== Y ? [W[0] * Y, W[1] * Y, W[2] * Y, W[3]] : W },
            Vj = function(o) {
                var Y = o.shapeModel;
                Y || (Y = bl(o)), Y && (Y._ctlineModel = [], Y._lineModel = O)
            },
            im = function() {
                var Z;
                return function(V, z, M) {
                    var c = V.getData3dUI(z),
                        F = c.shapeModel;
                    if (F || (F = bl(c)), F || !c.shapeName) {
                        var r, B = z.s("wf.combineTriangle");
                        if (M.geometry) {
                            if (!F && (z instanceof k.Node && !(z instanceof k.Shape) ? (Z || (Z = { vs: Nf, is: yk, uv: Lb }), F = Z) : F = [c.left, c.front, c.right, c.back, c.top, c.bottom], !F)) return O;
                            if (B) {
                                var E = z.s("wf.normEpsilon");
                                isNaN(E) && (E = 2), B = 0 | Math.min(3, Math.max(1, isNaN(B) ? 1 : B)), r = Ab[B - 1](F, c, 180 / (Math.PI * E))
                            } else r = Yo(F, c);
                            if (!r || 0 === r.length) return
                        } else r = M.short ? gi : xl;
                        var b = V.getBrightness(z),
                            W = z.s("bloom"),
                            y = z.s("3d.reflectable"),
                            L = Lf(M.color || "white"),
                            s = L[3] < 1,
                            u = Math.ceil(M.width) || 1,
                            e = (s ? "T" : "O") + (W ? "_1" : "_0") + (y ? "1_" : "0_") + u,
                            A = z.getRenderLayer(),
                            d = V._40Q.get(A),
                            v = d.wireframeIndexMap,
                            X = d.wireframeModelMap,
                            g = X[e];
                        g || (g = X[e] = { vs: [], cs: [], ps: [], ds: [], T: s, B: W, reflectable: !!y, W: u }), g.invalidate = !0;
                        var I = g.vs,
                            h = g.cs,
                            R = g.ds,
                            K = v[z._id] = { index: R.length, begin: I.length / 3, batch: e };
                        R.push(z);
                        var C = c.mat;
                        z instanceof k.Edge || !(!C || !M.geometry && z instanceof k.Shape) || (C = Rp(z, M.mat), z.appendAnchorMatrix3d(C)), uk(I, C, r);
                        var x = K.size = I.length / 3 - K.begin;
                        or(h, Kp(L, b), x)
                    }
                }
            }(),
            $j = function(I, $, u, E, e, z, h, n, T) {
                var f = I.getBrightness($);
                f == A && (f = 1);
                var _ = Kp(Lf(E), f),
                    Q = _[3] < 1;
                z = Math.ceil(z) || 1;
                var b = (Q ? "T" : "O") + z;
                if (h) {
                    var g = h[0],
                        s = (h[1] || g) + g;
                    b += "-" + g + "-" + s, T && (b += "-" + qj(T) + "-" + f, T = Kp(Lf(T), f))
                }
                var Z = $.getRenderLayer(),
                    W = I._40Q.get(Z),
                    x = W.polylineIndexMap,
                    D = W.polylineModelMap,
                    Y = D[b];
                Y || (Y = D[b] = { vs: [], cs: [], ps: [], ds: [], ls: h ? [] : A, T: Q, W: z }, h && (Y.D = g, Y.G = s, Y.A = T)), Y.invalidate = !0;
                var o, t = Y.vs,
                    y = Y.cs,
                    p = Y.ds,
                    q = Y.ls,
                    d = x[$._id] = { index: p.length, begin: t.length / 3, batch: b };
                p.push($), no(t, u);
                var k, w = d.size = t.length / 3 - d.begin,
                    L = u.length,
                    H = 0,
                    l = [];
                if (h || e)
                    for (o = 0; L > o; o += 6) k = _q([u[o], u[o + 1], u[o + 2]], [u[o + 3], u[o + 4], u[o + 5]]), l.push(k), H += k;
                if (H && e) {
                    var v, i = Kp(Lf(e), f),
                        J = [i[0] - _[0], i[1] - _[1], i[2] - _[2], i[3] - _[3]],
                        V = 0;
                    for (o = 0; L > o; o += 6) v = V / H, or(y, [_[0] + J[0] * v, _[1] + J[1] * v, _[2] + J[2] * v, _[3] + J[3] * v], 1), V += l[o / 6], v = V / H, or(y, [_[0] + J[0] * v, _[1] + J[1] * v, _[2] + J[2] * v, _[3] + J[3] * v], 1)
                } else or(y, _, w);
                if (h)
                    for (V = n || 0, o = 0; L > o; o += 6) q.push(V), V += l[o / 6], q.push(V)
            },
            mr = function(i, E, Z) {
                if (E) {
                    var e = 4 * E.begin,
                        O = Z[E.batch].ps;
                    if (O[e] !== i[0] || O[e + 1] !== i[1] || O[e + 2] !== i[2] || O[e + 3] !== i[3]) {
                        for (var g = 0; g < E.size; g++) O[e++] = i[0], O[e++] = i[1], O[e++] = i[2], O[e++] = i[3];
                        O._invalidateThisFrame = !0
                    }
                }
            },
            vn = function() {
                var o = new k.Math.Vector3,
                    $ = new k.Math.Vector3;
                return function(U, K) {
                    var W = K + ["32"],
                        Q = U[K],
                        R = U[W];
                    if (Q) {
                        if (D.extractBatchTranslation && "vs" === K) {
                            $.set(0, 0, 0);
                            for (var k = Q.length, T = 0; k > T; T += 3) $.add(o.fromArray(Q, T));
                            $.divideScalar(k / 3);
                            for (var G = $.x, N = $.y, q = $.z, f = new Array(k), T = 0; k > T; T += 3) f[T] = Q[T] - G, f[T + 1] = Q[T + 1] - N, f[T + 2] = Q[T + 2] - q;
                            Q = f, U.translate = [G, N, q]
                        }
                        R && R.length === Q.length ? (R.set(Q), R._bufId = null) : U[W] = new ss(Q)
                    } else delete U[W]
                }
            }(),
            Qi = function(f, n, C, M, D, i, w, v, o) {
                if (ud(C)) C.forEach(function(Z) { Qi(f, n, Z, M, D, i, w, v, o) });
                else if (Ok(C)) Qi(f, n, bl(M, C), M, D, i, w, v, o);
                else if (zg(C)) {
                    var g, E = Rr(C.mat, n, f),
                        W = Rr(C.s3, n, f),
                        V = Rr(C.t3, n, f),
                        L = Rr(C.r3, n, f);
                    if ((W || L || V || E) && (g = cq(E, W, L, Rr(C.rotationMode, n, f), V), i.push(g)), C.shape3d) Qi(f, n, C.shape3d, M, D, i, w, v, C);
                    else {
                        var x = M.s;
                        o = o || pk;
                        var j = i[0],
                            u = i.length,
                            m = x("shape3d.color", C.color, o.color);
                        if (D || (D = x("shape3d.blend", C.blend, o.blend)), u > 1) { j = Ac(j); for (var X = 1; u > X; X++) lk(j, j, i[X]) }
                        C.vs && x(Rn, C.visible, o.visible) && Jh(j, w, v, C.vs, C.uv, C.is, D, m), C.top_vs && x(Yf, C.topVisible, o.topVisible) && Jh(j, w, v, C.top_vs, C.top_uv, C.top_is, D, x("shape3d.top.color", C.topColor, o.topColor) || m), C.bottom_vs && x(wp, C.bottomVisible, o.bottomVisible) && Jh(j, w, v, C.bottom_vs, C.bottom_uv, C.bottom_is, D, x("shape3d.bottom.color", C.bottomColor, o.bottomColor) || m), C.from_vs && x(Ze, C.fromVisible, o.fromVisible) && Jh(j, w, v, C.from_vs, C.from_uv, C.from_is, D, x("shape3d.from.color", C.fromColor, o.fromColor) || m), C.to_vs && x(Jb, C.toVisible, o.toVisible) && Jh(j, w, v, C.to_vs, C.to_uv, C.to_is, D, x("shape3d.to.color", C.toColor, o.toColor) || m)
                    }
                    g && i.pop()
                }
            },
            Jh = function(V, r, I, P, w, o, x, b) {
                var W, e = r.cs,
                    N = r.uv,
                    n = r.bs;
                if (o) {
                    W = o.length;
                    for (var H = 0; W > H; H++) {
                        var a = o[H];
                        uk(I, V, [P[3 * a], P[3 * a + 1], P[3 * a + 2]]), N && no(N, [w[2 * a], w[2 * a + 1]])
                    }
                } else W = P.length / 3, uk(I, V, P), N && no(N, w);
                e && or(e, b, W), n && (x ? tc(n, x, W) : no(n, Wp, W))
            },
            ym = function(P, K, Q, S) {
                var m = [];
                S ? Qi(P.gv, P.data, S, P, P.getBodyColor(), [K], Q, m) : (Tg(P, Ui, K, Q, m), Tg(P, Ul, K, Q, m), Tg(P, Pi, K, Q, m), Tg(P, Qj, K, Q, m), Tg(P, Gm, K, Q, m), Tg(P, uq, K, Q, m), Tg(P, "csg", K, Q, m)), m.length && (no(Q.vs, m), no(Q.ns, Dc(m)))
            },
            Tg = function(C, U, R, w, e) {
                var P = C[U];
                if (P) {
                    var r = P.tuv;
                    if (r) {
                        var S = P.uvScale,
                            o = P.uvOffset,
                            g = P.uvRotation;
                        if (S || o || g) {
                            var O, N, E, B = Xm(g, o, S),
                                T = B.a,
                                x = B.b,
                                k = B.c,
                                $ = B.d,
                                L = B.tx,
                                h = B.ty,
                                G = r.length;
                            for (E = 0; G > E; E += 2) O = r[E], N = r[E + 1], r[E] = T * O + k * N + L, r[E + 1] = x * O + $ * N + h
                        }
                    }
                    Jh(R, w, e, P.vs, r, A, P.blend, P.color)
                }
            },
            Ei = function(g, W, q, s, d, V, r, T) {
                var U, c = q.cs,
                    n = q.uv,
                    p = q.bs;
                if (g.getFaceVisible(W, V)) {
                    var Y = g.getFaceMat(W, V);
                    if (Y && (d = Rp(W, Y)), uk(r, d, T), c && or(c, g.getFaceColor(W, V), 6), n) {
                        var O = g.getFaceUv(W, V) || s[V + "Uv"],
                            y = g.getFaceUvScale(W, V) || s[V + "UvScale"],
                            H = g.getFaceUvOffset(W, V) || s[V + "UvOffset"],
                            Q = g.getFaceUvRotation(W, V) || s[V + "UvRotation"];
                        O = O ? [O[6], O[7], O[0], O[1], O[2], O[3], O[2], O[3], O[4], O[5], O[6], O[7]] : Ko;
                        var j = O[0],
                            G = O[1],
                            b = O[2],
                            h = O[3],
                            _ = O[4],
                            e = O[5],
                            C = O[6],
                            A = O[7],
                            J = O[8],
                            t = O[9],
                            Z = O[10],
                            k = O[11];
                        if (y || H || Q) {
                            var D = Xm(Q, H, y),
                                M = D.a,
                                I = D.b,
                                S = D.c,
                                X = D.d,
                                R = D.tx,
                                $ = D.ty;
                            j = M * j + S * G + R, G = I * j + X * G + $, b = M * b + S * h + R, h = I * b + X * h + $, _ = M * _ + S * e + R, e = I * _ + X * e + $, C = M * C + S * A + R, A = I * C + X * A + $, J = M * J + S * t + R, t = I * J + X * t + $, Z = M * Z + S * k + R, k = I * Z + X * k + $
                        }
                        n.push(j, G, b, h, _, e, C, A, J, t, Z, k)
                    }
                    p && (U = g.getBodyColor(W) || g.getFaceBlend(W, V), U ? tc(p, U, 6) : no(p, Wp, 6))
                }
            },
            Kk = function(M, U, T, j) {
                var T = M._picking ? M.pickColorMap : null,
                    q = M.getGL(),
                    s = M._prg,
                    p = M._buffer;
                if (!ef(U)) {
                    Vp(M, Mk), Sc(q, s);
                    for (var L in U) {
                        var y = U[L];
                        if (!(j && !y.T || !j && y.T || M.isReflecting(q) && y.reflectable === !1)) {
                            y.invalidate ? (y.invalidate = !1, vn(y, "vs"), vn(y, "cs"), vn(y, "ls"), vn(y, "ps")) : T && y.ps && y.ps._invalidateThisFrame && (y.ps._invalidateThisFrame = !1, vn(y, "ps"));
                            var b = y.translate;
                            b && Vp(M, [1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, b[0], b[1], b[2], 1]);
                            var I = y.vs32,
                                R = T ? y.ps32 : y.cs32;
                            _o(q, s, y.W, A, p.vs, I);
                            var H = Jg.for(q),
                                Q = H.directUniforms(),
                                N = H.directAttribs(),
                                F = y.D,
                                J = !M._dashDisabled && F;
                            Q.uAlphaTest = h.alphaTest, q._blooming && !y.B && (Q.blackout = !0), J && (Q.uDash = !0, Q.uDashDistance = F, Q.uDashGapDistance = y.G, Q.uDiffuse = y.A || h["color.empty"], N.aLineDistance = Qm(q, p.lineDistance, y.ls32, A, 1));
                            var c = !M._batchColorDisabled;
                            c && R.length ? (Q.uBatchColor = !0, N.aBatchColor = Qm(q, p.batchColor, R, A, 4)) : (Q.uBatchColor = !1, N.aBatchColor = !1), Lg(q), xc(q, 0, I.length / 3, q.LINES), Th(q), c && (Q.uBatchColor = !1, N.aBatchColor = !1), J && (Q.uDash = !1, N.aLineDistance = !1), q._blooming && !y.B && (Q.blackout = !1), b && lf(M)
                        }
                    }
                    Ih(q, s), lf(M)
                }
            },
            Ie = function(e) { e.invalidate = !1, vn(e, "vs"), vn(e, "ns"), vn(e, "cs"), vn(e, "rs"), vn(e, "ps"), vn(e, "bs"), vn(e, "uv") },
            Td = function(F, m, z, E, Y) {
                var l, n, U, G, p, c, B, N, X, C, x, Z, z = F._picking ? F.pickColorMap : null,
                    o = F.getGL(),
                    _ = F._prg,
                    f = Jg.for(o),
                    q = f.directUniforms(),
                    W = f.directAttribs(),
                    D = F._buffer;
                if (!ef(m) && !F.drawFilter) {
                    Vp(F, Mk);
                    for (l in m)
                        if (n = F.getBatchInfo(l) || pk, n.visible !== !1 && !(E && !n.transparent || !E && n.transparent || F.isReflecting(o) && n.reflectable === !1)) {
                            var a = n.renderLayerMask;
                            if (a == A && (a = Mg), Y == A && (Y = Mg), kp(Y, a) && (U = m[l], z || !n.transparentMask)) {
                                var Q = E && n.autoSort === !0 && (F._33Q || U.invalidate);
                                if (U.invalidate ? Ie(U) : z && U.ps && U.ps._invalidateThisFrame && (U.ps._invalidateThisFrame = !1, vn(U, "ps")), p = U.vs32, c = z ? U.ps32 : U.cs32, X = U.uv32, B = U.bs32, N = U.rs32, x = p.length / 3, Q) {
                                    var k = Hg(p, F.getEye(), F);
                                    k ? (U.is = k.is, U.elementTypeUint = k.useUint32) : (U.is = null, U.elementTypeUint = null)
                                }
                                if (x) {
                                    Z = U.translate, Z && Vp(F, [1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, Z[0], Z[1], Z[2], 1]), G = n.light, C = F.getTexture(n.image), Ge(o, _, A, n.light, n.opacity, n.reverseFlip, n.reverseColor, n.reverseCull), c ? F._batchColorDisabled ? (q.uBatchColor = !1, W.aBatchColor = !1) : (q.uBatchColor = !0, W.aBatchColor = Qm(o, D.batchColor, c, A, 4)) : (q.uBatchColor = !1, q.uDiffuse = n.color || h["color.empty"]);
                                    var H = n.alphaTest;
                                    q.uAlphaTest = H === O ? h.alphaTest : H, q.shadowReceive = !z && n.shadowReceive !== !1, o._blooming && !n.bloom && (q.blackout = !0), n.envmap !== O ? (q.uUseEnvMap = !0, q.uReflectivity = n.envmap) : (q.uUseEnvMap = !1, q.uReflectivity = 0);
                                    var L = B && !F._batchBlendDisabled;
                                    L && (q.uBatchBlend = !0, W.aBatchBlend = Qm(o, D.batchBlend, B, A));
                                    var T = N && !F._batchBrightnessDisabled;
                                    T && (q.uBatchBrightness = !0, W.aBatchBrightness = Qm(o, D.batchBrightness, N, A, 1)), X ? Lg(o, _, C, n.discardSelectable, D.uv, X, n.uvOffset, n.uvScale, n.uvRotation) : Lg(o), W.aPosition = Qm(o, D.vs, p, A), W.aNormal = Qm(o, D.ns, U.ns32, A), U.is ? (Dh(o, D.is, U.is), pc(o, 0, x, null, U.elementTypeUint ? o.UNSIGNED_INT : null)) : xc(o, 0, x), X ? Th(o, _, C) : Th(o), c && !F._batchColorDisabled && (q.uBatchColor = !1, W.aBatchColor = !1), L && (q.uBatchBlend = !1, W.aBatchBlend = !1), T && (q.uBatchBrightness = !1, W.aBatchBrightness = !1), o._blooming && !n.bloom && (q.blackout = !1), Xf(o, _), Z && lf(F)
                                }
                            }
                        }
                    lf(F)
                }
            },
            Hg = function(W, o, b) {
                var g = W.length / 3,
                    D = g > 65535,
                    f = b._glCapabilities.elementTypeUint && D;
                if (!f && D) return null;
                for (var K = new Array(g), A = g / 3, B = new Array(A), p = 0; A > p; p++) B[p] = p;
                B.sort(function(h, D) {
                    var Z = 9 * h,
                        A = [(W[Z] + W[Z + 3] + 2 * W[Z + 6]) / 4, (W[Z + 1] + W[Z + 4] + 2 * W[Z + 7]) / 4, (W[Z + 2] + W[Z + 5] + 2 * W[Z + 8]) / 4];
                    Z = 9 * D;
                    var k = [(W[Z] + W[Z + 3] + 2 * W[Z + 6]) / 4, (W[Z + 1] + W[Z + 4] + 2 * W[Z + 7]) / 4, (W[Z + 2] + W[Z + 5] + 2 * W[Z + 8]) / 4],
                        N = _q(o, A) - _q(o, k);
                    return N > 0 ? -1 : 0 > N ? 1 : 0
                });
                for (var p = 0; A > p; p++) {
                    var v = 3 * p,
                        h = 3 * B[p];
                    K[v] = h, K[v + 1] = h + 1, K[v + 2] = h + 2
                }
                return { useUint32: f, is: f ? new Uint32Array(K) : new jn(K) }
            },
            Pn = {
                obj: function(h, w) {
                    var C = {
                        mat: h.mat,
                        s3: h.s3,
                        r3: h.r3,
                        rotationMode: h.rotationMode,
                        t3: h.t3,
                        cube: h.cube == A ? !0 : h.cube,
                        center: h.center == A ? !0 : h.center,
                        ignoreMtls: h.ignoreMtls,
                        ignoreTransparent: h.ignoreTransparent,
                        ignoreColor: h.ignoreColor,
                        ignoreImage: h.ignoreImage,
                        ignoreNormal: h.ignoreNormal,
                        prefix: h.prefix,
                        flipY: h.flipY,
                        flipFace: h.flipFace,
                        reverseFlipMtls: h.reverseFlipMtls,
                        finishFunc: function(k, u) {
                            if (k) {
                                var u = [];
                                for (var S in k) {
                                    var A = k[S];
                                    u.rawS3 = A.rawS3, A.center && (u.center = A.center), u.push(A), h.eachModel && h.eachModel(S, A)
                                }
                                u.json = h, w(u)
                            } else w()
                        }
                    };
                    D.loadObj(h.obj, h.mtl, C)
                },
                bin: function(p, r) {
                    var X = { finishFunc: function(j) { j ? r(j) : r() } };
                    D.loadBin(p.url, X)
                }
            };
        D.getModelTypeHandlers = function() { return Pn }, D.setModelTypeHandler = function(G, O) { Pn[G] = O }, D.getModelTypeHandler = function(u) { return Pn[u] }, D.handleModelLoaded = function() {}, D.handleUnfoundModel = function() {};
        var Rh = A,
            ms = A,
            en = function(R) { Rh && !R._loadingModelView_ && (ms || (ms = {}), ms[R._loadingModelView_ = Ji()] = R) },
            Oi = function(J, h) {
                Rh || (Rh = {});
                var X = Rh[J];
                if (X) {
                    if (X.url === h) return;
                    X.request.onload = js, X.request.onerror = js
                }
                if (h.indexOf(".bin") === h.length - 4) return Sq(J, { modelType: "bin", url: h }, h);
                if (h = D.beforeLoadURL(h), h.data) {
                    var z = D.parse(h.data);
                    Sq(J, z, h)
                } else {
                    var Q = new Gq;
                    Rh[J] = { request: Q, url: h }, Q.onload = function() {
                        if (200 === this.status || 0 === this.status) {
                            delete Rh[J];
                            var s = D.parse(Q.getResponseText());
                            Sq(J, s, h)
                        } else Zf(J, D.handleUnfoundModel(J, h) || A)
                    }, Q.onerror = function() { Zf(J, D.handleUnfoundModel(J, h) || A) };
                    var o = {};
                    o.url = encodeURI(h), o.sync = !1, Q.send(o)
                }
            },
            Sq = function(z, M, B) {
                var s = M.modelType;
                if (!s) return Zf(z, M), D.handleModelLoaded(z, M), void 0;
                var m = D.getModelTypeHandler(s);
                if (m) {
                    if (Rh || (Rh = {}), Rh[z]) return;
                    Rh[z] = !0;
                    var f = function(s) { s ? (Zf(z, s), D.handleModelLoaded(z, s)) : Zf(z, D.handleUnfoundModel(z, B, M) || A) };
                    m(M, f)
                } else Zf(z, D.handleUnfoundModel(z, B, M) || A)
            },
            Zf = function(P, R) {
                if (delete Rh[P], Ok(R) && go.test(R)) return Oi(P, R), void 0;
                if (dm[P] = R, ef(Rh) && (Rh = A, ms)) {
                    for (var Z in ms) {
                        var x = ms[Z];
                        x.invalidateAll && x.invalidateAll(O, "modelLoaded", P), x.redraw && x.redraw(), x.iv(), delete x._loadingModelView_
                    }
                    ms = A
                }
                if (R && ms)
                    for (var Z in ms) {
                        var x = ms[Z];
                        x.invalidateAll && x.invalidateAll(O, "modelLoading", P), x.redraw && x.redraw(), x.iv()
                    }
            },
            Pl = new ss([0, 0, 0, 1, 1, 1, 1, 0]),
            Ad = new ss([0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1]),
            Kn = new jn([0, 1, 2, 2, 3, 0]),
            Nf = new ss([-.5, .5, -.5, -.5, -.5, -.5, -.5, -.5, .5, -.5, .5, .5, -.5, .5, .5, -.5, -.5, .5, .5, -.5, .5, .5, .5, .5, .5, .5, .5, .5, -.5, .5, .5, -.5, -.5, .5, .5, -.5, .5, .5, -.5, .5, -.5, -.5, -.5, -.5, -.5, -.5, .5, -.5, -.5, .5, -.5, -.5, .5, .5, .5, .5, .5, .5, .5, -.5, -.5, -.5, .5, -.5, -.5, -.5, .5, -.5, -.5, .5, -.5, .5]),
            yk = new jn([0, 1, 2, 0, 2, 3, 4, 5, 6, 4, 6, 7, 8, 9, 10, 8, 10, 11, 12, 13, 14, 12, 14, 15, 16, 17, 18, 16, 18, 19, 20, 21, 22, 20, 22, 23]),
            Lb = new ss([0, 0, 0, 1, 1, 1, 1, 0, 0, 0, 0, 1, 1, 1, 1, 0, 0, 0, 0, 1, 1, 1, 1, 0, 0, 0, 0, 1, 1, 1, 1, 0, 0, 0, 0, 1, 1, 1, 1, 0, 0, 0, 0, 1, 1, 1, 1, 0]),
            er = Dc(Nf, yk),
            ch = (new ss([-.5, .5, .5, -.5, -.5, .5, .5, -.5, .5, .5, .5, .5, .5, -.5, -.5, .5, .5, -.5, -.5, -.5, -.5, -.5, .5, -.5]), new jn([0, 1, 2, 3, 0, 7, 5, 4, 6, 7, 5, 3, 2, 4, 6, 1]), [Ui, Pi, Ul, Qj, Gm, uq]),
            xl = [-.5, .5, .5, -.5, -.5, .5, -.5, -.5, .5, .5, -.5, .5, .5, -.5, .5, .5, .5, .5, .5, .5, .5, -.5, .5, .5, -.5, .5, -.5, -.5, -.5, -.5, -.5, -.5, -.5, .5, -.5, -.5, .5, -.5, -.5, .5, .5, -.5, .5, .5, -.5, -.5, .5, -.5, .5, .5, .5, .5, .5, -.5, .5, -.5, .5, .5, -.5, -.5, -.5, .5, .5, -.5, .5, -.5, -.5, -.5, .5, -.5, -.5, -.5],
            gi = [-.5, .5, .5, -.4, .5, .5, -.5, .5, .5, -.5, .4, .5, -.5, .5, .5, -.5, .5, .4, .5, .5, .5, .4, .5, .5, .5, .5, .5, .5, .4, .5, .5, .5, .5, .5, .5, .4, -.5, -.5, .5, -.4, -.5, .5, -.5, -.5, .5, -.5, -.4, .5, -.5, -.5, .5, -.5, -.5, .4, .5, -.5, .5, .4, -.5, .5, .5, -.5, .5, .5, -.4, .5, .5, -.5, .5, .5, -.5, .4, -.5, .5, -.5, -.4, .5, -.5, -.5, .5, -.5, -.5, .4, -.5, -.5, .5, -.5, -.5, .5, -.4, .5, .5, -.5, .4, .5, -.5, .5, .5, -.5, .5, .4, -.5, .5, .5, -.5, .5, .5, -.4, -.5, -.5, -.5, -.4, -.5, -.5, -.5, -.5, -.5, -.5, -.4, -.5, -.5, -.5, -.5, -.5, -.5, -.4, .5, -.5, -.5, .4, -.5, -.5, .5, -.5, -.5, .5, -.4, -.5, .5, -.5, -.5, .5, -.5, -.4],
            Zd = function(Z, i, a, B, G, u, $) {
                u = u || 16, Z = Z || 16, i = i || 0, a = a || Z;
                var S, d, t, l, s, D, L, K, A, h = .5,
                    Y = [],
                    J = [],
                    z = m / Z,
                    E = U / u;
                for (S = 0; u > S; S++)
                    for (D = S + 1, l = S * E, A = D * E, d = i; a > d; d++) L = d + 1, t = d * z, K = L * z, Y.push(h * N(l) * C(t), h * C(l), -h * N(l) * N(t), h * N(A) * C(K), h * C(A), -h * N(A) * N(K), h * N(l) * C(K), h * C(l), -h * N(l) * N(K), h * N(l) * C(t), h * C(l), -h * N(l) * N(t), h * N(A) * C(t), h * C(A), -h * N(A) * N(t), h * N(A) * C(K), h * C(A), -h * N(A) * N(K)), J.push(d / Z, S / u, L / Z, D / u, L / Z, S / u, d / Z, S / u, d / Z, D / u, L / Z, D / u);
                if ($) { var W = []; for (S = 0, s = Y.length; s > S; S += 3) W.push(2 * Y[S], 2 * Y[S + 1], 2 * Y[S + 2]) }
                if (B) {
                    var X = [],
                        P = [];
                    for (t = i * z, S = 0; u > S; S++) D = S + 1, l = S * E, A = D * E, X.push(0, 0, 0, h * N(A) * C(t), h * C(A), -h * N(A) * N(t), h * N(l) * C(t), h * C(l), -h * N(l) * N(t)), P.push(0, .5, i / Z, D / u, i / Z, S / u)
                }
                if (G) {
                    var I = [],
                        e = [];
                    for (t = a * z, S = 0; u > S; S++) D = S + 1, l = S * E, A = D * E, I.push(0, 0, 0, h * N(l) * C(t), h * C(l), -h * N(l) * N(t), h * N(A) * C(t), h * C(A), -h * N(A) * N(t)), e.push(1, .5, a / Z, S / u, a / Z, D / u)
                }
                var b = { vs: Y, uv: J, from_vs: X, from_uv: P, to_vs: I, to_uv: e };
                return $ && (b.ns = W), b
            },
            qq = function(O, h, J) {
                O = O || .17, h = h || 12, J = J || 18, 0 > O ? O = 0 : O > .25 && (O = .25);
                var K, X, g, M, $, x, H, a = .5,
                    S = [],
                    d = [],
                    s = [],
                    k = m / J,
                    z = m / h,
                    i = a - O;
                for (X = 0; h >= X; X++)
                    for (M = -U + X * z, x = C(M), $ = N(M), K = 0; J >= K; K++) g = K * k, H = i + O * x, S.push(C(g) * H, $ * O, -N(g) * H), d.push(K / J, 1 - X / h);
                for (X = 0; h > X; X++) {
                    var Z = X * (J + 1),
                        R = (X + 1) * (J + 1);
                    for (K = 0; J > K; K++) s.push(Z + K, R + K + 1, R + K, Z + K, Z + K + 1, R + K + 1)
                }
                return { vs: S, uv: d, is: s }
            },
            gs = function(s, L, H, i, g, D, f, F) {
                f = f || 12, s = s || 18, L = L || 0, H = H || s, D = D || .17, 0 > D ? D = 0 : D > .25 && (D = .25);
                var A, w, M, W, h, Z, o, P, l, j, k = .5,
                    G = [],
                    y = [],
                    e = m / s,
                    n = m / f,
                    t = k - D,
                    S = F ? [] : O;
                for (M = 0; f > M; M++)
                    for (W = M + 1, o = -U + M * n, P = -U + W * n, A = L; H > A; A++) w = A + 1, h = A * e, Z = w * e, l = t + D * C(o), j = t + D * C(P), G.push(C(h) * l, N(o) * D, -N(h) * l, C(Z) * l, N(o) * D, -N(Z) * l, C(Z) * j, N(P) * D, -N(Z) * j, C(h) * l, N(o) * D, -N(h) * l, C(Z) * j, N(P) * D, -N(Z) * j, C(h) * j, N(P) * D, -N(h) * j), y.push(A / s, 1 - M / f, w / s, 1 - M / f, w / s, 1 - W / f, A / s, 1 - M / f, w / s, 1 - W / f, A / s, 1 - W / f), F && S.push(C(h) * C(o), N(o), -N(h) * C(o), C(Z) * C(o), N(o), -N(Z) * C(o), C(Z) * C(P), N(P), -N(Z) * C(P), C(h) * C(o), N(o), -N(h) * C(o), C(Z) * C(P), N(P), -N(Z) * C(P), C(h) * C(P), N(P), -N(h) * C(P));
                if (i) {
                    var c = [],
                        x = [];
                    for (M = 0; f > M; M++) W = M + 1, o = -U + M * n, P = -U + W * n, h = L * e, l = t + D * C(o), j = t + D * C(P), c.push(C(h) * l, N(o) * D, -N(h) * l, C(h) * j, N(P) * D, -N(h) * j, C(h) * t, 0, -N(h) * t), x.push(.5 + .5 * C(o), .5 - .5 * N(o), .5 + .5 * C(P), .5 - .5 * N(P), .5, .5)
                }
                if (g) {
                    var u = [],
                        b = [];
                    for (M = 0; f > M; M++) W = M + 1, o = -U + M * n, P = -U + W * n, h = H * e, l = t + D * C(o), j = t + D * C(P), u.push(C(h) * l, N(o) * D, -N(h) * l, C(h) * t, 0, -N(h) * t, C(h) * j, N(P) * D, -N(h) * j), b.push(.5 - .5 * C(o), .5 - .5 * N(o), .5, .5, .5 - .5 * C(P), .5 - .5 * N(P))
                }
                var E = { vs: G, uv: y, from_vs: c, from_uv: x, to_vs: u, to_uv: b };
                return F && (E.ns = S), E
            },
            $r = function(V, g) {
                for (var E, p, n, M = .5, Y = 16, T = [], k = [], B = [], I = m / Y, L = 0; Y >= L; L++) E = L * I, p = C(E) * M, n = N(E) * M, T.push(p, -M, n, p, M, n), k.push(1 - L / Y, 1, 1 - L / Y, 0);
                for (L = 0; Y > L; L++) B.push(2 * L, 2 * L + 1, 2 * L + 3, 2 * L, 2 * L + 3, 2 * L + 2);
                if (g) {
                    var $ = [],
                        o = [],
                        z = [];
                    for ($.push(0, -M, 0), o.push(.5, .5), L = 0; Y >= L; L++) E = L * I, p = C(E), n = N(E), $.push(p * M, -M, -n * M), o.push(.5 + .5 * p, .5 + .5 * n);
                    for (L = 0; Y > L; L++) z.push(0, L + 2, L + 1)
                }
                if (V) {
                    var s = [],
                        U = [],
                        h = [];
                    for (s.push(0, M, 0), U.push(.5, .5), L = 0; Y >= L; L++) E = L * I, p = C(E), n = N(E), s.push(p * M, M, -n * M), U.push(.5 + .5 * p, .5 - .5 * n);
                    for (L = 0; Y > L; L++) h.push(0, L + 1, L + 2)
                }
                return { vs: T, uv: k, is: B, bottom_vs: $, bottom_uv: o, bottom_is: z, top_vs: s, top_uv: U, top_is: h }
            },
            kj = function(l, h, b, M, B, f, K, a) {
                l = l || 12, h = h || 0, b = b || l;
                for (var y, $, x, n, S, T, z, Y, v, s = .5, L = [], H = [], W = m / l, F = h; b > F; F++) y = F + 1, $ = F * W, x = y * W, n = C($) * s, S = N($) * s, T = C(x) * s, z = N(x) * s, L.push(n, -s, -S, T, -s, -z, n, s, -S, T, -s, -z, T, s, -z, n, s, -S), H.push(F / l, 1, y / l, 1, F / l, 0, y / l, 1, y / l, 0, F / l, 0);
                if (a) { var i = []; for (F = 0, v = L.length; v > F; F += 3) i.push(2 * L[F], 0, 2 * L[F + 2]) }
                if (K) {
                    var U = [],
                        q = [];
                    for (F = h; b > F; F++) $ = W * F, x = W * (F + 1), n = C($), S = N($), T = C(x), z = N(x), U.push(n * s, -s, -S * s, 0, -s, 0, T * s, -s, -z * s), q.push(.5 + .5 * n, .5 + .5 * S, .5, .5, .5 + .5 * T, .5 + .5 * z)
                }
                if (f) {
                    var o = [],
                        e = [];
                    for (F = h; b > F; F++) $ = W * F, x = W * (F + 1), n = C($), S = N($), T = C(x), z = N(x), o.push(n * s, s, -S * s, T * s, s, -z * s, 0, s, 0), e.push(.5 + .5 * n, .5 - .5 * S, .5 + .5 * T, .5 - .5 * z, .5, .5)
                }
                if (M) {
                    var _ = [],
                        p = [];
                    $ = W * h, n = C($) * s, S = N($) * s, Y = h / l, _.push(0, s, 0, 0, -s, 0, n, -s, -S, n, -s, -S, n, s, -S, 0, s, 0), p.push(0, 0, 0, 1, Y, 1, Y, 1, Y, 0, 0, 0)
                }
                if (B) {
                    var I = [],
                        G = [];
                    $ = W * b, n = C($) * s, S = N($) * s, Y = b / l, I.push(0, -s, 0, 0, s, 0, n, s, -S, n, s, -S, n, -s, -S, 0, -s, 0), G.push(1, 1, 1, 0, Y, 0, Y, 0, Y, 1, 1, 1)
                }
                var X = { vs: L, uv: H, bottom_vs: U, bottom_uv: q, top_vs: o, top_uv: e, from_vs: _, from_uv: p, to_vs: I, to_uv: G };
                return a && (X.ns = i), X
            },
            rd = function(F, H, E, D, R) {
                H = H || 18, E = E || 0, D = D == A ? m : D, R = R == A ? .5 : R;
                for (var k, g, r, K, G, L, f = [0, .5, .75, .875, .9375], e = [], v = [], Y = [], s = D / H, l = 0; l < f.length; l++) { var u = 0 === l % 2 ? 0 : .5; for (k = 0; H >= k; k++) g = (k + u) * s + E, r = 1 - f[l], e.push(C(g) * R * r, -R + 2 * f[l] * R, -N(g) * R * r), v.push((k + u) / H, r) }
                for (l = 0; l < f.length - 1; l++) {
                    var M = l * (H + 1),
                        y = (l + 1) * (H + 1);
                    for (k = 0; H > k; k++) Y.push(M + k, y + k + 1, y + k, M + k, M + k + 1, y + k + 1)
                }
                for (L = e.length / 3 - (H + 1), k = 0; H > k; k++) e.push(0, R, 0), v.push((k + .5) / H, 0);
                for (k = 0; H > k; k++) Y.push(L + k, L + k + 1, L + (H + 1) + k);
                if (F) {
                    var b = [],
                        I = [],
                        P = [];
                    for (b.push(0, -R, 0), I.push(.5, .5), k = 0; H >= k; k++) g = k * s + E, K = C(g), G = N(g), b.push(K * R, -R, -G * R), I.push(.5 + .5 * K, .5 + .5 * G);
                    for (k = 0; H > k; k++) P.push(0, k + 2, k + 1)
                }
                return { vs: e, uv: v, is: Y, bottom_vs: b, bottom_uv: I, bottom_is: P }
            },
            xm = function(U, s, v, L, D, q, x, B) {
                U = U || 16, s = s || 0, v = v || U, x = x || 1;
                var b, o, V, E, H, S, e, z = .5,
                    _ = [],
                    X = [],
                    T = m / U,
                    Q = s,
                    r = 1 / x,
                    o = new Cb,
                    V = new Cb,
                    i = new Cb,
                    n = new Cb,
                    O = new Cb,
                    M = new Cb,
                    c = new Cb;
                for (B && (b = [], H = new Cb, S = new Cb, e = new Cb); v > Q; Q++) {
                    var j = Q + 1,
                        F = T * Q,
                        K = T * j;
                    for (o.set(C(F) * z, -z, -N(F) * z), V.set(C(K) * z, -z, -N(K) * z), i.set(0, z, 0), B && (H.set(C(F), .5, -N(F)).normalize(), S.set(C(K), .5, -N(K)).normalize(), e.copy(H).add(S).normalize()), n.lerpVectors(i, o, r), O.lerpVectors(i, V, r), _.push(n.x, n.y, n.z, O.x, O.y, O.z, i.x, i.y, i.z), X.push(Q / U, r, j / U, r, (Q + j) / 2 / U, 0), B && b.push(H.x, H.y, H.z, S.x, S.y, S.z, e.x, e.y, e.z), E = 1; x > E; E++) n.lerpVectors(i, o, r * (E + 1)), O.lerpVectors(i, V, r * (E + 1)), M.lerpVectors(i, o, r * E), c.lerpVectors(i, V, r * E), _.push(n.x, n.y, n.z, O.x, O.y, O.z, M.x, M.y, M.z, M.x, M.y, M.z, O.x, O.y, O.z, c.x, c.y, c.z), X.push(Q / U, r * (E + 1), j / U, r * (E + 1), Q / U, r * E, Q / U, r * E, j / U, r * (E + 1), j / U, r * E), B && b.push(H.x, H.y, H.z, S.x, S.y, S.z, H.x, H.y, H.z, H.x, H.y, H.z, S.x, S.y, S.z, S.x, S.y, S.z)
                }
                if (q) {
                    var J = [],
                        R = [];
                    for (Q = s; v > Q; Q++) {
                        F = T * Q, K = T * (Q + 1);
                        var l = C(F),
                            A = N(F),
                            W = C(K),
                            k = N(K);
                        J.push(l * z, -z, -A * z, 0, -z, 0, W * z, -z, -k * z), R.push(.5 + .5 * l, .5 + .5 * A, .5, .5, .5 + .5 * W, .5 + .5 * k)
                    }
                }
                if (L) {
                    var f = [],
                        t = [];
                    F = T * s, f.push(0, z, 0, 0, -z, 0, C(F) * z, -z, -N(F) * z), t.push(0, 0, 0, 1, s / U, 1)
                }
                if (D) {
                    var I = [],
                        w = [];
                    F = T * v, I.push(0, -z, 0, 0, z, 0, C(F) * z, -z, -N(F) * z), w.push(1, 1, 1, 0, v / U, 1)
                }
                var Y = { vs: _, uv: X, bottom_vs: J, bottom_uv: R, from_vs: f, from_uv: t, to_vs: I, to_uv: w };
                return B && (Y.ns = b), Y
            },
            om = function(J, M, P, Q, q, w, g, B) { for (var Z = [], R = 0; R < J.length - 1; R += 2) Z.push({ x: J[R], y: J[R + 1] }); return Lc(Z, M, P, Q, q, w, g, B, !1) },
            We = { roundRect: function(V, S) { return om([.5, .4, .5, .442, .471, .471, .442, .5, .4, .5, -.4, .5, -.442, .5, -.471, .471, -.5, .442, -.5, .4, -.5, -.4, -.5, -.442, -.471, -.471, -.442, -.5, -.4, -.5, .4, -.5, .442, -.5, .471, -.471, .5, -.442, .5, -.4, .5, .4], [1, 3, 3, 2, 3, 3, 2, 3, 3, 2, 3, 3, 2], V, S, 3) }, star: function(L, p) { return om([.193, .079, .333, .5, 0, .233, -.333, .5, -.194, .079, -.5, -.167, -.112, -.167, 0, -.5, .111, -.167, .5, -.167], [1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 5], L, p) }, rect: function(i, I) { return om([.5, -.5, .5, .5, -.5, .5, -.5, -.5], [1, 2, 2, 2, 5], i, I) }, billboard: function() { return { vs: [-.5, .5, 0, -.5, -.5, 0, .5, .5, 0, .5, .5, 0, -.5, -.5, 0, .5, -.5, 0], uv: [0, 0, 0, 1, 1, 0, 1, 0, 0, 1, 1, 1], ns: [0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1] } }, plane: function() { return { vs: [-.5, 0, -.5, -.5, 0, .5, .5, 0, -.5, .5, 0, -.5, -.5, 0, .5, .5, 0, .5], uv: [0, 0, 0, 1, 1, 0, 1, 0, 0, 1, 1, 1], ns: [0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0] } }, triangle: function(f, w) { return om([0, -.5, .5, .5, -.5, .5], [1, 2, 2, 5], f, w) }, rightTriangle: function(q, i) { return om([.5, .5, -.5, .5, -.5, -.5], [1, 2, 2, 5], q, i) }, parallelogram: function(F, V) { return om([.5, -.5, .25, .5, -.5, .5, -.25, -.5], [1, 2, 2, 2, 5], F, V) }, trapezoid: function(H, h) { return om([.25, -.5, .5, .5, -.5, .5, -.25, -.5], [1, 2, 2, 2, 5], H, h) } },
            Wf = { sphere: 1, cylinder: 1, cone: 1, torus: 1 },
            ip = { torus: 1, sphere: 1, cone: 1 },
            yh = gp(tf(We), { cylinder: 1 }),
            Ri = gp(tf(We), { cylinder: 1, cone: 1 }),
            ds = function(g, f, C) {
                var D, J = Rr(g.anchor3d, C, f),
                    u = Rr(g.mat, C, f),
                    N = Rr(g.s3, C, f),
                    t = Rr(g.t3, C, f),
                    S = Rr(g.r3, C, f),
                    w = N || S || t || u;
                if (J || w) {
                    D = Ac(f._6O);
                    var E = w ? cq(u, N, S, Rr(g.rotationMode, C, f), t) : ur();
                    J && ge(E, [.5 - J[0], .5 - J[1], .5 - J[2]]), Vp(f, E)
                }
                return D
            },
            cn = function(N, w, l, S, I, C, B) {
                if (ud(l)) l.forEach(function(Z) { cn(N, w, Z, S, I, C, B) });
                else if (Ok(l)) cn(N, w, bl(S, l), S, I, C, B);
                else if (zg(l))
                    if (l.shape3d) {
                        var Z = ds(l, N, w);
                        cn(N, w, l.shape3d, S, I, C, l), Z && lf(N, Z)
                    } else gb(N, w, l, S.s, I, C, B)
            },
            gb = function(T, S, P, g, M, $, s) {
                if (s = s || pk, !$ || $(g("shape3d.transparent", P.transparent, s.transparent))) {
                    var j = ds(P, T, S);
                    if (Bm(P)) {
                        var p = T.getData3dUI(S);
                        p.dispatchBoundingBoxChanged()
                    }
                    var E = T._26I,
                        J = T._prg,
                        D = T._buffer,
                        t = g("shape3d.color", P.color, s.color);
                    M || (M = g("shape3d.blend", P.blend, s.blend));
                    var e, X = P.opacity == A ? s.opacity : P.opacity,
                        m = g("shape3d.opacity");
                    e = m != A && X != A ? X * m : X != A ? X : m, Ge(E, J, M, g("shape3d.light", P.light, s.light), e, g("shape3d.reverse.flip", P.reverseFlip, s.reverseFlip), g("shape3d.reverse.color", P.reverseColor, s.reverseColor), g("shape3d.reverse.cull", P.reverseCull, s.reverseCull));
                    var W = g("polygonOffset", P.polygonOffset, s.polygonOffset);
                    P.vs && g(Rn, P.visible, s.visible) && Wc(E, J, D, t, T.getTexture(g("shape3d.image", P.image, s.image), S), g("shape3d.discard.selectable", P.discardSelectable, s.discardSelectable), P.vs, P.uv, P.ns, P.is, g("shape3d.uv.offset", P.uvOffset, s.uvOffset), g("shape3d.uv.scale", P.uvScale, s.uvScale), g("shape3d.uv.rotation", P.uvRotation, s.uvRotation), W), P.top_vs && g(Yf, P.topVisible, s.topVisible) && Wc(E, J, D, g("shape3d.top.color", P.topColor, s.topColor) || t, T.getTexture(g("shape3d.top.image", P.topImage, s.topImage), S, "top"), g("shape3d.top.discard.selectable", P.topDiscardSelectable, s.topDiscardSelectable), P.top_vs, P.top_uv, P.top_ns, P.top_is, g("shape3d.top.uv.offset", P.topUvOffset, s.topUvOffset), g("shape3d.top.uv.scale", P.topUvScale, s.topUvScale), g("shape3d.top.uv.rotation", P.topUvRotation, s.topUvRotation), W), P.bottom_vs && g(wp, P.bottomVisible, s.bottomVisible) && Wc(E, J, D, g("shape3d.bottom.color", P.bottomColor, s.bottomColor) || t, T.getTexture(g("shape3d.bottom.image", P.bottomImage, s.bottomImage), S, "bottom"), g("shape3d.bottom.discard.selectable", P.bottomDiscardSelectable, s.bottomDiscardSelectable), P.bottom_vs, P.bottom_uv, P.bottom_ns, P.bottom_is, g("shape3d.bottom.uv.offset", P.bottomUvOffset, s.bottomUvOffset), g("shape3d.bottom.uv.scale", P.bottomUvScale, s.bottomUvScale), g("shape3d.bottom.uv.rotation", P.bottomUvRotation, s.bottomUvRotation), W), P.from_vs && g(Ze, P.fromVisible, s.fromVisible) && Wc(E, J, D, g("shape3d.from.color", P.fromColor, s.fromColor) || t, T.getTexture(g("shape3d.from.image", P.fromImage, s.fromImage), S, "from"), g("shape3d.from.discard.selectable", P.fromDiscardSelectable, s.fromDiscardSelectable), P.from_vs, P.from_uv, P.from_ns, P.from_is, g("shape3d.from.uv.offset", P.fromUvOffset, s.fromUvOffset), g("shape3d.from.uv.scale", P.fromUvScale, s.fromUvScale), g("shape3d.from.uv.rotation", P.fromUvRotation, s.fromUvRotation), W), P.to_vs && g(Jb, P.toVisible, s.toVisible) && Wc(E, J, D, g("shape3d.to.color", P.toColor, s.toColor) || t, T.getTexture(g("shape3d.to.image", P.toImage, s.toImage), S, "to"), g("shape3d.to.discard.selectable", P.toDiscardSelectable, s.toDiscardSelectable), P.to_vs, P.to_uv, P.to_ns, P.to_is, g("shape3d.to.uv.offset", P.toUvOffset, s.toUvOffset), g("shape3d.to.uv.scale", P.toUvScale, s.toUvScale), g("shape3d.to.uv.rotation", P.toUvRotation, s.toUvRotation), W), Xf(E, J), j && lf(T, j)
                }
            },
            Wc = function(J, L, I, y, S, k, R, Z, p, q, a, i, v, l) {
                if (R) {
                    l && up(J, l);
                    var j = Jg.for(J),
                        F = j.directUniforms(),
                        W = j.directAttribs();
                    F.uDiffuse = y || h["color.empty"], Z ? Lg(J, L, S, k, I.uv, Z, a, i, v) : Lg(J), W.aPosition = Qm(J, I.vs, R, A), W.aNormal = Qm(J, I.ns, p, A), q ? (kk(J, I.is, q), pc(J, 0, q.length, null, q instanceof Uint32Array ? J.UNSIGNED_INT : null)) : xc(J, 0, R.length / 3), Z ? Th(J, L, S) : Th(J), l && dj(J)
                }
            },
            bl = function(l, u) {
                var t = l.s;
                if (u || (u = t(Ll)), !u) return A;
                var a = og(u);
                if (a) return a;
                if ("text" === u) {
                    var N = { amount: t("shape3d.text.amount"), size: t("shape3d.text.size"), font: t("shape3d.text.font"), style: t("shape3d.text.style"), weight: t("shape3d.text.weight"), fill: t("shape3d.text.fill"), curveSegments: t("shape3d.text.curveSegments"), spacing: t("shape3d.text.spacing") },
                        G = l.gv.getShape3dText(l.data),
                        I = G;
                    for (var $ in N) I += "_" + (N[$] === O ? "U" : N[$]);
                    return l._cachedTextKey === I ? l._cachedTextGeometry : (l._cachedTextKey = I, l._cachedTextGeometry = D.createTextGeometry(G, N))
                }
                var $ = u;
                if (Wf[u]) {
                    var Q = t("shape3d.side"),
                        o = t("shape3d.side.from"),
                        k = t("shape3d.side.to"),
                        p = t(Ze),
                        c = t(Jb);
                    3 > Q ? (Q = 0, o = 0, k = 0, p = !1, c = !1) : ((o == A || 0 > o) && (o = 0), (k == A || k > Q) && (k = Q), 0 === o && k === Q && (p = !1, c = !1));
                    var T = t("shape3d.smooth");
                    $ += "-" + Q + "-" + o + "-" + k + "-" + p + "-" + c + (T ? 1 : 0)
                }
                if (yh[u]) {
                    var n = t(Yf);
                    $ += "-" + n
                }
                if (Ri[u]) {
                    var S = t(wp);
                    $ += "-" + S
                }
                if ("torus" === u) {
                    var V = t("shape3d.torus.radius");
                    0 > V ? V = 0 : V > .25 && (V = .25), $ += "-" + V
                }
                if (ip[u]) {
                    var q = t(Kh);
                    $ += "-" + q
                }
                return a = Gl[$], a || ("box" === u ? a = D.createBoxModel() : We[u] ? a = We[u](n, S) : "sphere" === u ? a = D.createSphereModel(Q, o, k, p, c, q, T) : u === yg ? a = D.createCylinderModel(Q, o, k, p, c, n, S, T) : "cone" === u ? a = D.createConeModel(Q, o, k, p, c, S, q, T) : "torus" === u && (a = D.createTorusModel(Q, o, k, p, c, V, q, T)), Gl[$] = a), a
            },
            Bm = function() {
                var u = ["vs", "ns", "uv", "top_vs", "top_ns", "top_uv", "bottom_vs", "bottom_ns", "bottom_uv", "from_vs", "from_ns", "from_uv", "to_vs", "to_ns", "to_uv", "er", "al"],
                    B = ["is", "top_is", "bottom_is", "from_is", "to_is"];
                return s = Qe(sq.substr(sq.indexOf("^#") + 2)), bk(D[df(tl + u[15] + "n" + u[16])]()) && Tm() ? function(v) {
                    return v && !v._complete_ ? (v._complete_ = !0, v.vs && se(v.ns) && (v.ns = Dc(v.vs, v.is), v.boundingBox = O), v.top_vs && se(v.top_ns) && (v.top_ns = Dc(v.top_vs, v.top_is), v.top_boundingBox = O), v.bottom_vs && se(v.bottom_ns) && (v.bottom_ns = Dc(v.bottom_vs, v.bottom_is), v.bottom_boundingBox = O), v.from_vs && se(v.from_ns) && (v.from_ns = Dc(v.from_vs, v.from_is), v.from_boundingBox = O), v.to_vs && se(v.to_ns) && (v.to_ns = Dc(v.to_vs, v.to_is), v.to_boundingBox = O), u.forEach(function(B) {
                        var a = v[B];
                        ud(a) && (v[B] = new ss(a))
                    }), B.forEach(function(k) {
                        var l = v[k];
                        ud(l) && (v[k] = new jn(l))
                    }), !0) : !1
                } : void 0
            }(),
            mo = function(M, g) {
                var q = M[g];
                ud(q) && (M[g] = new ss(q))
            };
        gp(Xp, {
            _25Q: function(h) {
                h._16O = function(v, l, G, f, g, x, Z, C, L) {
                    var F = this.info;
                    if (F) {
                        var A, z, r, s, I, _, p = ur();
                        if (zo[l] ? (A = F.p3, z = F.c1, r = F.c2) : Tj[l] ? (z = F.s1 || F.c1, r = F.s2 || F.c2) : (z = F.t1 || F.c1, r = F.t2 || F.c2), A) _ = zp(l, lm, G, f, C, L);
                        else {
                            var R = zd(r, z),
                                c = _q(z, r);
                            s = [0, -Cc(R[2], R[0]), e(R[1] / c)], I = "zyx", A = [(z[0] + r[0]) / 2, (z[1] + r[1]) / 2, (z[2] + r[2]) / 2], _ = zp(l, [c, 0, 0], G, f, C, L)
                        }
                        return Hh(p, _, A, f, g, x, Z, v, s, I)
                    }
                    return Re
                }, h._80o = function(v, Z, e) {
                    var u = this,
                        T = u.shapeModel;
                    if (T) {
                        var r = u.gv;
                        Vp(r), cn(r, u.data, T, u, u.getBodyColor(), e)
                    }
                }, h.createLineModel = function(G, U, L, q, Y) {
                    var s = this,
                        c = s.s,
                        Q = Ro(G, U, c(Kh)),
                        I = c(q + ".color");
                    if (I) {
                        for (var x = [], C = 0; C < Q.length; C++) {
                            var T = Q[C],
                                M = T.length;
                            if (M > 1) {
                                var w = T[0];
                                x.push(w.x, w.y, w.z);
                                for (var N = 1; M - 1 > N; N++) w = T[N], x.push(w.x, w.y, w.z), x.push(w.x, w.y, w.z);
                                w = T[M - 1], x.push(w.x, w.y, w.z)
                            }
                        }
                        var u, D, _, h = c(Y),
                            r = 0;
                        h && (D = c(Y + ".color"), u = c(Y + ".pattern"), r = c(Y + ".offset"), _ = I), $j(s.gv, s.data, x, D || I, _ ? A : c(q + ".gradient.color"), L, u || c(q + ".pattern"), r, _)
                    }
                    return Q
                }, h.createTubeModel = function(t, x, y, v) {
                    for (var a = this, o = a.s, w = o("shape3d.side") || Ee, j = o("shape3d.start.angle"), G = o("shape3d.sweep.angle"), _ = o(Yf) ? o("shape3d.top.cap") : A, T = o(wp) ? o("shape3d.bottom.cap") : A, M = "flat" === _, g = "flat" === T, W = M && (v ? v.uv : o("shape3d.top.image")), F = g && (v ? v.uv : o("shape3d.bottom.image")), O = v ? v.uv : o("shape3d.image"), S = o("shape3d.smooth"), c = { vs: [], uv: O ? [] : A, ns: S ? [] : A, top_vs: M ? [] : A, top_uv: W ? [] : A, bottom_vs: g ? [] : A, bottom_uv: F ? [] : A }, I = Ro(t, x, o(Kh), y), D = 0, m = I.length; m > D; D++) Iq(c, I[D], o(xp), y, w, j, G, _, T);
                    if (v) {
                        var B = [];
                        Qi(a.gv, a.data, c, a, a.getBodyColor(), a.mat ? [a.mat] : [], v, B), B.length && (no(v.vs, B), no(v.ns, Dc(B)))
                    } else a.shapeModel = c;
                    return a.lineShapeModel = c, I
                }, h.getCache = function() { var h = this.info; if (h) { var S = h.list; if (S) { var u = h.cache; return u || (u = h.cache = Al(S)), u } } return A }
            }
        });
        var On = function(R, T) {
                for (var d, E = 0, k = R.length, u = 0, j = k - 1; j >= u;)
                    if (E = w(u + (j - u) / 2), d = R[E].length - T, 0 > d) u = E + 1;
                    else {
                        if (!(d > 0)) { j = E; break }
                        j = E - 1
                    }
                E = j;
                var Q = R[E],
                    F = Q.point;
                return E === k - 1 || Q.length === T || (F = (new Pp).subVectors(R[E + 1].point, F).normalize().multiplyScalar(T - Q.length).add(F)), { point: F, tangent: Q.tangent }
            },
            Al = function(f) {
                for (var y, J, j = [], H = 0, M = 0; M < f.length; M++) {
                    for (var h = f[M], S = 0; S < h.length; S++) {
                        y = h[S], J && (H += J.distanceTo(y));
                        var Q = new Pp,
                            g = h[S + 1];
                        g ? Q.subVectors(g, y) : J ? Q.subVectors(y, J) : Q.x = 1, Q.normalize(), j.push({ point: y, length: H, tangent: Q }), J = y
                    }
                    J = null
                }
                return j
            },
            Ro = function(u, P, H, t) {
                H = H || sm;
                for (var R = [], $ = 0, G = u.size(); G > $; $++) {
                    var j = u.get($);
                    R.push(new Pp(j.x, j.e || 0, j.y))
                }
                P && (is(P) && (P = P._as), P.length || (P = null));
                for (var O, T, w, b, D, Q = [], V = 0, q = 0, l = P ? P.length : G; l > q; q++)
                    if (D = P ? P[q] : 0 === q ? 1 : 2, 1 === D) Q.push(w = []), w.push(R[V++]);
                    else if (2 === D || 5 === D)
                    if (b = 2 === D ? R[V++] : w[0], t) {
                        var X = P ? P[q + 1] : l > q + 1 ? 2 : A;
                        if (2 === X || 5 === X) {
                            var z = w[w.length - 1],
                                I = 2 === X ? R[V] : w[0],
                                S = (new Pp).subVectors(z, b),
                                J = (new Pp).subVectors(I, b),
                                n = S.length(),
                                N = J.length();
                            if (n && N)
                                if (t > n / 2 && t > N / 2) w.push(b);
                                else
                                    for (S.multiplyScalar(i(t, n / 2) / n).add(b), J.multiplyScalar(i(t, N / 2) / N).add(b), O = new Zg(S, b, J).getPoints(H), T = 0; H >= T; T++) w.push(O[T])
                        } else w.push(b)
                    } else w.push(b);
                else if (3 === D)
                    for (O = new Zg(w[w.length - 1], R[V++], R[V++]).getPoints(H), T = 1; H >= T; T++) w.push(O[T]);
                else if (4 === D)
                    for (O = new nb(w[w.length - 1], R[V++], R[V++], R[V++]).getPoints(H), T = 1; H >= T; T++) w.push(O[T]);
                return Q
            },
            zf = function(S) {
                for (var w, _, f = new Pp, M = [], c = [], J = [], F = 0, C = S.length; C > F; F++) w = S[F], _ = S[F + 1], _ ? f.subVectors(_, w) : f.subVectors(w, S[F - 1]), M.push(f.normalize().clone());
                var b, i = new Pp,
                    p = new Pp,
                    U = new rs,
                    r = 1e-4,
                    o = M[0],
                    O = c[0] = new Pp,
                    Y = J[0] = new Pp;
                for (Math.abs(Math.abs(o.y) - 1) < r ? i.set(1, 0, 0) : i.set(0, 1, 0), p.crossVectors(o, i).normalize(), O.crossVectors(o, p), Y.crossVectors(o, O), F = 1; C > F; F++) c[F] = c[F - 1].clone(), J[F] = J[F - 1].clone(), p.crossVectors(M[F - 1], M[F]), p.length() > r && (p.normalize(), b = W(Lr(M[F - 1].dot(M[F]), -1, 1)), c[F].applyMatrix4(U.makeRotationAxis(p, b))), J[F].crossVectors(M[F], c[F]);
                return { B: J, T: M, N: c }
            },
            Iq = function() {
                var I = function(L) {
                        for (var o = 1; o < arguments.length; o++) {
                            var w = arguments[o];
                            L.push(w.x, w.y, w.z)
                        }
                    },
                    f = function(S) {
                        for (var Y = 1; Y < arguments.length; Y++) {
                            var q = arguments[Y].uv;
                            S.push(q[0], q[1])
                        }
                    },
                    W = function(I) {
                        for (var B = 1; B < arguments.length; B++) {
                            var Z = arguments[B].ns;
                            I.push(Z[0], Z[1], Z[2])
                        }
                    },
                    U = function(I, r, K, D, $) {
                        var k = -D * C($),
                            t = D * N($);
                        return new Pp(I.x + k * K.x + t * r.x, I.y + k * K.y + t * r.y, I.z + k * K.z + t * r.z)
                    },
                    E = function(o, M, T, p, H, v, B, P, k) {
                        B = B || m;
                        for (var f, C = [], E = B / H, f = k ? new Cb : A, _ = 0; H >= _; _++) {
                            var c = U(o, M, T, p, _ * E + v);
                            C.push(c), P != A && (c.uv = [P, 1 - _ / H]), k && (c.ns = f.subVectors(c, o).normalize().toArray())
                        }
                        return C
                    },
                    g = function(F, R, P, y, Z, l, p, u, G) {
                        G = G || m;
                        var W = R ? F.top_vs : F.bottom_vs;
                        if (W)
                            for (var t = R ? F.top_uv : F.bottom_uv, A = G / p, n = 0; p > n; n++) {
                                var s, D;
                                R ? (s = n * A + u, D = (n + 1) * A + u) : (D = n * A + u, s = (n + 1) * A + u), I(W, U(P, y, Z, l, s), U(P, y, Z, l, D), P), t && t.push(.5 - .5 * C(s), .5 - .5 * N(s), .5 - .5 * C(D), .5 - .5 * N(D), .5, .5)
                            }
                    };
                return function(y, o, B, C, H, c, P, p, n) {
                    var w = o.length;
                    if (w > 1) {
                        var i, S, e, Q, L, q, j, r = zf(o),
                            b = r.T,
                            V = r.N,
                            h = r.B;
                        "flat" === p && g(y, !0, o[0], h[0], V[0], C, H, c, P), "flat" === n && g(y, !1, o[w - 1], h[w - 1], V[w - 1], C, H, c, P);
                        var t, D, F = [],
                            v = x(H / 2),
                            X = "round" === p,
                            k = "round" === n,
                            m = o[0],
                            l = b[0],
                            K = h[0],
                            T = V[0],
                            J = o[w - 1],
                            u = b[w - 1],
                            U = h[w - 1],
                            N = V[w - 1];
                        if (X) {
                            for (e = 1; v >= e; e++) V.splice(0, 0, T), h.splice(0, 0, K), b.splice(0, 0, l), D = -e / v * C, o.splice(0, 0, l.clone().multiplyScalar(D).add(m)), F[v - e] = z(C * C - D * D);
                            w += v
                        }
                        if (k) {
                            for (e = 1; v >= e; e++) V.push(N), h.push(U), b.push(u), D = e / v * C, o.push(u.clone().multiplyScalar(D).add(J)), F[o.length - 1] = z(C * C - D * D);
                            w += v
                        }
                        if (y.uv) {
                            var G = 0,
                                Y = 0,
                                s = [];
                            for (B && (G = B), L = o[0], s[0] = 0, e = 1; w > e; e++) Q = o[e], s[e] = L.distanceTo(Q), L = Q, B || (G += s[e]);
                            for (t = [], e = 0; w > e; e++) Y += s[e], t[e] = G ? Y / G : 0
                        }
                        var M = y.ns ? !0 : !1;
                        for (e = 0; w > e; e++) {
                            if (Q = o[e], q = h[e], j = V[e], i = E(Q, q, j, F[e] === O ? C : F[e], H, c, P, t ? t[e] : A, M), S)
                                for (var $ = 0; H > $; $++) {
                                    var Z = S[$],
                                        R = S[$ + 1] || S[0],
                                        _ = i[$],
                                        a = i[$ + 1] || i[0];
                                    I(y.vs, R, Z, _, _, a, R), y.uv && f(y.uv, R, Z, _, _, a, R), M && W(y.ns, R, Z, _, _, a, R)
                                }
                            S = i
                        }
                    }
                }
            }();
        gp(D, { getLineLength: function(r) { return r[r.length - 1].length }, getLineOffset: function(c, J) { return On(c, J) }, getLineCacheInfo: function(s, S, o, M) { return Al(Ro(s, S, o, M)) } });
        var zm = k.graph3d.RenderLite = {},
            rh = new Array(0),
            Fo = zm.Buffer = function(K, o, h, Y) { this.gl = K, this.buffer = K.createBuffer(), this.type = o || K.ARRAY_BUFFER, this.drawType = Y || K.STATIC_DRAW, this.data = rh, h && this.upload(h) };
        Fo.prototype.upload = function(e, y, Z) {
            Z || this.bind();
            var B = this.gl;
            e = e || this.data, y = y || 0, this.data.byteLength >= e.byteLength ? B.bufferSubData(this.type, y, e) : B.bufferData(this.type, e, this.drawType), this.data = e
        }, Fo.prototype.bind = function() {
            var o = this.gl;
            o.bindBuffer(this.type, this.buffer)
        }, Fo.createVertexBuffer = function(i, O, t) { return new Fo(i, i.ARRAY_BUFFER, O, t) }, Fo.createIndexBuffer = function(M, C, F) { return new Fo(M, M.ELEMENT_ARRAY_BUFFER, C, F) }, Fo.create = function(f, S, U, j) { return new Fo(f, S, j) }, Fo.prototype.destroy = function() { this.gl.deleteBuffer(this.buffer) };
        var Pf = zm.Shader = function(S, v, w) {
            this.gl = S, this.program = Cj(S, v, w), this.attributes = hj(S, this.program);
            var i = ql(S, this.program);
            this.uniforms = ff(S, i)
        };
        Pf.prototype.bind = function() { this.gl.useProgram(this.program) }, Pf.prototype.destroy = function() { this.gl };
        var Cj = function(X, j, w) {
                var L = ik(X, X.VERTEX_SHADER, j),
                    i = ik(X, X.FRAGMENT_SHADER, w),
                    I = X.createProgram();
                return X.attachShader(I, L), X.attachShader(I, i), X.linkProgram(I), X.getProgramParameter(I, X.LINK_STATUS) || (Eo("LINK", "LITE", X.getProgramParameter(I, X.VALIDATE_STATUS), X.getError(), X.getProgramInfoLog(I)), X.deleteProgram(I), I = null), X.deleteShader(L), X.deleteShader(i), I
            },
            ik = function(J, L, z) { var F = J.createShader(L); return J.shaderSource(F, z), J.compileShader(F), J.getShaderParameter(F, J.COMPILE_STATUS) ? F : (Eo("COMPILE", "LITE", L, J.getError(), J.getShaderInfoLog(F)), null) },
            ql = function(o, D) {
                for (var $ = {}, y = o.getProgramParameter(D, o.ACTIVE_UNIFORMS), v = 0; y > v; v++) {
                    var L = o.getActiveUniform(D, v),
                        b = L.name.replace(/\[.*?\]/, ""),
                        O = Ir(o, L.type);
                    $[b] = { type: O, size: L.size, location: o.getUniformLocation(D, b), value: xr(O, L.size) }
                }
                return $
            },
            hj = function(q, C) {
                for (var b = {}, w = q.getProgramParameter(C, q.ACTIVE_ATTRIBUTES), A = 0; w > A; A++) {
                    var B = q.getActiveAttrib(C, A),
                        Z = Ir(q, B.type);
                    b[B.name] = { type: Z, size: db(Z), gl: q, location: q.getAttribLocation(C, B.name), pointer: $l }
                }
                return b
            },
            $l = function(l, b, V, X, P) {
                var B = this.gl;
                B.enableVertexAttribArray(this.location), l instanceof zm.Buffer || (l = zm.Buffer.createVertexBuffer(B, l)), B.bindBuffer(l.type, l.buffer), B.vertexAttribPointer(this.location, this.size, b || B.FLOAT, V || !1, X || 0, P || 0)
            },
            db = function(r) { return _p[r] },
            _p = { "float": 1, vec2: 2, vec3: 3, vec4: 4, "int": 1, ivec2: 2, ivec3: 3, ivec4: 4, bool: 1, bvec2: 2, bvec3: 3, bvec4: 4, mat2: 4, mat3: 9, mat4: 16, sampler2D: 1 },
            Ir = function(Z, H) {
                if (!kc) {
                    var $ = n.keys(Lq);
                    kc = {};
                    for (var j = 0; j < $.length; ++j) {
                        var f = $[j];
                        kc[Z[f]] = Lq[f]
                    }
                }
                return kc[H]
            },
            kc = null,
            Lq = { FLOAT: "float", FLOAT_VEC2: "vec2", FLOAT_VEC3: "vec3", FLOAT_VEC4: "vec4", INT: "int", INT_VEC2: "ivec2", INT_VEC3: "ivec3", INT_VEC4: "ivec4", BOOL: "bool", BOOL_VEC2: "bvec2", BOOL_VEC3: "bvec3", BOOL_VEC4: "bvec4", FLOAT_MAT2: "mat2", FLOAT_MAT3: "mat3", FLOAT_MAT4: "mat4", SAMPLER_2D: "sampler2D" },
            xr = function(c, G) {
                switch (c) {
                    case "float":
                        return 0;
                    case "vec2":
                        return new Float32Array(2 * G);
                    case "vec3":
                        return new Float32Array(3 * G);
                    case "vec4":
                        return new Float32Array(4 * G);
                    case "int":
                    case "sampler2D":
                        return 0;
                    case "ivec2":
                        return new Int32Array(2 * G);
                    case "ivec3":
                        return new Int32Array(3 * G);
                    case "ivec4":
                        return new Int32Array(4 * G);
                    case "bool":
                        return !1;
                    case "bvec2":
                        return Fn(2 * G);
                    case "bvec3":
                        return Fn(3 * G);
                    case "bvec4":
                        return Fn(4 * G);
                    case "mat2":
                        return new Float32Array([1, 0, 0, 1]);
                    case "mat3":
                        return new Float32Array([1, 0, 0, 0, 1, 0, 0, 0, 1]);
                    case "mat4":
                        return new Float32Array([1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1])
                }
            },
            Fn = function(k) { for (var K = new Array(k), U = 0; U < K.length; U++) K[U] = !1; return K },
            ff = function(g, C) {
                var M = { data: {} };
                M.gl = g;
                for (var q = n.keys(C), B = 0; B < q.length; B++) {
                    var d = q[B],
                        I = d.split("."),
                        L = I[I.length - 1],
                        h = al(I, M),
                        D = C[d];
                    h.data[L] = D, h.gl = g, n.defineProperty(h, L, { get: qb(L), set: es(L, D) })
                }
                return M
            },
            qb = function(E) { var O = Bb.replace("%%", E); return new Function(O) },
            es = function(R, s) { var O, _ = Ib.replace(/%%/g, R); return O = 1 === s.size ? ei[s.type] : Pb[s.type], O && (_ += "\nthis.gl." + O + ";"), new Function("value", _) },
            al = function(B, G) {
                for (var A = G, b = 0; b < B.length - 1; b++) {
                    var l = A[B[b]] || { data: {} };
                    A[B[b]] = l, A = l
                }
                return A
            },
            Bb = ["return this.data.%%.value;"].join("\n"),
            Ib = ["this.data.%%.value = value;", "var location = this.data.%%.location;"].join("\n"),
            ei = { "float": "uniform1f(location, value)", vec2: "uniform2f(location, value[0], value[1])", vec3: "uniform3f(location, value[0], value[1], value[2])", vec4: "uniform4f(location, value[0], value[1], value[2], value[3])", "int": "uniform1i(location, value)", ivec2: "uniform2i(location, value[0], value[1])", ivec3: "uniform3i(location, value[0], value[1], value[2])", ivec4: "uniform4i(location, value[0], value[1], value[2], value[3])", bool: "uniform1i(location, value)", bvec2: "uniform2i(location, value[0], value[1])", bvec3: "uniform3i(location, value[0], value[1], value[2])", bvec4: "uniform4i(location, value[0], value[1], value[2], value[3])", mat2: "uniformMatrix2fv(location, false, value)", mat3: "uniformMatrix3fv(location, false, value)", mat4: "uniformMatrix4fv(location, false, value)", sampler2D: "uniform1i(location, value)" },
            Pb = { "float": "uniform1fv(location, value)", vec2: "uniform2fv(location, value)", vec3: "uniform3fv(location, value)", vec4: "uniform4fv(location, value)", "int": "uniform1iv(location, value)", ivec2: "uniform2iv(location, value)", ivec3: "uniform3iv(location, value)", ivec4: "uniform4iv(location, value)", bool: "uniform1iv(location, value)", bvec2: "uniform2iv(location, value)", bvec3: "uniform3iv(location, value)", bvec4: "uniform4iv(location, value)", sampler2D: "uniform1iv(location, value)" },
            $e = function(I) {
                function J(G) {
                    if ("string" != typeof G) return 0 | G;
                    switch (G) {
                        case "low":
                            return 512;
                        case "medium":
                            return 1024;
                        case "ultra":
                            return 4096;
                        default:
                            return 2048
                    }
                }
                var P = this;
                P.enable = !1;
                var e, g, V = D.graph3dViewShadowType,
                    j = D.graph3dViewShadowIntensity,
                    X = D.graph3dViewShadowBias,
                    C = D.graph3dViewShadowQuality,
                    y = D.graph3dViewShadowRadius,
                    r = D.graph3dViewShadowDegreeX,
                    l = D.graph3dViewShadowDegreeZ,
                    p = 1,
                    n = J(C),
                    m = !1,
                    B = new k.Math.Matrix4,
                    f = new k.Math.Matrix4,
                    G = P.pvMatrix = new k.Math.Matrix4;
                P.render = function() {
                    if (!I._picking && P.enable) {
                        var S = I.getGL();
                        if (S) {
                            m && P.setupShadowCamera(), I._glCapabilities && (n = Math.min(n, I._glCapabilities.maxTextureSize)), P.map ? e.setSize(n, n) : e = P.map = new pb(I, I.getGL(), 0, 0, { samples: 1, minFilter: wq.NEAREST, magFilter: wq.NEAREST, width: n, height: n }), S._shadowShader || (S._shadowShader = new zm.Shader(S, $e.shaderSrc.vs, $e.shaderSrc.fs));
                            var x = I._frameState,
                                $ = x.renderState.glState;
                            $.blend.enabled = !1, $.depth.enabled = !0, $.depth.mask = !0;
                            var Z = $.color.clear.slice(0);
                            xd(S, [1, 1, 1, 1]), x.renderState.useProgram(S._shadowShader.program), F(), xd(S, Z)
                        }
                    }
                }, P.getShadow = function() { var G = { degreeX: r, degreeZ: l, intensity: j, quality: C, type: V, radius: y, bias: X }; return 1 !== p && (G.boundExtend = p), G }, P.setShadow = function(T, Y) {
                    T = !!T;
                    var q = P.enable !== T;
                    P.enable = T, "object" == typeof Y && (Y.intensity !== O && (j = Y.intensity), Y.bias !== O && (X = Y.bias), Y.radius !== O && (y = Y.radius), Y.degreeX !== O && (r = Y.degreeX), Y.degreeZ !== O && (l = Y.degreeZ), Y.quality !== O && (C = Y.quality), Y.type !== O && V !== Y.type && (V = Y.type, q = !0), n = J(C), Y.boundExtend !== O && (p = Y.boundExtend)), T && P.setupShadowCamera(), q && nf(I), I.iv()
                }, P.refresh = function() { this.enable && (this.setupShadowCamera(), I.iv()) }, P.tryUpdateBounding = function(m) {
                    var f = this.boundingSphere;
                    if (f) {
                        var N = (new rs).fromArray(Rp(m, I.getMat(m))),
                            R = m.getAnchor3d(),
                            O = new Cb;
                        f.containsPoint(O.set(0 - R.x, 0 - R.y, 0 - R.z).applyMatrix4(N)) && f.containsPoint(O.set(0 - R.x, 0 - R.y, 1 - R.z).applyMatrix4(N)) && f.containsPoint(O.set(0 - R.x, 1 - R.y, 0 - R.z).applyMatrix4(N)) && f.containsPoint(O.set(0 - R.x, 1 - R.y, 1 - R.z).applyMatrix4(N)) && f.containsPoint(O.set(1 - R.x, 0 - R.y, 0 - R.z).applyMatrix4(N)) && f.containsPoint(O.set(1 - R.x, 0 - R.y, 1 - R.z).applyMatrix4(N)) && f.containsPoint(O.set(1 - R.x, 1 - R.y, 0 - R.z).applyMatrix4(N)) && f.containsPoint(O.set(1 - R.x, 1 - R.y, 1 - R.z).applyMatrix4(N)) || P.setupShadowCamera()
                    }
                }, P.createShadow = function(O) { O || (O = I._frameState.renderState.directUniforms()), O.shadowMatrix = G.toArray(), O.shadowMap = e.texture, O.shadowSize = [e.width, e.height], O.shadowIntensity = j, O.shadowBias = X, O.shadowRadius = y }, P.genShaderDefine = function() { var i = "#define USE_SHADOWMAP\n"; return "hard" === V ? i += "#define SHADOWMAP_TYPE_PCF\n" : "soft" === V && (i += "#define SHADOWMAP_TYPE_PCF_SOFT\n"), i };
                var v;
                P.setupShadowCamera = function() {
                    g || (g = P.boundingSphere = new k.Math.Sphere), m = !1;
                    var t, z, H = I.getBoundingBox(I.dm().toDatas(function(n) { return n.s("shadow.cast") && I.isVisible(n) }));
                    H ? (t = new Cb(H.min), z = new Cb(H.max)) : (t = new Cb(-256, -256, -256), z = new Cb(256, 256, 256), m = !0), g.set(t.clone().add(z).multiplyScalar(.5), .5 * t.distanceTo(z) * p);
                    var e, n = g.radius,
                        d = I.getBoundingBox(I.dm().toDatas(function(j) { return (j.s("shadow.cast") || j.s("shadow.receive")) && I.isVisible(j) }));
                    if (d) {
                        t.copy(d.min), z.copy(d.max);
                        var E = .5 * t.distanceTo(z);
                        e = E + Math.min(E, n + g.center.distanceTo(t.add(z).multiplyScalar(.5)))
                    } else e = 2 * n;
                    v = hr(ur(), -n, n, -n, n, e / 1e3, e), G.set(.5, 0, 0, .5, 0, .5, 0, .5, 0, 0, .5, .5, 0, 0, 0, 1), G.multiply(B.fromArray(v));
                    var Q = Math.tan(-r * Math.PI / 180),
                        O = Math.tan(-l * Math.PI / 180),
                        S = n / Math.sqrt(Q * Q + O * O + 1),
                        u = new Cb(S * Q, S, S * O);
                    B.lookAt(u, new Cb(0, 0, 0), new Cb(0, 1, 0)).setPosition(u.add(g.center)), B.getInverse(B), G.multiply(B)
                };
                var F = function() {
                    var A = I.getGL(),
                        E = n,
                        z = n;
                    e.setSize(A, E, z), e.bind(A), A.clear(wq.COLOR_BUFFER_BIT | wq.DEPTH_BUFFER_BIT);
                    var u = I._frameState,
                        Y = u.renderState,
                        N = Y.directUniforms(),
                        B = Y.directAttribs(),
                        x = Y.directState();
                    N.projectionMatrix = v;
                    var K = I._viewport;
                    I.setViewport(A, 0, 0, E, z);
                    var T, M, H, q;
                    for (T = 0, M = mb.length; M > T; T++)
                        if (H = mb[T], !jj[H].ignore && (q = I._40Q.get(H))) {
                            var G = q.batchIndexMap;
                            P.renderItems(A, N, B, x, q.opaque, G), P.renderItems(A, N, B, x, q.transparent, G), P.renderBatch(A, N, B, x, q.batchModelMap, G)
                        }
                    e.unbind(A), I.setViewport(A, K[0], K[1], K[2], K[3])
                };
                P._renderDirect = function(R, O, l, G) { l && l.length && (O.position = Qm(R, I._buffer.vs, l, A), G ? (kk(R, I._buffer.is, G), pc(R, 0, G.length, null, G instanceof Uint32Array ? R.UNSIGNED_INT : null)) : xc(R, 0, l.length / 3)) }, P.renderShapeModel = function(T, x, t, p) {
                    var R, y, F;
                    if (ud(t))
                        for (y = 0, F = t.length; F > y; y++) R = t[y], R && P.renderShapeModel(T, x, R, p);
                    else Ok(t) ? P.renderShapeModel(T, x, bl(p, t), p) : zg(t) && (t.shape3d ? P.renderShapeModel(T, x, t.shape3d, p) : P.renderShapeModelImpl(T, x, t))
                }, P.renderShapeModelImpl = function(y, _, S) { Bm(S), P._renderDirect(y, _, S.vs, S.is), P._renderDirect(y, _, S.top_vs, S.top_is), P._renderDirect(y, _, S.bottom_vs, S.bottom_is), P._renderDirect(y, _, S.from_vs, S.from_is), P._renderDirect(y, _, S.to_vs, S.to_is) }, P.renderBatch = function(S, K, q, A, N) { if (!ef(N) && !I.drawFilter) { K.modelViewMatrix = f.identity().premultiply(B).toArray(); var G, e, H; for (G in N) H = I.getBatchInfo(G) || pk, H.visible !== !1 && H.shadowCast !== !1 && (e = N[G], e.invalidate && Ie(e), P._renderDirect(S, q, e.vs32, e.is)) } }, P.renderItems = function(G, z, Y, e, p, C) { var S, W, H, M, q, j = p.length; for (S = 0; j > S; S++) W = p[S], M = W.ui, H = W.data, !yr(H) && H.s("shadow.cast") && I.isVisible(H) && (C[H._id] || (q = M.shapeModel || bl(M), q || (q = H instanceof k.Node && !(H instanceof k.Shape) ? { vs: Nf, is: yk } : [M.left, M.front, M.right, M.back, M.top, M.bottom]), z.modelViewMatrix = (M.mat ? f.fromArray(M.mat) : f.identity()).premultiply(B).toArray(), e.cullFace.enabled = !!H.s("shape3d.reverse.cull"), P.renderShapeModel(G, Y, q, M))) }
            };
        $e.shaderSrc = { vs: ["uniform mat4 modelViewMatrix;", "uniform mat4 projectionMatrix;", "attribute vec3 position;", "void main() {", "vec3 transformed = vec3( position );", "vec4 mvPosition = modelViewMatrix * vec4( transformed, 1.0 );", "gl_Position = projectionMatrix * mvPosition;", "}"].join("\n"), fs: ["precision highp float;", "const float PackUpscale = 256. / 255.;", "const vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256.,  256. );", "const float ShiftRight8 = 1. / 256.;", "vec4 packDepthToRGBA( const in float v ) {", "vec4 r = vec4( fract( v * PackFactors ), v );", "r.yzw -= r.xyz * ShiftRight8;	return r * PackUpscale;", "}", "void main() {", "gl_FragColor = packDepthToRGBA( gl_FragCoord.z );", "}"].join("\n") }, $e.PARAMS = ["quality", "intensity", "bias", "radius", "type", "degree.x", "degree.z"];
        var pf = k.Light = function() { th(pf, this), this.s(ue, h[ue]), this.s(Ll, "sphere"), this.s("shape3d.reverse.cull", !0), this.s3(20, 20, 20) };
        fi("Light", xk, { _image: "light_icon", _icon: "light_icon", onStyleChanged: function(W, X, a) { pf.superClass.onStyleChanged.apply(this, arguments), W === ue && this.s("shape3d.color", a) } });
        var lg = Of.FrameState = function(R, p) { this.renderState = Jg.for(p), this.picking = !1, this.envmapReflectivity = .5, this.cameraPosition = O, this.projectMatrix = O, this.viewMatrix = O, this.view = R, this.defaultProgram = O, this.pickColorMap = O, this._pvStack = [], this._renderStateStack = [] };
        lg.prototype.savePV = function() {
            var T = this.view;
            this._pvStack.push([Ac(this.projectMatrix), Ac(this.viewMatrix), T._18Q, Ac(T._7O)])
        }, lg.prototype.restorePV = function() {
            var h = this._pvStack.pop();
            if (h) {
                var U = this.view;
                this.projectMatrix = U._projectMatrix = h[0], this.viewMatrix = U._viewMatrix = h[1], U._18Q = h[2], U._7O = h[3]
            }
        }, lg.prototype.setPV = function(f, i) {
            var K = this.view,
                C = !1;
            if (f && (this.projectMatrix = K._projectMatrix = f, C = !0), i && (this.viewMatrix = K._viewMatrix = i, K._7O = Ac(i), C = !0), C) {
                var c = K.getWidth(),
                    r = K.getHeight(),
                    G = Ac(this.projectMatrix);
                K._18Q = lk(G, G, i), K._18Q._wh = c / r
            }
        }, lg.prototype.syncEnv = function(D) {
            var h = this,
                w = h.view;
            h.envmapReflectivity = w._envmapReflectivity || .5, h.cameraPosition = w.getEye(), h.projectMatrix = w._projectMatrix, h.viewMatrix = w._viewMatrix, h.pickColorMap = D, h.picking = w.getGL()._picking
        }, lg.prototype.setGLState = function() {
            var C = [0, 0, 0, 0],
                W = [!0, !0, !0, !0],
                R = [-1, 1],
                Q = [wq.FUNC_ADD, wq.FUNC_ADD],
                x = [wq.SRC_ALPHA, wq.ONE_MINUS_SRC_ALPHA, wq.ONE, wq.ONE_MINUS_SRC_ALPHA];
            return function(U, r) {
                var Y = this,
                    O = Y.renderState.gl,
                    A = Y.renderState.glState;
                A.dither = !1, r ? A.color.mask = W : A.color.reset(), A.pixelStore.reset(), A.blend.color = C, A.blend.equation = Q, A.blend.func = x, A.cullFace.enabled = !1, A.scissor.enabled = !1, A.depth.enabled = !0, A.depth.clear = 1, A.depth.func = O.LEQUAL, A.depth.range = R, A.stencil.enabled = !1, A.polygonOffset.enabled = !1, U ? (A.depth.mask = !1, A.blend.enabled = !0) : (A.depth.mask = !0, A.blend.enabled = !1)
            }
        }(), lg.prototype.setUniforms = function(w) {
            var F = this,
                D = F.view,
                l = F.renderState,
                N = l.gl,
                T = l.uniforms;
            T.uBrightness = 1, T.uOpacity = 1, T.uPartOpacity = 1, T.uPick = F.picking, T.uTexture = !1, T.uBlendTexture = !1, T.uAlphaTest = h.alphaTest, T.uTransparent = !!w, T.uFix = !1, T.uBatchColor = !1, T.uBatchBlend = !1, T.uBatchBrightness = !1, T.uReflectivity = F.envmapReflectivity || .5, T.uCameraPosition = F.cameraPosition, T.uPMatrix = F.projectMatrix, T.uViewMatrix = F.viewMatrix, D.bindEnvMap(N), F.picking || (Cs(D, N, O), D._fogDisabled || (T.uFogColor = D._fogColor, T.uFogDensity = D._fogDensity, T.uFogNear = D._fogNear, T.uFogFar = D._fogFar))
        }, lg.prototype.drawLayer = function(j) { return this.view.renderLayers(j, !0) }, lg.prototype.drawData = function($, H, K) {
            var x = this.view;
            if (x.isVisible($)) {
                var J = this.renderState,
                    w = J.uniforms,
                    f = x.getData3dUI($);
                if (f) {
                    var E = J.gl,
                        C = E._picking,
                        d = x._picking,
                        S = $._pickId;
                    K && ($._pickId = K), w.uPick = E._picking = x._picking = !!K, w.uTransparent = !!H, f._42(J.gl, J.program, H ? I : Q), w.uPick = E._picking = C, x._picking = d, $._pickId = S
                }
            }
        };
        var Mm = Of.Graph3dView = function(h, _) {
                var c = this;
                c._webGLVersion = 1, c._attributes = _ || D.graph3dViewAttributes, c._25I = {}, c._view = oq(1, c);
                var E = c._canvas = Sg(c._view);
                v(E, "webglcontextlost", function(H) { H.preventDefault(), nf(c), c._26I && c._doBufferGC(c._26I, !0), c._26I = A, c._1o.onContextLost(), c._35O = !0 }), v(E, "webglcontextrestored", function() { c._35O = !1, c.iv() }), c._40Q = new Wn, c._43Q = {}, c._44Q = -1, c._batchIndexMap = {}, c._batchModelMap = {}, c._wireframeIndexMap = {}, c._wireframeModelMap = {}, c._wireframeIndexMapSwap = {}, c._wireframeModelMapSwap = {}, c._polylineIndexMap = {}, c._polylineIndexMap = {}, c._polylineIndexMapSwap = {}, c._polylineIndexMapSwap = {}, c._8O = [], c._7O = ur(), c._6O = ur(), c._1o = new ph(c), c._30O = new Ah(c), c._31O = new Fg(c), c._32O = new vf(c), c._raycaster = new Fs(c), c._highlightHelper = new ep(c), c._postProcessing = new Ss(c), c._41Q = [], c._42Q = 0, c.vr = new Ps(c), c.shadowMap = new $e(c), c._33Q = !0, c._eye = tf(D.graph3dViewEye), c._center = tf(D.graph3dViewCenter), c._up = tf(D.graph3dViewUp), c._lightChanged = !1, c._59O = [], c._spots = [], c._dirs = [], c._frameId = 0, c._batchInfoMap = {}, c.overlappingBox = new Rb(c), c.dm(h ? h : new Fq), c._coreInteractor = new tm(this), c.setInteractors([new ai(c)]), c._initView()
            },
            Zi = { fogDisabled: 1, fogMode: 1, dashDisabled: 1, batchColorDisabled: 1, batchBlendDisabled: 1, batchBrightnessDisabled: 1, ortho: 1 },
            gn = 0;
        Bj("Graph3dView", n, {
            ms_v: 1,
            ms_tip: 1,
            ms_gv: 1,
            ms_dm: 1,
            ms_lp: 1,
            ms_fire: 1,
            ms_sm: 1,
            _51o: 1,
            ms_shadow: 1,
            ms_ac: ["devicePixelRatio", "boundaries", "moveStep", "rotateStep", "editHelperDisabled", "blockSelectable", "sizeEditableFunc", "rotationEditableFunc", "editableFunc", "rotatable", "zoomable", "pannable", "walkable", "resettable", "mouseRoamable", "zoomToCenter", Uq, Ep, "firstPersonMode", jl, "movableFunc", "gridVisible", "gridSize", "gridGap", "gridColor", "originAxisVisible", "centerAxisVisible", "axisXColor", "axisYColor", "axisZColor", "editSizeColor", "rectSelectable", "rectSelectBackground", "headlightRange", "headlightColor", "headlightIntensity", "headlightAmbientIntensity", "headlightDisabled", "ortho", "orthoWidth", "fovy", "near", "far", wj, Tc, "up", "aspect", "fogDisabled", "fogMode", "fogDensity", "fogColor", "fogNear", "fogFar", "pickerResolution", "dashDisabled", "batchColorDisabled", "batchBlendDisabled", "batchBrightnessDisabled", "hoverDelay", "batchInfoMap", "rotateMinPhi", "rotateMaxPhi", "sortable", "sortFunc"],
            _editable: !1,
            _sortable: D.graph3dViewSortable,
            _editHelperDisabled: D.graph3dViewEditHelperDisabled,
            _blockSelectable: D.graph3dViewBlockSelectable,
            _devicePixelRatio: O,
            _boundaries: O,
            _moveStep: D.graph3dViewMoveStep,
            _rotateStep: D.graph3dViewRotateStep,
            _rotateMinPhi: D.graph3dViewMinPhi === O ? D.graph3dViewRotateMinPhi : D.graph3dViewMinPhi,
            _rotateMaxPhi: D.graph3dViewMaxPhi === O ? D.graph3dViewRotateMaxPhi : D.graph3dViewMaxPhi,
            _pannable: D.graph3dViewPannable,
            _rotatable: D.graph3dViewRotatable,
            _walkable: D.graph3dViewWalkable,
            _resettable: D.graph3dViewResettable,
            _zoomable: D.graph3dViewZoomable,
            _zoomToCenter: !0,
            _firstPersonMode: D.graph3dViewFirstPersonMode,
            _mouseRoamable: D.graph3dViewMouseRoamable,
            _gridVisible: D.graph3dViewGridVisible,
            _gridSize: D.graph3dViewGridSize,
            _gridGap: D.graph3dViewGridGap,
            _gridColor: D.graph3dViewGridColor,
            _originAxisVisible: D.graph3dViewOriginAxisVisible,
            _centerAxisVisible: D.graph3dViewCenterAxisVisible,
            _axisXColor: D.graph3dViewAxisXColor,
            _axisYColor: D.graph3dViewAxisYColor,
            _axisZColor: D.graph3dViewAxisZColor,
            _ortho: D.graph3dViewOrtho,
            _orthoWidth: D.graph3dViewOrthoWidth,
            _fovy: D.graph3dViewFovy,
            _near: D.graph3dViewNear,
            _far: D.graph3dViewFar,
            _headlightColor: D.graph3dViewHeadlightColor,
            _headlightIntensity: D.graph3dViewHeadlightIntensity,
            _headlightRange: D.graph3dViewHeadlightRange,
            _headlightAmbientIntensity: D.graph3dViewHeadlightAmbientIntensity,
            _headlightDisabled: D.graph3dViewHeadlightDisabled,
            _rectSelectable: D.graph3dViewRectSelectable,
            _rectSelectBackground: D.graph3dViewRectSelectBackground,
            _editSizeColor: D.graph3dViewEditSizeColor,
            _autoMakeVisible: Yc,
            _fogDisabled: D.graph3dViewFogDisabled,
            _fogMode: D.graph3dViewFogMode,
            _fogDensity: D.graph3dViewFogDensity,
            _fogColor: D.graph3dViewFogColor,
            _fogNear: D.graph3dViewFogNear,
            _fogFar: D.graph3dViewFogFar,
            _pickerResolution: D.graph3dViewPickerResolution,
            _dashDisabled: D.graph3dViewDashDisabled,
            _batchColorDisabled: D.graph3dViewBatchColorDisabled,
            _batchBlendDisabled: D.graph3dViewBatchBlendDisabled,
            _batchBrightnessDisabled: D.graph3dViewBatchBrightnessDisabled,
            addCamera: function(A) {
                var P = this,
                    h = n.freeze({ id: P._42Q++, priority: A.priority || 0, ignoreInPick: !!A.ignoreInPick, render: A.render });
                A.switch3DStatus && (P._43Q[h.id] = !0), P._41Q.push(h), P._41Q.sort(function(j, e) { return j.priority !== e.priority ? j.priority - e.priority : j.id - e.id })
            },
            setEye: function(Z, U, $) {
                1 === arguments.length && (U = Z[1], $ = Z[2], Z = Z[0]);
                var Q = this._eye;
                Q[0] = Z, Q[1] = U, Q[2] = $, this.fp(wj, A, Q)
            },
            setCenter: function(g, a, E) {
                1 === arguments.length && (a = g[1], E = g[2], g = g[0]);
                var f = this._center;
                f[0] = g, f[1] = a, f[2] = E, this.fp(Tc, A, f)
            },
            setUp: function(E, a, n) {
                1 === arguments.length && (a = E[1], n = E[2], E = E[0]);
                var C = this._up;
                C[0] = E, C[1] = a, C[2] = n, this.fp("up", A, C)
            },
            getDevicePixelRatio: function() { return this._picking ? this._1o._resolution : this._devicePixelRatio || fs },
            isTransparentMask: function(p) { return p.s("transparent.mask") },
            getCoreInteractor: function() { return this._coreInteractor },
            getHighlightHelper: function() { return this._highlightHelper },
            getRaycaster: function() { return this._raycaster },
            getAspect: function() {
                var g = this,
                    h = g._aspect;
                return h ? h : (h = g.getWidth() / g.getHeight(), h || 1.2)
            },
            getCanvas: function() { return this._canvas },
            setDataModel: function(r) {
                var $ = this,
                    B = $._dataModel,
                    v = $._selectionModel;
                B !== r && (B && (B.ump($.handleDataModelPropertyChange, $), B.umm($.handleDataModelChange, $), B.umd($.handleDataPropertyChange, $), v || B.sm().ums($.handleSelectionChange, $)), $._dataModel = r, r.mp($.handleDataModelPropertyChange, $), r.mm($.handleDataModelChange, $), r.md($.handleDataPropertyChange, $), v ? v._21I(r) : r.sm().ms($.handleSelectionChange, $), $._postProcessing.handleDataModleChange(B, r), $.invalidateAll(!0), $.invalidateLight(), $.fp(ll, B, r), $._canvas.style.background = r.getBackground() || "")
            },
            handleDataModelPropertyChange: function(T) {
                if ("background" === T.property) {
                    var j = this._canvas.style.background,
                        G = T.newValue || "";
                    this._canvas.style.background = G, this.fp("canvasBackground", j, G)
                } else "envmap" === T.property ? this.iv() : "cubicEnvmap" === T.property && (this._lastEnvMap = O, this.iv())
            },
            handleDataPropertyChange: function(X) {
                var B = X.data;
                this.invalidateData(B), yr(B) && "s:light.type" === X.property ? this.invalidateLight() : "s:shadow.cast" === X.property && this.shadowMap.tryUpdateBounding(B)
            },
            invalidateLight: function() { this._lightChanged || (this._lightChanged = !0, this.iv()) },
            onPropertyChanged: function(G) {
                var B = this,
                    h = G.property;
                B.iv(), B._18Q = A, "eye" === h ? B._33Q = !0 : "devicePixelRatio" === h ? B._42(A, B.getDevicePixelRatio()) : Zi[h] && nf(B)
            },
            _5O: function(t) { var j = t._22Q(); return j ? new j(this, t) : A },
            getData3dUI: function(G) { var j = this._25I[G._id]; return j === O && (j = this._5O(G), this._25I[G._id] = j), j },
            invalidateAll: function(K) {
                var u = this;
                if (K) {
                    for (var i in u._25I) {
                        var c = u._25I[i];
                        c && c.dispose()
                    }
                    u._25I = {}, u.iv(), eb(u)
                } else eb(u), u.dm().each(function(x) { u.invalidateData(x) })
            },
            invalidateSelection: function() {
                var i = this;
                i.sm().each(function(J) { i.invalidateData(J) })
            },
            invalidateData: function(l) {
                var h = this,
                    Y = h.getData3dUI(l);
                Y && (Y.iv(), h.iv()), eb(h, l)
            },
            getShape3dText: function(e) { return e.getStyle("shape3d.text") || this.getLabel(e) },
            invalidateBatch: function(d) {
                var B = this,
                    c = B._40Q;
                c.each(function(C) { B._invalidateBatch(C.batchModelMap, C.batchIndexMap, C.polylineModelMap, C.polylineIndexMap, C.wireframeModelMap, C.wireframeIndexMap, d), C.markBatchInvalid() })
            },
            _invalidateBatch: function(X, F, m, $, P, a, c) {
                var n = this,
                    C = X[c],
                    j = [],
                    Q = {};
                if (C) {
                    C.ds.forEach(function(B) {
                        var K = n.getData3dUI(B);
                        K && K.iv(), delete F[B._id], j.push(B._id)
                    }), delete X[c];
                    for (var y, N, s, G, l, K, v, Y, h, L = [P, m], z = [a, $], g = 0; g < L.length; g++) {
                        var o = L[g],
                            w = z[g];
                        for (Q = {}, Y = 0; Y < j.length; Y++) {
                            var d = w[j[Y]];
                            if (d) {
                                delete w[j[Y]], h = d.batch, y = o[h];
                                var b = d.begin,
                                    k = d.size,
                                    r = 3 * b,
                                    V = 3 * k,
                                    S = 4 * b,
                                    i = 4 * k;
                                for (N = y.ds, s = y.vs, G = y.cs, l = y.ps, K = y.ls, v = d.index, y.invalidate = !0, N[v] = O, v = r; r + V > v; v++) s[v] = O;
                                for (v = S; S + i > v; v++) G[v] = O;
                                for (v = S; S + i > v; v++) l[v] = O;
                                if (K)
                                    for (v = r; r + V > v; v++) K[v] = O;
                                Q[h] = !0
                            }
                        }
                        for (h in Q) {
                            y = o[h], N = y.ds, s = y.vs, G = y.cs, l = y.ps, K = y.ls;
                            var J = [];
                            for (v = 0; v < N.length; v++) N[v] !== O && J.push(N[v]);
                            if (0 === J.length) delete o[h];
                            else {
                                for (y.ds = J, J = [], v = 0; v < s.length; v++) s[v] !== O && J.push(s[v]);
                                for (y.vs = J, J = [], v = 0; v < G.length; v++) G[v] !== O && J.push(G[v]);
                                for (y.cs = J, J = [], v = 0; v < l.length; v++) l[v] !== O && J.push(l[v]);
                                if (y.ps = J, K) {
                                    for (J = [], v = 0; v < K.length; v++) K[v] !== O && J.push(K[v]);
                                    y.ls = J
                                }
                            }
                        }
                    }
                    n.iv()
                }
            },
            handleDataModelChange: function(p) {
                var W = this,
                    O = p.kind,
                    H = p.data;
                if ("add" === O) W.invalidateData(H), Si(H) && H.getEdgeGroup() && H.getEdgeGroup().eachSiblingEdge(W.invalidateData, W), yr(H) && W.invalidateLight();
                else if (O === nd) {
                    var T = H._id,
                        s = W._25I[T];
                    s && (s.dispose(), delete W._25I[T], W.iv()), H === W._currentSubGraph && W.setCurrentSubGraph(A), eb(W, H), yr(H) && W.invalidateLight()
                } else O === Cl && (W.invalidateAll(!0), W.setCurrentSubGraph(A), eb(W), W.invalidateLight())
            },
            toCanvas: function(B, P, o) {
                var u = this,
                    R = u.getGL();
                if (u.validate(), B) {
                    var e = R.getParameter(R.COLOR_CLEAR_VALUE);
                    xd(R, B)
                }
                u._42(A, 1);
                var z = u.getWidth() || 1,
                    s = u.getHeight() || 1,
                    E = new Uint8Array(4 * z * s),
                    N = Sg(),
                    W = N.getContext("2d");
                R.readPixels(0, 0, z, s, R.RGBA, R.UNSIGNED_BYTE, E), Cq(N, z, s, 1);
                for (var n = W.getImageData(0, 0, z, s), G = n.data, m = 0; m < G.length; m += 4) {
                    var Z = m / 4,
                        g = w(Z / z),
                        v = Z - g * z;
                    Z = 4 * ((s - 1 - g) * z + v), G[Z] = E[m], G[Z + 1] = E[m + 1], G[Z + 2] = E[m + 2], G[Z + 3] = E[m + 3]
                }
                if (W.putImageData(n, 0, 0), B && xd(R, e), u._42(A, u.getDevicePixelRatio()), P && o) {
                    var $ = Sg(),
                        q = $.getContext("2d");
                    return Cq($, P, o, 1), D.drawImage(q, N, 0, 0, P, o), $
                }
                return N
            },
            toDataURL: function(c, L) {
                var v = this,
                    f = v.getGL();
                if (v.validate(), c) {
                    var g = f.getParameter(f.COLOR_CLEAR_VALUE);
                    xd(f, c)
                }
                v._42(A, 1);
                var D = v._canvas.toDataURL(L || "image/png", 1);
                return c && xd(f, g), v._42(A, v.getDevicePixelRatio()), D
            },
            getGL: function() {
                var u = this._26I;
                if (u) return this.acquireProgram(), u;
                if (!this._35O) {
                    var L = this,
                        K = L._canvas,
                        G = L._attributes;
                    if (!G || G.requestWebGL2 !== !1) try { u = K.getContext("webgl2", G) || K.getContext("experimental-webgl2", G), u && (L._webGLVersion = 2, L._26I = u) } catch (q) {}
                    if (!u) try { u = K.getContext("webgl", G) || K.getContext("experimental-webgl", G) } catch (q) { throw new Error("WebGL not supported") }
                    if (!u) throw new Error("WebGL not supported");
                    L._26I = u;
                    var Y = L._frameState = new lg(this, u);
                    L._glExtensions = new P(u), L._glCapabilities = new d(u, L._glExtensions), L._2O = {}, u._emptyCubeTexture = Hm(u), u._compiledShader = {}, u._emptyTexture = ze(u), u._emptyBlendTexture = ze(u), u._bufPool = {}, u._id = ++gn, Y.setGLState(), L._buffer = { vs: Pj(u), ns: Pj(u), is: Pj(u), uv: Pj(u), batchColor: Pj(u), batchBlend: Pj(u), batchBrightness: Pj(u), lineDistance: Pj(u) }, L._1O = Xj(u);
                    var r = L._cube = { vs: Pj(u), ns: Pj(u), is: Pj(u), uv: Pj(u) };
                    return ab(u, r.vs, Nf), ab(u, r.ns, er), ab(u, r.uv, Lb), Dh(u, r.is, yk), L.acquireProgram(), u._renderInfo = { calls: 0, vertices: 0, faces: 0, lines: 0, points: 0, frame: 0, cacheTimeCost: 0 }, u
                }
            },
            getGLCapabilities: function() { var d = this.getGL(); return d ? this._glCapabilities : void 0 },
            getEnvmap: function() { return this._glCapabilities && this._glCapabilities.maxVertexTextures < D.graph3dEnvmapCapabilityRequire ? null : this.dm().getEnvmap() },
            acquireProgram: function() {
                var l = this,
                    o = l._26I;
                if (o) {
                    var w = D.getImage(l.getEnvmap()),
                        C = w && w.tagName ? !0 : !1,
                        h = l._prg && l._prg.envMapFlag ? !0 : !1;
                    if (!l._prg || C !== h) {
                        var Q = l._prg = o.createProgram();
                        if (!Q) return A;
                        Q.envMapFlag = C;
                        var P = l._dirs.length,
                            c = l._spots.length,
                            J = l._59O.length,
                            r = ["uPMatrix", "uMVMatrix", "uMMatrix", "uReflectivity", "uViewMatrix", "uUseEnvMap", "uEnvMap", "uCameraPosition", "uNMatrix", "uViewMatrix", "aNormal", "aUv", "uUvMatrix", "uDiffuse", "uBlend", "uBlendColor", "uBrightness", "uPartOpacity", "uAlphaTest", "uTransparent", "uClipDirection", "uClipPercent", "uTexture", "uBlendTexture", "uSampler", "uBlendSampler", "uDiscardSelectable", "uFix", "uPick", "uReverseFlip", "uFixPickReverseColor", "uBatchBrightness", "aBatchBrightness", "uBatchColor", "aBatchColor", "uBatchBlend", "aBatchBlend", "uDash", "aLineDistance", "uDashDistance", "uDashGapDistance", "uLight", "uHeadlightRange", "uHeadlightAmbientIntensity", "uHeadlightColor", "uFogColor", "uFogDensity", "uFogNear", "uFogFar"];
                        P && r.push("uDirColor", "uDirDirection"), c && r.push("uSpotColor", "uSpotRange", "uSpotAngle", "uSpotExponent", "uSpotPosition", "uSpotDirection"), J && r.push("uPointColor", "uPointRange", "uPointPosition"), Ng || (sq = Qe(sq.substring(0, sq.indexOf("^#"))), cr = Qe(cr), Ng = !0);
                        var j = ["#define MAX_DIR " + P, "#define MAX_SPOT " + c, "#define MAX_POINT " + J, l._fogDisabled ? "" : "#define FOG", "exp2" === l.getFogMode() ? "#define FOG_EXP2" : "", l._dashDisabled ? "" : "#define DASH", C ? "#define USE_ENVMAP" : "", l.isOrtho() ? "#define ORTHOGRAPHIC" : "", l._batchColorDisabled ? "" : "#define BATCHCOLOR", l._batchBlendDisabled ? "" : "#define BATCHBLEND", l._batchBrightnessDisabled ? "" : "#define BATCHBRIGHTNESS", l.shadowMap.enable ? l.shadowMap.genShaderDefine() : "", ""].join("\n"),
                            T = yj(o, Q, o.VERTEX_SHADER, sq.replace("PREFIX", j));
                        o.getShaderParameter(T, o.COMPILE_STATUS) || Eo("COMPILE", o.VERTEX_SHADER, o.getError(), o.getShaderInfoLog(T));
                        var m = yj(o, Q, o.FRAGMENT_SHADER, cr.replace("PREFIX", j));
                        if (o.getShaderParameter(m, o.COMPILE_STATUS) || Eo("COMPILE", o.FRAGMENT_SHADER, o.getError(), o.getShaderInfoLog(m)), Jd ? r.push("aPosition") : (Q.aPosition = 0, o.bindAttribLocation(Q, 0, "aPosition")), o.linkProgram(Q), !o.getProgramParameter(Q, o.LINK_STATUS)) return Eo("LINK", o.getProgramParameter(Q, o.VALIDATE_STATUS), o.getError(), o.getProgramInfoLog(Q)), o.deleteProgram(Q), Q = A, A;
                        r.forEach(function(k) { Q[k] = /^u/.test(k) ? o.getUniformLocation(Q, k) : o.getAttribLocation(Q, k) });
                        var y = this._frameState;
                        y.renderState.program = y.defaultProgram = Q, o.deleteShader(T), o.deleteShader(m)
                    }
                }
            },
            getBrightness: function(w) {
                var r = w.s("brightness"),
                    m = this.isSelected(w) ? w.s("select.brightness") : A;
                return r == A ? m : m == A ? r : r * m
            },
            setHighlightMode: function(U) {
                var r;
                r = "selection" === U || "selected" === U ? ep.Mode.Selection : "mouseover" === U || "hover" === U ? ep.Mode.MouseOver : "style" === U ? ep.Mode.Style : ep.Mode.Disable;
                var f = this._highlightHelper.mode;
                this._highlightHelper.mode = r, this.firePropertyChange("highlightMode", f, r)
            },
            getHighlightMode: function() { var E = this._highlightHelper.mode; return E === ep.Mode.Selection ? "selected" : E === ep.Mode.MouseOver ? "hover" : E === ep.Mode.Style ? "style" : "disabled" },
            getDataHighlightMode: function(Z) { return Z.s("highlight.mode") },
            getHighlightColor: function() { return this._highlightHelper.color || h["highlight.color"] },
            setHighlightColor: function(G) {
                var C = this._highlightHelper.color;
                this._highlightHelper.color = G, this.firePropertyChange("highlightColor", C, G)
            },
            getHighlightWidth: function() { return this._highlightHelper.width || h["highlight.width"] },
            setHighlightWidth: function(y) {
                var F = this._highlightHelper.width;
                this._highlightHelper.width = y, this.firePropertyChange("highlightWidth", F, y)
            },
            bindEnvMap: function(Y) {
                var F = this,
                    y = Jg.for(Y),
                    q = y.directUniforms(),
                    P = F.getEnvmap(),
                    c = D.getImage(P);
                if (c && c.tagName) {
                    if (P !== F._lastEnvMap) {
                        var O = {};
                        if (F.dm().isCubicEnvmap()) {
                            var Z = Hc(c),
                                r = Gp(c);
                            if (0 === Z || 0 === r) return;
                            var k = Z / 4,
                                o = r / 3,
                                S = { top: { x: k, y: 0 }, left: { x: 0, y: o }, front: { x: k, y: o }, right: { x: 2 * k, y: o }, back: { x: 3 * k, y: o }, bottom: { x: k, y: 2 * o } };
                            ["top", "left", "front", "right", "back", "bottom"].forEach(function(p) {
                                var w = S[p],
                                    E = O[p] = Sg();
                                Cq(E, k, o, 1);
                                var J = Bp(E);
                                J.drawImage(c, w.x, w.y, k, o, 0, 0, k, o), J.restore(), O[p] = D.resizeImagePOT(E, !0)
                            })
                        } else c = D.resizeImagePOT(c, !0);
                        F._envMapTexture && Y.deleteTexture(F._envMapTexture);
                        var b = F._envMapTexture = Y.createTexture();
                        Y.activeTexture(Y.TEXTURE0), Y.bindTexture(Y.TEXTURE_CUBE_MAP, b), Y.texParameteri(Y.TEXTURE_CUBE_MAP, Y.TEXTURE_MAG_FILTER, Y.LINEAR), Y.texParameteri(Y.TEXTURE_CUBE_MAP, Y.TEXTURE_MIN_FILTER, Y.LINEAR), Y.texImage2D(Y.TEXTURE_CUBE_MAP_POSITIVE_X + 0, 0, Y.RGBA, Y.RGBA, Y.UNSIGNED_BYTE, O.right || c), Y.texImage2D(Y.TEXTURE_CUBE_MAP_POSITIVE_X + 1, 0, Y.RGBA, Y.RGBA, Y.UNSIGNED_BYTE, O.left || c), Y.texImage2D(Y.TEXTURE_CUBE_MAP_POSITIVE_X + 2, 0, Y.RGBA, Y.RGBA, Y.UNSIGNED_BYTE, O.top || c), Y.texImage2D(Y.TEXTURE_CUBE_MAP_POSITIVE_X + 3, 0, Y.RGBA, Y.RGBA, Y.UNSIGNED_BYTE, O.bottom || c), Y.texImage2D(Y.TEXTURE_CUBE_MAP_POSITIVE_X + 4, 0, Y.RGBA, Y.RGBA, Y.UNSIGNED_BYTE, O.front || c), Y.texImage2D(Y.TEXTURE_CUBE_MAP_POSITIVE_X + 5, 0, Y.RGBA, Y.RGBA, Y.UNSIGNED_BYTE, O.back || c), Y.bindTexture(Y.TEXTURE_CUBE_MAP, Y._emptyCubeTexture), F._lastEnvMap = P
                    }
                    q.uEnvMap = F._envMapTexture
                }
            },
            getWireframe: function(I) {
                var M = I.s("wf.visible"),
                    c = I.s("wf.width");
                return M === !0 || c > 0 && "selected" === M && this.isSelected(I) ? { color: I.s("wf.color"), width: c, "short": I.s("wf.short"), mat: I.s("wf.mat") } : void 0
            },
            _transformPointToViewSpace: function(_) { var A = [_[0], _[1], _[2]]; return yi(A, this._viewMatrix), A },
            _transformDirectionToViewSpace: function(Q, c) {
                var y = [Q[0], Q[1], Q[2]];
                yi(y, this._viewMatrix);
                var r = c ? [c[0], c[1], c[2]] : [0, 0, 0];
                yi(r, this._viewMatrix);
                var M = r[0] - y[0],
                    P = r[1] - y[1],
                    j = r[2] - y[2],
                    i = Math.sqrt(M * M + P * P + j * j);
                return i ? [M / i, P / i, j / i] : [M, P, j]
            },
            getWireframeGeometry: function(W) { return W.s("wf.geometry") ? { color: W.s("wf.color"), width: W.s("wf.width"), mat: W.s("wf.mat"), geometry: !0 } : void 0 },
            getBodyColor: function(J) { return J.s("body.color") },
            getMat: function($) { return $.getMat ? $.getMat() : $.s("mat") },
            getFaceMat: function(Z, w) { return Z.getFaceMat ? Z.getFaceMat(w) : Z.s(w + ".mat") },
            getFaceBlend: function(k, u) { return k.s(u + ".blend") || k.s("all.blend") },
            getFaceColor: function(p, L) { return p.s(L + ".color") || p.s("all.color") },
            getFaceImage: function(J, I) { return J.s(I + ".image") || J.s("all.image") },
            getFaceBlendImage: function(R, I) { return R.s(I + ".blend.image") || R.s("all.blend.image") },
            getFaceDiscardSelectable: function(S, e) { var H = S.s(e + ".discard.selectable"); return H == A ? S.s("all.discard.selectable") : H },
            getFaceUv: function(r, T) { return r.s(T + ".uv") || r.s("all.uv") },
            getFaceUvOffset: function(L, c) { return L.s(c + ".uv.offset") || L.s("all.uv.offset") },
            getFaceUvScale: function(C, t) { return C.s(t + ".uv.scale") || C.s("all.uv.scale") },
            getFaceUvRotation: function(A, Y) { return A.s(Y + ".uv.rotation") || A.s("all.uv.rotation") },
            getFaceLight: function(s, R) { var G = s.s(R + ".light"); return G == A ? s.s("all.light") : G },
            getFaceVisible: function(F, W) { var d = F.s(W + ".visible"); return d == A ? F.s("all.visible") : d },
            getFaceOpacity: function(w, I) { var G = w.s(I + ".opacity"); return G == A ? w.s("all.opacity") : G },
            getFaceTransparent: function(C, g) { var n = C.s(g + ".transparent"); return n == A ? C.s("all.transparent") : n },
            getFaceReverseColor: function(A, l) { return A.s(l + ".reverse.color") || A.s("all.reverse.color") },
            getFaceReverseFlip: function(l, T) { var f = l.s(T + ".reverse.flip"); return f == A ? l.s("all.reverse.flip") : f },
            getFaceReverseCull: function(e, q) { var E = e.s(q + ".reverse.cull"); return E == A ? e.s("all.reverse.cull") : E },
            getTextureMap: function() { return this._2O },
            deleteTexture: function(E) {
                var C = this,
                    m = C._2O[E];
                m && (delete C._2O[E], C.getGL().deleteTexture(m))
            },
            renderPickScene: function() {
                var i = this.getGL();
                this.syncRenderState(), this._picking = i._picking = !0, this.renderScene(), this._picking = i._picking = !1
            },
            invalidateCachedTexture: function(T) {
                var $ = this.getData3dUI(T);
                $.invalidateCachedTexture(this.getGL()), this.invalidateData(T)
            },
            invalidateShape3dCachedImage: function(G) { this.invalidateCachedTexture(G) },
            invalidateCachedGeometry: function(b) {
                var n = this.getData3dUI(b);
                n.invalidateCachedGeometry(), this.invalidateData(b)
            },
            isInteractive: function(J) { return J.s("interactive") },
            getTexture: function(t, G, X) {
                if (!t) return A;
                var m = this,
                    h = m.getGL(),
                    e = m._2O[t];
                if (!e) {
                    var V = Jc(t),
                        _ = {};
                    if (!V) return h._emptyTexture;
                    if (G) {
                        _.mipmapMaxLevel = G.s("texture.mipmap.max");
                        var l = G.s("texture.wrap");
                        _.clampToEdge = "clampToEdge" === l ? !0 : "repeat" === l ? !1 : O
                    }
                    if (V.uuid || (V.uuid = k.Math.generateUUID()), V.tagName) {
                        if (V.dynamic) return Xj(h, V, m._1O, _);
                        e = m._2O[t] = Xj(h, V, O, _)
                    } else {
                        var L, N = G && (G.s("texture.cache") || G.s("shape3d.image.cache") || V.textureCache),
                            f = m.vr.isPresenting();
                        if (f && (G._textureUpdateFrame === h._renderInfo.frame ? N = !0 : G._textureUpdateFrame = h._renderInfo.frame), N && (L = m.getData3dUI(G), e = L.getCachedTexture(X), e && L.interactiveInfo && e.interactiveInfo && (L.interactiveInfo[e.interactiveInfo.key] = e.interactiveInfo.info)), !e) {
                            var H = h._renderInfo.textureCache;
                            if (N) { if (H.time > D.graph3dMaxVectorCacheTime) return m.redraw(), h._emptyTexture; if (!fe(V, G)) return h._emptyTexture }
                            var $;
                            G && (1 !== G.s("texture.scale") ? $ = G.s("texture.scale") : 1 !== G.s("shape3d.texture.scale") && ($ = G.s("shape3d.texture.scale"))), $ || ($ = 1);
                            var q = G && (G.s("fixSizeOnScreen") || G.s("shape3d.fixSizeOnScreen")),
                                v = q ? h.NEAREST : h.LINEAR;
                            q ? "number" == typeof q && ($ *= 0 > q ? 1 : q) : G && (G.s("vector.dynamic") || G.s("shape3d.vector.dynamic")) && (L || (L = m.getData3dUI(G)), q = L.getVectorDynamicSize());
                            var M, x, d, s = G && G.s("shape3d");
                            "billboard" === s ? d = G.getTall() / G.getWidth() : "plane" === s && (d = G.getHeight() / G.getWidth());
                            var c = Hc(V, G);
                            if (q) {
                                var U;
                                U = N ? m._devicePixelRatio || fs : m.getDevicePixelRatio(), M = q[0] > 0 ? q[0] * U : $ * c * U, x = q[1] > 0 ? q[1] * U : $ * (d ? Gp(V, G, m, Math.min(4096, c * d)) : Gp(V, G)) * U
                            } else M = $ * c, x = $ * (d ? Gp(V, G, m, Math.min(4096, c * d)) : Gp(V, G));
                            if (M >= 1 && x >= 1) {
                                var B = 0;
                                (N || f) && (B = Date.now());
                                var p = m._glCapabilities.maxTextureSize;
                                M = Math.min(M, p), x = Math.min(x, p);
                                var R = cf(M, x);
                                if (!L && G && (L = m.getData3dUI(G)), L && L.interactiveInfo) {
                                    var r = t;
                                    "object" == typeof r && (r = r.uuid || (r.uuid = k.Math.generateUUID()));
                                    var o = L.interactiveInfo[r] = {};
                                    R.interactiveInfo = o.bodyInfo = { compInfos: [], matrix: new wh, rect: { x: 0, y: 0, width: M, height: x } }
                                }
                                as(R, V, 0, 0, M, x, G, m), R.interactiveInfo && (R.interactiveInfo = null), R.restore(), H.count++, H.pixels += M * x, G ? (_.minFilter = gj(G.s("texture.filter.min") || G.s("texture.filter")) || v, _.magFilter = gj(G.s("texture.filter.mag") || G.s("texture.filter")) || v) : _.minFilter = _.magFilter = v, N || f ? (e = Xj(h, Rl, null, _), L.setCachedTexture(e, X), H.time += Date.now() - B, o && (e.interactiveInfo = { key: r, info: o }), Rl = null) : e = Xj(h, Rl, m._1O, _)
                            }
                        }
                    }
                }
                return e
            },
            redraw: function() { this.iv() },
            validateImpl: function() {
                var M = this;
                if (M._lightChanged) {
                    M._lightChanged = !1;
                    var R = [],
                        y = [],
                        g = [];
                    M.dm().each(function(m) {
                        if (yr(m)) {
                            var e = m.s("light.type");
                            e === $p ? R.push(m) : e === Oe ? y.push(m) : e === qm && g.push(m)
                        }
                    }), (R.length !== M._59O.length || y.length !== M._spots.length || g.length !== M._dirs.length) && nf(M), M._59O = R, M._spots = y, M._dirs = g
                }
                M._42(), M._1o.iv()
            },
            getRenderInfo: function() { var B = this.getGL(); return B ? B._renderInfo : void 0 },
            getDebugTip: function() {
                var $ = this,
                    m = $.getRenderInfo();
                if (m) {
                    var z = $.getGL()._validBufCount || 0,
                        c = "Draw Calls: " + m.calls + "<br/>" + "Vertices: " + m.vertices + "<br/>" + "Faces: " + m.faces + "<br/>" + "Lines: " + m.lines + "<br/>" + (m.points ? "Points: " + m.points + "<br/>" : "") + "Buffers: " + z + "<br/>" + "Cache Models: " + n.keys(Gl).length + "<br/>" + "Shape3d Models: " + n.keys(dm).length;
                    if ($.vr.isPresenting() && (c += "<br/>VR fps: " + $.vr.getFps()), m.textureCache) {
                        var g = m.textureCache.count;
                        if (c += "<br/>2D Dynamic Textures: " + m.textureCache.count, g > 0) {
                            var M, N = m.textureCache.pixels;
                            M = N > 1e6 ? Math.round(N / 1e6) + "M" : N > 1e3 ? Math.round(N / 1e3) + "K" : Math.round(N), c += "<br/>2D Dynamic pixels: " + M
                        }
                    }
                    return c
                }
            },
            getFrameState: function() { return this._frameState },
            isBoundingBoxInView: function() {
                var u = new k.Math.Box3,
                    D = new k.Math.Matrix4;
                return function(Z) {
                    var V = Z;
                    if (V instanceof k.Data && (V = this.getData3dUI(V)), !V.mat) return !0;
                    var e = V.getBoundingBox();
                    u.copy(e).applyMatrix4(D.fromArray(V.mat));
                    var z = this.getFrustum();
                    return z.intersectsBox(u)
                }
            }(),
            updateScene: function() {
                var n = this;
                n._81O = A, n.overlappingBox.clear();
                var N = n._40Q;
                N.init();
                var g = n.getGL(),
                    L = n.dm();
                if (L.isHierarchicalRendering()) L.eachByHierarchical(function(i) {
                    var x = n.getData3dUI(i);
                    x && x.update(n, g, N)
                });
                else {
                    var r, C, y, Z = L.getDatas().getArray(),
                        a = Z.length;
                    for (r = 0; a > r; r++) C = Z[r], y = n.getData3dUI(C), y && y.update(n, g, N)
                }
                N.onUpdated()
            },
            renderScene: function() {
                function X(s, H) { w.setGLState(s, H), w.setUniforms(s), w.renderState.attribs.disable(), _ = f.directUniforms(), B = f.directAttribs(), B.disable() }

                function g(x) {
                    for (; I > L; L++) {
                        var s = i[L];
                        if (!a || !s.ignoreInPick) {
                            if (s.priority >= x) break;
                            (!u._43Q[u._44Q = s.id] || Nj[ag.length]) && (s.render(K, u, w), X())
                        }
                    }
                }
                var u = this;
                u.shadowMap.render(), u._44Q = -1;
                var B, w = u._frameState,
                    f = w.renderState,
                    p = f.glState,
                    _ = f.directUniforms(),
                    K = u.getGL(),
                    c = u._prg;
                u._projectMatrix = Rj(u), qh(u, u._7O), u._viewMatrix = Ac(u._7O), lk(u._projScreenMatrix = ur(), u._projectMatrix, u._viewMatrix), w.syncEnv(this._picking ? this.pickColorMap : O), f.useProgram(c), X(!1, !0), K.clear(K.DEPTH_BUFFER_BIT);
                var a = u._picking,
                    i = this._41Q,
                    L = 0,
                    I = i.length;
                if (g(D.cameraPriority.skybox), a) {
                    var H = p.color.clear.slice(0);
                    xd(K, [0, 0, 0, 0])
                } else xd(K, [0, 0, 0, 0]), p.blend.enabled = !1, p.depth.enabled = !1, p.depth.mask = !1, u.drawSky(K, c), u.drawReflectors(K) && (u._projectMatrix = Rj(u), qh(u, u._7O), u._viewMatrix = Ac(u._7O), w.syncEnv(), X()), p.blend.enabled = !1, p.depth.enabled = !0, p.depth.mask = !0, _.uTransparent = !1, u._31O._42(K, c);
                if (!K.textureBatch || Nj[(ONE_FRAME_TIME - 6) / 2]) {
                    !a && u.shadowMap.enable && u.shadowMap.createShadow(_);
                    for (var d = 0, Y = mb.length; Y > d; d++) {
                        var x = mb[d],
                            J = jj[x];
                        if (!J.ignore) {
                            var z = J.priority;
                            g(z), this.renderLayer(x)
                        }
                    }
                    p.depth.enabled = !1, _.uTransparent = !1, _.shadowReceive = !1, a ? u.drawFilter || u._30O._42(K, c) : (p.blend.enabled = !1, p.depth.mask = !0, u._32O._42(K, c), u._30O._42(K, c), u._highlightHelper._42(K, c)), p.depth.enabled = !0, g(D.cameraPriority.infinity), a && xd(K, H), ab(K, A), Dh(K, A), u._44Q = -1
                }
            },
            renderLayers: function(q, o) { o && (q = qs(q)); for (var O = 0, D = q.length; D > O; O++) this.renderLayer(q[O]) },
            renderLayer: function(m) {
                var i = this,
                    R = i._picking,
                    A = i._40Q.get(m);
                if (A) {
                    var X = i.getGL(),
                        V = i._frameState,
                        b = V.renderState,
                        r = b.glState,
                        w = b.directUniforms();
                    !R && i.isSortable() && A.sort(i._sortFunc, i._projScreenMatrix);
                    var g, y, U, k = A.opaque,
                        l = A.transparent,
                        $ = A.batchModelMap,
                        x = A.polylineModelMap,
                        W = A.wireframeModelMap,
                        X = i.getGL(),
                        C = i._prg;
                    R || (r.blend.enabled = !1, r.depth.enabled = !0, r.depth.mask = !0), w.uTransparent = !1, jj[m].clearDepth !== !1 && X.clear(X.DEPTH_BUFFER_BIT);
                    var H = this.drawFilter;
                    if (H)
                        for (U = k, g = 0, y = U.length; y > g; g++) H(U[g].data) !== !0 && U[g].ui._42(X, C, Q);
                    else {
                        for (U = k, g = 0, y = U.length; y > g; g++) U[g].ui._42(X, C, Q);
                        if (R)
                            for (U = l, g = 0, y = U.length; y > g; g++) U[g].ui._46Q(X);
                        Td(i, $), Kk(i, x), Kk(i, W)
                    }
                    if (R || (r.blend.enabled = !0, r.depth.mask = !1), i._45Q = w.uTransparent = !0, H)
                        for (U = l, g = 0, y = U.length; y > g; g++) H(U[g].data) !== !0 && U[g].ui._42(X, C, I);
                    else {
                        for (U = l, g = 0, y = U.length; y > g; g++) U[g].ui._42(X, C, I);
                        Td(i, $, null, !0), Kk(i, x, null, !0), Kk(i, W, null, !0)
                    }
                    i._45Q = null
                }
            },
            drawV2: function(L) {
                var I = this;
                if (!I._35O && (!tr || Nj(tr))) {
                    var Q = I.getWidth(),
                        A = I.getHeight();
                    if (Q && A) {
                        var k = I.getGL();
                        if (k) {
                            var B, J = I._canvas;
                            if (L ? B = !0 : L = I.getDevicePixelRatio(), !I._picking && (B || Q !== J.clientWidth || A !== J.clientHeight)) {
                                Cq(J, Q, A, L);
                                var z = L;
                                Q && Math.abs(k.drawingBufferWidth - Q * L) > 1 && (z = Math.min(z, k.drawingBufferWidth / Q)), A && Math.abs(k.drawingBufferHeight - A * L) > 1 && (z = Math.min(z, k.drawingBufferHeight / A)), z !== L && (I.setDevicePixelRatio(L = z), Cq(J, Q, A, L)), I._18Q = null
                            }
                            k.clear(k.COLOR_BUFFER_BIT);
                            var O = k._renderInfo;
                            O.calls = 0, O.vertices = 0, O.faces = 0, O.lines = 0, O.points = 0, O.textureCache = { time: 0, count: 0, pixels: 0 }, O.frame = ++I._frameId, O.cacheTimeCost = 0, O.reflectDepth = 0, Q *= L, A *= L, this.syncRenderState();
                            do {
                                if (I.vr.enable && I.vr.render(k, Q, A)) break;
                                if (I.updateScene(), I._postProcessing.render(k, Q, A)) break;
                                I.setViewport(k, 0, 0, Q, A), I.renderScene()
                            } while (!1);
                            I._33Q = !1, I.countFrame(), I._doBufferGC(k)
                        }
                    }
                }
            },
            syncRenderState: function() {
                var b, C;
                (b = this._frameState) && (C = b.renderState) && C.syncLoss()
            },
            _42: function(r, x) { return this.drawV2(x) },
            drawReflectors: function(d) {
                d._renderInfo.reflectDepth++;
                var v, f, $, W = this,
                    x = W._dataModel.getReflectors(),
                    B = !1;
                for (v in x) f = x[v], W.isVisible(f) && ($ = W.getData3dUI(f), $ && $.drawReflector(d) && (B = !0));
                return d._renderInfo.reflectDepth--, B
            },
            isReflecting: function(e) { return e._renderInfo.reflectDepth },
            getPostProcessing: function() { return this._postProcessing },
            enablePostProcessing: function(t, H) { return this._postProcessing.enableModule(t, H) },
            getPostProcessingModule: function(J) { return this._postProcessing.getModule(J) },
            getPostProcessingValue: function(T, E) { var B = this._postProcessing.getModule(T); return B ? B[E] : O },
            setPostProcessingValue: function(V, W, o) {
                var S = this.getPostProcessingValue(V, W),
                    m = this._postProcessing.getModule(V);
                m && S !== o && ("enable" === W ? this.enablePostProcessing(V, o) : m[W] = o, this.firePropertyChange("postProcessing." + V + "." + W, S, o))
            },
            setViewport: function(x, B, i, C, h) { this._viewport = [B, i, C, h], Jg.for(x).directState().viewport = this._viewport },
            getRenderState: function() { return Jg.for(this._26I) },
            getViewport: function() { return this._viewport },
            setBufferGCInterval: function(R) { this._bufferGCInterval = R },
            _doBufferGC: function(s, u) {
                var H, L, o = s._bufPool,
                    V = 0,
                    x = 0,
                    U = s._renderInfo.frame,
                    y = this._bufferGCInterval || 10;
                for (H in o) V++, L = o[H], L && (u || U - L._fid > y ? (s.deleteBuffer(L._buf), L._buf = null, o[H] = null) : x++);
                if (V / 2 > x && V > 128) {
                    var K = {};
                    for (H in o) o[H] && (K[H] = o[H]);
                    s._bufPool = K
                }
                s._validBufCount = x
            },
            _swapLineMap: function() {
                var S = this;
                nq = S._polylineModelMap, S._polylineModelMap = S._polylineModelMapSwap, S._polylineModelMapSwap = nq, nq = S._wireframeModelMap, S._wireframeModelMap = S._wireframeModelMapSwap, S._wireframeModelMapSwap = nq, nq = S._polylineIndexMap, S._polylineIndexMap = S._polylineIndexMapSwap, S._polylineIndexMapSwap = nq, nq = S._wireframeIndexMap, S._wireframeIndexMap = S._wireframeIndexMapSwap, S._wireframeIndexMapSwap = nq
            },
            _updateSkybox: function(K) {
                if (this._skybox && K) {
                    var r = K.property,
                        D = !1,
                        $ = this._skybox;
                    if ("eye" === r || "forceUpdate" === r) {
                        var O = this._eye;
                        $.p3(O[0], O[1], O[2]), D = !0
                    }
                    if ("near" === r || "far" === r || "forceUpdate" === r) {
                        var H = this._near,
                            t = this._far,
                            E = $.getFinalScale3d();
                        if (E[0] /= 2, E[1] /= 2, E[2] /= 2, E[0] <= H || E[0] >= t || E[1] <= H || E[1] >= t || E[2] <= H || E[2] >= t) {
                            var d = 2 * H * t / (H + t),
                                i = Math.min(E[0], E[1], E[2]),
                                e = d / i,
                                C = $.getScale3d();
                            $.setScale3d(C[0] * e, C[1] * e, C[2] * e), D = !0
                        }
                    }
                    D && this.invalidateData($)
                }
            },
            getSkyBox: function() { return this.getSkybox() },
            setSkyBox: function($) { return this.setSkybox($) },
            getSkybox: function() { return this._skybox },
            setSkybox: function(Y) { var t = this._skybox; return t === Y ? (Y && this._updateSkybox({ property: "forceUpdate" }), void 0) : (t && (this._skyboxStyleMap && t.setStyleMap(this._skyboxStyleMap), this._skyboxStyleMap = null, this._skyboxAnchor3d && t.setAnchor3d(this._skyboxAnchor3d), this._skyboxAnchor3d = null, this._skyboxP3 && t.p3(this._skyboxP3), this._skyboxP3 = null), this._skybox = Y, this.ump(this._updateSkybox, this), Y && (Y.dm() && Y.dm().remove(Y), this._skyboxStyleMap = k.Default.clone(Y.getStyleMap()), this._skyboxAnchor3d = Y.getAnchor3d(), Y.setAnchor3d(.5, .5, .5), this._skyboxP3 = Y.p3().slice(0), Y.s({ "shape3d.reverse.flip": !0, "shape3d.reverse.cull": !1, "all.reverse.flip": !0, "all.reverse.cull": !1, "front.reverse.flip": !0, "front.reverse.cull": !1, "back.reverse.flip": !0, "back.reverse.cull": !1, "left.reverse.flip": !0, "left.reverse.cull": !1, "right.reverse.flip": !0, "right.reverse.cull": !1, "top.reverse.flip": !0, "top.reverse.cull": !1, "bottom.reverse.flip": !0, "bottom.reverse.cull": !1 }), this.mp(this._updateSkybox, this), this._updateSkybox({ property: "forceUpdate" })), this.fp("skybox", t, Y), void 0) },
            drawSky: function(h, S) {
                var N = this,
                    Y = N._skybox;
                if (Y) {
                    var t = Jg.for(h).directUniforms(),
                        E = N._headlightIntensity,
                        d = Lf(N._headlightColor),
                        S = N._prg;
                    1 !== E && (d = [d[0] * E, d[1] * E, d[2] * E]), t.uHeadlightColor = [d[0], d[1], d[2], 1];
                    var Q = N.getData3dUI(Y);
                    if (Q) {
                        var v = N.isOrtho(),
                            J = v || this._computedProjectMatrix;
                        if (J) {
                            var e = N._projectMatrix;
                            v && (N._ortho = !1), t.uPMatrix = N._projectMatrix = Rj(N, !0)
                        }
                        var c = Y.p3(),
                            g = this._eye;
                        (c[0] !== g[0] || c[1] !== g[1] || c[2] !== g[2]) && (Y._position.x = g[0], Y._54O = g[1], Y._position.y = g[2]), Q.validate(), Q._42(h, S, R), J && (v && (N._ortho = !0), t.uPMatrix = N._projectMatrix = e)
                    }
                    h.clear(h.DEPTH_BUFFER_BIT), t.uHeadlightColor = [d[0], d[1], d[2], N._headlightDisabled ? 1 : 0]
                }
            },
            getLogicalPoint: function(N) { return Mo(N, this._canvas) },
            isRectOverlapping: function($) { var l = this.getData3dUI($); return l._rectOverlapping },
            getHitFaceInfo: function(h) { h.target && (h = this.lp(h)); var w = this.getDataInfoAt(h); if (w) { var X = this.intersectObject(h, w.data); if (X) return { data: w.data, face: X.part } } return A },
            unproject: function($, d) {
                var A = this,
                    i = A.getWidth(),
                    v = A.getHeight(),
                    K = $.target ? A.lp($) : $,
                    g = K.x - i / 2,
                    O = K.y - v / 2,
                    W = 2 * (g / i),
                    w = 2 * (-1 * O / v);
                d = d || 0;
                var t = ur(),
                    E = Rj(A),
                    e = qh(A);
                lk(t, E, e), Dl(t);
                var D = ki([W, w, d, 1], t);
                return [D[0] / D[3], D[1] / D[3], D[2] / D[3]]
            },
            getDataAt: function(z) { var H = this.getDataInfoAt(z); return H ? H.data : A },
            getDataInfoAt: function(E, l, H) { return E.target && (E = this.lp(E)), this._1o.get(bj(E.x, E.y, l), !0, H) },
            getDatasInRect: function(x) { return this._1o.get(x) },
            setEditable: function(U) {
                var b = this,
                    D = b._editable;
                b._editable = U, this.fp(wi, D, U)
            },
            isEditable: function(i) { var q = this; return i ? q._editable ? Dj(i) ? i.s("3d.editable") ? q._editableFunc ? q._editableFunc(i) : !0 : !1 : !1 : !1 : q._editable },
            isSelectable: function(q) { return q.s("3d.selectable") && this.sm().isSelectable(q) },
            isMovable: function(K) { var j = this; return Si(K) && K.getStyle(Lk) !== Vf ? !1 : K.s("3d.movable") ? j._movableFunc ? j._movableFunc(K) : !0 : !1 },
            isSizeEditable: function(H) { return Dj(H) ? this._sizeEditableFunc ? this._sizeEditableFunc(H) : !0 : !1 },
            isRotationEditable: function(I) { return Dj(I) && I.IRotatable !== !1 ? this._rotationEditableFunc ? this._rotationEditableFunc(I) : !0 : !1 },
            handleDelete: function() { this._editable && this.removeSelection() },
            zoomIn: function(l) { this.setZoom(Gi, l) },
            zoomOut: function(s) { this.setZoom(1 / Gi, s) },
            setZoom: function() {
                var I = new Cb,
                    w = new Cb,
                    A = new Cb,
                    V = new Cb;
                return function(x, p) {
                    if (1 !== x) {
                        var R = this;
                        R._14o && R._14o.stop(!0);
                        var O, n = 1 / x;
                        I.copy(R.getCenter()), w.copy(R.getEye());
                        var l = R._ortho;
                        if (l) { if (O = R._orthoWidth, O < R._moveStep && x > 1) return } else if (I.distanceTo(w) < R._moveStep && 1 > n) return;
                        var H = !1;
                        return R._zoomToCenter === !1 && R._lastZoomLP && (A.copy(w).sub(I).normalize(), R._81O = null, V.copy(R.getHitPosition(R._lastZoomLP, I.toArray(), A.toArray())), H = !0, R._lastZoomHit = V), (p = Ur(p)) ? (p.action = function(W) {
                            R.fi({ kind: R._zooming ? "betweenZoom" : "beginZoom" }), R._zooming = 1;
                            var o = (n - 1) * W + 1;
                            l && R.setOrthoWidth(O * o), H ? (R.setEye(A.lerpVectors(V, w, o).toArray()), R.setCenter(A.lerpVectors(V, I, o).toArray())) : R.setEye(A.lerpVectors(I, w, o).toArray())
                        }, p._37o = function() { delete R._14o, delete R._zooming, R.fi({ kind: "endZoom" }), R.onZoomEnded() }, R._14o = Il(p)) : (l && R.setOrthoWidth(O * n), H ? (R.setEye(A.lerpVectors(V, w, n).toArray()), R.setCenter(A.lerpVectors(V, I, n).toArray())) : l || R.setEye(A.lerpVectors(I, w, n).toArray()), void 0)
                    }
                }
            }(),
            setOrthoZoom: function(B, V) { return this.setZoom(B, V) },
            getPositionInfo: function(d) {
                var h = this,
                    e = h._eye,
                    x = h._center,
                    r = h.getAspect(),
                    D = d ? Uj(zd(x, e, !0), zd(d, e)) : _q(e, x);
                if (h._ortho) { var S = h._orthoWidth; return { length: D, height: S / r, width: S } }
                var c = 2 * rg(h._fovy / 2) * D;
                return { length: D, height: c, width: c * r }
            },
            getCenterInfo: function() { var e = this; return e._81O || (e._81O = e.getPositionInfo()), tf(e._81O) },
            rotate: function(j, G, t, R) {
                var B = this;
                if (j || G) {
                    R == A && (R = B._firstPersonMode), B._88O && B._88O.stop(!0);
                    var Q = B._center,
                        L = B._eye,
                        S = B.getCenterInfo().length,
                        m = R ? Q : L,
                        b = R ? L : Q,
                        D = zd(m, b),
                        f = Cc(D[0], D[2]),
                        l = Cc(z(D[0] * D[0] + D[2] * D[2]), D[1]),
                        u = R ? Tc : wj;
                    return R && (G = -G), (t = Ur(t)) ? (t.action = function(Q) {
                        B.fi({ kind: B._rotating ? "betweenRotate" : "beginRotate" }), B._rotating = 1;
                        var e = f + j * Q,
                            r = l + G * Q;
                        r = R ? U - hh(B, U - r) : hh(B, r), D[0] = S * N(r) * N(e), D[1] = S * C(r), D[2] = S * N(r) * C(e), m[0] = b[0] + D[0], m[1] = b[1] + D[1], m[2] = b[2] + D[2], B.fp(u, A, m)
                    }, t._37o = function() { delete B._88O, delete B._rotating, B.fi({ kind: "endRotate" }), B.onRotateEnded() }, B._88O = Il(t)) : (f += j, l += G, l = R ? U - hh(B, U - l) : hh(B, l), D[0] = S * N(l) * N(f), D[1] = S * C(l), D[2] = S * N(l) * C(f), m[0] = b[0] + D[0], m[1] = b[1] + D[1], m[2] = b[2] + D[2], B.fp(u, A, m), void 0)
                }
            },
            pan: function(d, n, h, C) {
                if (d || n) {
                    var F = this;
                    C == A && (C = F._firstPersonMode), F._89O && F._89O.stop(!0);
                    var O = qh(F),
                        e = [O[0] * d, O[4] * d, O[8] * d],
                        V = [O[1] * n, O[5] * n, O[9] * n],
                        R = e[0] + V[0],
                        L = e[1] + V[1],
                        X = e[2] + V[2],
                        g = F._center,
                        x = F._eye;
                    if (C) {
                        var r = mh(F.getBoundaries(), x[0], x[2], x[0] + R, x[2] + X, z(R * R + X * X));
                        R = r[0], X = r[1]
                    }
                    if (h = Ur(h)) {
                        var Q = tf(x),
                            c = tf(g);
                        return h.action = function(u) { F.fi({ kind: F._panning ? "betweenPan" : "beginPan" }), F._panning = 1, g[0] = c[0] + R * u, g[1] = c[1] + L * u, g[2] = c[2] + X * u, x[0] = Q[0] + R * u, x[1] = Q[1] + L * u, x[2] = Q[2] + X * u, F.fp(wj, A, x), F.fp(Tc, A, g) }, h._37o = function() { delete F._89O, delete F._panning, F.fi({ kind: "endPan" }), F.onPanEnded() }, F._89O = Il(h)
                    }
                    g[0] += R, g[1] += L, g[2] += X, x[0] += R, x[1] += L, x[2] += X, F.fp(wj, A, x), F.fp(Tc, A, g)
                }
            },
            walk: function(a, D, d) {
                if (a) {
                    var W = this;
                    d == A && (d = W._firstPersonMode), W._90O && W._90O.stop(!0);
                    var e = W._center,
                        h = W._eye,
                        t = zd(e, h, !0);
                    if (d) {
                        var $ = mh(W.getBoundaries(), h[0], h[2], h[0] + t[0] * a, h[2] + t[2] * a, X(a));
                        if (a = _q($), !a) return;
                        t = [$[0] / a, 0, $[1] / a]
                    }
                    if (D = Ur(D)) {
                        var y = tf(h),
                            J = tf(e);
                        return D.action = function(B) {
                            W.fi({ kind: W._walking ? "betweenWalk" : "beginWalk" }), W._walking = 1;
                            var U = a * B;
                            h[0] = y[0] + t[0] * U, h[1] = y[1] + t[1] * U, h[2] = y[2] + t[2] * U, e[0] = J[0] + t[0] * U, e[1] = J[1] + t[1] * U, e[2] = J[2] + t[2] * U, W.fp(wj, A, h), W.fp(Tc, A, e)
                        }, D._37o = function() { delete W._90O, delete W._walking, W.fi({ kind: "endWalk" }), W.onWalkEnded() }, W._90O = Il(D)
                    }
                    h[0] += t[0] * a, h[1] += t[1] * a, h[2] += t[2] * a, e[0] += t[0] * a, e[1] += t[1] * a, e[2] += t[2] * a, W.fp(wj, A, h), W.fp(Tc, A, e)
                }
            },
            handleScroll: function(f, j) {
                f.preventDefault();
                var l = this,
                    F = l._moveStep,
                    O = l.getDataInfoAt(f);
                if (O) {
                    var d = O.data;
                    if (d && l.isInteractive(d)) {
                        var L = l.intersectObject(f, d);
                        if (L) {
                            var s = L.part,
                                K = Jc(d.s(s + ".image") || d.s("shape3d." + s + ".image") || d.s("all.image") || d.s("shape3d.image"));
                            if (K && Rr(K.scrollable, d, l)) return
                        }
                    }
                }
                return l.isFirstPersonMode() ? (l.isPannable() && l.pan(0, j > 0 ? F : -F), void 0) : (l.isZoomable() && (l._lastZoomLP = l.lp(f), l.setZoom(0 > j ? 1 / ee : ee), l._lastZoomLP = l._lastZoomHit = null), void 0)
            },
            handlePinch: function(m, Y) {
                if (this.isZoomable()) {
                    if (Math.abs(m - Y) < D.pinchZoomThreshold) return;
                    this.setZoom(Y > m ? 1 / Ol : Ol)
                }
            },
            reset: function() { this.setCenter(D.graph3dViewCenter), this.setEye(D.graph3dViewEye), this.setUp(D.graph3dViewUp) },
            moveSelection: function(w, E, o) {
                var t = this;
                t.dm().beginTransaction(), Em(this.sm().toSelection(this.isMovable, this), w, E, o), t.dm().endTransaction()
            },
            getMoveMode: function(i, j) {
                var c = j.s("3d.move.mode");
                if (c) return c;
                var W = "88",
                    F = "89",
                    Y = "90";
                return eq(i) || $m[W] && $m[F] && $m[Y] ? "xyz" : $m[W] && $m[F] ? "xy" : $m[W] && $m[Y] ? "xz" : $m[F] && $m[Y] ? "yz" : $m[W] ? "x" : $m[F] ? "y" : $m[Y] ? "z" : "xz"
            },
            handleTick: function() {
                var l = this,
                    U = !1,
                    d = l._moveStep,
                    c = d,
                    M = !1,
                    J = !0,
                    I = l._rotateStep * (J ? -1 : 1);
                if (l.isWalkable() || (c = 0), l.isPannable() || (d = 0), l.isRotatable() || (I = 0), l._32Q) {
                    var x = (Xc() - l._32Q) / 50;
                    c *= x, d *= x, I *= x
                }
                l._31Q && (xb(l._31Q), delete l._31Q, delete l._32Q), ok() && (U = !0, l.pan(-d, 0, M, J)), ho() && (U = !0, l.pan(d, 0, M, J)), oc() && (U = !0, eq() ? l.pan(0, d, M, J) : l.walk(c, M, J)), sl() && (U = !0, eq() ? l.pan(0, -d, M, J) : l.walk(-c, M, J)), Dg() && (U = !0, l.rotate(-I, 0, M, J)), Wg() && (U = !0, l.rotate(I, 0, M, J)), Yi() && (U = !0, l.rotate(0, -I / 2, M, J)), gg() && (U = !0, l.rotate(0, I / 2, M, J)), U && (l._32Q = Xc(), l._31Q = Lh(l.handleTick, l))
            },
            handleKeyDown: function(U) { var f = this;!Xn(U) && Ub[U.keyCode] ? f.handleTick() : Bo(U) ? f.selectAll() : Tp(U) ? f.handleDelete(U) : wd(U) && this.isResettable() && f.reset() },
            checkDoubleClickOnNote: function(Z, x, t) { var p = this; if (t === Rc) { if (x.s("note.toggleable")) return x.s(Cp, !x.s(Cp)), p.fi({ kind: "toggleNote", event: Z, data: x, part: t }), !0 } else if (t === td && x.s("note2.toggleable")) return x.s(ld, !x.s(ld)), p.fi({ kind: "toggleNote2", event: Z, data: x, part: t }), !0; return !1 },
            checkDoubleClickOnRotation: function(I, g, G) { return G === ys ? (g.setRotationX(0), !0) : G === Ic ? (g.setRotationY(0), !0) : G === yb ? (g.setRotationZ(0), !0) : !1 },
            onRotateEnded: function() {},
            onWalkEnded: function() {},
            getViewRatio: function(w) {
                var t = this;
                if (t.isOrtho()) return t.getWidth() / t.getOrthoWidth();
                var e = t.getCenter(),
                    I = t.getHeight(),
                    B = t.getEye(),
                    A = [e[0] - B[0], e[1] - B[1], e[2] - B[2]],
                    L = [w[0] - B[0], w[1] - B[1], w[2] - B[2]],
                    h = Math.sqrt(A[0] * A[0] + A[1] * A[1] + A[2] * A[2]),
                    Z = 1 / Math.tan(t.getFovy() / 2);
                return I * h * Z / (L[0] * A[0] + L[1] * A[1] + L[2] * A[2])
            },
            inViewSpace: function(K) {
                var j, l = this,
                    G = l._transformPointToViewSpace(K),
                    U = l.getAspect(),
                    z = l.getNear(),
                    h = l.getFar();
                return -G[2] < z || -G[2] > h ? !1 : l.isOrtho() ? (j = l.getOrthoWidth() / 2, Math.abs(G[0]) <= j && Math.abs(G[1] * U) <= j) : (j = Math.sqrt(G[0] * G[0] + G[1] * G[1] + G[2] * G[2]) * Math.tan(l.getFovy() / 2), Math.abs(G[1] <= j) && Math.abs(G[0]) <= j * U)
            },
            getPVMatrix: function() { var X, h = this; return (X = h._18Q) || (X = Rj(h), h._18Q = lk(X, X, qh(h)), h._18Q._wh = h.getWidth() / 2 / h.getHeight()), X },
            getFrustum: function() {
                var j = new rs,
                    D = new mc,
                    f = new Array(16);
                return function() { for (var L = this.getPVMatrix(), M = !1, C = 0; 16 > C; C++) L[C] !== f[C] && (M = !0, f[C] = L[C]); return M && D.setFromMatrix(j.fromArray(L)), D }
            }(),
            toViewPosition: function(I) {
                var n = this,
                    s = n.getWidth() / 2,
                    z = n.getHeight() / 2,
                    f = n.getPVMatrix();
                return I = ki([I[0], I[1], I[2], 1], f), { x: s + s * I[0] / I[3], y: z - z * I[1] / I[3], z: I[2] / I[3] }
            },
            getHitPosition: function(s, o, F) {
                var Y = this,
                    z = Y.getWidth(),
                    Z = Y.getHeight(),
                    j = s.target ? Y.lp(s) : s,
                    c = j.x - z / 2,
                    l = j.y - Z / 2,
                    P = Y.getCenterInfo(),
                    r = qh(Y);
                o = o ? o : [0, 0, 0], F = F ? F : [0, 1, 0], c = c / z * P.width, l = -1 * l / Z * P.height;
                var b = [r[0] * c, r[4] * c, r[8] * c],
                    $ = [r[1] * l, r[5] * l, r[9] * l],
                    N = [b[0] + $[0], b[1] + $[1], b[2] + $[2]],
                    W = Y.getCenter(),
                    J = lh(Y, o, F, [N[0] + W[0], N[1] + W[1], N[2] + W[2]]);
                return J ? J : [0, 0, 0]
            },
            intersectObject: function(Z, h) { return this._raycaster.intersectObject(Z, h) },
            intersectObjects: function(N, T, j) { return this._raycaster.intersectObjects(N, T, j) },
            getLineLength: function(t) { this.validate(); var B = this.getData3dUI(t); if (B && B.getCache) { var S = B.getCache(); if (S) return S[S.length - 1].length } return 0 },
            getLineOffset: function(Y, X) {
                var b = this.getData3dUI(Y);
                if (b && b.getCache) {
                    var v = b.getCache();
                    if (v) {
                        var U = On(v, X);
                        if (!Y.r3) return U;
                        var W = Y.r3();
                        if (0 === W[0] && 0 === W[1] && 0 === W[2]) return U;
                        var O = new Cb(Y.p3()),
                            N = new Cb(U.point).sub(O),
                            l = new Cb(U.tangent).add(N),
                            T = (new Wd).setFromEuler(new Mq(W, Y.getRotationMode(), !0));
                        return N.applyQuaternion(T), l.applyQuaternion(T), { point: N.add(O), tangent: l.sub(N).normalize() }
                    }
                }
                return A
            },
            isLabelVisible: function() { return !0 },
            isNoteVisible: function() { return !0 },
            moveCamera: function(K, $, i) {
                var x = this,
                    E = x.getEye();
                E = [E[0], E[1], E[2]];
                var k = x.getCenter();
                if (k = [k[0], k[1], k[2]], K || (K = E), $ || ($ = k), x._flyAnim && x._flyAnim.stop(!0), i = Ur(i), !i) return x.setEye(K[0], K[1], K[2]), x.setCenter($[0], $[1], $[2]), delete x._flyAnim, !0;
                var o = [K[0] - E[0], K[1] - E[1], K[2] - E[2]],
                    j = [$[0] - k[0], $[1] - k[1], $[2] - k[2]];
                return i.action = function(z) { x.setCenter(k[0] + j[0] * z, k[1] + j[1] * z, k[2] + j[2] * z), x.setEye(E[0] + o[0] * z, E[1] + o[1] * z, E[2] + o[2] * z) }, i._37o = function() { delete x._flyAnim }, x._flyAnim = Il(i)
            },
            flyTo: function() {
                function S(F, U, v) {
                    if (v instanceof k.Node) {
                        G.fromArray(Rp(v, U.getMat(v)));
                        var E = v.getAnchor3d();
                        F.push((new Cb).set(0 - E.x, 0 - E.y, 0 - E.z).applyMatrix4(G)), F.push((new Cb).set(0 - E.x, 0 - E.y, 1 - E.z).applyMatrix4(G)), F.push((new Cb).set(0 - E.x, 1 - E.y, 0 - E.z).applyMatrix4(G)), F.push((new Cb).set(0 - E.x, 1 - E.y, 1 - E.z).applyMatrix4(G)), F.push((new Cb).set(1 - E.x, 0 - E.y, 0 - E.z).applyMatrix4(G)), F.push((new Cb).set(1 - E.x, 0 - E.y, 1 - E.z).applyMatrix4(G)), F.push((new Cb).set(1 - E.x, 1 - E.y, 0 - E.z).applyMatrix4(G)), F.push((new Cb).set(1 - E.x, 1 - E.y, 1 - E.z).applyMatrix4(G))
                    }
                }
                var A = new Cb,
                    M = new Cb,
                    N = new Cb,
                    K = new Cb,
                    G = new rs,
                    d = new k.Math.Quaternion,
                    g = new Mq,
                    f = new tk;
                return function(P, h, s) {
                    var n = this;
                    if (s !== O) h = { animation: h, ratio: s };
                    else {
                        var w = typeof h;
                        ("boolean" === w || "object" === w && h.duration) && (h = { animation: h })
                    }
                    h = h || {}, A.fromArray(n.getEye()), M.fromArray(n.getCenter());
                    var y, m, X = [],
                        H = h.center,
                        B = h.distance === O;
                    if (H && N.fromArray(H), P instanceof k.Node) H || N.fromArray(P.p3()), B && (S(X, n, P), y = X.length);
                    else {
                        if (P || (P = n.dm().getDatas()), !P.length) return;
                        if ((B || !H) && (X = [], P.forEach(function(o) { S(X, n, o) }), y = X.length, !y)) return;
                        H || (f.setFromPoints(X), N.copy(f.min).add(f.max).multiplyScalar(.5))
                    }
                    if (n.setCenter(N.x, N.y, N.z), K.subVectors(A, M), h.direction || h.worldDirection) {
                        !h.worldDirection && P instanceof k.Node ? d.setFromEuler(g.set(P.r3(), P.getRotationMode(), !0)) : d.set(0, 0, 0, 1);
                        var a = K.length();
                        K.fromArray(h.worldDirection || h.direction).applyQuaternion(d).setLength(a)
                    }
                    var U = 0;
                    if (B) {
                        var Y, Z, l, s = h.ratio || .8,
                            r = h.xRatio || s,
                            x = h.yRatio || s;
                        if (n.isOrtho()) {
                            var Q = -1 / 0;
                            for (n._eye[0] = K.x + N.x, n._eye[1] = K.y + N.y, n._eye[2] = K.z + N.z, Y = Rj(n), lk(Y, Y, qh(n)), m = 0; y > m; m++) l = X[m], Z = ki([l.x, l.y, l.z, 1], Y), Q = Math.max(Q, Math.max(Math.abs(Z[0]) / r, Math.abs(Z[1]) / x));
                            U = n.getOrthoWidth() * Q, K.add(N)
                        } else {
                            for (var J, _, t = n.getNear(), W = 10; W--;) {
                                for (n._eye[0] = K.x + N.x, n._eye[1] = K.y + N.y, n._eye[2] = K.z + N.z, Y = Rj(n), lk(Y, Y, qh(n)), J = !0, _ = -1 / 0, m = 0; y > m; m++) {
                                    if (l = X[m], Z = ki([l.x, l.y, l.z, 1], Y), Z[3] < t && W) { K.multiplyScalar(2), J = !1; break }
                                    _ = Math.max(_, Math.max(Math.abs(Z[0]) / r, Math.abs(Z[1]) / x) - Z[3])
                                }
                                if (J) break
                            }
                            K.setLength(_ + K.length()).add(N)
                        }
                    } else K.setLength(h.distance).add(N);
                    n._flyAnim && n._flyAnim.stop(!0);
                    var T = Ur(h.animation);
                    if (T) {
                        n.setEye(A.x, A.y, A.z), n.setCenter(M.x, M.y, M.z);
                        var c = (new Cb).subVectors(K, A),
                            p = (new Cb).subVectors(N, M);
                        if (U) var G = n.getOrthoWidth();
                        var e = new Cb,
                            D = new Cb,
                            j = T.action,
                            F = T._37o,
                            u = A.clone(),
                            z = M.clone();
                        return T.action = function(R, h) { e.copy(u).addScaledVector(c, R), D.copy(z).addScaledVector(p, R), n.setCenter(D.x, D.y, D.z), n.setEye(e.x, e.y, e.z), U && n.setOrthoWidth((U - G) * R + G), j && j(R, h) }, T._37o = function() { delete n._flyAnim, F && F() }, { lastEye: A, lastCenter: M, eye: K, center: N, orthoWidth: U, animation: n._flyAnim = Il(T) }
                    }
                    return n.setEye(K.x, K.y, K.z), U && n.setOrthoWidth(U), delete n._flyAnim, { lastEye: A, lastCenter: M, eye: K, center: N, orthoWidth: U }
                }
            }(),
            getBoundingBox: function() {
                function b(m, p, G) {
                    r.fromArray(Rp(G, p.getMat(G)));
                    var f = G.getAnchor3d();
                    m.push((new Cb).set(0 - f.x, 0 - f.y, 0 - f.z).applyMatrix4(r)), m.push((new Cb).set(0 - f.x, 0 - f.y, 1 - f.z).applyMatrix4(r)), m.push((new Cb).set(0 - f.x, 1 - f.y, 0 - f.z).applyMatrix4(r)), m.push((new Cb).set(0 - f.x, 1 - f.y, 1 - f.z).applyMatrix4(r)), m.push((new Cb).set(1 - f.x, 0 - f.y, 0 - f.z).applyMatrix4(r)), m.push((new Cb).set(1 - f.x, 0 - f.y, 1 - f.z).applyMatrix4(r)), m.push((new Cb).set(1 - f.x, 1 - f.y, 0 - f.z).applyMatrix4(r)), m.push((new Cb).set(1 - f.x, 1 - f.y, 1 - f.z).applyMatrix4(r))
                }
                var r = new rs;
                return function(z) {
                    if (z = z || this.sm().getSelection(), z instanceof k.Node && (z = [z]), 0 === z.length) return A;
                    var X = [];
                    z.forEach(function(d) { Dj(d) && b(X, this, d) }, this);
                    var t = [1 / 0, 1 / 0, 1 / 0],
                        q = [-1 / 0, -1 / 0, -1 / 0];
                    return X.forEach(function(j) { t[0] = Math.min(j.x, t[0]), t[1] = Math.min(j.y, t[1]), t[2] = Math.min(j.z, t[2]), q[0] = Math.max(j.x, q[0]), q[1] = Math.max(j.y, q[1]), q[2] = Math.max(j.z, q[2]) }), { min: t, max: q }
                }
            }(),
            setBatchInfo: function(v, b) {
                var B = this._batchInfoMap[v];
                this._batchInfoMap[v] = b, this.fp("batchInfo", B, b)
            },
            getBatchInfo: function(K) { return this._batchInfoMap[K] || mm[K] }
        }), Of.RenderEnv = function(C) { this.gv = C, this.enable = !1 }, n.defineProperties(Of.RenderEnv.prototype, { debugOn: { get: function() { return this._debugOn }, set: function(m) { this._debugOn = m, this.capture && this.capture() } } }), n.assign(Of.RenderEnv.prototype, {
            renderEnvToCube: function(u, X, h, z) {
                var M = this,
                    g = M.gv;
                if (!u || !X || !h) return M.enable = !1, M._42 = null, void 0;
                M.enable = !0;
                var d = Math.floor(z / u * X),
                    F = g.getGL(),
                    y = M._renderTargets;
                y ? y.length < h && (y = M._renderTargets = y.concat(new Array(h - y.length))) : y = M._renderTargets = new Array(h);
                for (var m = 0; h > m; m++) y[m] ? y[m].setSize(F, z, d) : y[m] = new Of.RenderTarget(g, F, z, d);
                var J = !1;
                M.capture = function() { J = !0, g._42(), J = !1 };
                var c = new Cb,
                    Y = new Cb,
                    k = new Cb,
                    A = new Cb,
                    t = (new Cb).setY(0),
                    e = 2 * Math.PI / h,
                    T = u / 2 / Math.tan(Math.PI / h),
                    E = 2 * Math.atan2(X / 2, T),
                    p = u / X;
                M._42 = function(f, u, D, I) {
                    var U = M._debugOn;
                    if (!J && !U) return !1;
                    c.copy(g.getEye()), A.copy(g.getCenter()).sub(c);
                    var V = Math.atan2(A.z, A.x),
                        Q = g.getNear(),
                        B = g.getFovy(),
                        R = g.getAspect();
                    Y.copy(g.getCenter());
                    for (var z, K = 0; h > K; K++)
                        if (z = y[K], t.setZ(Math.cos(V)).setX(Math.sin(V)).multiplyScalar(T), V -= e, k.addVectors(c, t), g.setNear(T), g.setCenter([k.x, k.y, k.z]), g.setFovy(E), g.setAspect(p), U) {
                            var i = Math.round(u / h);
                            Jg.for(f).glState.viewport = [i * K, 0, i, D], I()
                        } else md(f, z.frame), Jg.for(f).glState.viewport = [0, 0, z.width, z.height], f.clear(f.COLOR_BUFFER_BIT), I(), Fc(f), z.assureTexture();
                    return g.setNear(Q), g.setCenter([Y.x, Y.y, Y.z]), g.setFovy(B), g.setAspect(R), !0
                }, M.capture()
            },
            getTextureInfo: function(f) { var h = this._renderTargets; if (!h) return null; var L = this._renderTargets[f]; return L ? { index: f, texture: L.texture, textureName: L.uuid } : null }
        }), n.assign(Of.Graph3dView.prototype, {
            renderEnvToCube: function(g, y, Y, N) {
                var c = this;
                c.envRenderer || (c.envRenderer = new Of.RenderEnv(c)), c.envRenderer.renderEnvToCube(g, y, Y, N)
            }
        });
        var Ak = ["left", "front", "right", "back", "top", "bottom"],
            gf = Of._RenderList = function() {
                function w() { P.length = 0, I.length = 0, F = {} }

                function t(f) {
                    var k, r, h, F, m = f.gv,
                        j = f.data,
                        p = f.shapeModel;
                    if (p) { var l, w, W, Q = j.s("shape3d.transparent") || j.s("points.transparent"); for (ud(p) || (l = Rr(p.transparent, j, m), p = [p]), h = 0, F = p.length; F > h; h++) W = p[h], w = Rr(W.transparent, j, m), w === O && (w = l), w === O && (w = Q), w ? r = !0 : k = !0 }
                    for (h = 0, F = Ak.length; F > h; h++) {
                        var u = f[Ak[h]];
                        u && (u.transparent ? r = !0 : k = !0)
                    }
                    m.isLabelVisible(j) && (f.labelInfo && (j.s($c + ".transparent") ? r = !0 : k = !0), f.label2Info && (j.s(If + ".transparent") ? r = !0 : k = !0)), m.isNoteVisible(j) && (f.noteInfo && (j.s(Rc + ".transparent") ? r = !0 : k = !0), f.note2Info && (j.s(td + ".transparent") ? r = !0 : k = !0)), f._38o && (r = k = !0), r || (k = !0), f._renderParams = { opaque: k, transparent: r }
                }

                function j(U, z) {
                    z && t(U);
                    var o = U.data,
                        f = o._id;
                    if (!F[f]) {
                        F[f] = !0;
                        var X = U._renderParams;
                        X && X.visible !== !1 && (U = { ui: U, data: o, z: 0, id: f }, X.opaque && P.push(U), X.transparent && I.push(U))
                    }
                }

                function Z(W, V) {
                    if (I.length > 1) {
                        for (var h, k = 0, a = I.length; a > k; k++) h = I[k].data.p3(), I[k].z = yi(h, V)[2];
                        I.sort(W || b)
                    }
                }

                function C(a) { a ? (Fd(E, B, a), Fd(J, g, a), Fd(s, p, a)) : (E = this.batchModelMap = {}, B = this.batchIndexMap = {}, J = this.polylineModelMap = {}, g = this.polylineIndexMap = {}, s = this.wireframeModelMap = {}, p = this.wireframeIndexMap = {}), this.markBatchInvalid() }

                function m(d) { d ? Fd(E, B, d) : (E = this.batchModelMap = {}, B = this.batchIndexMap = {}), this.markBatchInvalid() }

                function S(t) { t ? Fd(J, g, t) : (J = this.polylineModelMap = {}, g = this.polylineIndexMap = {}), this.markBatchInvalid() }

                function M(V) { V ? Fd(s, p, V) : (s = this.wireframeModelMap = {}, p = this.wireframeIndexMap = {}), this.markBatchInvalid() }

                function v() { return this._batchInvalid }

                function L() { this._batchInvalid = !0 }

                function R() { this._batchInvalid = null }
                var P = [],
                    I = [],
                    E = {},
                    B = {},
                    J = {},
                    g = {},
                    s = {},
                    p = {},
                    F = {};
                return { opaque: P, transparent: I, init: w, push: j, batchModelMap: E, batchIndexMap: B, polylineModelMap: J, polylineIndexMap: g, wireframeModelMap: s, wireframeIndexMap: p, ivBatch: C, ivModelBatch: m, ivPolylineBatch: S, ivWireframeBatch: M, markBatchInvalid: L, isBatchInvalid: v, onUpdated: R, sort: Z }
            },
            Wn = Of._RenderLists = function() {
                function A() { for (var A in W) W[A].init() }

                function Q() { for (var o in W) W[o].onUpdated() }

                function h(E, j) { E = E || "main"; var $ = W[E]; return !$ && j && ($ = W[E] = new gf), $ }

                function v(m, Q) {
                    var N = m.data.getRenderLayer(),
                        X = h(N, !0);
                    X.push(m, Q)
                }

                function p($) { for (var T in W) $(W[T]) }
                var W = {};
                return { init: A, onUpdated: Q, get: h, push: v, each: p, lists: W }
            },
            pb = Of.RenderTarget = function(A, c, M, t, D) {
                var X = this;
                D = D || {}, D.samples = Math.min(A._glCapabilities.maxSamples, D.samples && D.samples > 1 && 2 === A._webGLVersion ? D.samples : 0), X.options = D, X.uuid = k.Math.generateUUID(), X.gv = A, X.init(A, c, D), D.samples && !A._glCapabilities._maxSamplesChecked ? X.setSize(c, M || 1, t || 1) : X.setSize(c, M, t)
            };
        n.assign(Of.RenderTarget.prototype, {
            bind: function(z) { md(z, this.options.samples ? this._MSAAFbo : this.frame) },
            unbind: function(R) { Fc(R), this.options.samples && (R.bindFramebuffer(R.READ_FRAMEBUFFER, this._MSAAFbo), R.bindFramebuffer(R.DRAW_FRAMEBUFFER, this.frame), R.blitFramebuffer(0, 0, this.width, this.height, 0, 0, this.width, this.height, R.COLOR_BUFFER_BIT, R.NEAREST), R.bindFramebuffer(R.READ_FRAMEBUFFER, null), R.bindFramebuffer(R.DRAW_FRAMEBUFFER, null)) },
            init: function(R, v, L) {
                var K = this,
                    N = K.texture = v.createTexture();
                v.activeTexture(v.TEXTURE0), Jo(v, N);
                var d = L.samples,
                    g = d ? v.NEAREST : v.LINEAR;
                v.texParameteri(v.TEXTURE_2D, v.TEXTURE_MIN_FILTER, L.minFilter || g), v.texParameteri(v.TEXTURE_2D, v.TEXTURE_MAG_FILTER, L.magFilter || g), Jo(v, null), K.render = v.createRenderbuffer(), K.frame = v.createFramebuffer(), R._2O[K.uuid] = N
            },
            assureTexture: function() {
                var M = this,
                    J = M.uuid,
                    G = M.gv._2O;
                G[J] || (G[J] = M.texture)
            },
            setSize: function(E, l, i) {
                var T = this;
                if (l && i && (T.width !== l || T.height !== i)) {
                    var j = E.RGBA,
                        Q = E.TEXTURE_2D,
                        v = E.RENDERBUFFER,
                        M = E.FRAMEBUFFER,
                        U = T.options.samples;
                    if (E.activeTexture(E.TEXTURE0), Jo(E, T.texture), E.texImage2D(Q, 0, j, l, i, 0, j, E.UNSIGNED_BYTE, A), zn.isPOT(l) && zn.isPOT(i) && !T.options.clampToEdge ? (E.texParameteri(E.TEXTURE_2D, E.TEXTURE_WRAP_S, E.REPEAT), E.texParameteri(E.TEXTURE_2D, E.TEXTURE_WRAP_S, E.REPEAT)) : (E.texParameteri(E.TEXTURE_2D, E.TEXTURE_WRAP_S, E.CLAMP_TO_EDGE), E.texParameteri(E.TEXTURE_2D, E.TEXTURE_WRAP_T, E.CLAMP_TO_EDGE)), E.bindRenderbuffer(v, T.render), U) {
                        var g = T.gv._glCapabilities;
                        if (g._maxSamplesChecked) E.renderbufferStorageMultisample(v, U, E.DEPTH_COMPONENT16, l, i);
                        else {
                            for (E.getError(); U > 1 && (E.renderbufferStorageMultisample(v, U, E.DEPTH_COMPONENT16, l, i), E.getError());) U = Math.floor(U >> 1);
                            1 >= U && (U = 0, E.texParameteri(E.TEXTURE_2D, E.TEXTURE_MIN_FILTER, T.options.minFilter || E.LINEAR), E.texParameteri(E.TEXTURE_2D, E.TEXTURE_MAG_FILTER, T.options.magFilter || E.LINEAR), E.renderbufferStorage(v, E.DEPTH_COMPONENT16, l, i)), g._maxSamplesChecked = !0, g.maxSamples = T.options.samples = U
                        }
                    } else E.renderbufferStorage(v, E.DEPTH_COMPONENT16, l, i);
                    U && !T._MSAAFbo && (T._MSAAFbo = E.createFramebuffer(), T._MSAARbO = E.createRenderbuffer()), md(E, T.frame), E.framebufferTexture2D(M, E.COLOR_ATTACHMENT0, Q, T.texture, 0), U || E.framebufferRenderbuffer(M, E.DEPTH_ATTACHMENT, v, T.render), Fc(E), U && (E.bindRenderbuffer(E.RENDERBUFFER, T._MSAARbO), E.renderbufferStorageMultisample(E.RENDERBUFFER, U, E.RGBA8, l, i), md(E, T._MSAAFbo), E.framebufferRenderbuffer(E.FRAMEBUFFER, E.COLOR_ATTACHMENT0, E.RENDERBUFFER, T._MSAARbO), E.framebufferRenderbuffer(M, E.DEPTH_ATTACHMENT, v, T.render), Fc(E)), Jo(E, A), E.bindRenderbuffer(v, A), T.width = l, T.height = i
                }
            },
            toCanvas: function() {
                var i = this,
                    K = i.gv.getGL();
                md(K, i.frame);
                var X = i.width,
                    C = i.height,
                    T = new Uint8Array(4 * X * C);
                K.readPixels(0, 0, X, C, K.RGBA, K.UNSIGNED_BYTE, T), Fc(K);
                var D = M.createElement("canvas");
                D.width = X, D.height = C;
                var R = D.getContext("2d"),
                    J = R.createImageData(X, C);
                return J.data.set(T), R.putImageData(J, 0, 0), D
            }
        });
        var oe = Of.Interactor = function(F) { this.gv = this.g3d = F };
        Bj("Interactor", n, { ms_listener: 1, getView: function() { return this.gv.getView() }, setUp: function() { this.addListeners() }, tearDown: function() { this.removeListeners() }, fi: function(b) { this.gv.fi(b) }, startDragging: function(f) { zi(this, f) } });
        var ai = Of.DefaultInteractor = function(C) { th(ai, this, [C]) };
        Bj("DefaultInteractor", oe, {
            getState: function() { return this._62O },
            setState: function(P) { this._62O = P },
            getDataInfoAt: function(Z, V) {
                var B = this.gv,
                    T = B.getDataInfoAt(Z);
                if (!B.isBlockSelectable() || !T || !T.data) return T;
                if (!V && B.isSelected(T.data)) return T;
                for (var p = T.data;
                    (p = p.getParent()) && p instanceof k.Block && B.isSelectable(p);) { var J = B.isSelected(p); if (J && V) break; if (T = { data: p, part: T }, J && !V) break }
                return T
            },
            handle_contextmenu: function($) { sh($) },
            handle_mousewheel: function(s) { this.gv.handleScroll(s, s.wheelDelta / 40) },
            handle_DOMMouseScroll: function(T) { 2 === T.axis && this.gv.handleScroll(T, -T.detail) },
            handle_keydown: function(i) { this.gv.handleKeyDown(i) },
            handle_mousedown: function(e) { this.handle_touchstart(e) },
            handle_touchstart: function(n) {
                sh(n);
                var C = this,
                    k = C.gv,
                    o = pn(n),
                    t = C.getDataInfoAt(n),
                    e = t ? t.data : A,
                    O = t ? t.part : A,
                    l = k.sm(),
                    V = Lp(n),
                    p = Xk(n);
                k.setFocus(n) && (C._62O = A, C._57I = A, C.pendingClickThrough = A, C.__lastClientPoint__ = Sp(n), e ? Xn(n) ? l.co(e) ? l.rs(e) : l.as(e) : l.co(e) ? e instanceof em && e.isClickThroughEnabled() && pn(n) && (C.pendingClickThrough = Sp(n)) : l.ss(e) : o && (Xn(n) ? k.isRectSelectable() && (C._62O = af) : C._57I = Sp(n)), C._31Q && (xb(C._31Q), delete C._31Q, delete C._32Q), C._62O || (k.isFirstPersonMode() && (eq(n) || kd(n) || p > 2 ? C._62O = "pan" : k.isMouseRoamable() || Mc(n) ? (C._62O = "roaming", C.foward = V && pn(n), C._32Q = Xc(), C._31Q = Lh(C.tick, C)) : o || (C._62O = "roaming")), C._62O || (o && V && Es[O] ? (C._62O = O, C.p3 = e.p3()) : o && V && Dj(e) && k.isSelected(e) ? k.isMovable(e) ? (C._62O = "move", C.p3 = e.p3(), C.movedata = e) : k._39Q(e) && (C._62O = "none") : Mc(n) && (p > 2 ? C._62O = "pan" : 2 === p && (C.dist = mi(n), C._62O = "pinch")))), C.point = k.lp(n), zi(C, n), Mp(n) ? k.handleDoubleClick(n, e, O) : k.handleClick(n, e, O))
            },
            tick: function() {
                var I = this,
                    w = I.gv,
                    V = w._moveStep;
                I.point && w.isWalkable() && (I._32Q && (V *= (Xc() - I._32Q) / 50), w.walk(I.foward ? V : -V), I._32Q = Xc(), I._31Q = Lh(I.tick, I))
            },
            handle_mouseup: function(N) { this.handle_touchend(N) },
            handle_touchend: function(n) {
                var i = this._57I;
                if (i && (_q(i, Sp(n)) <= 1 && this.gv.sm().cs(), this._57I = A), i = this.pendingClickThrough) {
                    if (_q(i, Sp(n)) <= 1) {
                        var T = this.getDataInfoAt(n);
                        T && T.data instanceof em && T.data.isClickThroughEnabled() && (T = this.getDataInfoAt(n, !0), T && (n.clickThrough = !0, this.gv.sm().ss(T.data)))
                    }
                    this.pendingClickThrough = null
                }
            },
            handleWindowMouseMove: function(y) { this.handleWindowTouchMove(y) },
            handleWindowTouchMove: function(N) {
                var u, z, G = this,
                    b = G.gv,
                    l = G._62O,
                    A = G.point,
                    i = b.dm(),
                    f = b.lp(N),
                    V = f.x - A.x,
                    M = f.y - A.y,
                    o = b.getWidth(),
                    v = b.getHeight();
                if (o && v) {
                    var Y = Sp(N),
                        k = Tq(b, Y, G.__lastClientPoint__),
                        O = _q({ x: 0, y: 0 }, k),
                        w = -m * V / o,
                        H = -m * M / v;
                    if ("roaming" === l) G.rotate(N, w / 2, H / 2);
                    else if (l === ys || l === Ic || l === yb) b._86O || i.beginTransaction(), b.fi({ kind: b._86O ? "betweenEditRotation" : "beginEditRotation", event: N }), b._86O = 1, b.sm().each(function(D) {
                        if (Dj(D) && b.isRotationEditable(D)) {
                            var T = X(w) > X(H) ? w : H;
                            l === ys ? D.setRotationX(D.getRotationX() + T) : l === Ic ? D.setRotationY(D.getRotationY() + T) : l === yb && D.setRotationZ(D.getRotationZ() + T)
                        }
                    });
                    else if ("move" === l || Es[l]) {
                        if (l === ib || l === wl || l === Ds) b._87O || i.beginTransaction(), b.fi({ kind: b._87O ? "betweenEditScale" : "beginEditScale", event: N }), b._87O = 1;
                        else {
                            if (!b._moving) {
                                if (O < D.touchMoveThreshold) return;
                                i.beginTransaction()
                            }
                            b.fi({ kind: b._moving ? "betweenMove" : "beginMove", event: N }), b._moving = 1
                        }
                        var J, B = G.p3,
                            s = b.getPositionInfo(B),
                            y = qh(b);
                        J = l === yc ? "x" : l === $n ? "y" : l === nl ? "z" : l === ib ? "sx" : l === wl ? "sy" : l === Ds ? "sz" : b.getMoveMode(N, G.movedata), V = V / o * s.width, M = -1 * M / v * s.height;
                        var $, t, Z = [y[0] * V, y[4] * V, y[8] * V],
                            q = [y[1] * M, y[5] * M, y[9] * M],
                            S = Z[0] + q[0],
                            W = Z[1] + q[1],
                            r = Z[2] + q[2],
                            g = [B[0] + S, B[1] + W, B[2] + r],
                            c = zd(b.getEye(), g, !0);
                        if ("xyz" === J ? ($ = g, b.moveSelection(S, W, r)) : "xz" === J ? ($ = lh(b, B, [0, 1, 0], g), $ && b.moveSelection($[0] - B[0], 0, $[2] - B[2])) : "xy" === J ? ($ = lh(b, B, [0, 0, 1], g), $ && b.moveSelection($[0] - B[0], $[1] - B[1], 0)) : "yz" === J ? ($ = lh(b, B, [1, 0, 0], g), $ && b.moveSelection(0, $[1] - B[1], $[2] - B[2])) : "x" === J || "sx" === J ? (c[0] = 0, $ = lh(b, B, c, g), $ && (t = $[0] - B[0], "x" === J ? b.moveSelection(t, 0, 0) : b.sm().each(function(j) { Dj(j) && b.isSizeEditable(j) && (u = j.getScaleX() + t / 100, z = u / j.getScaleX(), j.setScaleX(u), eq(N) && (j.setScaleY(j.getScaleY() * z), j.setScaleTall(j.getScaleTall() * z))) }))) : "y" === J || "sy" === J ? (c[1] = 0, $ = lh(b, B, c, g), $ && (t = $[1] - B[1], "y" === J ? b.moveSelection(0, t, 0) : b.sm().each(function(B) { Dj(B) && b.isSizeEditable(B) && (u = B.getScaleTall() + t / 100, z = u / B.getScaleTall(), B.setScaleTall(u), eq(N) && (B.setScaleY(B.getScaleY() * z), B.setScaleX(B.getScaleX() * z))) }))) : ("z" === J || "sz" === J) && (c[2] = 0, $ = lh(b, B, c, g), $ && (t = $[2] - B[2], "z" === J ? b.moveSelection(0, 0, t) : b.sm().each(function(p) { Dj(p) && b.isSizeEditable(p) && (u = p.getScaleY() + t / 100, z = u / p.getScaleY(), p.setScaleY(u), eq(N) && (p.setScaleX(p.getScaleX() * z), p.setScaleTall(p.getScaleTall() * z))) }))), !$) return;
                        G.p3 = $
                    } else if (l === af) {
                        var x = G.div;
                        x || (x = G.div = sf(), Ml(G.getView(), x), x.op = A, x.style.background = b.getRectSelectBackground()), b.fi({ kind: b._rectSelecting ? "betweenRectSelect" : "beginRectSelect", event: N }), b._rectSelecting = 1, x.rect = we(x.op, f), dq(x, x.rect)
                    } else if ("pinch" === l && 2 === Xk(N)) {
                        b.fi({ kind: b._pinching ? "betweenPinch" : "beginPinch", event: N }), b._pinching = 1;
                        var t = mi(N);
                        b._lastZoomLP || (b._lastZoomLP = Bn(N)), b.handlePinch(t, G.dist), G.dist = t
                    } else "pan" === l || eq(N) || kd(N) ? G.pan(N, V, M) : "none" === l || b.isFirstPersonMode() || G.rotate(N, w, H);
                    G.point = f
                }
            },
            pan: function(O, c, a) {
                var G = this.gv;
                if (G.isPannable()) {
                    var h = G.getWidth(),
                        u = G.getHeight();
                    if (!h || !u) return;
                    var d = G.getCenterInfo(),
                        S = c / h * d.width,
                        A = -1 * a / u * d.height;
                    G.fi({ kind: G._panning ? "betweenPan" : "beginPan", event: O }), G._panning = 1, G.pan(-S, -A)
                }
            },
            rotate: function(w, L, W) {
                var $ = this.gv;
                $.isRotatable() && ($.fi({ kind: $._rotating ? "betweenRotate" : "beginRotate", event: w }), $._rotating = 1, $.rotate(L, W))
            },
            handleWindowMouseUp: function(I) { this.handleWindowTouchEnd(I) },
            handleWindowTouchEnd: function(L) {
                var G = this,
                    W = G.gv,
                    N = W.dm(),
                    o = G.div;
                if (o) {
                    var l = W.getDatasInRect(o.rect);
                    if (!l.isEmpty()) {
                        var j = W.sm(),
                            s = j.toSelection();
                        l.each(function(U) { j.co(U) ? s.remove(U) : s.add(U) }), j.ss(s)
                    }
                    tp(o)
                }
                W._moving && (delete W._moving, W.fi({ kind: "endMove", event: L }), W.onMoveEnded(), N.endTransaction()), W._panning && (delete W._panning, W.fi({ kind: "endPan", event: L }), W.onPanEnded()), W._rotating && (delete W._rotating, W.fi({ kind: "endRotate", event: L }), W.onRotateEnded()), W._86O && (delete W._86O, W.fi({ kind: "endEditRotation", event: L }), N.endTransaction()), W._87O && (delete W._87O, W.fi({ kind: "endEditScale", event: L }), N.endTransaction()), W._pinching && (delete W._pinching, W.fi({ kind: "endPinch", event: L }), W.onPinchEnded()), W._rectSelecting && (delete W._rectSelecting, W.fi({ kind: "endRectSelect", event: L }), W.onRectSelectEnded()), W._walking && (delete W._walking, W.fi({ kind: "endWalk", event: L }), W.onWalkEnded()), W._lastZoomLP = W._lastZoomHit = null, G.dist = G.point = G._62O = G.p3 = G.movedata = G.div = G._57I = G.pendingClickThrough = G._32Q = G._31Q = G.foward = A, G.__lastClientPoint__ = A
            }
        });
        var Un = Of.MapInteractor = function(a) { th(Un, this, [a]), this._keepHorizon = !0, this._threshold = 2, this._touchScaleThreshold = .05, this._touchRotateThreshold = .03, this._touchScaleCheckAccuracy = .01, this._panButton = "right", this._minPhi = 0, this._maxPhi = 5 * Math.PI / 12 };
        Bj("MapInteractor", oe, {
            setUp: function() {
                Un.superClass.setUp.call(this);
                var z = this.gv;
                this.__oldMinPhi__ = z.getRotateMinPhi(), this.__oldMaxPhi__ = z.getRotateMaxPhi(), z.setRotateMinPhi(this._minPhi), z.setRotateMaxPhi(this._maxPhi)
            },
            tearDown: function() {
                Un.superClass.tearDown.call(this);
                var O = this.gv;
                O.setRotateMinPhi(this.__oldMinPhi__), O.setRotateMaxPhi(this.__oldMaxPhi__), delete this.__oldMinPhi__, delete this.__oldMaxPhi__
            },
            handle_contextmenu: function(q) { sh(q) },
            handle_mousewheel: function(j) { this.gv.handleScroll(j, j.wheelDelta / 40) },
            handle_DOMMouseScroll: function(E) { 2 === E.axis && this.gv.handleScroll(E, -E.detail) },
            handle_keydown: function(n) { this.gv.handleKeyDown(n) },
            handle_mousedown: function(P) { this.handle_touchstart(P) },
            handle_touchstart: function(e) {
                sh(e);
                var w = this,
                    l = w.gv;
                if (l.setFocus(e)) {
                    var W = l.getDataInfoAt(e),
                        E = W ? W.data : A,
                        F = W ? W.part : A,
                        z = w.editing = { point: l.lp(e) };
                    Mc(e) ? z.touch = !0 : (z.touch = !1, z.clickLeft = pn(e), z.pan = kd(e) ? !0 : "left" === this.panButton === z.clickLeft), E && l._39Q(E) && (z.preventDefault = !0), zi(w, e), Mp(e) ? l.handleDoubleClick(e, E, F) : l.handleClick(e, E, F)
                }
            },
            handle_mouseup: function(E) { this.handle_touchend(E) },
            handle_touchend: function() {},
            handleWindowMouseMove: function(i) { this.handleWindowTouchMove(i) },
            handleWindowTouchMove: function(y) {
                var E = this,
                    u = E.gv,
                    W = E.editing;
                if (W) {
                    var k = u.lp(y),
                        r = W.point,
                        i = k.x - r.x,
                        d = k.y - r.y;
                    if (!W.moved) {
                        if (Math.abs(i) < E.threshold && Math.abs(d) < E.threshold && !(y.touches && y.touches.length > 1)) return;
                        W.moved = !0
                    }
                    if (!W.preventDefault)
                        if (W.point = k, W.touch) {
                            var V = y.touches.length;
                            if (2 !== V) E.pan(y, i, d);
                            else {
                                if (1 >= V) return;
                                var f = y.touches,
                                    S = { x: f[0].clientX, y: f[0].clientY },
                                    w = { x: f[1].clientX, y: f[1].clientY },
                                    X = { x: w.x - S.x, y: w.y - S.y },
                                    Q = W.lastCenter,
                                    a = Math.atan2(X.y, X.x),
                                    b = W.theta,
                                    n = 0;
                                b == A ? b = W.theta = a : (n = a - b, W.thetaStarted || Math.abs(n) > E.touchRotateThreshold ? (W.thetaStarted = !0, W.theta = a) : n = 0);
                                var R = U * (S.y + w.y) / 2 / u.getHeight(),
                                    D = W.phi,
                                    I = 0;
                                D == A ? D = W.phi = R : (I = R - D, W.phiStarted || Math.abs(I) > E.touchRotateThreshold ? (W.phiStarted = !0, W.phi = R) : I = 0);
                                var H, O = Math.sqrt(X.x * X.x + X.y * X.y),
                                    N = W.vlen;
                                if (N) {
                                    var l = S.x - Q.x,
                                        G = S.y - Q.y,
                                        F = w.x - Q.x,
                                        v = w.y - Q.y,
                                        t = Math.sqrt(l * l + G * G),
                                        B = Math.sqrt(F * F + v * v),
                                        g = N / 2,
                                        P = E._sign2(t - g),
                                        L = E._sign2(B - g);
                                    0 > P * L || 0 === P && 0 === L ? (H = 1, W.vlen = O) : (H || (H = O / N), W.scaleStarted || Math.abs(H - 1) > E.touchScaleThreshold ? (W.vlen = O, W.scaleStarted = !0) : H = 1)
                                } else N = W.vlen = O, H = 1;
                                1 !== H && u.setZoom(H), (I || n) && E.rotate(y, n, -I), W.lastCenter = { x: (w.x + S.x) / 2, y: (w.y + S.y) / 2 }
                            }
                        } else if (W.pan) E.pan(y, i, d);
                    else {
                        var T = u.getWidth(),
                            Y = u.getHeight();
                        if (!T || !Y) return;
                        var C = -m * i / T,
                            M = -m * d / Y;
                        E.rotate(y, C, M)
                    }
                }
            },
            _sign2: function(X) { return Math.abs(X) < this._touchScaleCheckAccuracy ? 0 : X > 0 ? 1 : -1 },
            handleWindowMouseUp: function(I) { this.handleWindowTouchEnd(I) },
            handleWindowTouchEnd: function(M) {
                var C = this,
                    e = C.editing;
                if (C.editing = null, e) {
                    var h = C.gv;
                    if (e.moved || !e.clickLeft && !e.touch) h._panning = null, h._rotating = null, h.fi({ kind: e.pan ? "endPan" : "endRotate", event: M });
                    else {
                        var y = h.getDataAt(M);
                        y ? h.sm().setSelection([y]) : h.sm().clearSelection()
                    }
                }
            },
            pan: function(h, j, L) {
                var W = this,
                    l = W.gv;
                if (l.isPannable()) {
                    var H = l.getWidth(),
                        b = l.getHeight();
                    if (H && b) {
                        var N = l.getCenterInfo(),
                            m = -j / H * N.width,
                            Z = 1 * L / b * N.height;
                        l.fi({ kind: l._panning ? "betweenPan" : "beginPan", event: h }), l._panning = 1;
                        var q = W.keepHorizon,
                            U = W.editing.touch;
                        if ((U && h.touches && h.touches.length > 1 || !U && eq(h)) && (q = !q), !q) return l.pan(m, Z);
                        if (m || Z) {
                            var E = qh(l),
                                K = [E[0] * m, E[4] * m, E[8] * m],
                                S = [E[1], 0, E[9]],
                                u = Math.sqrt(S[0] * S[0] + S[2] * S[2]);
                            u && (S = [S[0] / u * Z, 0, S[2] / u * Z]);
                            var v = K[0] + S[0],
                                i = K[1] + S[1],
                                Q = K[2] + S[2],
                                _ = l._center,
                                d = l._eye;
                            _[0] += v, _[1] += i, _[2] += Q, d[0] += v, d[1] += i, d[2] += Q, l.fp(wj, A, d), l.fp(Tc, A, _)
                        }
                    }
                }
            },
            rotate: function(w, y, G) {
                var E = this,
                    x = E.gv;
                if (x.isRotatable()) {
                    var C = x._center,
                        W = x._eye,
                        o = zd(W, C),
                        p = Cc(z(o[0] * o[0] + o[2] * o[2]), o[1]),
                        c = hh(x, p + G);
                    G = c - p, x.fi({ kind: x._rotating ? "betweenRotate" : "beginRotate", event: w }), x._rotating = 1, x.rotate(y, G)
                }
            }
        }), n.defineProperties(Un.prototype, { panButton: { get: function() { return this._panButton }, set: function(D) { this._panButton = D } }, minPhi: { get: function() { return this._minPhi }, set: function(c) { this.gv.setRotateMinPhi(this._minPhi = c) } }, maxPhi: { get: function() { return this._maxPhi }, set: function(R) { this.gv.setRotateMaxPhi(this._maxPhi = R) } }, keepHorizon: { get: function() { return this._keepHorizon }, set: function(P) { this._keepHorizon = P } }, threshold: { get: function() { return this._threshold }, set: function(t) { this._threshold = t } }, touchScaleThreshold: { get: function() { return this._touchScaleThreshold }, set: function(N) { this._touchScaleThreshold = N } }, touchRotateThreshold: { get: function() { return this._touchRotateThreshold }, set: function(F) { this._touchRotateThreshold = F } } });
        var dl, Lm = "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAEyUlEQVRYR62XW0xcVRSG/58cmIG2HmstE9N4SX2xtVqBCISoFS/RmDSpKQSvTWNixUStQSqVyBQYJUGttrQVtYkPatuQPmhivMUHqbUBZ2itl1qjTzZpImNUZhDLsUeWWXgOOd2cgcGyk3mYs/de69trr70uxP8YIlJKMi0i9wIgyf0iEiM5PFdxzGeDiBQAuB7AjQBuALCN5NcGQDmANgBfeL8UyYnZ5M8KICJ3AXgAwAlfOMl/VHAQwPtveYAKuQLA2yQ/ngliRgAR2QogA2AvSdcUZAIE50VEYR4BsIDkC7kgQgFE5GIAuwDsJnkk1+aZAPw9IqLX1gjgcZK/m7KmAXjK4wBaSf4ZplxEIgCuA3Cz3gSAfgDHSf6dY/0FAJ4D0G5ChAEcAPBwmHIRqXNd90nLsiocx/k+k8n8oK/Atu2rIpHIStd1v7QsawfJd0Ouywawh6T609Q4B8C788NhZnddt29sbGxBd3f39q6urtNhJ43H48uam5u3lJSUjFiWdV8IxE0Aqki+6M9NAXjefjnJXsOZogBGBgYGttbU1Hw427PS+cHBwbVVVVUJAItJOoa8xwD8RPIT/T4J4L3zfQAeNL1dRMZra2ur+/v7/8pHub+mvr7+wr6+vs8KCgoWGABFAN4EsEHjhA9QBeA2ks8HF6vZk8nkQL4nNwGTyeTa8vLycsuy7jcg1Mk/IpnyAZoBaOQ6FHg+ddlsdqNt201zObm5NpvN7ly0aNHrJN8LyL4FwGqSr/gAOrnej3C60HXdw/F4PJ7L4fKFSiQSl7W0tLQVFRWtCQDoNRwguZ6aWABcorE9sEDf+QjJ1fkqmmmdiHwHoCToXyKiceR0rkhY5TjOq9FoVLPdeY/x8fG+SCSySe/cFKYWCFOyPJ1Or4zFYh3nrR3A8PBwe2lp6TcAfg4DmBYwAFyRTqdXxWKx9nkE+DYUIEyBiFQ6jvNaNBq9Zz4AZruCGIBlJI8ZXpolee18AORwwgoAp/xnqMmjPuilZ8+ePZRIJNo7OztD436+YB0dHZe2trY+W1hYWGsccD/JOh/gKQBHSWpanRwicnc2m91k2/bmfJWFrRsdHd29cOHCXSTfD8i+FcA1JHcEQ/HtJDVnTw3XdfcPDQ0dra6unto8F5hUKrWurKxslWVZG4L7RGQbgA9IDgWT0VsANprJaGJi4kxDQ8OagwcPjsxFeWNj49Le3l6N91qMTA2vmNnr6fovGXkmvxPAlST3hGz4LZVKbausrMzLEnryioqKNpJLzCpJRJ4AcJLkp6rHLEieBjBA8rB5Wtd1942NjS3p6el5qa2t7VSYNdThmpqaWoqLi38xze4dUku4CpLb/f1hJZnWBY+SzJpKRGSdV5LVOI5zIpPJnNQ1tm2viEQiV7uue8SyrJeDDhew8GIAO0me4w9hABdp8ahNBkktyacNr+Qu84pSndfX81VY6e6dXJV3AoiT/CMoMFcyUogeAG+Q/DyX8+VZlqvZHwKw2VQ+zQdCTL4FwBkPZFrJPUtjoildG5PC4J2bOvJpze7QWhHAj4HWbBImpDXTQsPvH5cDeMf39lxWnBXAU6TNqcZu7fn0lyB53GhOdf6ZQHN6bF6a0xxOuJTkrwbA5LdcJ831/V8SOUYQxYGhRwAAAABJRU5ErkJggg==",
            rr = 32,
            os = Of.GlobeInteractor = function(Q, u) {
                th(os, this, [Q]);
                var z, o = u.radius || 6378137,
                    l = this,
                    K = null;
                dl || (dl = sf(), dl.style.border = "", dl.style.backgroundImage = "url(" + Lm + ")");
                var V = new Wd,
                    m = new Cb,
                    J = new Cb,
                    v = new Cb,
                    M = new Vc,
                    w = "number" == typeof o ? { x: o, y: o, z: o } : o,
                    X = { center: new Cb(0, 0, 0), radius: w },
                    U = function(K) { Q._81O = null; var Y = Q.getHitPosition(K, Q.getCenter(), m.copy(Q.getEye()).sub(J.copy(Q.getCenter())).toArray()); return M.origin.copy(Q.getEye()), M.direction.copy(Y).sub(M.origin).normalize(), M.intersectEllipsoid(X) },
                    R = function(d, H) {
                        Q._81O = null, M.origin.copy(Q.getEye());
                        for (var v, s, p = Q.getCenter(), T = m.copy(Q.getEye()).sub(J.copy(Q.getCenter())).toArray(), u = 1, L = 16, q = 0, P = 1, l = { x: 0, y: 0 }; L--;) {
                            if (l.x = H.x + (d.x - H.x) * u, l.y = H.y + (d.y - H.y) * u, v = Q.getHitPosition(l, p, T), M.direction.copy(v).sub(M.origin).normalize(), s = M.intersectEllipsoid(X), s && 1 === u) return { hit: s };
                            s ? q = u : P = u, u = (q + P) / 2
                        }
                        return { hit: s, out: 1 > u }
                    },
                    C = function(k, L) {
                        if (K) {
                            var z = Date.now();
                            K.deltaTime = K.lastTime ? z - K.lastTime : 1e3, K.lastTime = z, K.lastAxis = k, K.lastAngle = L
                        }
                        L && (V.setFromAxisAngle(k, L), Q.setEye(m.copy(Q.getEye()).applyQuaternion(V).toArray()), Q.setCenter(m.copy(Q.getCenter()).applyQuaternion(V).toArray()), Q.setUp(m.copy(Q.getUp()).applyQuaternion(V).toArray()))
                    };
                l._showCrossIcon = function(O) { Ml(l.getView(), dl), dq(dl, { x: O.clientX - rr / 2, y: O.clientY - rr / 2, width: rr, height: rr }) }, l._hideCrossIcon = function() { tp(dl) }, l._scrollImpl = function(C, O) {
                    K = { point: Q.lp(C), screen: Sp(C), hit: U(C), type: "right" }, K.hitNormalize = K.hit ? K.hit.clone().normalize() : new Cb;
                    var F = { clientX: K.screen.x, clientY: K.screen.y + 10 * O };
                    l._handleMoveImpl(F), l._endMoveImpl(F)
                }, l._startMoveImpl = function(b) { z && (z.stop(!0), z = null), K = { point: Q.lp(b), screen: Sp(b), hit: U(b) }, K.hitNormalize = K.hit ? K.hit.clone().normalize() : new Cb, Mc(b) ? 1 === b.touches.length ? K.hit && (K.type = "left") : 2 === b.touches.length && (K.type = "touch2") : (pn(b) ? K.hit && (K.type = "left") : Up(b) ? K.type = "right" : kd(b) && K.hit && (K.type = "middle"), !K.hit || "right" !== K.type && "middle" !== K.type || l._showCrossIcon(b)), K.type && zi(l, b) }, l._handleMoveImpl = function(V) {
                    if (K) switch (K.type) {
                        case "left":
                            return l._handleLeft(V);
                        case "right":
                            return l._handleRight(V);
                        case "middle":
                            return l._handleMiddle(V);
                        case "touch2":
                            return l._handleTouch2(V)
                    }
                }, l._endMoveImpl = function() {
                    if (K) {
                        if (this._hideCrossIcon(), "left" === K.type || "middle" === K.type) {
                            var U = 1e3 * (K.lastAngle / (K.deltaTime || 30)),
                                N = K.lastAxis,
                                b = K.lastTime,
                                $ = function() {
                                    var v = Date.now(),
                                        r = (v - b) / 1e3;
                                    return b = v, U *= Math.pow(Math.abs(l.decelerationRate), 3 * r), Math.abs(U) < .01 ? (U = 0, z && z.stop(), void 0) : (C(N, U * r), void 0)
                                };
                            z = Il({ action: function() { $(arguments) }, duration: 5e3 })
                        }
                        K = null
                    }
                }, l._handleLeft = function(c) {
                    if (!K.finished) {
                        var P = Sp(c),
                            Z = R(P, K.lastScreen || K.screen);
                        if (K.lastScreen = P, !Z.hit) return K.finished = !0, l._endMoveImpl(c), void 0;
                        var u = Z.hit;
                        u.normalize();
                        var y = K.hitNormalize,
                            I = Math.acos(u.dot(y)),
                            m = u.cross(y).normalize();
                        C(m, I), Z.out && (K.finished = !0, l._endMoveImpl(c))
                    }
                }, l._handleRight = function(P) {
                    var r = K.lastScreen || K.screen,
                        E = r.y;
                    r = K.lastScreen = Sp(P);
                    var i = r.y,
                        p = i - E;
                    if (p) {
                        var f = Math.min(.5, p * l.scaleSpeed);
                        m.copy(Q.getEye());
                        var t = K.hit;
                        t || (t = m.clone().divide(w).normalize().multiply(w)), J.copy(m).lerp(t, f), Q.setEye(J.toArray()), m.copy(Q.getUp()), J.normalize();
                        var e = m.clone().cross(J).normalize();
                        if (v.copy(Q.getCenter()), v.sub(e.multiplyScalar(v.dot(e))), Q.setCenter(v.toArray()), K.hit) {
                            var y = U(K.screen),
                                V = K.hitNormalize;
                            if (y) {
                                y.normalize();
                                var S = Math.acos(y.dot(V)),
                                    Y = y.cross(V).normalize();
                                S && C(Y, S)
                            }
                        }
                    }
                };
                var d = function(H) { return Math.abs(H) < .01 ? 0 : H > 0 ? 1 : -1 };
                l._handleTouch2 = function(T) {
                    var p = T.touches.length;
                    if (2 === p) {
                        var V = T.touches,
                            e = { x: V[0].clientX, y: V[0].clientY },
                            c = { x: V[1].clientX, y: V[1].clientY },
                            m = { x: c.x - e.x, y: c.y - e.y },
                            z = K.lastCenter,
                            q = Math.atan2(m.y, m.x),
                            I = K.theta,
                            j = 0;
                        I == A ? I = K.theta = q : (j = q - I, K.thetaStarted || Math.abs(j) > .03 ? (K.thetaStarted = !0, K.theta = q) : j = 0);
                        var y, B = Math.sqrt(m.x * m.x + m.y * m.y),
                            Z = K.vlen;
                        if (Z) {
                            var l = e.x - z.x,
                                g = e.y - z.y,
                                u = c.x - z.x,
                                S = c.y - z.y,
                                X = Math.sqrt(l * l + g * g),
                                O = Math.sqrt(u * u + S * S),
                                M = Z / 2,
                                L = d(X - M),
                                b = d(O - M);
                            0 > L * b || 0 === L && 0 === b ? (y = 1, K.vlen = B) : (y || (y = B / Z), K.scaleStarted || Math.abs(y - 1) > .05 ? (K.vlen = B, K.scaleStarted = !0) : y = 1)
                        } else Z = K.vlen = B, y = 1;
                        var m = J.copy(Q.getEye()).clone();
                        1 !== y && Q.setEye(m.setLength((m.length() - o) / y + o).toArray()), j && C(m.normalize(), j), K.lastCenter = { x: (c.x + e.x) / 2, y: (c.y + e.y) / 2 }
                    }
                }, l._handleMiddle = function(E) {
                    var z = Sp(E),
                        V = K.screen;
                    K.screen = z;
                    var T = (z.y - V.y) / 180 * Math.PI * l.rollSpeed;
                    J.copy(Q.getCenter()).sub(m.copy(Q.getEye())).normalize(), m.copy(Q.getUp()).cross(J).normalize(), J.copy(Q.getEye()).sub(K.hit).applyAxisAngle(m, T).add(K.hit);
                    var $ = J.clone();
                    J.copy(Q.getCenter()).sub(K.hit).applyAxisAngle(m, T).add(K.hit);
                    var b = J.clone(),
                        y = J.copy(Q.getUp()).applyAxisAngle(m, T).clone(),
                        A = !1;
                    T > 0 && (v.copy(y), J.copy(b).sub($).normalize(), m.copy($).multiplyScalar(-1).normalize(), m.dot(v) - J.dot(v) > 0 && (A = !0)), A || v.copy(K.hit).sub($).dot(K.hitNormalize) >= 0 && (A = !0), A || (Q.setEye($.toArray()), Q.setCenter(b.toArray()), Q.setUp(y.toArray()));
                    var U = -(z.x - V.x) / 180 * Math.PI * l.rotateSpeed;
                    C(K.hitNormalize, U)
                }
            };
        Bj("GlobeInteractor", oe, {
            handle_contextmenu: function(T) { sh(T) },
            handle_mousewheel: function(d) { this._scrollImpl(d, d.wheelDelta / 40) },
            handle_DOMMouseScroll: function(A) { 2 === A.axis && this._scrollImpl(A, -A.detail) },
            handle_keydown: function(H) { this.gv.handleKeyDown(H) },
            handle_mousedown: function(T) { this.handle_touchstart(T) },
            handle_touchstart: function(l) {
                sh(l);
                var N = this.gv;
                if (N.setFocus(l)) {
                    var H = N.getDataInfoAt(l),
                        y = H ? H.data : A;
                    y && N.isInteractive(y) || this._startMoveImpl(l);
                    var p = H ? H.part : A;
                    Mp(l) ? N.handleDoubleClick(l, y, p) : N.handleClick(l, y, p)
                }
            },
            handle_mouseup: function(s) { this.handle_touchend(s) },
            handle_touchend: function() {},
            handleWindowMouseMove: function(Q) { this.handleWindowTouchMove(Q) },
            handleWindowTouchMove: function(V) { this._handleMoveImpl(V) },
            handleWindowMouseUp: function(u) { this.handleWindowTouchEnd(u) },
            handleWindowTouchEnd: function(M) { this._endMoveImpl(M) }
        }), n.defineProperties(os.prototype, { rotateSpeed: { get: function() { return this._rotateSpeed || .3 }, set: function(Q) { this._rotateSpeed = Q } }, rollSpeed: { get: function() { return this._rollSpeed || .1 }, set: function(R) { this._rollSpeed = R } }, scaleSpeed: { get: function() { return this._scaleSpeed || .002 }, set: function(c) { this._scaleSpeed = c } }, decelerationRate: { get: function() { return this._decelerationRate || .04 }, set: function(t) { this._decelerationRate = t } } });
        var Jr = function(Z) { var I = 2147483648 | Z; return [(255 & I >> 16) / 255, (255 & I >> 8) / 255, (255 & I) / 255, (255 & I >> 24) / 255] },
            ph = function(Y) { this.gv = Y, this.gv.pickColorMap = { _pickIdUsed: 1e3 } };
        eh(ph, n, {
            _iv: !0,
            iv: function() { this._iv = !0 },
            get: function(Z, p, d) {
                this.validate();
                var o = this,
                    G = o.gv.getGL();
                if (!G) return A;
                var V, e, B = o._resolution,
                    Y = Math.round(Z.x * B),
                    E = Math.ceil(Z.width * B),
                    K = Math.ceil(Z.height * B),
                    y = o.height - Math.round(Z.y * B) - K,
                    g = w(E / 2),
                    h = new Uint8Array(4 * E * K),
                    f = 0,
                    c = h.length,
                    U = p ? A : new En,
                    s = p ? A : {};
                if (md(G, o.frame), G.readPixels(Y, y, E, K, G.RGBA, G.UNSIGNED_BYTE, h), Fc(G), p) {
                    for (; g >= f; f++)
                        for (var O = g - f, v = g + f, j = O; v >= j; j++)
                            for (var $ = O; v >= $; $++)
                                if ((j === O || j === v || $ === O || $ === v) && (V = o.info(h, 4 * (j * E + $)))) { if (d && d(V) === !1) continue; return V }
                } else
                    for (; c > f; f += 4)
                        if (V = o.info(h, f)) {
                            if (d && d(V) === !1) continue;
                            e = V.data, s[e._id] || (U.add(e), s[e._id] = e)
                        } return U
            },
            info: function(_, i) { return this.gv.pickColorMap[(_[i] << 16) + (_[i + 1] << 8) + _[i + 2] + ((127 & _[i + 3]) << 24)] },
            getResolution: function() { return this._resolution },
            onContextLost: function() { this.texture = null, this.width = this.height = -1 },
            validate: function() {
                var w = this,
                    B = w.gv,
                    e = B.getGL();
                if (e) {
                    var c = w._resolution = B._pickerResolution * B.getDevicePixelRatio(),
                        W = Math.round(c * B.getWidth()),
                        M = Math.round(c * B.getHeight()),
                        p = e.RGBA,
                        k = e.TEXTURE_2D,
                        Z = e.RENDERBUFFER,
                        P = e.FRAMEBUFFER;
                    if (w.texture || (w.texture = Xj(e), w.render = e.createRenderbuffer(), w.frame = e.createFramebuffer()), (w.width !== W || w.height !== M) && (e.activeTexture(e.TEXTURE0), Jo(e, w.texture), e.texImage2D(k, 0, p, W, M, 0, p, e.UNSIGNED_BYTE, A), tn(e, e.TEXTURE_MIN_FILTER, e.LINEAR), e.bindRenderbuffer(Z, w.render), e.renderbufferStorage(Z, e.DEPTH_COMPONENT16, W, M), md(e, w.frame), e.framebufferTexture2D(P, e.COLOR_ATTACHMENT0, k, w.texture, 0), e.framebufferRenderbuffer(P, e.DEPTH_ATTACHMENT, Z, w.render), Jo(e, A), e.bindRenderbuffer(Z, A), Fc(e), w.width = W, w.height = M), w._iv) {
                        w._iv = !1;
                        var m = !1;
                        B._40Q.each(function(U) {!m && U.isBatchInvalid() && (m = !0) }), m && B.updateScene(), md(e, w.frame), e.clear(e.COLOR_BUFFER_BIT), B.overlappingBox.clear(), B.setViewport(e, 0, 0, W, M), B.renderPickScene(), Fc(e)
                    }
                }
            }
        });
        var Fg = function(m) { this.gv = m };
        eh(Fg, n, {
            gap: 0,
            size: 0,
            _42: function(e, N) {
                var S = this,
                    H = S.gv,
                    F = H._gridGap,
                    C = H._gridSize;
                if (H._gridVisible) {
                    if (S.gap !== F || S.size !== C) {
                        for (var u = [], s = H._gridSize / 2, R = F * s, b = 0; 2 * s + 1 > b; b++) {
                            var l = 6 * b,
                                j = 6 * (2 * s + 1) + l;
                            u[l] = -R, u[l + 1] = 0, u[l + 2] = -R + b * F, u[l + 3] = R, u[l + 4] = 0, u[l + 5] = -R + b * F, u[j] = -R + b * F, u[j + 1] = 0, u[j + 2] = -R, u[j + 3] = -R + b * F, u[j + 4] = 0, u[j + 5] = R
                        }
                        S.vs = new ss(u), S.gap = F, S.size = C
                    }
                    Vp(H), Sc(e, N), Lg(e), _o(e, N, 1, H._gridColor, H._buffer.vs, S.vs), xc(e, 0, S.vs.length / 3, e.LINES), Th(e), Ih(e, N)
                } else S.vs = S.gap = S.size = A
            }
        });
        var vf = function(H) { this.gv = H };
        eh(vf, n, {
            _42: function(u, x) {
                var V = this.gv,
                    t = V._buffer.vs,
                    j = V._axisXColor,
                    X = V._axisYColor,
                    h = V._axisZColor,
                    T = V._originAxisVisible,
                    U = V._centerAxisVisible;
                if (T || U) {
                    var s = Jd ? u.TRIANGLES : u.TRIANGLE_FAN,
                        m = u.LINES;
                    if (Vp(V), Sc(u, x), Lg(u), T) {
                        var C = V.getCenterInfo(),
                            S = i(C.width, C.height) / 5,
                            O = .8 * S,
                            F = .05 * S;
                        _o(u, x, 1.5, j, t, new ss([0, 0, 0, S, 0, 0, O, F, 0, O, 0, F, O, -F, 0, O, 0, -F, O, F, 0, 0, 0, 0, 0, S, 0, F, O, 0, 0, O, F, -F, O, 0, 0, O, -F, F, O, 0, 0, 0, 0, 0, 0, S, F, 0, O, 0, F, O, -F, 0, O, 0, -F, O, F, 0, O])), xc(u, 0, 2, m), xc(u, 1, 6, s), _o(u, x, A, X), xc(u, 7, 2, m), xc(u, 8, 6, s), _o(u, x, A, h), xc(u, 14, 2, m), xc(u, 15, 6, s)
                    }
                    if (U) {
                        var q = V._center,
                            L = q[0],
                            f = q[1],
                            z = q[2],
                            C = V.getPositionInfo(q);
                        S = i(C.width, C.height) / 20, _o(u, x, 1.5, j, t, new ss([L, f, z, L + S, f, z, L, f, z, L, f + S, z, L, f, z, L, f, z + S])), xc(u, 0, 2, m), _o(u, x, A, X), xc(u, 2, 2, m), _o(u, x, A, h), xc(u, 4, 2, m)
                    }
                    Th(u), Ih(u, x)
                }
            }
        });
        var ep = function(m) { this.gv = m, this.onMouseOver = this.onMouseOver.bind(this), this.mode = ep.Mode.Style, this.color = O, this.width = O };
        ep.Mode = { Disable: 0, Selection: 1, MouseOver: 2, Style: 3 }, eh(ep, n, {
            onMouseOver: function(A) {
                D.preventDefault(A);
                var j = this.gv.getDataAt(A);
                j !== this.mouseOverData && (this.mouseOverData = j, this.gv.iv())
            },
            setFetchTargetFunc: function(p) { this.fetchTargetFunc = p },
            _42: function(K, B) {
                var P, h, k = this,
                    y = k._mode,
                    f = k.gv;
                if (!K._renderInfo.reflectDepth && y !== ep.Mode.Disable) {
                    if (y === ep.Mode.Selection ? P = f.sm().getSelection().toArray(function(z) { return z.s("highlight.visible") }) : y === ep.Mode.MouseOver && k.mouseOverData && k.mouseOverData.s("highlight.visible") && (P = [k.mouseOverData]), k.fetchTargetFunc && (P = k.fetchTargetFunc(P)), y === ep.Mode.Style) P = P || [], h = function(x) { if (P.indexOf(x) >= 0) return !1; var C = f.getDataHighlightMode(x); return C === !1 ? !0 : C === !0 ? !1 : "selected" === C ? f.isSelected(x) ? !1 : !0 : "hover" === C ? x === k.mouseOverData ? !1 : !0 : !0 };
                    else {
                        if (!P || !P.length) return;
                        h = function(q) { return P.indexOf(q) < 0 ? !0 : void 0 }
                    }
                    var l = f.vr.isPresenting(),
                        b = f.getWidth();
                    if (l) {
                        var s = f.getWidth;
                        b /= 2, f.getWidth = function() { return b };
                        var c = f.getViewport()
                    }
                    var I, M = f.getDevicePixelRatio(),
                        U = b * M,
                        L = f.getHeight() * M;
                    (I = k._renderTarget) ? I.setSize(K, U, L): k._renderTarget = I = new Of.RenderTarget(f, K, U, L), md(K, I.frame), K.clear(K.COLOR_BUFFER_BIT), f.setViewport(K, 0, 0, U, L), f.drawFilter = h, f.renderPickScene(), f.drawFilter = null, Fc(K), Jd && qi(K, B.aPosition), qi(K, B.aNormal), l && (f.getWidth = s, f.setViewport(K, c[0], c[1], c[2], c[3]));
                    var Y = K._compiledShader.highlight;
                    Y || (Y = K._compiledShader.highlight = new zm.Shader(K, Dp.vs, Dp.fs)), Y.bind();
                    var R = Jg.for(K),
                        j = R.directState();
                    j.blend.enabled = !0, j.depth.enabled = !1, K.activeTexture(K.TEXTURE0 + 0), Jo(K, I.texture), Y.uniforms.image = 0, Y.uniforms.textureSize = [U, L], Y.uniforms.edgeWidth = f.getHighlightWidth();
                    var $ = f.getHighlightColor();
                    if (k._lastHighlightColor !== $) {
                        var p = qj(k._lastHighlightColor = $);
                        k._highlightColorData = [p[0] / 255, p[1] / 255, p[2] / 255, p[3] / 255]
                    }
                    Y.uniforms.edgeColor = k._highlightColorData, k.ibuffer ? (k.ibuffer.upload(), k.vbuffer.upload()) : (k.ibuffer = zm.Buffer.createIndexBuffer(K, new Uint16Array([0, 2, 1, 1, 2, 3])), k.vbuffer = zm.Buffer.createVertexBuffer(K, new Float32Array([0, 0, 1, 0, 0, 1, 1, 1]))), Y.attributes.pos.pointer(k.vbuffer), K.drawElements(K.TRIANGLES, 6, K.UNSIGNED_SHORT, 0), j.blend.enabled = !1, j.depth.enabled = !0, Jo(K, null), K.useProgram(B), Jd && zj(K, B.aPosition)
                }
            }
        }), n.defineProperties(ep.prototype, {
            mode: {
                get: function() { return this._mode },
                set: function(l) {
                    var c = this._mode;
                    if (l !== c) {
                        this._mode = l;
                        var i = c === ep.Mode.MouseOver || c === ep.Mode.Style,
                            N = l === ep.Mode.MouseOver || l === ep.Mode.Style;
                        N && i || (i && $(this.gv.getView(), "mousemove", this.onMouseOver), N && v(this.gv.getView(), "mousemove", this.onMouseOver))
                    }
                }
            }
        });
        var Dp = { vs: ["attribute vec2 pos;", "varying vec2 vUv;", "void main(void) {", "gl_Position = vec4(pos.x * 2.0 - 1.0, -pos.y * 2.0 + 1.0, 0.0, 1.0);", "vUv = vec2(pos.x, 1.0 - pos.y);", "}"].join("\n"), fs: ["precision highp float;", "uniform sampler2D image;", "uniform vec2 textureSize;", "uniform float edgeWidth;", "uniform vec4 edgeColor;", "varying vec2 vUv;", "float getCol(vec2 coord) {", "return texture2D(image, coord).a;", "}", "void main() {", "vec2 cc = vUv;", "float center = getCol(cc);", "float dx = edgeWidth / textureSize.x;", "float dy = edgeWidth / textureSize.y;", "vec2 coord;", "float topLeft = getCol(cc+vec2(-dx, -dy));", "float top = getCol(cc+vec2(0.0, -dy));", "float topRight = getCol(cc+vec2(dx, -dy));", "float left = getCol(cc+vec2(-dx, 0.0));", "float right = getCol(cc+vec2(dx, 0.0));", "float bottomLeft = getCol(cc+vec2(-dx, dy));", "float bottom = getCol(cc+vec2(0.0, dy));", "float bottomRight = getCol(cc+vec2(dx, dy));", "float v = -topLeft-2.0*top-topRight+bottomLeft+2.0*bottom+bottomRight;", "float h = -bottomLeft-2.0*left-topLeft+bottomRight+2.0*right+topRight;", "float edge = sqrt(h * h + v * v);", "edge = smoothstep(0.9, 1.0, edge);", "if (edge < 0.5) {", "discard;", "}", "gl_FragColor = edgeColor;", "}"].join("\n") },
            Ah = function(h) { this.gv = h },
            yc = "edit_tx",
            $n = "edit_ty",
            nl = "edit_tz",
            ys = "edit_rx",
            Ic = "edit_ry",
            yb = "edit_rz",
            ib = "edit_sx",
            wl = "edit_sy",
            Ds = "edit_sz",
            Es = {};
        Es[yc] = 101, Es[$n] = 102, Es[nl] = 103, Es[ys] = 104, Es[Ic] = 105, Es[yb] = 106, Es[ib] = 107, Es[wl] = 108, Es[Ds] = 109, eh(Ah, n, {
            _42: function(k, K, n) {
                var o = this,
                    P = o.gv,
                    v = P.sm().ld();
                if (v && P.isEditable(v) && !P.isEditHelperDisabled() && Dj(v) && (!P.isFirstPersonMode() || !P.isMouseRoamable() && !Po)) {
                    Vp(P);
                    var s, D = P.isMovable(v),
                        f = P.isRotationEditable(v),
                        p = P.isSizeEditable(v),
                        $ = P._axisXColor,
                        j = P._axisYColor,
                        d = P._axisZColor,
                        N = P._editSizeColor,
                        Y = v.p3();
                    if (P.isOrtho()) {
                        var B = P.getCenterInfo();
                        s = i(B.width, B.height) / 8
                    } else s = _q(P.getEye(), Y) / 10;
                    var x, A, _ = s / (n ? 5 : 10),
                        W = .7 * s,
                        M = .4 * W,
                        z = Y[0],
                        F = Y[1],
                        G = Y[2];
                    x = [0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0], D && o._17O(k, K, v, n, yc, $, x, [z, F - _, G, z + W, F - _, G, z + W, F, G, z + W, F, G, z, F, G, z, F - _, G, z, F - _, G + _, z + W, F - _, G + _, z + W, F - _, G, z + W, F - _, G, z, F - _, G, z, F - _, G + _]), A = z + W, p && o._17O(k, K, v, n, ib, N, x, [A, F - _, G, A + M, F - _, G, A + M, F, G, A + M, F, G, A, F, G, A, F - _, G, A, F - _, G + _, A + M, F - _, G + _, A + M, F - _, G, A + M, F - _, G, A, F - _, G, A, F - _, G + _]), A += M, f && o._17O(k, K, v, n, ys, $, x, [A, F - _, G, A + M, F - _, G, A + M, F, G, A + M, F, G, A, F, G, A, F - _, G, A, F - _, G + _, A + M, F - _, G + _, A + M, F - _, G, A + M, F - _, G, A, F - _, G, A, F - _, G + _]), x = [0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0], D && o._17O(k, K, v, n, $n, j, x, [z, F, G, z, F + W, G, z - _, F + W, G, z - _, F + W, G, z - _, F, G, z, F, G, z, F, G, z, F, G - _, z, F + W, G - _, z, F + W, G - _, z, F + W, G, z, F, G]), A = F + W, p && o._17O(k, K, v, n, wl, N, x, [z, A, G, z, A + M, G, z - _, A + M, G, z - _, A + M, G, z - _, A, G, z, A, G, z, A, G, z, A, G - _, z, A + M, G - _, z, A + M, G - _, z, A + M, G, z, A, G]), A += M, f && o._17O(k, K, v, n, Ic, j, x, [z, A, G, z, A + M, G, z - _, A + M, G, z - _, A + M, G, z - _, A, G, z, A, G, z, A, G, z, A, G - _, z, A + M, G - _, z, A + M, G - _, z, A + M, G, z, A, G]), x = [1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0], D && o._17O(k, K, v, n, nl, d, x, [z, F, G, z, F, G + W, z, F - _, G + W, z, F - _, G + W, z, F - _, G, z, F, G, z, F - _, G, z - _, F - _, G, z - _, F - _, G + W, z - _, F - _, G + W, z, F - _, G + W, z, F - _, G]), A = G + W, p && o._17O(k, K, v, n, Ds, N, x, [z, F, A, z, F, A + M, z, F - _, A + M, z, F - _, A + M, z, F - _, A, z, F, A, z, F - _, A, z - _, F - _, A, z - _, F - _, A + M, z - _, F - _, A + M, z, F - _, A + M, z, F - _, A]), A += M, f && o._17O(k, K, v, n, yb, d, x, [z, F, A, z, F, A + M, z, F - _, A + M, z, F - _, A + M, z, F - _, A, z, F, A, z, F - _, A, z - _, F - _, A, z - _, F - _, A + M, z - _, F - _, A + M, z, F - _, A + M, z, F - _, A])
                }
            },
            _17O: function(S, U, Z, B, P, p, D, z) {
                var q = this.gv,
                    l = q._buffer,
                    J = Jg.for(S),
                    k = J.directUniforms(),
                    Q = J.directAttribs();
                if (q._picking) {
                    B = q.pickColorMap;
                    var r = Es[P];
                    B[r] = { data: Z, part: P }, k.uFixPickReverseColor = Jr(r)
                }
                Ge(S, U, A, !0, A, !0, A, !1), k.uDiffuse = p, Q.aPosition = ab(S, l.vs, new ss(z), A), Q.aNormal = ab(S, l.ns, new ss(D), A), Lg(S), xc(S, 0, 12), Th(S), Xf(S, U)
            }
        });
        var Fs = k.Raycaster = function(w) { this.gv = w, this.maxTriangleTest = 1 / 0, this.backfaceCulling = !0 };
        fi("Raycaster", n, {
            intersect: function(i) {
                var O = this,
                    U = O.gv,
                    I = U.getDataAt(i);
                return I ? O.intersectObject(i, I) : null
            },
            intersectObjects: function(r, p, F) {
                var B, q, o, T, V = this,
                    w = 1 / 0,
                    u = r.origin || (new Cb).fromArray(V.gv.getEye()),
                    R = V.maxTriangleTest,
                    H = [];
                p.forEach(function(u) { F && F(u) === !1 || u.s("intersect") !== !1 && H.push(u) });
                var $ = u.distanceToSquared2([0, 0, 0]);
                return H.sort(function(E, y) { return (E.p3 ? u.distanceToSquared2(E.p3()) : $) - (y.p3 ? u.distanceToSquared2(y.p3()) : $) }), V.countTriangles = 0, H.forEach(function(b) { V.countTriangles > R || (B = V.intersectObject(r, b), B && (q = u.distanceToSquared(B.world), w > q && (o = b, T = B, w = q))) }), V.countTriangles = 0, { data: o, intersect: T }
            },
            intersectObject: function(A, S) {
                if (A instanceof Vc) return this._intersectObjectImpl(A, S);
                var d = this,
                    Z = d.gv,
                    J = Z.unproject(A),
                    F = new Cb,
                    n = Z.getEye(),
                    u = new Cb;
                if (Z.isOrtho()) {
                    var I = new Cb(n);
                    u.copy(Z.getCenter()).sub(I).normalize();
                    var x = F.copy(J).sub(I).dot(u);
                    F.copy(u).setLength(-x).add(I.copy(J))
                } else F.copy(n), u.copy(J).sub(F).normalize();
                var M = new k.Math.Ray(F, u);
                return d._intersectObjectImpl(M, S)
            },
            _intersectObjectImpl: function() {
                function C() { var Q = new Cb; return Q.subVectors(d, S), c.subVectors(_, S), Q.cross(c).normalize(), Q }

                function q(T, Y, M, H, K, t, y) { return qr.barycoordFromPoint(T, Y, M, H, Q), K.multiplyScalar(Q.x), t.multiplyScalar(Q.y), y.multiplyScalar(Q.z), K.add(t).add(y), K.clone() }
                var L = new rs,
                    m = new rs,
                    t = new Vc,
                    T = new Cb,
                    Y = new Cb,
                    l = new Cb,
                    V = new Cb,
                    e = new Cb,
                    _ = new Cb,
                    S = new Cb,
                    d = new Cb,
                    N = new Um,
                    H = new Um,
                    P = new Um,
                    c = new Cb,
                    X = { vs: Nf, is: yk, uv: Lb },
                    Q = new Cb,
                    r = ch.slice(0);
                return r.push("csg"),
                    function(n, s) {
                        var b = this.gv.getData3dUI(s),
                            K = s.mat || b.mat;
                        K ? L.fromArray(K) : L.identity(), m.getInverse(L), t.copy(n).applyMatrix4(m);
                        var B, Q, F, G = "body",
                            $ = b.shapeModel;
                        if (!$ && (s instanceof k.Polyline || s instanceof k.Edge) && b.lineShapeModel && ($ = b.lineShapeModel), $ || ($ = bl(b)), $ || (k.CSGNode && s instanceof k.CSGNode || k.CSGShape && s instanceof k.CSGShape ? (F = !0, $ = [b.left, b.front, b.right, b.back, b.top, b.bottom, b.csg]) : s instanceof k.Node && !(s instanceof k.Shape) ? (B = !0, $ = X) : (Q = !0, $ = [b.left, b.front, b.right, b.back, b.top, b.bottom])), !$) return console.log("Can not find shape model."), null;
                        ud($) || ($ = [$]);
                        var x, g, v, f, z, U, A, R, J, y, c, W, u, I, M, o, Z = 1 / 0,
                            j = ["", "top_", "bottom_"],
                            O = !1,
                            E = this.backfaceCulling,
                            p = [];
                        for ($i($, b, p), x = 0, g = p.length; g > x; x++)
                            if (u = p[x])
                                for (v = 0, f = j.length; f > v; v++)
                                    if (I = j[v], A = u[I + "vs"], R = u[I + "is"], J = u[I + "uv"] || u[I + "tuv"], A) {
                                        if (M = u[I + "boundingBox"]) {
                                            var c = t.intersectBox(M);
                                            if (!c) continue;
                                            if (t.origin.distanceTo(c) > Z) continue;
                                            o = !1
                                        } else u[I + "boundingBox"] = M = new k.Math.Box3, o = !0;
                                        for (z = 0, U = R ? R.length : A.length / 3; U > z; z += 3) this.countTriangles++, R ? (Y.fromArray(A, 3 * R[z]), l.fromArray(A, 3 * R[z + 1]), V.fromArray(A, 3 * R[z + 2])) : (Y.fromArray(A, 3 * z), l.fromArray(A, 3 * (z + 1)), V.fromArray(A, 3 * (z + 2))), o && (M.expandByPoint(Y), M.expandByPoint(l), M.expandByPoint(V)), y = t.intersectTriangle(Y, l, V, E, T), y && (W = t.origin.distanceTo(y), Z > W && (Z = W, e.copy(y), _.copy(Y), S.copy(l), d.copy(V), "" !== I ? G = I.slice(0, -1) : B ? G = ch[Math.floor(z / 6)] : Q ? G = ch[x] : F && (G = r[x]), J && (O = !0, R ? (N.fromArray(J, 2 * R[z]), H.fromArray(J, 2 * R[z + 1]), P.fromArray(J, 2 * R[z + 2])) : (N.fromArray(J, 2 * z), H.fromArray(J, 2 * (z + 1)), P.fromArray(J, 2 * (z + 2))))))
                                    }
                        if (!isFinite(Z)) return null;
                        var i, h = e.clone().applyMatrix4(L);
                        O && (i = q(e, _, S, d, N, H, P));
                        var D = C(_, S, d),
                            w = C(_.applyMatrix4(L), S.applyMatrix4(L), d.applyMatrix4(L)),
                            a = t.direction.dot(D);
                        return a > 0 && (D.multiplyScalar(-1), w.multiplyScalar(-1)), { world: h, local: e.clone(), worldNormal: w, normal: D, uv: i, part: G }
                    }
            }()
        });
        var Gs = function(J, e) { this.gv = J, this.s = function(X, G, E) { return G == A && (G = E), G == A ? e.getStyle(X) : Rr(G, e, J) }, this.data = e };
        eh(Gs, n, {
            I3d: !0,
            ms_icons: 1,
            _iv: !0,
            _cacheBoundingBox: O,
            iv: function() { this._iv = !0 },
            update: function(W, G, n) {
                var c = this,
                    p = c.data;
                if (W || (W = c.gv, G = W.getGL(), n = G._40Q), !c.needValidate(G) || !W.isVisible(p)) return n.push(this, !1), void 0;
                var D, x, m, O, H, g = p._id,
                    z = c.s("autorotate") || c.s("shape3d.autorotate") || c.s("fixSizeOnScreen") || c.s("shape3d.fixSizeOnScreen") ? null : c.s("batch"),
                    r = p.getRenderLayer(),
                    t = n.get(r, !0),
                    s = t.batchIndexMap,
                    b = t.batchModelMap,
                    k = W.getBrightness(p),
                    $ = k != A && 1 !== k;
                D = mg(s, b, p, z, W);
                var e = c.validate(D, z ? W.getBatchInfo(z) || pk : A);
                if (D && (x = s[g], m = x.size = D.vs.length / 3 - x.begin, H = D.rs))
                    for (k = $ ? k : 1, O = 0; m > O; O++) H.push(k);
                var h = W.getWireframeGeometry(p);
                if (h) im(W, p, h);
                else if (Dj(p)) {
                    var T = W.getWireframe(p);
                    T && im(W, p, T)
                }
                c.labelInfo = c.label2Info = c.noteInfo = c.note2Info = c._38o = A, c._24O($c, "getLabel"), c._24O(If, "getLabel2"), c._26O(Rc, "getNote"), c._26O(td, "getNote2"), c._15O(), c.interactiveInfo = W.isInteractive(p) ? {} : A, t.push(this, !0), e !== !1 && (c._iv = !1)
            },
            clearWireframeGeometryCache: function() {
                var t = this;
                Vj(t), t.data.iv()
            },
            _46Q: function(V) {
                var X = this,
                    e = X.data,
                    r = X.gv;
                if (r.isVisible(e)) {
                    var o = e._id,
                        j = r._40Q.get(e._renderLayer, !0),
                        g = j.batchIndexMap[o],
                        U = j.polylineIndexMap[o],
                        s = j.wireframeIndexMap[o];
                    if (g || U || s) {
                        var K = Ap(V, r.pickColorMap, r.isSelectable(e), e, jp, !0);
                        K && (mr(K, g, j.batchModelMap), mr(K, U, j.polylineModelMap), mr(K, s, j.wireframeModelMap))
                    }
                }
            },
            _42: function(P, w, i) {
                function s(H, d, P) {
                    var f = d.getBrightness(P),
                        G = P.s("alphaTest"),
                        R = P.s("envmap"),
                        j = Jg.for(H),
                        c = j.directUniforms();
                    f != A && 1 !== f && (c.uBrightness = f), c.uAlphaTest = G, c.uUseEnvMap = R ? !0 : !1, c.uReflectivity = R || .01, c.shadowReceive = !Z && P.s("shadow.receive"), c.shadowCull = !Z && !!P.s("shadow.cull");
                    var h = t.s("3d.clip.direction");
                    if (h) {
                        var x = t.s("3d.clip.percentage");
                        switch (0 === x && (a = !1), h) {
                            case "left":
                                h = 2;
                                break;
                            case "top":
                                h = 3;
                                break;
                            case "bottom":
                                h = 4;
                                break;
                            case "front":
                                h = 5;
                                break;
                            case "back":
                                h = 6;
                                break;
                            case "right":
                            default:
                                h = 1
                        }
                        if (0 === h % 2 && (x = 1 - x), P instanceof k.Shape) {
                            var E = P.s3(),
                                I = P.p3(),
                                W = P.getAnchor3d();
                            x = 3 > h ? (x - W.x) * E[0] + I[0] : 5 > h ? (x - W.y) * E[1] + I[1] : (x - W.z) * E[2] + I[2]
                        } else x -= .5;
                        c.uClipPercent = x
                    }
                    c.uClipDirection = h || 0, H._blooming && !P.s("bloom") && (c.blackout = !0)
                }
                var t = this,
                    I = t.data,
                    K = t.gv;
                if (K.isVisible(I)) {
                    var L, Z = K._picking;
                    if (Z) L = K.pickColorMap;
                    else {
                        if (K.isTransparentMask(I) || K.isReflecting(P) && I.s("3d.reflectable") === !1) return;
                        L = O
                    }
                    if (Gs.getTitle === O) {
                        Gs.getTitle = 0;
                        for (var B in D)
                            if (B.length === If.length + 1 && B[If.length] === br[4].toUpperCase() && B[If.length - 1] === br[If.length + 1].toUpperCase()) { Gs.getTitle = ic; break }
                    }
                    if (!Gs.getTitle || Nj[If.length + 2]) {
                        if (Gs.getHead === O) {
                            Gs.getHead = 0;
                            for (var B in T) {
                                var J = "box-sizing";
                                6 === B.length && B[0] === br[4] && B[3] === J[0] && B[4] === J[1] && B[5] === J[2] && (Gs.getHead = ic)
                            }
                        }
                        if (!Gs.getHead || Nj[If.length]) {
                            var z, G, d = I._id,
                                f = K._40Q.get(I._renderLayer, !0),
                                Y = f.batchIndexMap,
                                p = f.batchModelMap,
                                o = K.isSelectable(I),
                                x = !1,
                                a = !0,
                                r = Y[d];
                            if (Z && (G = Ap(P, L, o, I, jp, r), G && !K._45Q && (mr(G, r, p), mr(G, f.polylineIndexMap[d], f.polylineModelMap), mr(G, f.wireframeIndexMap[d], f.wireframeModelMap))), r || (x || (x = !0, s(P, K, I)), a && t._80o(P, w, i)), K.isLabelVisible(I) && ((z = t.labelInfo) && (Z && Ap(P, L, o, I, $c), x || (x = !0, s(P, K, I)), t._28O(z, $c, i)), (z = t.label2Info) && (Z && Ap(P, L, o, I, If), x || (x = !0, s(P, K, I)), t._28O(z, If, i))), K.isNoteVisible(I) && ((z = t.noteInfo) && (Z && Ap(P, L, o, I, Rc), x || (x = !0, s(P, K, I)), t._29O(z, Rc, i)), (z = t.note2Info) && (Z && Ap(P, L, o, I, td), x || (x = !0, s(P, K, I)), t._29O(z, td, i))), (z = t._38o) && (x || (x = !0, s(P, K, I)), t._99O(P, w, z, L, o, i)), x) {
                                var g = Jg.for(P).directUniforms();
                                g.uBrightness = 1, g.uClipDirection = 0, P._blooming && (g.blackout = !1)
                            }
                        }
                    }
                }
            },
            prepare: function() {
                var Z = this,
                    X = Z.data;
                if (!(X instanceof em)) {
                    var g, D, p, G, $, t = Z.gv,
                        z = t.getGL(),
                        T = X._id,
                        H = Z.s("batch"),
                        h = t._batchIndexMap,
                        P = t._batchModelMap,
                        V = t.getBrightness(X),
                        k = V != A && 1 !== V;
                    if (Z.needValidate(z)) {
                        if (g = mg(h, P, X, H, t), Z.validate(g, H ? t.getBatchInfo(H) || pk : A), g && (D = h[T], p = D.size = g.vs.length / 3 - D.begin, $ = g.rs))
                            for (V = k ? V : 1, G = 0; p > G; G++) $.push(V);
                        if (Dj(X)) {
                            var d = t.getWireframeGeometry(X);
                            if (d) im(t, X, d);
                            else {
                                var O = t.getWireframe(X);
                                O && im(t, X, O)
                            }
                        }
                        Z.labelInfo = Z.label2Info = Z.noteInfo = Z.note2Info = Z._38o = A, Z._24O($c, "getLabel"), Z._24O(If, "getLabel2"), Z._26O(Rc, "getNote"), Z._26O(td, "getNote2"), Z._15O(), Z.interactiveInfo = t.isInteractive(X) ? {} : A, Z._iv = !1
                    }
                }
            },
            dispatchBoundingBoxChanged: function() { this._cacheBoundingBox = O },
            getBoundingBox: function() {
                var j, M, Q, P, J, E;
                return function() {
                    if (this._cacheBoundingBox) return this._cacheBoundingBox;
                    j || (j = { vs: Nf, is: yk, uv: Lb }, M = new Cb, Q = new Cb, P = new Cb, J = new Cb, E = new Cb);
                    var q = this,
                        A = q.data,
                        m = q.shapeModel;
                    if (m || A instanceof k.Shape || (m = bl(q)), !m && A instanceof k.Shape && (q.prepare(), m = q.shapeModel), m || (A instanceof k.Node && !(A instanceof k.Shape) ? m = j : (q.left || q.front || q.right || q.back || q.top || q.bottom) && (m = [q.left, q.front, q.right, q.back, q.top, q.bottom])), !m) return O;
                    ud(m) || (m = [m]);
                    var C, U, o, _, H, u, Z, b, l, X, p, g, T = ["", "top_", "bottom_"],
                        W = new k.Math.Box3,
                        B = !1;
                    if (q._needRecoverPosition) {
                        J.set.apply(J, A.p3());
                        var w = A.s3();
                        E.set(1 / (w[0] || 1), 1 / (w[1] || 1), 1 / (w[2] || 1))
                    } else J.set(0, 0, 0), E.set(1, 1, 1);
                    for (C = 0, U = m.length; U > C; C++)
                        if (l = m[C])
                            for (o = 0, _ = T.length; _ > o; o++)
                                if (X = T[o], Z = l[X + "vs"], b = l[X + "is"], Z) {
                                    if (g = X + "boundingBox", p = l[g], !p)
                                        for (l[g] = p = new k.Math.Box3, H = 0, u = b ? b.length : Z.length / 3; u > H; H += 3) b ? (M.fromArray(Z, 3 * b[H]).sub(J).multiply(E), Q.fromArray(Z, 3 * b[H + 1]).sub(J).multiply(E), P.fromArray(Z, 3 * b[H + 2]).sub(J).multiply(E)) : (M.fromArray(Z, 3 * H).sub(J).multiply(E), Q.fromArray(Z, 3 * (H + 1)).sub(J).multiply(E), P.fromArray(Z, 3 * (H + 2)).sub(J).multiply(E)), !M.isNaN() && p.expandByPoint(M), !Q.isNaN() && p.expandByPoint(Q), !P.isNaN() && p.expandByPoint(P);
                                    W.expandByBox(p), B = !0
                                }
                    return B ? (this._cacheBoundingBox = W, n.freeze(W), n.freeze(W.min), n.freeze(W.max), eb(q.gv, A), W) : O
                }
            }(),
            needValidate: function() { return this._iv },
            validate: function() {},
            _16O: function() { return Re },
            _80o: function() {},
            dispose: function() {},
            getBodyColor: function(h) {
                var F = this.data,
                    C = this.gv.getBodyColor(F);
                return C ? C : h ? F.getStyle(h) : A
            },
            getCachedTexture: function(t) { var x = this._cachedTextures; return x ? x[t || "main"] : null },
            setCachedTexture: function(r, I) { var S = this._cachedTextures; return S || (S = this._cachedTextures = {}), S[I || "main"] = r, r },
            invalidateCachedTexture: function(J) {
                var i = this._cachedTextures;
                if (i) {
                    for (var R in i) J.deleteTexture(i[R]);
                    this._cachedTextures = {}
                }
            },
            invalidateCachedGeometry: function() {},
            _24O: function(s, m) {
                var i = this,
                    T = i.data,
                    K = i.gv,
                    Q = i.s,
                    M = K[m](T);
                if (M != A) {
                    var H = Q(s + ".scale"),
                        g = Q(s + ".max"),
                        U = i[s + "Info"] = { label: M, textureScale: Q(s + ".texture.scale"), color: K[m + "Color"](T), font: Q(s + ".font"), align: Q(s + ".align"), background: K[m + "Background"](T) },
                        S = U.rect = Bi(U, M);
                    g > 0 && g < S.width && (U.labelWidth = S.width, S.width = g), S.x = S.y = 0, S.width *= H, S.height *= H, U.mat = i._16O(Q(s + ".autorotate"), Q(s + ".position"), S, Q(s + ".face"), Q(s + ".t3"), Q(s + ".r3"), Q(s + ".rotationMode"));
                    var R = S.width / 2,
                        f = S.height / 2;
                    U.vs = new ss([-R, f, 0, -R, -f, 0, R, -f, 0, R, f, 0]), S.width /= H, S.height /= H
                }
            },
            _26O: function(T, f) {
                var g = this,
                    n = g.data,
                    p = g.gv,
                    q = g.s,
                    Z = p[f](n);
                if (Z != A) {
                    var m = q(T + ".scale"),
                        t = this[T + "Info"] = { note: Z, textureScale: q(T + ".texture.scale"), expanded: q(T + ".expanded"), font: q(T + ".font"), color: q(T + ".color"), align: q(T + ".align"), borderWidth: q(T + ".border.width"), borderColor: q(T + ".border.color"), background: p[f + "Background"](n) };
                    if (t.expanded) {
                        var l = q(T + ".max"),
                            B = Bi(t, Z);
                        B.width += 6, B.height += 2, l > 0 && l < B.width && (t.labelWidth = B.width, B.width = l);
                        var S = { x: -B.width / 2, y: -8 - B.height, width: B.width, height: B.height + 8 }
                    } else S = { x: -6, y: -18, width: 12, height: 18 };
                    t.mat = g._16O(q(T + ".autorotate"), q(T + ".position"), A, q(T + ".face"), q(T + ".t3"), q(T + ".r3"), q(T + ".rotationMode")), t.rect = S, 1 !== m && (S = tf(S), S.x *= m, S.height *= m, S.y = -S.height, S.width *= m);
                    var e = S.x,
                        j = S.y,
                        W = S.width,
                        N = S.height;
                    t.vs = new ss([e, -j, 0, e, -j - N, 0, e + W, -j - N, 0, e + W, -j, 0])
                }
            },
            eachShapeModel: function(N, Q) {
                function H(E) { Bm(E), E.vs && N(E.vs, E.is, E.ns, E.uv), E.top_vs && N(E.top_vs, E.top_is, E.top_ns, E.top_uv), E.bottom_vs && N(E.bottom_vs, E.bottom_is, E.bottom_ns, E.bottom_uv), E.from_vs && N(E.from_vs, E.from_is, E.from_ns, E.from_uv), E.to_vs && N(E.to_vs, E.to_is, E.to_ns, E.to_uv) }

                function B(l) {
                    var q, T, e;
                    if (ud(l))
                        for (T = 0, e = l.length; e > T; T++) q = l[T], q && B(q);
                    else Ok(l) ? B(bl(d, l), d) : zg(l) && (l.shape3d ? B(l.shape3d) : H(l))
                }
                var d = this,
                    F = d.data,
                    Q = Q || d.shapeModel || bl(d);
                Q || (Q = F instanceof k.Node && !(F instanceof k.Shape) ? { vs: Nf, is: yk } : [d.left, d.front, d.right, d.back, d.top, d.bottom]), B(Q)
            },
            _28O: function(v, C, P) {
                if (P(this.s(C + ".transparent"))) {
                    var j = v.rect,
                        x = v.textureScale,
                        m = j.width * x,
                        Y = j.height * x;
                    if (m >= 1 && Y >= 1) {
                        var J = cf(m, Y);
                        1 !== x && (J.translate(J, j.x, j.y), J.scale(x, x), J.translate(J, -j.x, -j.y)), Ug(J, v), J.restore(), xs(this, C, v.mat, v.vs, !0)
                    }
                }
            },
            _29O: function(i, J, E) {
                if (E(this.s(J + ".transparent"))) {
                    var S = i.rect,
                        L = i.textureScale,
                        d = S.x,
                        A = S.y,
                        G = S.width * L,
                        f = S.height * L;
                    if (G >= 1 && f >= 1) {
                        S.x = S.y = 0;
                        var m = cf(G, f);
                        1 !== L && m.scale(L, L), uh(m, i), m.restore(), S.x = d, S.y = A, xs(this, J, i.mat, i.vs, !1)
                    }
                }
            },
            _99O: function(u, o, w, E, h, $) {
                if (w) {
                    var m = this,
                        g = m.gv,
                        O = m.data,
                        S = g._buffer,
                        v = g._1O,
                        N = w.icons,
                        F = Jg.for(u),
                        G = F.directAttribs();
                    for (var D in N) {
                        var n = N[D],
                            b = w.rects[D];
                        if (b && $(Rr(n.transparent, O, g))) {
                            g._picking && Ap(u, E, h, O, D);
                            var B = Rr(n.shape3d, O, g),
                                C = B ? [B] : Rr(n.names, O, g),
                                t = C ? C.length : 0,
                                y = Rr(n.textureScale, O, g) || 1,
                                c = Rr(n.light, O, g);
                            c == A && (c = B ? !0 : !1), Ge(u, o, Rr(n.blend, O, g), c, Rr(n.opacity, O, g), Rr(n.reverseFlip, O, g), Rr(n.reverseColor, O, g), Rr(n.reverseCull, O, g));
                            for (var k = 0; t > k; k++) {
                                var f = C[k],
                                    z = b[k];
                                if (_c(m, z.mat), B) cn(g, O, bl(m, B), m);
                                else {
                                    var Y = Jc(f);
                                    if (Y) {
                                        var s = z.width * y,
                                            j = z.height * y;
                                        if (s >= 1 && j >= 1) {
                                            var U = cf(s, j);
                                            Kq(U, Y, Rr(n.stretch, O, g), 0, 0, s, j, O, g), U.restore(), Xj(u, Rl, v), Lg(u, o, v, Rr(n.discardSelectable, O, g), S.uv, Pl), G.aPosition = ab(u, S.vs, z.vs, A), G.aNormal = Qm(u, S.ns, Ad, A), kk(u, S.is, Kn), pc(u, 0, Kn.length), Th(u, o, v)
                                        }
                                    }
                                }
                                lf(g)
                            }
                            Xf(u, o)
                        }
                    }
                }
            }
        });
        var Hs = function(W, K) { th(Hs, this, [W, K]) };
        eh(Hs, Gs, {
            _16O: function(Z, X, C, A, V, H, E, r, S) {
                var e = this.data,
                    n = e.getFinalScale3d(),
                    P = zp(X, n, C, A, r, S);
                if (e.hasOwnProperty("_anchor") || e.hasOwnProperty("_anchorElevation")) {
                    var I = e.getAnchor3d();
                    P[0] -= (I.x - .5) * n[0], P[1] -= (I.y - .5) * n[1], P[2] -= (I.z - .5) * n[2]
                }
                return Hh(ur(), P, e.p3(), A, V, H, E, Z, e.getFinalRotation3d(), e.getRotationMode())
            },
            clear: function() {
                var q = this;
                q.faceMat = q.mat = q.shapeModel = q.left = q.right = q.front = q.back = q.top = q.bottom = q.csg = A
            },
            needValidate: function(F) { if (this._iv) return this._validateFrameId = F._renderInfo.frame, !0; if (this.s("autorotate") || this.s("shape3d.autorotate") || this.s("fixSizeOnScreen") || this.s("shape3d.fixSizeOnScreen") || this.s("hide.overlapping.group")) { var K = F._renderInfo.frame; if (this._validateFrameId !== K) return this._validateFrameId = K, !0 } return !1 },
            validate: function(f, k) {
                var c = this,
                    J = c.gv,
                    P = c.data,
                    H = c.shapeName = c.s(Ll),
                    v = bl(c, H);
                if (c._updateAutoRotation(), c._updateFixSize2d(), c._updateOverlapping(), c.dispatchBoundingBoxChanged(), this.s("autorotate") || this.s("shape3d.autorotate") || this.s("fixSizeOnScreen") || this.s("shape3d.fixSizeOnScreen")) {
                    var x = P.getRenderLayer(),
                        Q = J._40Q.get(x);
                    Q && Q.ivWireframeBatch(P)
                }
                var p = Rp(P, J.getMat(P), v ? c.s("shape3d.scaleable") : !0);
                if (P.appendAnchorMatrix3d(p), c.clear(), c.mat = P.mat = p, v || !H)
                    if (c.shapeModel = v, f) {
                        var w = [];
                        v ? Qi(J, P, v, c, c.getBodyColor(), [p], f, w) : (Ei(J, P, f, k, p, Ui, w, rm), Ei(J, P, f, k, p, Ul, w, ig), Ei(J, P, f, k, p, Gm, w, am), Ei(J, P, f, k, p, uq, w, Ke), Ei(J, P, f, k, p, Pi, w, Pr), Ei(J, P, f, k, p, Qj, w, Nm)), w.length && (no(f.vs, w), no(f.ns, Dc(w)))
                    } else v || (c._cubeUvs = null, c.vf(Ui, 0), c.vf(Ul, 16), c.vf(Pi, 8), c.vf(Qj, 24), c.vf(Gm, 32), c.vf(uq, 40))
            },
            _updateAutoRotation: function() {
                var Q = new Mq,
                    I = new rs,
                    d = new Cb,
                    t = new Cb,
                    x = new Cb;
                return function() {
                    var J = this,
                        E = J.data,
                        X = J.s("autorotate") || J.s("shape3d.autorotate");
                    if (!X) return E._dynamicRotation && delete E._dynamicRotation, void 0;
                    var N = J.gv;
                    x.copy(J.s("shape3d.autorotate.up") || N._up);
                    var S;
                    S = "string" == typeof X ? [X.indexOf("x") < 0 ? N._eye[0] : N._center[0], X.indexOf("y") < 0 ? N._eye[1] : N._center[1], X.indexOf("z") < 0 ? N._eye[2] : N._center[2]] : N._eye;
                    var n = N._center,
                        i = E.p3();
                    d.copy(i), t.set(S[0] - n[0], S[1] - n[1], S[2] - n[2]).add(d), I.lookAt(t, d, x), Q.set(0, 0, 0, E.getRotationMode(), !0).setFromRotationMatrix(I);
                    var h = E._dynamicRotation;
                    h && Math.abs(h[0] - Q.x) < 1e-5 && Math.abs(h[1] - Q.y) < 1e-5 && Math.abs(h[2] - Q.z) < 1e-5 || (E._dynamicRotation = [Q.x, Q.y, Q.z])
                }
            }(),
            _updateFixSize2d: function() {
                var z = this,
                    Q = z.data,
                    g = z.s("fixSizeOnScreen") || z.s("shape3d.fixSizeOnScreen");
                if (!g) return Q._dynamicScale3d && delete Q._dynamicScale3d, void 0;
                var W = z.gv,
                    t = Rp(Q, W.getMat(Q)),
                    s = yi([0, 0, 0], t),
                    R = W.toViewPosition(s);
                if (!isNaN(R.x) && !isNaN(R.y)) {
                    var B = yi([1, 0, 0], t),
                        f = W.toViewPosition(B),
                        e = yi([0, 1, 0], t),
                        i = W.toViewPosition(e),
                        I = f.x - R.x,
                        D = i.y - R.y;
                    if (I && D) {
                        var F, C, q = Q._dynamicScale3d || [1, 1, 1],
                            P = Jc(Q.s("shape3d.image"));
                        if (g[0] > 0 && (F = g[0]), g[1] > 0 && (C = g[1]), !F || !C) {
                            var y = g > 0 ? g : 1;
                            F || (F = (Hc(P, Q) || Q.getWidth()) * y), C || (C = (Gp(P, Q) || Q.getTall()) * y)
                        }
                        var w = Math.abs(I / F),
                            n = Math.abs(D / C);
                        Math.abs(w - 1) < .001 && Math.abs(n - 1) < .001 || (Q._dynamicScale3d = [q[0] / w, q[1] / n, q[2]])
                    }
                }
            },
            _updateOverlapping: function() {
                var b = this,
                    x = b.s("hide.overlapping.group");
                if (!x) return b._rectOverlapping && (b._rectOverlapping = O), void 0;
                var E, e, p, K = b.gv,
                    B = b.data,
                    v = Rp(B, K.getMat(B)),
                    k = 1 / 0,
                    t = 1 / 0,
                    l = -1 / 0,
                    Q = -1 / 0,
                    $ = B.getAnchor3d(),
                    r = $.x,
                    U = $.y,
                    Z = $.z;
                for (E = 0; 8 > E; E++) {
                    if (e = yi([(E >> 2) - r, (1 & E >> 1) - U, (1 & E) - Z], v), p = K.toViewPosition(e), isNaN(p.x) || isNaN(p.y)) return;
                    k = Math.min(k, p.x), l = Math.max(l, p.x), t = Math.min(t, p.y), Q = Math.max(Q, p.y)
                }
                var h = { x: k, y: t, w: l - k, h: Q - t };
                b._rectOverlapping = K.overlappingBox.isOverlapping(x, h)
            },
            getVectorDynamicSize: function() {
                var f, n = this,
                    H = n.s("shape3d"),
                    W = n.data;
                if ("billboard" === H || "plane" === H || (f = W._currentCubeElementId) != A) {
                    var u, S, b = n.gv,
                        T = Rp(W, b.getMat(W)),
                        e = W.getAnchor3d(),
                        P = .5 - e.x,
                        D = .5 - e.y,
                        R = .5 - e.z,
                        x = Math.min(n.s("vector.dynamic.maxsize"), b._glCapabilities.maxTextureSize) / b.getDevicePixelRatio(),
                        s = function(f, C) {
                            f[0] += P, f[1] += D, f[2] += R, C[0] += P, C[1] += D, C[2] += R;
                            var l = b.toViewPosition(yi(f, T)),
                                _ = b.toViewPosition(yi(C, T)),
                                A = l.x - _.x,
                                k = l.y - _.y;
                            return Math.min(x, Math.sqrt(A * A + k * k))
                        };
                    if ("billboard" === H) u = s([-.5, 0, 0], [.5, 0, 0]), S = s([0, -.5, 0], [0, .5, 0]);
                    else if ("plane" === H) u = s([-.5, 0, 0], [.5, 0, 0]), S = s([0, 0, -.5], [0, 0, .5]);
                    else if (W._currentCubeElementId != A) {
                        var z = 3 * yk[f + 1],
                            m = 3 * yk[f],
                            L = 3 * yk[f + 2];
                        u = s([Nf[z], Nf[z + 1], Nf[z + 2]], [Nf[L], Nf[L + 1], Nf[L + 2]]), S = s([Nf[z], Nf[z + 1], Nf[z + 2]], [Nf[m], Nf[m + 1], Nf[m + 2]])
                    }
                    return [u, S]
                }
            },
            vf: function(h, n) {
                var G = this;
                if (G.gv.getFaceVisible(G.data, h)) {
                    var z = lb(G, h);
                    z.mat && (G.faceMat = !0);
                    var I = z.uv;
                    if (I) {
                        var w = G._cubeUvs;
                        w || (w = G._cubeUvs = new ss([0, 0, 0, 1, 1, 1, 1, 0, 0, 0, 0, 1, 1, 1, 1, 0, 0, 0, 0, 1, 1, 1, 1, 0, 0, 0, 0, 1, 1, 1, 1, 0, 0, 0, 0, 1, 1, 1, 1, 0, 0, 0, 0, 1, 1, 1, 1, 0]));
                        for (var c = 0; 8 > c; c++) w[n + c] = I[c]
                    }
                    return z
                }
            },
            _billboardInView: function() {
                var S = [-.5, -.5, 0, -.5, .5, 0, .5, -.5, 0, .5, .5, 0],
                    q = [-.5, 0, -.5, -.5, 0, .5, .5, 0, -.5, .5, 0, .5],
                    K = new tk,
                    p = new Cb,
                    c = new rs;
                return function(v) {
                    var R = this;
                    if (!R.mat) return !0;
                    var d = R.gv.getFrustum(),
                        k = "billboard" === v ? S : q;
                    K.makeEmpty(), c.fromArray(R.mat);
                    for (var Z = 0, L = k.length; L > Z; Z += 3) K.expandByPoint(p.fromArray(k, Z).applyMatrix4(c));
                    return d.intersectsBox(K)
                }
            }(),
            _80o: function(O, B, f) {
                var Z = this;
                if (Z._rectOverlapping) return !0;
                var N = Z.shapeModel;
                if (N || !Z.shapeName) {
                    var W = Z.s("shape3d");
                    if (("billboard" === W || "plane" === W) && !Z._billboardInView(W)) return !0;
                    var w = Z.gv,
                        J = Z.data,
                        i = w._cube,
                        P = Jg.for(O),
                        d = P.directAttribs();
                    if (Yj && !uo) {
                        var n = Z.mat;
                        if (n)
                            for (var S = 0; S < n.length; S++) Z.mat[S] = n[n.length - S - 1]
                    }
                    Vp(w, Z.mat), Z.s("shape3d.reflector") && !O._picking || (N ? cn(w, J, N, Z, Z.getBodyColor(), f) : (d.aPosition = ab(O, i.vs, A, A), d.aNormal = ab(O, i.ns, A, A), Dh(O, i.is), Z._18O(O, B, "left", 0, f), Z._18O(O, B, "front", 6, f), Z._18O(O, B, "right", 12, f), Z._18O(O, B, "back", 18, f), Z._18O(O, B, "top", 24, f), Z._18O(O, B, "bottom", 30, f))), lf(w), Z.faceMat && (Z._18O(O, B, "left", 0, f, !0), Z._18O(O, B, "front", 6, f, !0), Z._18O(O, B, "right", 12, f, !0), Z._18O(O, B, "back", 18, f, !0), Z._18O(O, B, "top", 24, f, !0), Z._18O(O, B, "bottom", 30, f, !0))
                }
            },
            _18O: function(d, t, p, x, U, n) {
                var u = this[p];
                if (u) {
                    if (!U(u.transparent)) return;
                    if (n && !u.mat || !n && u.mat) return;
                    var c = this.data.s("polygonOffset");
                    c && up(d, c), n && Vp(this.gv, u.mat);
                    var X = this,
                        a = X.data,
                        y = Jg.for(d),
                        j = y.directUniforms();
                    a._currentCubeElementId = x;
                    var P = X.gv,
                        v = P.getTexture(u.texture, a, p),
                        l = u.uv,
                        O = u.uvScale,
                        L = u.uvOffset,
                        q = u.uvRotation,
                        G = u.discardSelectable;
                    v ? l ? Lg(d, t, v, G, P._buffer.uv, X._cubeUvs, L, O, q) : Lg(d, t, v, G, P._cube.uv, A, L, O, q) : Lg(d), Ge(d, t, u.blend, u.light, u.opacity, u.reverseFlip, u.reverseColor, u.reverseCull), j.uDiffuse = u.color || h["color.empty"], pc(d, x, 6), Xf(d, t), Th(d, t, v), n && lf(P), c && dj(d), a._currentCubeElementId = null
                }
            },
            drawReflector: function() {
                var R = new Cb,
                    n = new Cb,
                    o = new Mq,
                    X = new rs,
                    W = new Cb,
                    I = new Cb,
                    m = new Cb,
                    r = new Cb,
                    t = new rs,
                    j = new rs,
                    U = new he,
                    g = new oo,
                    b = new oo,
                    L = function(a, U, L) { a[L] = U[0], a[L + 1] = U[1], a[L + 2] = U[2] },
                    D = function(K, Z) { L(K, Z.getEye(), 0), L(K, Z.getCenter(), 3), L(K, Z.getUp(), 6) },
                    G = function(y, u) {
                        u._eye = [y[0], y[1], y[2]], u._center = [y[3], y[4], y[5]], u._up = [y[6], y[7], y[8]], u._18Q = A;
                        var p = u._skybox;
                        p && (p.p3([y[0], y[1], y[2]]), u.getData3dUI(p).iv())
                    };
                return function(B) {
                    var l = this;
                    l._reflectorInfo = null;
                    var K = l.data;
                    if (K._reflecting) return !1;
                    var P = l.gv;
                    if (P._picking) return !1;
                    var $ = l._reflectorRenderTarget,
                        v = P.getDevicePixelRatio(),
                        h = P.getWidth() * v,
                        u = P.getHeight() * v;
                    $ ? $.setSize(B, h, u) : $ = l._reflectorRenderTarget = new Of.RenderTarget(P, B, h, u), R.copy(K.p3()), n.copy(P.getEye()), X.makeRotationFromEuler(o.set(K.r3(), K.getRotationMode(), !0));
                    var y;
                    if (!l._reflectNormal) {
                        var y = bl(l, l.s("shape3d"));
                        if (!y) return !1;
                        if (!y.ns && y.length && (y = y[0]), !y.ns || !y.vs) return !1;
                        l._reflectNormal = [y.ns[0], y.ns[1], y.ns[2]], l._reflectorVbuffer = zm.Buffer.createVertexBuffer(B, new Float32Array(y.vs))
                    }
                    if (W.copy(l._reflectNormal), W.applyMatrix4(X), I.subVectors(R, n), I.dot(W) > 0) return !1;
                    I.reflect(W).negate(), I.add(R), m.copy(P.getCenter()).negate().add(R), m.reflect(W).negate(), m.add(R), r.copy(P.getUp()), r.reflect(W);
                    var H = [0, 0, 0, 0, 0, 0, 0, 0, 0];
                    D(H, P), P._eye = I.toArray(), P._center = m.toArray(), P._up = r.toArray(), P._18Q = A;
                    var Q = P._skybox;
                    Q && (Q.p3(P._eye), P.getData3dUI(Q).iv()), md(B, $.frame), P.setViewport(B, 0, 0, $.width, $.height);
                    var k = K.s("shape3d.reflector.background");
                    if (k) {
                        var C = B.getParameter(B.COLOR_CLEAR_VALUE);
                        xd(B, k)
                    } else xd(B, [0, 0, 0, 1]);
                    Jg.for(B).glState.depth.mask = !0, B.clear(B.COLOR_BUFFER_BIT | B.DEPTH_BUFFER_BIT);
                    var F = Rj(P),
                        J = qh(P);
                    U.setFromNormalAndCoplanarPoint(W, R), U.applyMatrix4(j.fromArray(J)), g.set(U.normal.x, U.normal.y, U.normal.z, U.constant), b.x = (Math.sign(g.x) + F[8]) / F[0], b.y = (Math.sign(g.y) + F[9]) / F[5], b.z = -1, b.w = (1 + F[10]) / F[14], g.multiplyScalar(2 / g.dot(b));
                    var e = K.s("shape3d.reflector.clip"),
                        E = e === O ? .003 : e;
                    F[2] = g.x, F[6] = g.y, F[10] = g.z + 1 - E, F[14] = g.w;
                    var S = P._computedProjectMatrix;
                    P._computedProjectMatrix = F, K._reflecting = !0, P.renderScene(), P._computedProjectMatrix = S, t.set(.5, 0, 0, .5, 0, .5, 0, .5, 0, 0, .5, .5, 0, 0, 0, 1), t.multiply(j.fromArray(P._projectMatrix)), t.multiply(j.fromArray(P._viewMatrix)), k && xd(B, C), Fc(B), G(H, P);
                    var c = K.s("shape3d.reflector.blur");
                    if (c) {
                        var w = P.getPostProcessingModule("Blur");
                        w && w.drawImpl(B, $, c, K.s("shape3d.reflector.blur.ratio"))
                    }
                    var i = B._compiledShader.reflector;
                    i || (i = B._compiledShader.reflector = new zm.Shader(B, yn.Reflector.vs, yn.Reflector.fs)), i.bind(), B.activeTexture(B.TEXTURE0), Jo(B, $.texture), i.uniforms.tDiffuse = 0, i.uniforms.color = Lf(K.s("shape3d.reflector.color") || "rgb(128,128,128)"), i.uniforms.textureMatrix = t.toArray(), i.uniforms.modelMatrix = Rp(K), i.uniforms.viewMatrix = qh(P), i.uniforms.projectionMatrix = Rj(P), l._reflectorVbuffer.upload(), i.attributes.pos.pointer(l._reflectorVbuffer);
                    var Z = this.s("shape3d.transparent");
                    if (Z) {
                        var p = Jg.for(B).glState,
                            x = p.depth.mask;
                        p.depth.mask = !1
                    }
                    return B.drawArrays(B.TRIANGLES, 0, 6), Z && (p.depth.mask = x), K._reflecting = !1, B.useProgram(P._prg), Jo(B, A), !0
                }
            }()
        }), yn.Reflector = { vs: ["attribute vec3 pos;", "uniform mat4 textureMatrix;", "uniform mat4 modelMatrix;", "uniform mat4 viewMatrix;", "uniform mat4 projectionMatrix;", "varying vec4 vUv;", "void main() {", "	vUv = textureMatrix * modelMatrix * vec4( pos, 1.0 );", "	gl_Position = projectionMatrix * viewMatrix * modelMatrix * vec4( pos, 1.0 );", "}"].join("\n"), fs: ["precision highp float;", "uniform vec3 color;", "uniform sampler2D tDiffuse;", "varying vec4 vUv;", "float blendOverlay( float base, float blend ) {", "	return( base < 0.5 ? ( 2.0 * base * blend ) : ( 1.0 - 2.0 * ( 1.0 - base ) * ( 1.0 - blend ) ) );", "}", "vec3 blendOverlay( vec3 base, vec3 blend ) {", "	return vec3( blendOverlay( base.r, blend.r ), blendOverlay( base.g, blend.g ), blendOverlay( base.b, blend.b ) );", "}", "void main() {", "	vec4 base = texture2DProj( tDiffuse, vUv );", "   vec2 tUv = vUv.xy / vUv.w;", "   if (tUv.x < .0 || tUv.y < .0 || tUv.x > 1. || tUv.y > 1.) discard;", "	gl_FragColor = vec4( blendOverlay( base.rgb, color ), base.a );", "}"].join("\n") };
        var Is = function(A, U) { th(Is, this, [A, U]) };
        eh(Is, Hs, { _80o: function() {} });
        var Js = function(w, N) { th(Js, this, [w, N]) };
        eh(Js, Gs, {
            _25Q: 1,
            validate: function(W) {
                var S = this;
                if (!S.s("geometry.cache") || !S.info) {
                    var L = S.gv,
                        G = S.data,
                        p = S.s,
                        B = p("edge.width"),
                        h = G._40I,
                        R = G._41I;
                    if (S.shapeModel = S.info = S.lineShapeModel = A, h && R) {
                        var o, C, f, Z, X, b, k, r, u, K, M = G.isLooped(),
                            I = p(Lk),
                            c = D.getEdgeType(I);
                        if (c) {
                            var J = c(G, Qo(S, L, G, M, I), L, S._19Q);
                            if (!J.points || J.points.isEmpty()) return;
                            b = S.info = {}, k = J.segments, X = J.points, r = X.size();
                            for (var e = h.getElevation(), w = R.getElevation(), s = 0; r > s; s++) {
                                var $ = X.get(s);
                                $.e == A && ($.e = e + (w - e) * s / (r - 1))
                            }
                            u = Hj(X.get(0)), K = Hj(X.get(r - 1));
                            var T = r % 2;
                            0 === T ? (b.c1 = Hj(X.get(r / 2 - 1)), b.c2 = Hj(X.get(r / 2))) : b.p3 = Hj(X.get((r - T) / 2)), b.s1 = u, b.s2 = Hj(X.get(1)), b.t1 = Hj(X.get(r - 2)), b.t2 = K
                        } else {
                            X = new En, b = S.info = {};
                            var V = p("edge.offset"),
                                y = p("edge.center"),
                                d = p("edge.source.t3"),
                                Q = p("edge.target.t3"),
                                _ = rp(L, G, "source"),
                                P = rp(L, G, "target");
                            if (!_ || !P) return L.invalidateData(G), delete S.info, !1;
                            if (d && (_[0] += d[0], _[1] += d[1], _[2] += d[2]), Q && (P[0] += Q[0], P[1] += Q[1], P[2] += Q[2]), I === Vf) {
                                k = p("edge.segments");
                                var O = b.points = p(Go) || xg;
                                if (r = O.size()) {
                                    u = Hj(O.get(0)), K = Hj(O.get(r - 1)), !y && V && (f = zd(u, _, !0), V = i(V, _q(_, u)), _ = [_[0] + f[0] * V, _[1] + f[1] * V, _[2] + f[2] * V], f = zd(P, K, !0), V = i(V, _q(K, P)), P = [P[0] - f[0] * V, P[1] - f[1] * V, P[2] - f[2] * V]);
                                    var T = r % 2;
                                    0 === T ? (o = Hj(O.get(r / 2 - 1)), C = Hj(O.get(r / 2))) : b.p3 = Hj(O.get((r - T) / 2)), b.s1 = _, b.s2 = u, b.t1 = K, b.t2 = P
                                } else !y && V && (f = zd(P, _, !0), Z = _q(_, P), V = ck(V, Z), _ = [_[0] + f[0] * V, _[1] + f[1] * V, _[2] + f[2] * V], P = [P[0] - f[0] * V, P[1] - f[1] * V, P[2] - f[2] * V]), o = _, C = P;
                                X.add({ x: _[0], y: _[2], e: _[1] }), X.addAll(O), X.add({ x: P[0], y: P[2], e: P[1] })
                            } else {
                                var l = Qo(S, L, G, M, I);
                                if (S._19Q || (l = -l), M) {
                                    var m = _[0],
                                        E = _[1],
                                        n = _[2],
                                        q = h.getTall() / 2 + l;
                                    o = [m - l, E + q, n], C = [m + l, E + q, n], X.add({ x: m - l, y: n, e: E }), X.add({ x: m - l, y: n, e: E + q }), X.add({ x: m + l, y: n, e: E + q }), X.add({ x: m + l, y: n, e: E })
                                } else {
                                    f = zd(P, _, !0), Z = _q(_, P);
                                    var F = { x: _[0], y: _[2] },
                                        x = { x: P[0], y: P[2] },
                                        N = Sd(A, F, x, l),
                                        Y = N.x - F.x,
                                        U = N.y - F.y;
                                    V = ck(V, Z), f[0] *= V, f[1] *= V, f[2] *= V, o = [_[0] + f[0] + Y, _[1] + f[1], _[2] + f[2] + U], C = [P[0] - f[0] + Y, P[1] - f[1], P[2] - f[2] + U], y ? (X.add({ x: _[0], y: _[2], e: _[1] }), X.add({ x: o[0], y: o[2], e: o[1] }), X.add({ x: C[0], y: C[2], e: C[1] }), X.add({ x: P[0], y: P[2], e: P[1] })) : (X.add({ x: o[0], y: o[2], e: o[1] }), X.add({ x: C[0], y: C[2], e: C[1] }))
                                }
                            }
                            b.c1 = o, b.c2 = C
                        }
                        b._lastPointsSegments = { points: X, segments: k }, b.list = p(Ll) === yg ? S.createTubeModel(X, k, B / 2, W) : S.createLineModel(X, k, B, "edge", "edge.dash")
                    }
                }
            },
            invalidateCachedGeometry: function() { this.info = A }
        });
        var Ks = function(G, i) { th(Ks, this, [G, i]), this._needRecoverPosition = !0 };
        eh(Ks, Hs, {
            _80o: function(_, y, R) {
                var H = this,
                    X = H.mat;
                if (X) {
                    var f = H.gv,
                        b = H.shapeModel;
                    Vp(f, X), b ? cn(f, H.data, b, H, H.getBodyColor(), R) : (mn(H, _, y, "left", R), mn(H, _, y, "front", R), mn(H, _, y, "right", R), mn(H, _, y, "back", R), mn(H, _, y, "top", R), mn(H, _, y, "bottom", R)), lf(f)
                }
            },
            validate: function(P, Q) {
                var b, U, O = this,
                    C = O.s,
                    t = O.data,
                    W = t._thickness / 2,
                    v = t.isClosePath(),
                    V = t.getPoints(),
                    q = t.getSegments(),
                    y = C(Kh),
                    I = P && P.uv;
                if (O.clear(), O.dispatchBoundingBoxChanged(), 0 > W) {
                    try { U = O.shapeModel = Lc(V, q, C(Yf), C(wp), y, C(xp), t.getTall(), t.getShapeElevation(), v) } catch (F) { U = O.shapeModel = {} }
                    C(Rn) ? C("shape3d.image") || delete U.uv : (delete U.vs, delete U.ns, delete U.uv), C("shape3d.top.image") || delete U.top_uv, C("shape3d.bottom.image") || delete U.bottom_uv
                } else if (C(Ll) === yg) b = vc(V, q, y, v), U = O.shapeModel = { vs: [] }, C("shape3d.image") && (U.uv = [], U.sum = C(xp) || Oj(b) || 1, U.len = 0), C(Yf) && !v && (U.top_vs = [], C("shape3d.top.image") && (U.top_uv = [])), C(wp) && !v && (U.bottom_vs = [], C("shape3d.bottom.image") && (U.bottom_uv = [])), O._12O(b, W);
                else {
                    var u, f, G, H, l, n, i, T, c, N;
                    if (b = vc(V, q, y, v), l = O.vf(Pi, I, !1, Q), W && (n = O.vf(Qj, I, !1, Q), i = v ? A : O.vf(Ui, I, !1, Q), T = v ? A : O.vf(Ul, I, !1, Q), c = O.vf(Gm, I, !1, Q), N = O.vf(uq, I, !1, Q)), W) {
                        for (var K = 0, S = b.length; S > K; K++) b[K] = O._tryRemoveBezierPoints(b[K], W);
                        O._12O(b, W)
                    } else l && b.forEach(function(C) {
                        if (H = C.length, H > 0)
                            for (u = C[0], G = 1; H > G; G++) f = C[G], O.addV(l.vs, u, f), u = f
                    });
                    O._20Q(b), P || (l && (l.ns = Dc(l.vs), mo(l, "vs"), mo(l, cm)), W && (n && (n.ns = Dc(n.vs), mo(n, "vs"), mo(n, cm)), i && (i.ns = Dc(i.vs), mo(i, "vs"), mo(i, cm)), T && (T.ns = Dc(T.vs), mo(T, "vs"), mo(T, cm)), c && (c.ns = Dc(c.vs), mo(c, "vs"), mo(c, cm)), N && (N.ns = Dc(N.vs), mo(N, "vs"), mo(N, cm))))
                }
                var d = O.mat = t.getPointsMatrix3d().getElements();
                P && (ym(O, d, P, U), O.clear())
            },
            _20Q: function(T) {
                var i, L, W, D, h, N, g, J = this,
                    l = J.front,
                    M = J.back,
                    j = J.top,
                    w = J.bottom,
                    e = l ? l.tuv : A,
                    c = M ? M.tuv : A,
                    X = j ? j.tuv : A,
                    x = w ? w.tuv : A,
                    u = 0;
                (e || c || X || x) && (i = J.s(xp) || Oj(T) || 1, T.forEach(function(G) {
                    if (L = G.length, L > 0)
                        for (N = G[0], W = 1; L > W; W++) g = G[W], D = u / i, u += _q(N, g), h = u / i, J._14O(l, D, h), J._14O(M, 1 - h, 1 - D), J._14O(j, D, h), J._14O(w, D, h), N = g
                }))
            },
            _14O: function(z, x, B) {
                if (z) {
                    var D = z.uv,
                        a = z.tuv;
                    if (a) {
                        if (D) var o = D[0] + (D[6] - D[0]) * x,
                            $ = D[1] + (D[7] - D[1]) * x,
                            p = D[2] + (D[4] - D[2]) * x,
                            E = D[3] + (D[5] - D[3]) * x,
                            v = D[2] + (D[4] - D[2]) * B,
                            y = D[3] + (D[5] - D[3]) * B,
                            O = D[0] + (D[6] - D[0]) * B,
                            K = D[1] + (D[7] - D[1]) * B;
                        else o = x, $ = 0, p = x, E = 1, v = B, y = 1, O = B, K = 0;
                        a.push(p, E, v, y, O, K, O, K, o, $, p, E)
                    }
                }
            },
            _13O: function(U) {
                var P = U.uv,
                    z = U.tuv;
                z && (P ? z.push(P[2], P[3], P[4], P[5], P[6], P[7], P[6], P[7], P[0], P[1], P[2], P[3]) : z.push(0, 1, 1, 1, 1, 0, 1, 0, 0, 0, 0, 1))
            },
            _tryRemoveBezierPoints: function(U, Z) {
                var t = U.length;
                if (4 > t) return U;
                var u, D, h, Y, i, e, p = !1,
                    r = function(q) { return U[q] },
                    S = function(Y) { return U[t - 1 - Y] };
                for (i = 0; 1 >= i; i++)
                    for (e = i ? S : r, D = e(0), h = e(1), u = 2; t - 1 > u; u++)
                        if (Y = e(u), !Y.remove)
                            if (Y.b) {
                                var L = Sd(D, h, Y, Z);
                                L.adjust ? (Y.remove = !0, p = !0) : (D = h, h = Y)
                            } else D = h, h = Y;
                if (!p) return U;
                var n = [];
                for (u = 0; t > u; u++) U[u].remove || n.push(U[u]);
                return n
            },
            _12O: function(H, c) {
                var h, D, o, J, d, u = this.s("shape3d.point.epsilon"),
                    t = this;
                H.forEach(function(T) {
                    if (d = T.length, d > 0)
                        for (h = { p: T[0], n: !0 }, J = 1; d > J; J++) D = T[J], o = d - 1 > J ? T[J + 1] : A, o && Math.abs(D.x - o.x) < u && Math.abs(D.y - o.y) < u || t.addPoint(h, D, o, c, T)
                })
            },
            addPoint: function(i, T, C, G, d) {
                var W, t, s, L, S, $, e, P, x, y = this,
                    g = i.p,
                    z = i.f,
                    Y = i.b,
                    j = y.s("shape3d.side") || Ee,
                    v = y.s("shape3d.start.angle"),
                    N = y.s("shape3d.sweep.angle"),
                    B = y.shapeModel,
                    F = y.data.isClosePath();
                if (i.n && (i.n = !1, z = F && d.length > 2 ? Sd(d[d.length - 2], g, T, G) : Sd(A, g, T, G), Y = sr(g, z), B ? B.top_vs && y._10O(Y, z, j, v, N, B.top_vs, B.top_uv) : (W = y.left) && (y.addV(W.vs, Y, z), y._13O(W))), t = C ? Sd(g, T, C, G) : F && d.length > 2 ? Sd(g, T, d[1], G) : Sd(g, T, A, G), s = sr(T, t), B) {
                    var o, U, M = B.vs,
                        c = B.uv,
                        J = B.sum;
                    for (c && (o = B.len / J, B.len += _q(g, T), U = B.len / J), $ = y._9O(Y, z, j, v, N), e = y._9O(s, t, j, v, N), P = 0; j > P; P++) x = P + 1, no(M, $[x]), no(M, e[P]), no(M, $[P]), no(M, e[P]), no(M, $[x]), no(M, e[x]), c && (L = P / j, S = x / j, c.push(o, S, U, L, o, L, U, L, o, S, U, S));
                    !C && B.bottom_vs && y._10O(s, t, j, v, N, B.bottom_vs, B.bottom_uv, !0)
                } else !C && (W = y.right) && (y.addV(W.vs, t, s), y._13O(W)), (W = y.front) && y.addV(W.vs, z, t), (W = y.back) && y.addV(W.vs, s, Y), (W = y.top) && y.addH(W.vs, z, t, s, Y, !0), (W = y.bottom) && y.addH(W.vs, Y, s, t, z);
                i.p = T, i.f = t, i.b = s
            },
            _10O: function(V, S, e, t, v, X, d, J) {
                var E, s, n = this,
                    j = n.data,
                    f = n._9O(V, S, e, t, v),
                    i = (V.x + S.x) / 2,
                    h = (V.y + S.y) / 2,
                    y = j.getShapeElevation(),
                    c = 0;
                for (c = 0; e > c; c++) J ? (no(X, f[c]), no(X, f[c + 1])) : (no(X, f[c + 1]), no(X, f[c])), no(X, [i, y, h]), d && (J ? (E = m * (c + 1) / e + t, s = m * c / e + t) : (E = m * c / e + t, s = m * (c + 1) / e + t), d.push(.5 - .5 * C(s), .5 - .5 * N(s), .5 - .5 * C(E), .5 - .5 * N(E), .5, .5))
            },
            _9O: function(K, w, o, D, V) {
                var n, O, J = this,
                    T = J.data,
                    c = [],
                    k = (K.x + w.x) / 2,
                    t = (K.y + w.y) / 2,
                    e = T.getTall() / 2,
                    G = T.getShapeElevation(),
                    L = 0;
                for (V == A && (V = m); o >= L; L++) n = V * L / o + D, O = C(n), c.push([k + (K.x - k) * O, G + e * N(n), t + (K.y - t) * O]);
                return c
            },
            addV: function(S, w, G) {
                var P = w.x,
                    E = w.y,
                    t = G.x,
                    W = G.y,
                    V = this.data,
                    h = V.getShapeElevation(),
                    O = V.getTall() / 2;
                S.push(P, h - O, E, t, h - O, W, t, h + O, W, t, h + O, W, P, h + O, E, P, h - O, E)
            },
            addH: function(q, y, p, W, I, r) {
                var N = this.data,
                    J = N.getTall() / 2,
                    z = N.getShapeElevation() + (r ? J : -J);
                q.push(y.x, z, y.y, p.x, z, p.y, W.x, z, W.y, W.x, z, W.y, I.x, z, I.y, y.x, z, y.y)
            },
            vf: function(G, e, z, X) {
                var D, o = this,
                    H = o.gv.getFaceVisible(o.data, G);
                return (z || H) && (D = lb(o, G, X), D.vs = [], D.tuv = H && (D.texture || e) ? [] : A, D.visible = H), D
            }
        });
        var Ls, Ms, Ns = function(W, Q) { th(Ns, this, [W, Q]) };
        eh(Ns, Hs, {
            validate: function() {
                var E = this,
                    o = E.gv,
                    k = E.data,
                    V = E.s,
                    h = Lf(V("points.color"));
                h = [h[0], h[1], h[2]];
                var d = V("points.size"),
                    X = V("points.image") || "rect";
                ("rect" === X || "circle" === X) && ("rect" === X ? (Ls || (Ls = E._createCachedImage(X)), X = Ls) : (Ms || (Ms = E._createCachedImage(X)), X = Ms));
                var p = V("points.model");
                if (p) {
                    if (E._lastShapeModel !== p || !E.shapeModel) {
                        var N = bl(E, p);
                        if (!N) return;
                        var r = [],
                            J = {};
                        E.eachShapeModel(function(d) {
                            for (var q = 0, o = d.length; o > q; q += 3) {
                                var a = d[q],
                                    i = d[q + 1],
                                    l = d[q + 2],
                                    x = "" + a + "_" + i + "_" + l;
                                J[x] || (J[x] = !0, r.push(a, i, l))
                            }
                        }, N), E.shapeModel = { vs: new ss(r) }, k._pointsDirty = !0, E._lastShapeModel = p
                    }
                } else {
                    var Z = k.points,
                        F = Z.length,
                        C = F / 3;
                    if (k._pointsDirty || !E.shapeModel) {
                        var u = new ss(Z);
                        E.shapeModel = { vs: u }, k._pointsDirty = !1, E._lastShapeModel = null
                    }
                }
                if (E.info = { mat: Rp(k), size: d, diffuse: h, opacity: V("points.opacity"), texture: X, alphaTest: V("points.transparent") ? 0 : V("alphaTest") }, k._colorsDirty) {
                    for (var i, P, H, T = [], D = !1, W = k.colors, l = 0; F > l; l += 3) i = W[l], P = W[l + 1], H = W[l + 2], i === O || P === O || H === O ? T.push(h[0], h[1], h[2]) : (D = !0, T.push(i, P, H));
                    E.shapeModel.cs = D ? new ss(T) : null, k._colorsDirty = !1
                }
                if (k._sizesDirty) {
                    for (var w = [], m = !1, Q = k.sizes, l = 0; C > l; l++) Q[l] ? (w.push(Q[l]), m = !0) : w.push(d);
                    E.shapeModel.ss = m ? new ss(w) : null, k._sizesDirty = !1
                }
                if (E._lastPointNumber !== C) {
                    var U = o.pickColorMap,
                        A = U._pickIdUsed;
                    U._pickIdUsed = A + C;
                    for (var q = [], l = 0; C > l; l++) {
                        var s = A + l,
                            G = Jr(s);
                        q.push(G[0], G[1], G[2], G[3]), U[s] || (U[s] = { data: k, part: l })
                    }
                    E.shapeModel.ps = new ss(q), E._lastPointNumber = C
                }
                this.dispatchBoundingBoxChanged()
            },
            _createCachedImage: function(G) {
                var i = 128,
                    z = Sg(),
                    x = z.getContext("2d");
                Cq(z, i, i, 1), as(x, { width: i, height: i, comps: [{ type: G, background: "white", borderWidth: 0, rect: [0, 0, i, i] }] }, 0, 0, i, i);
                var P = k.Math.generateUUID();
                return Qr[P] = z, P
            },
            _80o: function(T, u) {
                var S = this,
                    Y = S.gv,
                    O = S.shapeModel,
                    L = S.info;
                if (O && O.vs && O.vs.length) {
                    var P = Jg.for(T);
                    P.useProgram(S._asureProgram(T)), P.directState();
                    var s = P.directUniforms(),
                        g = P.directAttribs();
                    s.modelMatrix = L.mat, s.modelViewMatrix = lk([], Y._viewMatrix, L.mat), s.projectionMatrix = Y._projectMatrix, s.viewMatrix = Y._viewMatrix, s.scale = Y.getHeight() / 2, s.size = L.size, s.diffuse = L.diffuse, s.opacity = L.opacity, s.map = Y.getTexture(L.texture, S.data), s.alphaTest = L.alphaTest, s.resolution = Y.getDevicePixelRatio(), g.position = Qm(T, Y._buffer.vs, O.vs, A), Y._picking ? (s.picking = !0, g.pickColor = Qm(T, Y._buffer.ps, O.ps, A), s.useColor = !1, g.color = null) : (s.picking = !1, g.pickColor = null, O.cs ? (s.useColor = !0, g.color = Qm(T, Y._buffer.cs, O.cs, A)) : (s.useColor = !1, g.color = null)), O.ss ? (s.useSizeArray = !0, g.sizeArray = Qm(T, Y._buffer.ss, O.ss, A)) : (s.useSizeArray = !1, g.sizeArray = null), xc(T, 0, O.vs.length / 3, T.POINTS), P.useProgram(u)
                }
            },
            _asureProgram: function(y) { return y._pointsShader || (y._pointsShader = this.gv._postProcessing.createShader(y, Ns.shaderSrc)), y._pointsShader.program }
        }), Ns.shaderSrc = "!!~v!oj<g*p!s{n/!onpbjuu5j!tnppQewfnm!N.b!u0s!jfym<bd!tv!o)j!g>p+s!nf!{njbTuu5o!jnppQe`fmmhW!j*f!xfNwbjuusdjfyq<ts!fvQotjjg!p)s!ng!jn!bu<5*!!q1s/p2k!f.d!u>j>p!o^N!b4u!s]j^y!<3!!]vyojjsgupbsNno!pnjbuud5f!kwpjsfqx!N)b!u>s!jfyw<ju!dvfoqjtgspfsQnt!jg!mmppbpuc!!tdbm~f!<<o!pbjuuuvsmjpctvfusf!!+w!ffd{4j!tq!p>t!jfu{jjpTou<ojp!Qv`omjhg!ps|n!!fctpmpfm!!~v!tf<Doppmjpusv<mp!tbfusu!s+j!czvbusfs!Bwff{dj4t!!d>p!mfp{sj<Tu!owjbpsQz`jmohh!!w|f!d*5z!bwsDspBmfp{sj<Tft!vv)o!jggjp!sn<!ocppjpumj!tqpjQdwlnj!o+h!<yj!sbuubuNsojpcjvuudff!kwpfsdq5!!>q!jodpljDupjmtppsQ<`mh!!vo<jogppjsunj!tgpmQpwbnu!!+t!jy{jfs<ub!NvxofjjgWpmsfne!pgnm!p>b!uo!psjfutjptmpvQuwjnp!o<<*!!v1o/j2g!p-senf!ncspppgmt!ovbtsfuT!j){5fdBfsws!b>z!<op!jbuujutspjQcwvnu!f5!dgfmwp!bu<!*t!jo{pfjBusjstbpzq<!)4!dcfpwp!m>!!jetfQnfssptgqtfodbusjuw!f4Ndbfuws!jy~)!!n<b*u15/!2n!!-*s!p|mp!ds)f5udvfswo!!>n!]s!p3m!p^D]w!!4!|^!!*>s>p!m.p!D2f/t1v<)!!g~j!f!twmpfj!e!~n!bj<os)p*m!p|Dl!djjgq!!)>q!jsdplmjpoDhw*!!|^#!!~qs~f!dj<tsjppmop!Difjthvigqg!jgem!p>b!us<pm!p$DehfbgsjGo`fm!hV!TF|`!NfBtQmf!!v~o!jg<psspnm!pwDfwd!4>!!esjpgmgpvDthfb<sG!`vmohj!gp<sens!bgdmtpjbeu!!*p1q/b1d!j>u>z!<b/!svpomjpgDpfstnv!gggmjpeb)u!!gbjm!qi|b!U*fhtouj<ldj!qv)o!jggjp!sn<!ecspbpdmt!jvet!f*DuptmfpUsb<iq!mwbb!s=z!jbo/hs!pwmfpdD5f!twvDgpgmjpes)<!gj!!vogjjgeposfn$!!cp~p!m!<q*j!delsjpophD<uo!jvpoQj`gmphs!n-!qcbpnp!m)!Ee3jftsdvbusyefTuf!m>f+d!usbpcmmpfD<ftvg$gjjge!!ef|g!j*offmec)b!uVdTfFm`fNTBeQs!b*dt!jveoaj!g}p}s!nh!otjblndqjmqfas)3!Eg!jn!bq*<!Q$BfNo`eFjTgV!)wepfjoej!gnfbej!og)j*$!!|~!!wf<d*5!!zeujjgdgbvqtpf!D-pfmtpvsg<gj!ej!g)!5)dafqwj!d>l!jsophm!p%D%f!tvvtgfgDjpem!ps|*!!f|tm!fe!j~g!gv<t*f!Dzpumjpdsb!q>p!!w-f{dz5y)/!swpDmp";
        var Os = function(R, D) { th(Os, this, [R, D]), this._needRecoverPosition = !0 };
        eh(Os, Gs, {
            _25Q: 1,
            validate: function(B) {
                var S = this,
                    t = S.data,
                    E = S.s,
                    b = t.getPoints(),
                    Y = b.size();
                S.dispatchBoundingBoxChanged();
                var q = t.p3(),
                    F = S.mat = ur();
                ge(F, q), Wl(F, t.getFinalRotation3d(), t.getRotationMode());
                var T = t.getScale3d(),
                    v = t._dynamicScale3d;
                if (v && (T[0] *= v[0], T[1] *= v[1], T[2] *= v[2]), ro(F, T), ge(F, wo(q)), (!S.s("geometry.cache") || !S.shapeModel) && (S.shapeModel = S.info = S.lineShapeModel = A, Y > 1)) {
                    var u = S.info = {},
                        w = t.getSegments(),
                        Z = t.getThickness(),
                        V = Hj(b.get(0)),
                        y = Hj(b.get(Y - 1)),
                        _ = Y % 2;
                    0 === _ ? (u.c1 = Hj(b.get(Y / 2 - 1)), u.c2 = Hj(b.get(Y / 2))) : u.p3 = Hj(b.get((Y - _) / 2)), u.s1 = V, u.s2 = Hj(b.get(1)), u.t1 = Hj(b.get(Y - 2)), u.t2 = y, u.list = E(Ll) === yg ? S.createTubeModel(b, w, Z / 2, B) : S.createLineModel(b, w, Z, "shape.border", "shape.dash")
                }
            },
            invalidateCachedGeometry: function() { this.shapeModel = this.info = this.lineShapeModel = A },
            _80o: function(k, L, p) {
                var t = this,
                    h = t.shapeModel;
                if (h) {
                    var U = t.gv;
                    Vp(U, t.mat), cn(U, t.data, h, t, t.getBodyColor(), p), lf(U)
                }
            }
        });
        var Ps = k.graph3d.VR = function(S) {
            var X = this;
            X.gv = S, X._controllers = [], X.switch = new Rs(X), X._enable = !1, X._defaultCallLater = k.Default.callLater, X._defaultCancelLater = xb, "undefined" != typeof y && "VRFrameData" in y && (X._frameData = new y.VRFrameData), X.measureOflength = 1, X.eyesOffset = [0, 0, 0], X._orientation = new zn.Quaternion, X._lastHeadPose = [0, 0, 0], X._offsetToBeAdd = [0, 0, 0], X._originalOrientation = null, X._fpsInfo = { time: 0, fps: 0, frames: 0 }
        };
        eh(Ps, n, {
            ms_fire: !0,
            setOriginalYRotation: function(B) {
                var n = this;
                if (null == B) return n._originalOrientation = null, void 0;
                var J = new zn.Vector3(0, 1, 0),
                    Y = (new zn.Quaternion).setFromAxisAngle(J, -B),
                    y = (new zn.Matrix4).makeRotationFromQuaternion(Y);
                return Y.setFromAxisAngle(J, B), n._originalOrientation = { quaternion: Y, matrixInverse: y }, !0
            },
            render: function(c, n, y) {
                var p = this,
                    G = p.gv;
                if (p._deviceInAction) {
                    var h = p._device;
                    if (h) {
                        var W = p._measureOflength;
                        h.depthNear = G.getNear() * W, h.depthFar = G.getFar() * W;
                        var N = p._offsetToBeAdd;
                        if (p.eyesOffset[0] += N[0], p.eyesOffset[1] += N[1], p.eyesOffset[2] += N[2], N[0] = 0, N[1] = 0, N[2] = 0, h.isPresenting === !1) return p._controllers.forEach(function(w) {
                            w && w.update()
                        }), G.iv(), !1;
                        var K = p._frameData;
                        h.getFrameData(K);
                        var j = K.pose.position;
                        if (j) {
                            var V = p.toViewPosition(j);
                            G.setEye(V), p._orientation.fromArray(K.pose.orientation), p._originalOrientation && p._orientation.premultiply(p._originalOrientation.quaternion);
                            var P = new zn.Vector3(0, 0, -10 * p._scaleFactor);
                            P.applyQuaternion(p._orientation), G.setCenter([V[0] + P.x, V[1] + P.y, V[2] + P.z])
                        }
                        p._controllers.forEach(function(w) { w && w.update() }), G.setViewport(c, 0, 0, n / 2, y), p._viewMatrix = p._copyViewMatrix(K.leftViewMatrix), p._projectMatrix = p._copyProjectMatrix(K.leftProjectionMatrix), G.updateScene(), G.renderScene(), G.setViewport(c, n / 2, 0, n / 2, y), p._viewMatrix = p._copyViewMatrix(K.rightViewMatrix), p._projectMatrix = p._copyProjectMatrix(K.rightProjectionMatrix), G.updateScene(), G.renderScene(), p._lastViewMatrix = p._viewMatrix, p._lastProjectMatrix = p._projectMatrix, p._viewMatrix = null, p._projectMatrix = null, p.submitFrame();
                        var i = Date.now(),
                            f = p._fpsInfo;
                        return i - f.time > 1e3 ? (f.fps = Math.round(1e3 * (f.frames + 1) / (i - f.time)), f.time = i, f.frames = 0) : f.frames++, !0
                    }
                }
            },
            onVRDisplayPresentChange: function() {
                var w = this.isPresenting();
                this._injectGraphView(w), this.fp("present", !w, w)
            },
            getOrientation: function() { return this._orientation },
            addController: function(l) {
                l = l || 0;
                var $ = this,
                    A = $.getController(l);
                return A ? A : (A = new Qs($, l), $._controllers.push(A), A)
            },
            getController: function(K) {
                K = K || 0;
                for (var s = this._controllers, D = 0, y = s.length; y > D; D++)
                    if (s[D] && s[D].id === K) return s[D];
                return null
            },
            removeController: function(P) {
                P = P || 0;
                for (var I = this._controllers, J = 0, U = I.length; U > J; J++)
                    if (I[J] && I[J].id === P) return I.splice(J, 1), !0;
                return !1
            },
            getLastHeadPose: function() { return this._lastHeadPose },
            toViewPosition: function(g, q) {
                var s = this,
                    C = s._scaleFactor,
                    M = s._eyesOffset,
                    F = s._lastHeadPose;
                if (s._originalOrientation) {
                    var r = s._originalOrientation.quaternion,
                        S = new zn.Vector3(g);
                    S.applyQuaternion(r).multiplyScalar(C).toArray(F)
                } else F[0] = g[0] * C, F[1] = g[1] * C, F[2] = g[2] * C;
                return q ? (q[0] = F[0] + M[0], q[1] = F[1] + M[1], q[2] = F[2] + M[2], q) : [F[0] + M[0], F[1] + M[1], F[2] + M[2]]
            },
            addEyesOffset: function(D, h, u) {
                var T = this._offsetToBeAdd;
                T[0] += D, T[1] += h, T[2] += u
            },
            _copyViewMatrix: function(R) {
                var Q = this,
                    j = Q.dup(R);
                if (Q._originalOrientation) {
                    var U = (new zn.Matrix4).fromArray(j);
                    U.multiply(Q._originalOrientation.matrixInverse).toArray(j)
                }
                var h = Q._scaleFactor;
                j[12] *= h, j[13] *= h, j[14] *= h;
                var y = Q._eyesOffset;
                if (y && (y[0] || y[1] || y[2])) {
                    var c = y[0],
                        q = y[1],
                        C = y[2];
                    j[12] -= j[0] * c + j[4] * q + j[8] * C, j[13] -= j[1] * c + j[5] * q + j[9] * C, j[14] -= j[2] * c + j[6] * q + j[10] * C
                }
                return j
            },
            shutdown: function() {
                var E = this._device;
                E && E.isPresenting && E.exitPresent()
            },
            isPresenting: function() { var t = this._device; return t && t.isPresenting },
            _copyProjectMatrix: function(Y) {
                var q = this.dup(Y),
                    B = this._scaleFactor;
                return q[14] *= B, q
            },
            dup: function(b, d) { for (var f = b.length, L = d || new Array(f); f--;) L[f] = b[f]; return L },
            getViewMatrix: function(Q) { var m = this._viewMatrix; return m ? this.dup(m, Q) : void 0 },
            getProjectMatrix: function() { var w = this._projectMatrix; return w ? this.dup(w) : void 0 },
            submitFrame: function() {
                var z = this;
                if (z._enable && z._deviceInAction) {
                    var O = z._device;
                    O && O.isPresenting && (O.submitFrame(), z.gv.iv())
                }
            },
            getFps: function() { return this._fpsInfo.fps },
            intersectWorld: function(Y) { var d = this.gv; return d.intersectObjects(Y, d.dm().getDatas()) },
            setDevice: function(R) {
                var p = this;
                p._device = R
            },
            _injectGraphView: function() {
                var x, p, r;
                return function(U) {
                    var S = this.gv;
                    if (!U) return x && (S.getWidth = x, S.getHeight = p, S.getDevicePixelRatio = r), void 0;
                    var D = this._device,
                        N = D.getEyeParameters("left"),
                        G = N.renderWidth,
                        y = N.renderHeight;
                    x = S.getWidth, p = S.getHeight, r = S.getDevicePixelRatio, S.getWidth = function() { return 2 * G }, S.getHeight = function() { return y }, S.getDevicePixelRatio = function() { return 1 }
                }
            }(),
            _injectCallLaterFunc: function(q) {
                var r = this;
                if (!q) return Lh = k.Default.callLater = r._defaultCallLater, xb = k.Default.cancelLater = r._defaultCancelLater, void 0;
                var r = this;
                Lh = k.Default.callLater = function(L, T, h, p) { var w = r._device; return w && w.isPresenting ? p ? Ig(function() { Lh(L, T, h) }, p) : w.requestAnimationFrame(function() { r._deviceInAction = !0, L.apply(T, h), r._deviceInAction = !1 }) : r._defaultCallLater(L, T, h, p) }, xb = k.Default.cancelLater = function(s, V) { var m = r._device; return m && m.isPresenting ? V ? pe(s) : m.cancelAnimationFrame(s) : r._defaultCancelLater(s, V) }
            }
        }), n.defineProperties(Ps.prototype, {
            enable: {
                get: function() { return this._enable },
                set: function($) {
                    var L = this;
                    L._enable !== $ && (L._enable = $, $ ? (L.switch.showButton(), L._injectCallLaterFunc(!0)) : (L.shutdown(), L.switch.hideButton(), L._injectCallLaterFunc(!1)), L.fp("enable", !$, $))
                }
            },
            measureOflength: {
                get: function() { return this._measureOflength },
                set: function(X) {
                    this._measureOflength = X;
                    var i = this._scaleFactor = 1 / X;
                    this._controllers.forEach(function(D) { D && D._setScaleFactor(i) })
                }
            },
            eyesOffset: { get: function() { return this._eyesOffset }, set: function(B) { this._eyesOffset = B } },
            controllerModel: {
                get: function() { return this._controllerModel },
                set: function(y) {
                    var A;
                    "object" == typeof y ? (A = y.mtl, y = y.obj) : (A = y + ".mtl", y += ".obj");
                    var T = this,
                        l = T._controllerModel;
                    l && l.obj === y && l.mtl === A || (l = T._controllerModel = { obj: y, mtl: A }, D.loadObj(y, A, { finishFunc: function(L, m) { T._controllerModel === l && D.setShape3dModel("vrControllerModel", m) } }))
                }
            },
            interactive: { get: function() { return !!this._interactive }, set: function(c) {!!c != !!this._interactive && (this._interactive = c, c && this.addController(0), this.gv.getCoreInteractor().enableVR(c)) } }
        });
        var Qs = function(H, g) {
                function M(q) {
                    var U = navigator.getGamepads && navigator.getGamepads();
                    if (U)
                        for (var u = 0, m = 0, V = U.length; V > u; u++) {
                            var w = U[u];
                            if (w) {
                                var R = w.id;
                                if ("OpenVR Gamepad" === R || 0 === R.indexOf("Oculus Touch") || R.indexOf("Controller") >= 0) {
                                    if (m === q) return w;
                                    m++
                                }
                            }
                        }
                }

                function A(K, G, I) { return Math.abs(K[0] - G[0]) < I && Math.abs(K[1] - G[1]) < I && Math.abs(K[2] - G[2]) < I ? !0 : !1 }
                var w = this;
                w.vr = H, w.id = g;
                var y, V, f = [0, 0],
                    R = [{ id: "thumbpad", pressed: !1 }, { id: "trigger", pressed: !1 }, { id: "grips", pressed: !1 }, { id: "menu", pressed: !1 }],
                    b = new xk;
                b.s("shape3d", "vrControllerModel"), b.isController = !0, b.s("intersect", !1), w.getGamepad = function() { return V }, w.isButtonPressed = function(i) {
                    for (var T, n = 0, v = R.length; v > n; n++)
                        if (T = R[n], T.id === i) return T.pressed;
                    return !1
                }, w.getNode = function() { return b };
                var C = .003;
                w.setRotationEpsilon = function(f) { C = f };
                var e = 5e-4,
                    q = e;
                w.setPositionEpsilon = function(P) { e = P, q = P * w.vr._scaleFactor }, w._setScaleFactor = function(V) { b.s3(V, V, V), q = e * V }, w._setScaleFactor(w.vr._scaleFactor);
                var i, F = new Wd,
                    X = new rs,
                    p = [0, 0, 0],
                    U = [0, 0, 0],
                    t = new Mq,
                    L = new Cb,
                    c = new Vc;
                w.getRay = function() { return i ? (c.origin.fromArray(p), c.direction.copy(L), i = !1, c) : c }, w.update = function() {
                    if (y = V, V = M(g), !V || V.pose === O) return V = null, b.s("3d.visible", !1), void 0;
                    if (D.getShape3dModel("vrControllerModel")) {
                        b.dm() || H.gv.dm().add(b), b.s("3d.visible", !0);
                        var J = V.pose;
                        if (null !== J) {
                            if (J.position && (w.vr.toViewPosition(J.position, p), A(b.p3(), p, q) || (i = !0, b.p3(p))), J.orientation) {
                                F.fromArray(J.orientation);
                                var j = w.vr._originalOrientation;
                                j && F.premultiply(j.quaternion), L.set(0, 0, -1).applyQuaternion(F).normalize(), X.makeRotationFromQuaternion(F), t.set(0, 0, 0, b.getRotationMode(), !0).setFromRotationMatrix(X), U[0] = t.x, U[1] = t.y, U[2] = t.z, A(b.r3(), U, C) || (i = !0, b.r3(U))
                            }
                            i && H.fp("gamepad.pose", null, { position: p, rotation: U, id: g });
                            var n = V.axes;
                            (f[0] !== n[0] || f[1] !== n[1]) && (f = [n[0], n[1]], H.fp("gamepad.axes", null, { id: g, axes: f }));
                            var N, m, k, z, s = V.buttons;
                            for (N = 0, m = s.length; m > N; N++)
                                if (k = s[N], k && (z = k.pressed, R[N] || (R[N] = { id: "button" + N, pressed: !1 }), z !== R[N].pressed)) {
                                    R[N].pressed = z;
                                    var I = { id: g },
                                        u = "state";
                                    I[u] = I._62O = z ? "down" : "up", H.fp("gamepad.button." + R[N].id, null, I)
                                }
                        }
                    }
                }
            },
            Rs = function(P) { this.vr = P, this._button = null };
        eh(Rs, n, {
            showButton: function() {
                var y = this.assureButton();
                if (!y.parentNode) {
                    var G = this.vr.gv,
                        w = G.getView();
                    G._79O ? w.insertBefore(y, G._79O) : w.appendChild(y)
                }
            },
            hideButton: function() {
                var Z = this._button;
                Z && Z.parentNode && Z.parentNode.removeChild(Z)
            },
            assureButton: function() { var L = this._button; return L ? L : this._button = this.createButton(this.vr.gv) },
            createButton: function(A) {
                function P(s, S) { s.textContent = S && S.isPresenting ? " VR " : " VR " }

                function m(g) { _.style.display = "", _.style.cursor = "pointer", _.style.left = "calc(50% - 50px)", _.style.width = "100px", P(_, g), _.onmouseenter = function() { _.style.opacity = "1.0" }, _.onmouseleave = function() { _.style.opacity = "0.5" }, _.onclick = function() { g.isPresenting ? g.exitPresent() : g.requestPresent([{ source: A.getCanvas() }]) }, A.vr.setDevice(g) }

                function d() { _.style.display = "", _.style.cursor = "auto", _.style.left = "calc(50% - 75px)", _.style.width = "150px", P(_, null), _.onmouseenter = null, _.onmouseleave = null, _.onclick = null, A.vr.setDevice(null) }

                function F(z) { z.style.position = "absolute", z.style.bottom = "20px", z.style.padding = "12px 6px", z.style.border = "1px solid #fff", z.style.borderRadius = "4px", z.style.color = "#000", z.style.font = "normal 13px sans-serif", z.style.textAlign = "center", z.style.opacity = "0.5", z.style.outline = "none", z.style.zIndex = "999" }
                if ("getVRDisplays" in navigator) { var _ = this._button = M.createElement("button"); return _.style.display = "none", F(_), v(y, "vrdisplayconnect", function(_) { m(_.display) }), v(y, "vrdisplaydisconnect", function() { d() }), v(y, "vrdisplaypresentchange", function(l) { P(_, l.display), A.vr.onVRDisplayPresentChange() }), navigator.getVRDisplays().then(function(j) { j.length > 0 ? m(j[0]) : d() }), _ }
                var I = M.createElement("a");
                return I.href = "https://webvr.info", I.innerHTML = " webvr", I.style.left = "calc(50% - 90px)", I.style.width = "180px", I.style.textDecoration = "none", F(I), I
            }
        }), n.defineProperties(Rs.prototype, {});
        var Ss = k.graph3d.PostProcessing = function(j) {
                function R() {
                    if (!o) {
                        var t = j.getGL();
                        o = new Of.RenderTarget(j, t, null, null, { samples: h.renderTextureSamples || 1 }), W = new zm.Shader(t, I.vs, I.fs), S = zm.Buffer.createIndexBuffer(t, new Uint16Array([0, 2, 1, 1, 2, 3])), A = zm.Buffer.createVertexBuffer(t, new Float32Array([0, 0, 1, 0, 0, 1, 1, 1]))
                    }
                }
                var o, W, S, A, c = this,
                    C = {},
                    N = !1;
                ! function() { n.keys(Ss).forEach(function($) { C[$] = new Ss[$](j) }) }(), c.getModule = function(z) { return z ? C[z] : c }, c.getModuleList = function() { return n.keys(C) }, c._serializable = !0, c.handleDataModleChange = function(q, f) { q && (c._serializable && q.setPostProcessingData(c.serialize()), q.removeSerializeListener(c.onDataModelSerialize, c)), f && (f.addSerializeListener(c.onDataModelSerialize, c), c.deserialize(f)) }, c.onDataModelSerialize = function(r) { "serialize" === r.type ? c._serializable && (j.dm()._postProcessingData = c.serialize()) : "deserialize" === r.type && c.deserialize(j.dm()) }, c.isDeserializeDisabled = function(J) { return !c._serializable || J.a("sceneBloom") !== O }, c.isSerializable = function() { return c._serializable }, c.setSerializable = function(k) { c._serializable = k, k || j.dm().setPostProcessingData(O) }, c.serialize = function() {
                    var x, R, T, q, u = {};
                    for (R in C)
                        if (T = C[R], q = T.serializeProperties) {
                            x = {}, T.enable && (x.enable = !0);
                            for (var L in q) {
                                var V = T[L];
                                V != q[L] && (x[L] = V)
                            }
                            n.keys(x).length && (u[R.toLowerCase()] = x)
                        }
                    return u
                }, c.deserialize = function(p) {
                    var v, D, U, o, s, b = {},
                        t = {};
                    for (v in C) {
                        U = C[v], o = U.serializeProperties;
                        var H = {},
                            d = "scene" + v,
                            Q = p.a(d);
                        Q !== O && (H.enable = Q);
                        for (var s in o) Q = p.a(d + s[0].toUpperCase() + s.slice(1)), Q !== O && Q !== o[s] && (H[s] = Q);
                        ef(H) || (t[v[0].toLowerCase() + v.slice(1)] = H)
                    }
                    if (ef(t) && (t = p.getPostProcessingData()), t)
                        for (D in t)
                            if (D && (v = D[0].toUpperCase() + D.slice(1), U = C[v])) {
                                b[v] = !0, o = t[D];
                                var h = !!o.enable;
                                c.enableModule(v, h), v = "scene" + v, p.a(v, h), U.resetProperties && U.resetProperties();
                                for (s in o)
                                    if ("enable" !== s) {
                                        var Q = o[s];
                                        U[s] = Q, p.a(v + s[0].toUpperCase() + s.slice(1), Q)
                                    }
                            }
                    for (v in C) b[v] || (U = C[v], U.enable = !1, U.resetProperties && U.resetProperties())
                }, c.decodeShader = function(i) {
                    var R, d, X, x = "",
                        z = "";
                    for (X = 0; X < i.length; X++) R = i[X], "%" === R ? R = "'" : "a" === R ? R = '"' : "]" === R && (R = "\\"), d = String.fromCharCode(R.charCodeAt(0) - 1), X % 2 ? z += d : x = d + x;
                    return z + x
                }, c.createShader = function(s, e, D) {
                    var Z = e.indexOf("^#"),
                        H = c.decodeShader(e.substr(0, Z)),
                        I = c.decodeShader(e.substr(Z + 2));
                    if (D) {
                        var E = D(H, I);
                        E && E.vs && (H = E.vs), E && E.fs && (I = E.fs)
                    }
                    return new zm.Shader(s, H, I)
                }, c.enableModule = function(M, E) {
                    var q, Q, X, O = M.split(",");
                    for (q = 0, Q = O.length; Q > q; q++) X = O[q].trim(), C[X] && (C[X].enable = E);
                    N = !1;
                    for (X in C)
                        if (C[X].enable) { N = !0; break }
                    N && R()
                };
                var I = { vs: ["attribute vec2 pos;", "varying vec2 vUv;", "void main(void) {", "gl_Position = vec4(pos.x * 2.0 - 1.0, -pos.y * 2.0 + 1.0, 0.0, 1.0);", "vUv = vec2(pos.x, 1.0 - pos.y);", "}"].join("\n"), fs: ["precision highp float;", "uniform sampler2D image;", "varying vec2 vUv;", "void main() {", "gl_FragColor = texture2D(image, vUv);", "}"].join("\n") };
                c.render = function(t, r, p) {
                    if (N) {
                        o.setSize(t, r, p), o.bind(t);
                        var J = t.getParameter(t.COLOR_CLEAR_VALUE);
                        J && 0 === J[0] && 0 === J[1] && 0 === J[2] && 0 === J[3] ? J = null : xd(t, [0, 0, 0, 0]), t.clear(t.COLOR_BUFFER_BIT | t.DEPTH_BUFFER_BIT), j.setViewport(t, 0, 0, r, p), j.renderScene(), o.unbind(t);
                        for (var i = 0, K = j._glCapabilities.maxAttributes; K > i; i++) t.disableVertexAttribArray(i);
                        var T, G = o;
                        for (T in C) G = C[T]._42(t, G) || G;
                        return j.setViewport(t, 0, 0, r, p), J && xd(t, J), t.clear(t.COLOR_BUFFER_BIT | t.DEPTH_BUFFER_BIT), W.bind(), t.activeTexture(t.TEXTURE0 + 0), Jo(t, G.texture), W.uniforms.image = 0, S.upload(), A.upload(), W.attributes.pos.pointer(A), t.drawElements(t.TRIANGLES, 6, t.UNSIGNED_SHORT, 0), Jo(t, null), t.useProgram(j._prg), !0
                    }
                }
            },
            Ts = k.graph3d.PostProcessing.HueSaturation = function(l) {
                function F() {
                    A = !0;
                    var X = l.getGL();
                    B = new Of.RenderTarget(l, X), H = l._postProcessing.createShader(X, Ts.hueSaturationShader), i = zm.Buffer.createIndexBuffer(X, new Uint16Array([0, 2, 1, 1, 2, 3])), c = zm.Buffer.createVertexBuffer(X, new Float32Array([0, 0, 1, 0, 0, 1, 1, 1]))
                }
                var i, c, H, B, g = this,
                    K = !1,
                    A = !1,
                    p = [],
                    S = [],
                    t = [];
                this.serializeProperties = { hue: [0, 0, 0, 0, 0, 0, 0], saturation: [0, 0, 0, 0, 0, 0, 0], lightness: [0, 0, 0, 0, 0, 0, 0] }, this.resetProperties = function() { var S = this.serializeProperties; for (var e in S) this[e] = S[e] }, this.resetProperties(), n.defineProperties(g, {
                    enable: { get: function() { return K }, set: function(k) {!!K != !!k && (K = k, k && !A && F(), l.iv()) } },
                    hue: {
                        get: function() { return p.map(function(k) { return w(180 * k) }) },
                        set: function(O) {
                            if (p !== O && 7 === O.length) {
                                for (var i = 0; 7 > i; i++) p[i] = O[i] / 180;
                                l.iv()
                            }
                        }
                    },
                    saturation: {
                        get: function() { return S.map(function(M) { return w(100 * M) }) },
                        set: function(M) {
                            if (S !== M && 7 === M.length) {
                                for (var f = 0; 7 > f; f++) S[f] = M[f] / 100;
                                l.iv()
                            }
                        }
                    },
                    lightness: {
                        get: function() { return t.map(function(e) { return w(100 * e) }) },
                        set: function(x) {
                            if (t !== x && 7 === x.length) {
                                for (var K = 0; 7 > K; K++) t[K] = x[K] / 100;
                                l.iv()
                            }
                        }
                    }
                }), g._42 = function(M, E) {
                    if (K) {
                        A || F();
                        var s = E.width,
                            N = E.height;
                        if (s && N) { B.setSize(M, s, N), md(M, B.frame), l.setViewport(M, 0, 0, B.width, B.height), M.clear(M.COLOR_BUFFER_BIT | M.DEPTH_BUFFER_BIT), H.bind(), M.activeTexture(M.TEXTURE0 + 0), Jo(M, E.texture); var W = H.uniforms; return W.image = 0, W.hue = p, W.saturation = S, W.lightness = t, i.upload(), c.upload(), H.attributes.pos.pointer(c), M.drawElements(M.TRIANGLES, 6, M.UNSIGNED_SHORT, 0), Jo(M, null), Fc(M), B }
                    }
                }
            };
        Ts.hueSaturationShader = "!!b~u!us<j*czv/utfp!qw!f.d!31!/q2p!t-<y/!twpbqs)z3jdofhw!!w>f!dw3V!ww!Vw<<*1/!2w!p-j1e/!1n!b-j1o/)2w!p,j!e1*/!3|!+!!hzm/`tQppqt.j!u-j1p/o2!!>.!!w1f/d35!)+q!pyt/^#!!q~s!fd<j*txj/psop!mipjdh!i-q*!mgtmip)bcuh<s3!mvtoij)g5pdsfnw!!t>b!nsqpmmfpsD3hEb!sjGn`bmhhf!<<!*w!bs*zfjhoohb!Swtftdf3o!uwiVhwj<m!-!^$1e]ftgtjfoofu!iNhBjYm`!S-B{O/HmFt!i8)t!t$feofugijhojfm!`SqBbOnH!F`-B*MfMh!o1bSo!pvjoujbgspvsunb!tg!m-p^b1u]!oipvjfu]bNsBvYu`bStB!O-HzF/^m<ti!)voopjjgupbssnv!ugbmtp`bqub!nt!bu-v*sfbhuojbpSof]vNiB!Y-`^S1B]OfHvFi^!<-y!/vmotjig)pfsvni!`gqmbpnb!u!)m4jdhfiwu!o>f!tmtt]iN!BY`~S!BO~H!F^<<lbf!sgcm!pb<u^!snfbuqo`vipvdf`)fgvmip]btut!fjoouWibhmjvmf!->!!gfmhpobbuS!titvffoBumimh-j!mg!mp<b^us!fiuvofvSpbdo`hffv*i!]|op!jgumbpsbvuu!bwtb!m>v!ff!h>o!bjSooWpbjmuvbfs!v,u!b)ti!vf<B^msmf!u,o!vipvdf`Sfbvoih]ff*v!i0!!>3!/f1h<obS!fjvgi!!)w|b!m*vffh!o=b!s1!/>1>*!!ssffuuovvspod!`wfbvmiv)f!!g,j!!2/|1!<*,!,fsmftufo!vjpgd!`)fwvbim!v<fF!H?O!B2S/`1Y*B!Ns!f=u!vssfou!owvbpmdv`ff!v.i!!2</11!<>!!sffmutofv!psdf`ufvvsio!!uwobjm)v!fs<pg!!~<!2g!m,p!bfuh!onbbsq!`>t!bfuhvosbbsu!jp<o1)!g>m!pfbhuo!bjso!W*b7m!v>f?-!!fghmopbbsu)!!tgbju!vs~b!uj~p!oB<mlmb-f!sgcm!pb<us!ftubouvvpsdb`ufjvpio!S>b!ofhhfo*b!s|!!|g!m*p6b/u1!!w,b!m*vsff!u>o!vjpodW`bfmvvif)!u+b!p)m2g/!1=!!,i!)t!bgujv!sb|u!j*p,o,Bsmfmu!o,v!ptdb`ufvvsib!u<jFpHoOSBbSo`hYfB*N<!=!!ssffuuvosvop!dd`mfbvniq!)<w1b!m>v!fs-f!u1o/v1p-d!`2f/v1i*!<uo!j~)!!sgpmgp!bu!<nfbhqo`bmSjthtifuooufithtj)mg!m-pfbhuo!bjSooWpbjmuvbfs-v!ugbmtp!b-uf!hmojbhSifuvoif!tutbBpmmmg-!!g<m1p!b>u!!fmhjohbisu!oufotjt!Sb<oehmfp*i!t|fs!igum`pfbvui!!wu!b>p!mmgj!hi<u1o/f7t!t+B!mym/!m,t!im!j>h!iiu!oufbtptmSgb!oh<f*<{z!yj/gs!p)mwp!d=)!m1t/i13*ch!ss!f>u!vmstoi!!j4odWfbwm!vf<!*+w!V)ww!!-,f!h2b/n1j*)<E3!ffsmvtufyf!us!f>u!vsspom!pjdo!W5bdmfvwf!!,|!!)*w)!o+j!b)n2!/e1j!p.w!!joW~b!mv<f**m*!<-t!!~-i!)g4mdpfbwu!!oisvvfu3fssh!c)~g!mp<b1u/!7g!20-!!ig!m>p!biu!!g~3!-!<g1m/p7b!u>!,i!vif!*!||!*!1j/g1!!)=i!vif)!!=g!j1!/1*~!!i<vbfu!m,f>E!d2!/01!<*h!!f.m!tsf)!!j,g!!1)/i5v!f>!!?i!!2/|1!*ft!mifv!f~!!.><!b2u/m1f<Ed!!g0m!p*bsu!!.s!fct)<!,!!j1g/!3)!)>7!/i1!!+|!!i*vyfb*N!d=!!>2>/!1h*)!!gsjf!tf!t>m!fg!2~!!,!<)bgu3m!f.E!dg!20*!!*+c!!7./!1h!)+!!>i!vif!<|!!f*mytbfN!dj!g>!>)!)s3)/!1g!j+!!iv<f***!o=j!N2d/!1,*!y!bsNfdt)!!>.!!g13/<3)!!f0m!tbfu!mjfgE!d)!);4!/*1o!j+N!di!v,f!*y!b=N!d3)/!10*!b!usmfftE!d>!!@g!26!/,1!!)=g!3m!!.>!!gt2!*!+<!o)j)N3d/!1.!!0y!b4N/d1!*>!!.b!uimvffE*d!!+u!b7p/m1g<!!|f!m*tofjN!ds!f?t!!y>b!Ngd2)<!g!js!fuv<s1o/!3s!f0t!<*o!j~Nd!!,w!fydb4N!di)t!m>3!smh!c)w<f*d*4c!!i-thm)*y!b|n!!-wsf)dy4b!ns!h>c!<ybN!dj!gu!b)pimtgm!/z<!*>*>c!!1-/h1)*o!j|n!!-ssh)co!j>n!!w>f!do4j)Nidt!mu/b{p*m<g!!~<!cf/mdt!f>!!|c!!ugbmppmbgu!!g<3h</d!!>j!gh!!)uibtpmm/g{!!=<!s1//d6!*>!!sg!3u!b>p!migt!m/<{1!/+1!!)>2!/m1!!u,b!pimtgm!/z<*1</1!!f>m!ttf!u!bgp3m!g>!!i<t1m//2{.!!,>!!iit!mu/bzp!m.g!!it|m!/*zd!!+4!diftwm)/m{t<i3c!hgsm!p4bduf!wg!2!>~!!3/<1c!h+s!!iotsmv/u{f!s.!!g~3!<<*!*s1h/c4/0s1!/>2!)i!v.f!3ys/hmct)ig!2--3!gg!3--2!gi)tcmh/sy3!f,v!i)!2>/!1c0/4c/h1s*!*<<*!ys/hmct/ih!!->3!gi!v-f23gs)hc";
        var Us = k.graph3d.PostProcessing.Bloom = function(s) {
            function r() {
                var r = s.getGL();
                if (r)
                    for (var F = s._postProcessing, L = 0; D > L; L++) R[L] = F.createShader(r, Us._35Q, function(M, N) { return { fs: N.replace(/DEFINE_VALUE/g, B[L]).replace("%OVERRIDE_ALPHA_DEFINE%", o ? "#define OVERRIDE_ALPHA" : "") } })
            }

            function H() {
                var X = s.getWidth(),
                    x = s.getHeight();
                if (X && x) {
                    E = [X, x], p = !0;
                    var a, _ = s.getGL(),
                        n = Math.round(E[0] / 2),
                        m = Math.round(E[1] / 2);
                    for (g = new Of.RenderTarget(s, _, n, m), a = 0; D > a; a++) u.push(new Of.RenderTarget(s, _, n, m)), P.push(new Of.RenderTarget(s, _, n, m)), n = Math.round(n / 2), m = Math.round(m / 2);
                    var L = s._postProcessing;
                    w = L.createShader(_, Us._34Q), r(), v = L.createShader(_, Us._36Q, function(l, P) { return { fs: P.replace(/NUM_MIPS/g, D) } }), A = L.createShader(_, Us.finalShader), I = zm.Buffer.createIndexBuffer(_, new Uint16Array([0, 2, 1, 1, 2, 3])), O = zm.Buffer.createVertexBuffer(_, new Float32Array([0, 0, 1, 0, 0, 1, 1, 1]))
                }
            }
            var G, X, z, o, U, I, O, N, c = this,
                _ = !1,
                p = !1;
            this.serializeProperties = { strength: 1.5, threshold: .55, radius: .4, overrideAlpha: !0, selective: !1 }, this.resetProperties = function() { var q = this.serializeProperties; for (var o in q) this[o] = q[o] }, n.defineProperties(c, { enable: { get: function() { return _ }, set: function(S) {!!_ != !!S && (_ = S, S && !p && H(), s.iv()) } }, strength: { get: function() { return G }, set: function(T) { G !== T && (G = T, s.iv()) } }, threshold: { get: function() { return X }, set: function(Y) { X !== Y && (X = Y, s.iv()) } }, radius: { get: function() { return z }, set: function(j) { z !== j && (z = j, s.iv()) } }, overrideAlpha: { get: function() { return o }, set: function(y) {!!o != !!y && (o = y, p && r(), s.iv()) } }, selective: { get: function() { return U }, set: function(P) {!!U != !!P && (U = !!P, s.iv()) } } }), this.resetProperties();
            var g, w, v, A, E = [256, 256],
                u = [],
                P = [],
                D = 5,
                B = [3, 5, 7, 9, 11],
                R = [];
            c._42 = function(m, Y) {
                function e(B, R, J, E) {
                    md(m, R.frame), s.setViewport(m, 0, 0, R.width, R.height), E ? E(m) : m.clear(m.COLOR_BUFFER_BIT | m.DEPTH_BUFFER_BIT), Q !== B && B.bind();
                    var d = 0;
                    for (var g in J) {
                        var Z = J[g];
                        Z instanceof WebGLTexture && (m.activeTexture(m.TEXTURE0 + d), Jo(m, Z), Z = d, d++), B.uniforms[g] = Z
                    }
                    for (Q !== B && (I.upload(), O.upload(), B.attributes.pos.pointer(O), Q = B), m.drawElements(m.TRIANGLES, 6, m.UNSIGNED_SHORT, 0); d--;) m.activeTexture(m.TEXTURE0 + d), Jo(m, null);
                    Fc(m)
                }
                if (_ && (p || (H(), p))) {
                    var Q;
                    if (U) {
                        N || (N = new Of.RenderTarget(s, m)), N.setSize(m, Y.width, Y.height), N.bind(m);
                        var f = m.getParameter(m.COLOR_CLEAR_VALUE);
                        f && 0 === f[0] && 0 === f[1] && 0 === f[2] && 1 === f[3] ? f = null : xd(m, [0, 0, 0, 1]), m.clear(m.COLOR_BUFFER_BIT | m.DEPTH_BUFFER_BIT), s.setViewport(m, 0, 0, Y.width, Y.height), m._blooming = !0, s.renderScene(), m._blooming = !1, f && xd(m, f), N.unbind(m)
                    }
                    e(w, g, { smoothWidth: .01, luminosityThreshold: X, tDiffuse: U ? N.texture : Y.texture });
                    var a, V = g,
                        q = Math.round(E[0] / 2),
                        S = Math.round(E[1] / 2);
                    for (a = 0; D > a; a++) e(R[a], u[a], { colorTexture: V.texture, direction: [1, 0], texSize: [q, S] }), e(R[a], P[a], { colorTexture: u[a].texture, direction: [0, 1], texSize: [q, S] }), q = Math.round(q / 2), S = Math.round(S / 2), V = P[a];
                    return e(v, u[0], { blurTexture1: P[0].texture, blurTexture2: P[1].texture, blurTexture3: P[2].texture, blurTexture4: P[3].texture, blurTexture5: P[4].texture, bloomStrength: G, bloomRadius: z, bloomTintColor: [1, 1, 1] }), e(A, Y, { image: u[0].texture }, function(c) { Jg.for(c).glState.blend.apply({ enabled: !0, equation: c.FUNC_ADD, func: [c.SRC_ALPHA, c.ONE] }) }), Jg.for(m).glState.blend.apply({ equation: m.FUNC_ADD, func: [m.SRC_ALPHA, m.ONE_MINUS_SRC_ALPHA, m.ONE, m.ONE_MINUS_SRC_ALPHA] }), Y
                }
            }
        };
        Us._34Q = "~bu<u*szj/ctvpuqf!!.w!f1d/32!!q-pyt/<tpwqb)s3zdjfowh!!>w!fwdV3w!w<V*w1</2w!p-j1e/!1n!b-j1o/)2w!p,j!e1*/!3|!+h!mz`/Qtpptqj.u!j-p1o/!2>!!.w!f1d/53)!q+p!ty/^#~qs<f*d!jbtijqpmob!!i-jmhfiyqf!ug!m-psbpum<pDvuovjqgupvspn!!)tybjnnq!m>f!ss3pEm!puDEhjbgsgGv`tmfh<<v*o!jwg!p-sinu!egjmXpibuup!pmnvtn!j,o!petmjpuiztUfissifUtziupjmtep<ojvnovjmg!p-senm!pgimtpfbsui!UtznupjptupioXjjnevumi!<)qwfbustzijuophp!nwtf!d>3!!bwiVqwm<b!wupbjpem!gnb<j*o1)/*1!!|-1w/f1d!5-!1u/f1y!f-m1!/>1!)u5fdyfuwv!s>f!3sEp)m!puDEujvgqguvvtpf!-5!dwfVww!<**<!bwnfvdm4!!-m{vznyb/!m>f!ywffud!4))u!p1e/!3>:!:w-!!u1b/p6m9g8-<!*1!/522", Us._35Q = "~bu<u*szj/ctvpuqf!!.w!f1d/32!!q-pyt/<tpwqb)s3zdjfowh!!>w!fwdV3w!w<V*w1</2w!p-j1e/!1n!b-j1o/)2w!p,j!e1*/!3|!+h!mz`/Qtpptqj.u!j-p1o/!2>!!.w!f1d/53)!q+p!ty/^#~qsgfjdejotfj$po<!*ibj/hyijqQ!fgsmvpubyuf<u!w-bnsvzTjuoihh!jwffxd03n!vwTVfwt<vgvgojjeg)p5sdnf!wt!b>n!qsmpfmsp3DEh!bdspGm`pmshUffytumvfs$f<<*v1o/j2g!p-snnv!Twufidh3j!fuxf0ynTvjT{fft<vgvgojjeg)p5sdnf!ww!f>d!3s!pemjpsDfhdbusjGp`om<h$BeIfQgMjBo`fF!ELJFSSSOFFWMP`!SgBfEeJgVjT$!E~FG<JxO!F+`!W1B/M3V!F>,$!enfvgTjuoifh!jTfJxHN<Bx!!E+F!G*J3OfFm`qWnBbMtV!F,!&2PfWmFqSnSbJtE)F!`>B,M!QnIvBT`fEtFvGgJgOjFe&<gcmhpsb/u*!uhfbtvgtgtPjwbvo!Q.e!gw)Vjwo!!-gfmspvbuuy!fyU-s!pjmop!dg!m)pEb3uf!stvjuhynfbu*!!>|!3sffmuqvnsbot!!14/d4f:w9:<5c!h+s!/f*yuqf)t!g.g1P/w6v!!+,!!yw!V+w!!y-0f)s!vtujyhfnUbs!p+m!ptdj!h)nEb3*f*s0vtujyhfnub!<>!~2fwmpqjneb!tn!b4jdof)w*!<|y!w+f!df3{!jjTowwoTjj!{+f!!o>p!j2u/d1f!s0j!eu!f>y!Tujf{tfg<gPgwmvp!b3ud!fgwTj<h*nbbn!h>j!Tggm!p-byu))gTeJQHoNbBj*t<tvgbmhp!b>u!!xx!fujbhpimugTv<n*!j>)!uhbbpvmtgt!j>b!oyQ!eugb)p1m/g1-|!!g*T!j,h,n!bj*!<<TwVfJdE5B!Su`fMyFuOvSsFfLQ!j=y!!j>!!<u2f!y>u!vjs!fu3oEj)!!)dsppmgps<UnfvyTuuvishfj-f!xw!V+w!*c<hsw/fydj4Q!fesjvgugyvftuf!T>v!n", Us._36Q = "~bu<u*szj/ctvpuqf!!.w!f1d/32!!q-pyt/<tpwqb)s3zdjfowh!!>w!fwdV3w!w<V*w1</2w!p-j1e/!1n!b-j1o/)2w!p,j!e1*/!3|!+h!mz`/Qtpptqj.u!j-p1o/!2>!!.w!f1d/53)!q+p!ty/^#~qs<f*d!j*twjVpwo!!-i6jfhsivqu!ygfmUpsbvum<c)wEb3sfzsjvouhy!fwuf!d+3!!*w1V/w2<!-vsopjmgppDsuno!jtUbnnpqpmmfcs)35Ed!fcwm!v+s!U*f3y/u1v)ssfp2u<dbvGonjpgppmsCnq!stfbmnq!m,f!s*3wEV!wc!m-v5sfUsfvyuuyvfsUfs3v<mcv)oEj3gfpssvnu!ytfbun!q+m!f*s13/E2!!c-msvpsmUpfDyuuovjsUfn4p<pmvco)j5gdpfswn!!+t!b*n5q/m1f)ss3pEu!dcbmGvnspUpfmyCuqvssffm5<!,v!o*jwgVpws!n-!4tfbsnvqumyffsU3sEv!mccm)vEs3Uffsyvuuvysffu6!<+!v*o1j/g2p!s-ns!ptmbpnDqumofjsU3nEp!pemjcs)u5Udffywu!v+s!f*<7/v1o)jsgppusdnb!GgnmpppbmuC!qcsmfpmpn!T,u!s*fwoVhwu!i-<3fvsovjugypfsUns!vgmmcp)bEu3!fcsmvpupynfSub!e+j!v*t1</2v!o-jsgppmspnD!uwofjdU4n!pcpmmpcp)n5Udjfowu!D+p!m*p9s/<1)gsmppubdub!GmnfpspqmCCmqpspfnmGb!d,u!p*sw)Vdwp!o-t2uf!sjvou!ygfmUpsbvum!cg)bEd3ufpssv*u!y|fug!m+p!b*u1!/n2j!s-ssppsmGpbDduuopjsU!n>p!p2m/c3)!5.d!fgwb!d+u!p*s1</2s)fsupvusdob!Gnnjpyp)mgCbqdsufpms!-)!!n+j!sisuphsoGfbsduuTpnsp-p!mccm!p>p!nsSpbmepjDvhtb*s<G`~mhwp|j!e*!)nobj", Us.finalShader = "~bu<u*szj/ctvpuqf!!.w!f1d/32!!q-pyt/<tpwqb)s3zdjfowh!!>w!fwdV3w!w<V*w1</2w!p-j1e/!1n!b-j1o/)2w!p,j!e1*/!3|!+h!mz`/Qtpptqj.u!j-p1o/!2>!!.w!f1d/53)!q+p!ty/^#~qs<f*dwjVtwj!p-of!hibjnhji)qE!3gfmspvbuuy<fuv!o>j!gsppsmnp!DthbbnsqGm`fmsh3E|!!j*n)bohjfb<n!webjspzwjo<hw!Vwwf!d3";
        var Vs = k.graph3d.PostProcessing.Dof = function(f) {
            function S() {
                o = !0;
                var h = f.getGL();
                F = new Of.RenderTarget(f, h), J = f._postProcessing.createShader(h, Vs._38Q), y = zm.Buffer.createIndexBuffer(h, new Uint16Array([0, 2, 1, 1, 2, 3])), u = zm.Buffer.createVertexBuffer(h, new Float32Array([0, 0, 1, 0, 0, 1, 1, 1]))
            }
            var F, J, y, u, M, D, v, i, L = this,
                I = !1,
                o = !1,
                h = zn.generateUUID();
            this.serializeProperties = { aperture: .025, maxblur: 1, image: null }, this.resetProperties = function() { var A = this.serializeProperties; for (var X in A) this[X] = A[X] }, n.defineProperties(L, { enable: { get: function() { return I }, set: function(E) {!!I != !!E && (I = E, E && !o && S(), f.iv()) } }, image: { get: function() { return D }, set: function(Q) { D !== Q && (D = Q, M && (f.deleteTexture(h), M = null), f.iv()) } }, maxblur: { get: function() { return v }, set: function(m) { v !== m && (v = m, f.iv()) } }, aperture: { get: function() { return i }, set: function(l) { i !== l && (i = l, f.iv()) } } }), this.resetProperties(), L._42 = function(n, U) {
                function i(s, E, R, P) {
                    md(n, E.frame), f.setViewport(n, 0, 0, E.width, E.height), P ? P(n) : n.clear(n.COLOR_BUFFER_BIT | n.DEPTH_BUFFER_BIT), D !== s && s.bind();
                    var Y = 0;
                    for (var S in R) {
                        var B = R[S];
                        B instanceof WebGLTexture && (n.activeTexture(n.TEXTURE0 + Y), Jo(n, B), B = Y, Y++), s.uniforms[S] = B
                    }
                    for (D !== s && (y.upload(), u.upload(), s.attributes.pos.pointer(u), D = s), n.drawElements(n.TRIANGLES, 6, n.UNSIGNED_SHORT, 0); Y--;) n.activeTexture(n.TEXTURE0 + Y), Jo(n, null);
                    Fc(n)
                }
                if (I) {
                    o || S();
                    var D;
                    if (!M) {
                        var Z = Jc(this.image);
                        if (!Z || !Z.comps && !Z.tagName) return U;
                        k.Default.setImage(h, Z), M = f.getTexture(h)
                    }
                    var d = U.width,
                        T = U.height;
                    if (d && T) return F.setSize(n, d, T), i(J, F, { tColor: U.texture, tDepth: M, aspect: d / T, aperture: this.aperture, maxblur: this.maxblur }), F
                }
            }
        };
        Vs._38Q = "~bu<u*szj/ctvpuqf!!.w!f1d/32!!q-pyt/<tpwqb)s3zdjfowh!!>w!fwdV3w!w<V*w1</2w!p-j1e/!1n!b-j1o/)2w!p,j!e1*/!3|!+h!mz`/Qtpptqj.u!j-p1o/!2>!!.w!f1d/53)!q+p!ty/^#~qs<f1d/j2t!j>p!ob!/isjphmipqD!hgbmspGb`um<hw<b1s/z2j5o!h0!!wmfpdd3!!>w!Vswp<mpvDohjbgspGs`nm!hcp<p*m!!5vstvfmEcfgqpuei!<+!v*o!jugdpfssns!ptdbundqfmqftsb3!E+!!u*D!p5m/p1s!<-1v/o1j!g)p3sdnf!wt!b)n!q,m!fzsy3/Ew!VuwE!f-qsupim<pDvuo!j)gEp3sfns!vgumypfbuu!!>n,b!ymcpmdvs<<*!v5osjvgmpcsgnp!eg!m+p!b*u!!ubdqffsssupvdsufd<fqvtobj!g+p!s*n!!:g3m/p1b.u!!-o:f3b/s1D.m!j)q3<dfvwo!j)g!p,s!nz!yg/mwpVbwu!!-gsbpsmDpmDjuq!<)Ev3ofjsgvpusynf!ug!m>p,b!um!pgdpd<v*t!<5svvomjcggppsen!!+g!m*p!buud!fbstsqpfdduud<fqdtpbo!t+u!!*g!m1p/b1u!!-V5o/q1b.d!l)E3pdxfowt!d)b!m,f!!z>y!/3w6V6w/!!-0s!p3m6p7D/u<!!)0E03!f1s/v/u2y!f.u?!!>g,s!bmdpudjp<o*!!)5fsyvdmmcvgepjeo!h+!!2**!uddpfostsup!dwufddf4q!tQbb!d+l!G*b!d:u3p/s1t!!->:!3w/f1d.4!))!33d6f7w/!!)+!!,3!6z7y//!w+V!w3!6-7s/p-m!p3D6u7!/)!E+3!f3s6v7u/y-f!u3!6>7,/!!m*p<dd<p*o!t5us!vwmfcdg5p!eV!o+q!b*d!luGdbfdsusppsdtu!d>f!qVtobq!b+d!l*E!p5x/o1t.d!b-m1f/!10!!)w3fddf5w)!!)Q!b,d!lzGyb/dwuVpws!t--s!p2m/p!D*u<!)gEm3pfbsuv!uvyofqub!d>l,S!HmCpBdUp<E*f!q5usiv)m!cdgppoet!u+!!j*o!!uwdffds5s!pwd!u*d!f|qt!bs!f+u!v*s!o:!3e/p1u.)!!-w:-3!/V1o!q)b3ddlfGwb!d)u!p,s!tz!y*/<wV~w!g-msppbmup!Dhuf!u)EEf3qfusiv)u!ydfpuo!t>u,!!jmop!dwf<d*3!!5tsdvsmfcfgopQep!t+j!u*j!puod!f*s!s|pd\nusdffuqvtsbo!!+v!o*q!b1d/l1S!H-C5B/U1p!E)f3qdufiw)!!)u!f,y!uzvys/fw3VEw)!!-usEpfmqpuDiu-!!)tEd3sffsfvouQypftuj!u>j,p!om!p*d!*<<*!~5sgvmmpcbgup!eq!f+s!t*q!fuddufjswsfpEdfuqdufiqUtpbW!j+f!x*[!):!3d/p1o!t-u:!3j/o1!!g)m3pdbfuw!!j)o!w,D!mzjyq/[w-V!wd!p-ostpum!pjDou!!g)mEp3bfus!voufybfsu-!!>d,p!omtpud!j<o*!!g8mspvbmuc!ggpbes!!+*!!*|!u!dsffsusvpsdou!d)f!qotfbb!s+!!+*!!g5b/s1!!*-!10/!1)!!))3!dgfbws!!).!!,o!fzbys/!w*V!w+!!-jsopwmDpmDjuq![)!E.3!fgsbvsu!y*f<u!~>,g!mmppbdu!<h*f!u8Wsjvfmxc[g)p!ed!p+o!t*u!!ujdof!sgsmppdbuud!feqftqbu!i+!!**!!|:3\n/s1f.u!v-s:o3!/q1f.s!t)q3fddfuwj!w)f!E,f!qzuyi/UwpVWwj!f-xs[p)m!peDfuq!u)iE-3!fosfvbusyDfmuj!q>-,!!gmbpsdDm<j*q!!8*s<vm~cgwppej!e+!!n*b!juod)f*s!s|pdwufddf3q!tebp!g+c!m*v!s1</1w!f-d53/!1b.t!q)f3ddufdwp!s)s!f,d!uz!y>/!wwVfwd!3-)s!p2m/p1D-u!!b)tEq3ffdsuv!u*y<fuj!g>!,)!vmtpfdEf<q*u!i8*s!v|mc!ggpmep!b+u!!*w!jufdxf[s!s>p!dhufdufWqjtfbx![+)!!*h!f:u3E/f1q!u-i:)3!/w1V.w!!)*3!d*f<w!!)g!m,p!bzuy!/gwbVdwu!p-ss!p>m!p)D!ug!p)dEv3tf!s,v!uwyjffux![>!,*!<mp!dep<g*c!m8vssv!m>c!gwpfed!3+!!)*!!dumdbfnsqs)p!dgubddfuqptsb!!++!!b*q!f5s/u1v.s!f--1!/.1n!b)y3cdmfvws!-)!!n,b!yzcym/vwsV!w*!!-*s<pm~pDfum!t)fE!3|fs!veupygfcum!v>s,!!>m!pwdfd<3*!!)8!sdvmmbcngqp)e!!u+f!y*u!vusdff3sEs)p!duuEdffqqutib-!!+w!f*d!3:)3w/V1w./!y--:!32//11!!).3!dwfVww!/)z!*,!!*z/yb/!w+V!wb!q-fsspumvpsDfu-!!).En3bfyscvmuvysf-u!!n>b,y!cmmpvds!<**!!*8<sv~mcwgfpde3!!+e!p*g!cumdvfss:s!p>d!uedpfgqctmbv!s+!!+*!!11//:1<!-w1f5d/31!!e)p3gdcfmwv!s)8!!,>!!zeyp/gwcVmwv!s-!s+p!m1p/D8u<!)wEf3df3s!veupygfcum!v>s,5!!m>p!dep<g*c!m8vssv!m+c!g1p/e5!<+!w*f!du5d!fdspsmp!d>u!dwffqdt5b)!!+1!/*1!!:*3</1d!p-m:!3,/>1!!u)f3ydufvws!f)3!E,)!!zuyD/pwmVpws!--!swpVmwp/Dyuz!!)*E<3fdspvmu!y,f>u!!u>f,y!umvpsdf3<E*)!!:usDvpmmcpgsp-e!!w+V!w*/!yuzd!f,s!s)p!dwufddf3q)t!b1!/+1!-*!!18/45/!1*.!!+-!6b2t/q1f!d)u3ddpfsws!f)d!u,!!*z!y+/!weVpwg!c-msvpsm!p*D<u!d)pEm3!f,s>v!uuyffyuu!v>s,f!3mEp)d!u<D*p!m:pssv-m!cwgVpwe/!y+z!!*,!!u)d!fwsfsdp3d)u!d1f/q2t6b-!!+1!/*4!86!2*/!1+.!!b-t8q4f/d1u.d!p)s3sdffdwu!!)*!!,+!!zeyp/gwcVmwv!s-!s*p<mpdDpum!!),E>3!fusfvyuuyvfsuf!3>E,)!!mupDdpm<p*s!-:!swvVmwc/gypze!!,+!!)*!!wufddf3s)s!p1d/u3d:f-q!t1b/!3+:!!**!!6+2!/b1t!q-f8d4u/d1p!s)s3fddfuw!!*)!!+,!!ezpyg/cwmVvws!!-*s<pmdppDmu!!,)>E!3uffsyvuuvysffu3!E>),!!umDppdmp<s*-!!:wsVvwm/cygzp!e,!!+)!!*w!fudd3f)s!s.p1d/u4d8f-q!t1b/!2+6!!**!!8+4!/b1t!q-f6d2u/d1p.s!s)f3dduf!w*!!)+!!,e!pzgyc/mwvVsw!!*-<spdmppmD!u,!>)!Eu3ffysuvvusyff3uE!)>!,u!Dmppmdps<-*!!w:Vswv/myczg!p,e!!)+!!w*f!du3d)f!s1s/p5d1u-d!f1q/t1b!!*+!!+*!!b8t4q/f1d.u!d-p6s2s/f1d.u!!)*3!d+f!we!p)g!c,m!vzsy!/*w<Vwd!p-ms!p,m>p!Duuf!y)uEv3sffs3vEu)y!fuuD!p>m,p!sm-p!dwV<w*/!y:zs!v,m!c)g!pwef!d+3!)*!!1u/d4f8s-s!p.d1u/d2f6q!t*b!!++!!b*t!q6f2d/u1d.p!s-s8f4d/u1!!*)!3+d!fewp!g)c!m,v!sz!y*/<wVdwp!m-!s,p>m!puDfuy!u)vEs3ff3sEv)u!yufDup!m>p,s!-m!pwdVw</*y!z:!s,v!m)c!gwpfed!3+)!!*1!/u3d:f-s!s.p1d/u3d:f!q*t!b+!!+b!t*q!f6d2u/d1p!s-s8f4d/u1!.*!!)+3!defpwg!c)m!v,s!!z*y</wdVpwm!!-,s>p!mupfDyuu!v)sEf33fEs)v!uuyDfpum!p>s,-!!mwpVdw/<y*z!!:,s!v)m!cwgfpde3!)+!!.*1!/u2d6f-s!s.p1d/u4d8f!q*t!b+!!+b!t*q!f8d4u/d1p!s-s6f2d/u1!!*)!3+d!fewp!g)c!m,v!sz!y*/<wVdwp!m-!s,p>m!puDfuy!u)vEs3ff3sEv)u!yufDup!m>p,s!-m!pwdVw</*y!zs!v,m!c)g!pwef!d+3!)*!!1u/d1f-s!s.p1d/u5d!f*q!t+b!!b+t!q*f!d8u4d/p1s.s!f-d6u2!/*1!!+)!3edpfgwc!m)v!s,!!*z<y/dwpVmw!!,->s!pumfpyDuuv!s)fE33Ef)s!vuuDypfmup!s>-,!!wmVpwd/y<z*!!,s!v)m!cwgfpde3!)+!!.*1!/u2d6f-s!s1p/d4u8d!f*q!t+b!!b+t!q*f!d:u3d/p1s.s!f-d:u3!/*1!.+!!)e3pdgfcwm!v)s!!,*!<zyd/pwmV!w,!>-!supfmypuDvus!f)3EE3)f!suvDupymfpus!->!,w!Vmwp/dyz<!*,!!s)v!mwcfgdp3e)!!+.!1*/!3u:d-f!s1s/p3d:u!d*f!q+t!bb!t+q!f*d!u6d2p/s1s.f!d-u8!4*/!1+.!!e)p3gdcfmwv!s)!!*,<!zdyp/mw!V,w>!!-usfpymupvDsuf!3)EE)3!fusDvpumypfsu-!!>w,V!wm/pydz!<,*!!)s!vwmfcdg3p)e!!1+/!4*8!-u!d1f/s2s6p!d*u!d+f!qbttbq!f+d!u*d!p1s/s1f!d-u5!/*1!.+!!)e3pdgfcwm!v)s!!,*!<zyd/pwmV!w,!>-!supfmypuDvus!f)3E";
        var Ws = k.graph3d.PostProcessing.Blur = function(h) {
            function m() {
                d = !0;
                var t = h.getGL();
                Q = new Of.RenderTarget(h, t), j = h._postProcessing.createShader(t, Ws.hBlurShader), R = h._postProcessing.createShader(t, Ws.vBlurShader), B = zm.Buffer.createIndexBuffer(t, new Uint16Array([0, 2, 1, 1, 2, 3])), w = zm.Buffer.createVertexBuffer(t, new Float32Array([0, 0, 1, 0, 0, 1, 1, 1]))
            }
            var B, w, j, R, Q, $, s = this,
                Y = !1,
                d = !1;
            this.serializeProperties = { value: 0 }, this.resetProperties = function() { this.value = 0 }, n.defineProperties(s, { enable: { get: function() { return Y }, set: function(P) {!!Y != !!P && (Y = P, P && !d && m(), h.iv()) } }, value: { get: function() { return $ }, set: function(K) { $ !== K && ($ = K, h.iv()) } } }), this.resetProperties(), s._42 = function(V, o) { return Y ? s.drawImpl(V, o, $) : void 0 }, s.drawImpl = function(Y, p, $, V) {
                d || m();
                var S = p.width,
                    q = p.height;
                if (S && q) {
                    V && (S *= V, q *= V), Q.setSize(Y, S, q), md(Y, Q.frame), h.setViewport(Y, 0, 0, Q.width, Q.height), Y.clear(Y.COLOR_BUFFER_BIT | Y.DEPTH_BUFFER_BIT), j.bind(), Y.activeTexture(Y.TEXTURE0 + 0), Jo(Y, p.texture);
                    var A = j.uniforms;
                    A.image = 0, A.value = $ / S, B.upload(), w.upload(), j.attributes.pos.pointer(w), Y.drawElements(Y.TRIANGLES, 6, Y.UNSIGNED_SHORT, 0), Fc(Y), md(Y, p.frame), h.setViewport(Y, 0, 0, p.width, p.height), Y.clear(Y.COLOR_BUFFER_BIT | Y.DEPTH_BUFFER_BIT), R.bind(), Y.activeTexture(Y.TEXTURE0 + 0), Jo(Y, Q.texture);
                    var A = R.uniforms;
                    return A.image = 0, A.value = $ / q, B.upload(), w.upload(), R.attributes.pos.pointer(w), Y.drawElements(Y.TRIANGLES, 6, Y.UNSIGNED_SHORT, 0), Fc(Y), Jo(Y, null), Q
                }
            }
        };
        Ws.hBlurShader = "!!b~u!us<j*czv/utfp!qw!f.d!31!/q2p!t-<y/!twpbqs)z3jdofhw!!w>f!dw3V!ww!Vw<<*1/!2w!p-j1e/!1n!b-j1o/)2w!p,j!e1*/!3|!+!!hzm/`tQppqt.j!u-j1p/o2!!>.!!w1f/d35!)+q!pyt/^#!!q~s!fd<jntvjtp!o>!!isjphmipqD!hgbmspGb`um<h!!vo<j2g6p1s/n1!!t+b!n*q!m*f!sz3/Ew!Vjwn!b-hffv<mb!ww!b+s!z1j/o5h!!,w!fyd/3w!VwwV!w)<3d!fvwo!j-gfphsbnn!jg!m)pEb3uf!swvbumyvffu<!>,!!wnpvjte!!n<b9j2o:)1*/!1|!+!!w*f!d*5!!zt/vwnV!w>!!-wffvdm5b)w!!1+/!11!/*4<!,!!yt/vwnV!w,!>)!3udffywu!v-sffh3bEn)j!!j)nEb3hffs-v!uwyffdu3!)>!,w!Vnwv/ty!!.<!655/313!2+/!1w!b+m!v*f!-*!!wzV/ww/Vzw!!*-!f*v!m+b!w1!/+1!612/<3!!,t!vyn/!w,V>w!!u)f3ydufvws!f-3fEh)b!njjn!b)hEf3-f!swvfudy3f)u!!w>V,w!/nyv!t.!!4</214!6+2!/w1b!m+v!f*-!!*w!Vzw//wzV!w*!!-*f!v+m!b1w/!1+:!219/<2!!,t!vyn/!w,V>w!!u)f3ydufvws!f-3fEh)b!njjn!b)hEf3-f!swvfudy3f)u!!w>V,w!/nyv!t.!!3</414!7+2!/w1b!m+v!f*-!!*w!Vzw//wzV!w*!!-*y!/+w!V1w/!2)333d5f6w<!-!fthvbnn!j,!>)!Eu3ffysuvvusyff3uE!)>!,j!nnbvhtf!-!<w2f4d632)/!1w!V+w!/*y!!*.!!z2//w1V!w+!!-wfbvm", Ws.vBlurShader = "!!b~u!us<j*czv/utfp!qw!f.d!31!/q2p!t-<y/!twpbqs)z3jdofhw!!w>f!dw3V!ww!Vw<<*1/!2w!p-j1e/!1n!b-j1o/)2w!p,j!e1*/!3|!+!!hzm/`tQppqt.j!u-j1p/o2!!>.!!w1f/d35!)+q!pyt/^#!!q~s!fd<jntvjtp!o>!!isjphmipqD!hgbmspGb`um<h!!vo<j2g6p1s/n1!!t+b!n*q!m*f!sf3vEm!bjwn!b+h!f1</5!!w,b!szz/jwoVhw!!w-fyd/3w!VwwV!w)<3d!fvwo!j-gfphsbnn!jg!m)pEb3uf!swvbumyvffu<!>,!!wnpvjte!!n<b9j2o:)1*/!1|!+!!w*f!d*5!!ftvvmnb!w>!!+w!f1d/54)!!,1!/z1/!w*V<w!-!yt/vwnV!w,!>)!3udffywu!v-sffh3bEn)j!!j)nEb3hffs-v!uwyffdu3!)>!,w!Vnwv/ty!-!<w6V5w3/3z2!/.1!!5+/!1*!!+*!!wfbvmmvbfw!!*+!!*1!/+3!!1,/!1z6/2w<Vw!!t-vyn/!w,V>w!!u)f3ydufvws!f-3fEh)b!njjn!b)hEf3-f!swvfudy3f)u!!w>V,w!/nyv-t!!wV<w2/4z6!2./!14!/+1!!*+!!*w!bfmvvmfb!w*!!+*!!1+/!21!/,1!:z2/9w<Vw!!t-vyn/!w,V>w!!u)f3ydufvws!f-3fEh)b!njjn!b)hEf3-f!swvfudy3f)u!!w>V,w!/nyv-t!!wV<w4/4z7!2./!13!/+1!!*+!!*w!bzm/vwfV!w*!!-*y!/+w!V1w/!2)333d5f6w<!-!fthvbnn!j,!>)!Eu3ffysuvvusyff3uE!)>!,j!nnbvhtf!-!<w2f4d632)/!1w!V+w!/*y!-*!!wfVvwm/bzw!!.+!!21/", gp(D, { accordionViewExpandIcon: Fh(Fi), accordionViewCollapseIcon: Fh(Fi, !0), accordionViewLabelColor: Yr, accordionViewLabelFont: Zq, accordionViewTitleBackground: qk, accordionViewSelectBackground: sn, accordionViewSelectWidth: 3, accordionViewSeparatorColor: O, splitViewDividerSize: 1, splitViewDividerBackground: qk, splitViewDragOpacity: .5, splitViewToggleIcon: { width: 16, height: 16, comps: [{ type: Aj, rect: [2, 2, 12, 12], background: Fi }] }, propertyViewLabelColor: Yg, propertyViewLabelSelectColor: Yr, propertyViewLabelFont: Zq, propertyViewExpandIcon: Fh(wm), propertyViewCollapseIcon: Fh(wm, !0), propertyViewBackground: ol, propertyViewRowLineVisible: !0, propertyViewColumnLineVisible: !0, propertyViewRowLineColor: Am, propertyViewColumnLineColor: Am, propertyViewSelectBackground: sn, listViewLabelColor: Yg, listViewLabelSelectColor: Yr, listViewLabelFont: Zq, listViewRowLineVisible: !1, listViewRowLineColor: Am, listViewSelectBackground: sn, treeViewLabelColor: Yg, treeViewLabelSelectColor: Yr, treeViewLabelFont: Zq, treeViewExpandIcon: Fh(iq), treeViewCollapseIcon: Fh(iq, !0), treeViewRowLineVisible: !1, treeViewRowLineColor: Am, treeViewSelectBackground: sn, treeViewDoubleClickToToggle: !0, tableViewLabelColor: Yg, tableViewLabelSelectColor: Yr, tableViewLabelFont: Zq, tableViewRowLineVisible: !0, tableViewColumnLineVisible: !0, tableViewRowLineColor: Am, tableViewColumnLineColor: Am, tableViewSelectBackground: sn, treeTableViewLabelColor: Yg, treeTableViewLabelSelectColor: Yr, treeTableViewLabelFont: Zq, treeTableViewExpandIcon: Fh(iq), treeTableViewCollapseIcon: Fh(iq, !0), treeTableViewRowLineVisible: !0, treeTableViewColumnLineVisible: !0, treeTableViewRowLineColor: Am, treeTableViewColumnLineColor: Am, treeTableViewSelectBackground: sn, tableHeaderLabelColor: Yg, tableHeaderLabelFont: Zq, tableHeaderColumnLineVisible: !0, tableHeaderColumnLineColor: fg, tableHeaderBackground: ol, tableHeaderMoveBackground: sp, tableHeaderInsertColor: sn, tableHeaderSortDescIcon: Yh(wm, !0), tableHeaderSortAscIcon: Yh(wm), tabViewTabGap: 1, tabViewLabelColor: Yr, tabViewLabelFont: Zq, tabViewTabBackground: qk, tabViewSelectWidth: 3, tabViewSelectBackground: sn, tabViewMoveBackground: sp, tabViewInsertColor: sn, toolbarLabelColor: Yg, toolbarLabelSelectColor: Yr, toolbarLabelFont: Zq, toolbarBackground: ol, toolbarSelectBackground: sn, toolbarItemGap: 8, toolbarSeparatorColor: Cf }, !0);
        var Xs = { translateX: 1, sortColumn: 1 },
            Ys = { sortable: 1, sortOrder: 1, sortFunc: 1 },
            Zs = { focusData: 1 },
            $s = { dataModel: 1, sortColumn: 1, sortFunc: 1, visibleFunc: 1, rootData: 1, rootVisible: 1 },
            _s = { dataModel: 1, sortFunc: 1, visibleFunc: 1, categorizable: 1 },
            at = function(d, p) { p.add(d), d.hasChildren() && d.eachChild(function(M) { at(M, p) }) },
            bt = function(o, w, V, C, R, h, N, Q, L, W, I) {
                var O, X = V.getValueType(W),
                    c = V.getAlign(W);
                if (V.getEnumValues(W)) {
                    var M = V.toEnumLabel(w, W),
                        G = Ef || 0,
                        t = 0,
                        y = h,
                        Y = D.getTextSize(C, M).width;
                    return O = Jc(V.toEnumIcon(w, W)), O && (t = h + Ef / 2, "center" === c ? t += (Q - (G + Y)) / 2 : "right" === c && (t = t + Q - (G + Y)), Gj(o, O, t, N + L / 2, W, I), y = t + Ef / 2), M != A && (O ? hg(o, M, C, R, y, N, Q - (y - h), L) : hg(o, M, C, R, h, N, Q, L, c)), void 0
                }
                return w = V.formatValue(w), w != A ? X === gd ? (re(o, h, N, Q, L, w), void 0) : X === Ff || !X && Nl(w) ? (O = Jc(w ? dk : Cr), Gj(o, O, h + Q / 2, N + L / 2, W, I), void 0) : (hg(o, w, C, R, h, N, Q, L, c), void 0) : void 0
            },
            ct = function(n, b) {
                var _ = b.view,
                    w = rf(n),
                    Y = b.column || b.property;
                _.getDataModel().beginTransaction(), b.editor = n, n.info = b, _.setCurrentEditor(n), _.getView().insertBefore(w, _._79O), dq(n, b.editorRect), n.setFocus ? n.setFocus() : fm(n), n.commitValue = function(d, z) { n._17Q && (n = n._17Q), z || _.setValue(b.data, Y, n.getValue ? n.getValue() : n.value), n.close && n.close(), tp(w) }, Y.onEditorCreated && Y.onEditorCreated(b)
            },
            dt = function(w, F, y, O, W) {
                var H = Im(w, y),
                    e = F.value,
                    s = F.view,
                    n = W.getValueType(F.data);
                return H.onblur = H.onchange = function() { s.endEditing() }, "input" === w ? (e = W.formatValue(e), e != A && (H.value = e), H.onkeydown = function(k) { jf(k) ? s.endEditing() : nc(k) && s.endEditing(!0) }, (n === tl || n === zq) && v(H, Ci, D.numberListener)) : w === af && O.forEach(function(g) {
                    var P = M.createElement("option");
                    P.innerHTML = W.toEnumLabel(g), P.value = g, W.isEnumEqual(e, g) && (P.selected = !0), Ml(H, P)
                }), ct(H, F), H
            },
            et = k.widget = {},
            ft = function(G, B, l) { eh(L + ".widget." + G, B, l) };
        gp(Xp, {
            ms_value: function(q) {
                q.getValue = function(z) {
                    var d = this.getItemById(z),
                        k = d.element;
                    return Ok(k) ? k : k ? k.getValue ? k.getValue() : k.value : d.selected
                }, q.setValue = function(s, K) {
                    var u = this.getItemById(s);
                    if (u) {
                        var E = u.element;
                        E && !Ok(E) ? E.setValue ? E.setValue(K) : E.value = K : Nl(K) ? (u.selected = K, this.iv()) : (u.element = K, this.iv())
                    }
                }, q.v = function(u, M) {
                    var i = this;
                    if (2 === arguments.length) i.setValue(u, M);
                    else { if (!zg(u)) return i.getValue(u); for (var N in u) i.setValue(N, u[N]) }
                    return i
                }
            },
            _46o: function(h) {
                h._icon = A, h._accessType = A, h._valueType = A, h._editable = !1, h._batchEditable = !0, h._align = Ui, h._nullable = !0, h._emptiable = !1, h.setParent = Vb, h.formatValue = function(k) {
                    var O = this,
                        a = O._valueType;
                    return O.getEnumValues() ? O.toEnumLabel(k) : a === Ff ? !!k : k != A && a === tl ? j(k) : k
                }, h.setEnum = function(i, R, E, Y, N, O, k) {
                    var d = this;
                    i && !ud(i) && i.values && (Y = i.editable, E = i.icons, R = i.labels, N = i.strict, O = i.maxHeight, k = i.dropDownWidth, i = i.values), is(i) && (i = i._as), is(R) && (R = R._as), is(E) && (E = E._as), d._enumValues = i, d._enumLabels = R, d._enumIcons = E, d._enumEditable = Y, d._enumStrict = N == A ? !0 : N, d._enumMaxHeight = O, d._enumDropDownWidth = k, i && i.length && lc(i[0]) && (d._valueType = zq), d.fp("enum", !1, !0)
                }, h.getEnumDropDownWidth = function() { return this._enumDropDownWidth }, h.getEnumMaxHeight = function() { return this._enumMaxHeight }, h.isEnumEditable = function() { return this._enumEditable }, h.getEnumValues = function() { return this._enumValues }, h.getEnumLabels = function() { return this._enumLabels }, h.getEnumIcons = function() { return this._enumIcons }, h.isEnumStrict = function() { return this._enumStrict }, h.isEnumEqual = function(Z, L) { return this._enumStrict ? Z === L : Z == L }, h.toEnumLabel = function(x, h) {
                    var e = this,
                        j = e.getEnumValues(h),
                        t = e.getEnumLabels(h);
                    if (j && t)
                        for (var V = 0; V < j.length; V++)
                            if (e.isEnumEqual(x, j[V])) return t[V];
                    return x
                }, h.toEnumIcon = function(s, g) {
                    var c = this,
                        u = c.getEnumValues(g),
                        x = c.getEnumIcons(g);
                    if (u && x)
                        for (var F = 0; F < u.length; F++)
                            if (c.isEnumEqual(s, u[F])) return x[F];
                    return O
                }
            },
            _45o: function(Z) {
                Z._87o = function(H, N, o, w, v, a) {
                    if (H) {
                        var Y = this,
                            q = Y._90I,
                            S = sf(1);
                        Y._columnLineVisible && (v -= 1), Y._rowLineVisible && (a -= 1), 0 >= v || 0 >= a || (Y._90I || (q = Y._90I = {}), q[N] || (q[N] = new En), dq(S, Y.tx() + o, Y.ty() + w, v, a), Ml(S, H), Y._view.insertBefore(S, Y._79O), H.onParentAdded && H.onParentAdded(S), q[N].add(S))
                    }
                }, Z._76o = function() {
                    var F = this,
                        C = F._90I;
                    if (C) {
                        for (var v in C) C[v].each(function(T) { tp(T) });
                        delete F._90I
                    }
                }, Z._77o = function(D) {
                    var O = this;
                    if (O._90I) {
                        var g = O._90I[D];
                        g && (g.each(function(B) { tp(B) }), delete O._90I[D])
                    }
                }
            },
            _47o: function(I) {
                I.getValue = function(s, $) { return $.getValue ? $.getValue(s, $, this) : ic(s, $.getAccessType(), $.getName()) }, I.setValue = function(F, P, t) {
                    if (P.isEmptiable(F) || "" !== t || (t = O), P.isNullable(F) || t != A) {
                        var C = this,
                            z = P.getName(F),
                            I = P.getAccessType(F),
                            q = P.getValueType(F);
                        q === tl && Ok(t) ? t = pr(t) : q === zq && Ok(t) ? t = parseFloat(t) : q === Ff && Ok(t) && (t = "true" === t), C._batchEditable && P._batchEditable && C.isSelected(F) ? C.sm().each(function(E) { P.setValue ? P.setValue(E, P, t, C) : bm(E, I, z, t) }) : P.setValue ? P.setValue(F, P, t, C) : bm(F, I, z, t)
                    }
                }, I.setCurrentEditor = function(J) { this.endEditing(), this._currentEditor = J, this.redraw() }, I.isEditing = function(q, A) {
                    var b = this,
                        D = b._currentEditor;
                    if (!D) return !1;
                    if (A) { var u = D.info; return u ? (u.column || u.property) === A && u.data === q : !1 }
                    return !0
                }, I.endEditing = function(m) {
                    var a = this,
                        U = a._currentEditor;
                    U && (delete a._currentEditor, U.commitValue && U.commitValue(U.info, m), a.redraw(), a.getDataModel().endTransaction())
                }, I.beginEditing = function(M) {
                    this.endEditing();
                    var u = this,
                        H = M.column || M.property;
                    if (H.beginEditing) H.beginEditing(M);
                    else {
                        var t = M.data,
                            r = M.value,
                            n = u.getSelectBackground(t),
                            k = H.getEnumValues(t),
                            x = H.getSlider(t),
                            y = H.getColorPicker(t);
                        if (x) { var F = cj(et.Slider, x); return F.setValue(r), F.getView().onblur = function() { u.endEditing() }, F.isInstant() && (F.onValueChanged = function() { u.setValue(t, H, F.getValue()) }), ct(F, M), void 0 }
                        if (y || H.getValueType(t) === gd) { var C = cj(et.ColorPicker, y); return C.setValue(r), C.onClosed = function() { u.endEditing() }, C.isInstant() && (C.onValueChanged = function(v, B) { u.setValue(t, H, B) }), ct(C, M), C.open(), void 0 }
                        if (k) {
                            if (et.ComboBox) {
                                var J = new et.ComboBox;
                                J.setValue(r), J.setValues(k), J.setLabels(H.getEnumLabels(t)), J.setIcons(H.getEnumIcons(t)), J.setEditable(H.isEnumEditable(t)), J.setStrict(H.isEnumStrict(t)), J.setMaxHeight(H.getEnumMaxHeight(t)), J.setDropDownWidth(H.getEnumDropDownWidth(t)), J.onClosed = function() { u.endEditing() }, ct(J, M), J.open()
                            } else dt(af, M, n, k, H);
                            return
                        }
                        var O = H.getValueType(t);
                        if (O === Ff || Nl(r)) return u.setValue(t, H, !r), void 0;
                        if (H.getItemEditor(t)) {
                            var l = pm(H.getItemEditor(t)),
                                j = new l(t, H, u, M),
                                m = j.getView();
                            return m._17Q = j, j.setValue(r), bg(m), ct(m, M), j.editBeginning && j.editBeginning(), void 0
                        }
                        dt("input", M, n, A, H)
                    }
                }
            },
            _44o: function(N) {
                N.init = function(l) {
                    var C = this,
                        V = C.th = new ut(l),
                        I = C._view = oq(1, C);
                    C.tv = C._tableView = l, Ml(I, V.getView()), Ml(I, l.getView()), V.mp(function(Z) { Z.property === Cm && C.iv() }), C.iv()
                }, N.getTableView = function() { return this.tv }, N.getTableHeader = function() { return this.th }, N.getDataModel = function() { return this.tv.dm() }, N.getColumnModel = function() { return this.tv.getColumnModel() }, N.setColumns = function(U) { this.tv.setColumns(U) }, N.addColumns = function(o) { this.tv.addColumns(o) }, N.endEditing = function() { this.tv.endEditing() }, N.validateImpl = function() {
                    var L = this,
                        v = L.th,
                        Y = rj(v),
                        E = { x: 0, y: 0, width: L.getWidth(), height: Y };
                    dq(v, E), E.y = Y, E.height = K(0, L.getHeight() - Y), dq(L.tv, E)
                }
            },
            ms_vs: function(W) {
                W._41o = function() { return this._29I.height < this._59I }, W._43o = function() {
                    var b = this;
                    b._41o() && (b._58I || (Ig(function() { b._94O() }, Bg), b.iv()), b._58I = new Date)
                }, W._94O = function() {
                    var J = this;
                    if (J._58I) {
                        var O = new Date;
                        O.getTime() - J._58I.getTime() >= Bg ? (delete J._58I, J.iv()) : Ig(function() { J._94O() }, Bg)
                    }
                }, W._93I = function() {
                    var w = this,
                        S = w._27I;
                    if (w._58I || !w._autoHideScrollBar) {
                        S || Ml(w._79O, S = w._27I = sf());
                        var _ = w._29I,
                            F = _.height,
                            t = w._59I,
                            V = w.getScrollBarSize(),
                            u = _.width - V - 2,
                            j = F * (-w.ty() / t),
                            I = F * (F / t),
                            N = S.style;
                        t > F ? (ji > I && (j = j + I / 2 - ji / 2, 0 > j && (j = 0), j + ji > F && (j = F - ji), I = ji), N.visibility = fn, N.background = w.getScrollBarColor(), N.borderRadius = V / 2 + dd, dq(S, u, j, V, I)) : N.visibility = gm
                    } else S && (S.style.visibility = gm)
                }
            },
            ms_hs: function(m) {
                m._40o = function() { return this._29I.width < this._91I }, m._42o = function() {
                    var K = this;
                    K._40o() && (K._95O || (Ig(function() { K._94I() }, Bg), K.iv()), K._95O = new Date)
                }, m._94I = function() {
                    var s = this;
                    if (s._95O) {
                        var m = new Date;
                        m.getTime() - s._95O.getTime() >= Bg ? (delete s._95O, s.iv()) : Ig(function() { s._94I() }, Bg)
                    }
                }, m._92I = function() {
                    var N = this,
                        o = N._28I;
                    if (N._95O || !N._autoHideScrollBar) {
                        o || Ml(N._79O, o = N._28I = sf());
                        var k = N._29I,
                            $ = k.width,
                            K = N._91I,
                            q = N.getScrollBarSize(),
                            r = k.height - q - 2,
                            b = $ * (-N.tx() / K),
                            f = $ * ($ / K),
                            L = o.style;
                        K > $ ? (ji > f && (b = b + f / 2 - ji / 2, 0 > b && (b = 0), b + ji > $ && (b = $ - ji), f = ji), L.visibility = fn, L.background = N.getScrollBarColor(), L.borderRadius = q / 2 + dd, dq(o, b, r, f, q)) : L.visibility = gm
                    } else o && (o.style.visibility = gm)
                }
            }
        }), Dr(dk, to(16, 16, [{ type: Ej, rect: [1, 1, 14, 14], background: sn }, { type: Wo, rect: [1, 1, 14, 14], width: 1, color: gq }, { type: ii, points: [13, 3, 7, 12, 4, 8], borderWidth: 2, borderColor: "#FFF" }])), Dr(Cr, to(16, 16, { type: Wo, rect: [1, 1, 14, 14], width: 1, color: gq })), Dr(Hk, to(16, 16, [{ type: Nk, rect: [2, 2, 12, 12], borderWidth: 1, borderColor: gq, background: "#FFF" }, { type: Nk, rect: [4, 4, 8, 8], background: sn }])), Dr(nr, to(16, 16, { type: Nk, rect: [2, 2, 12, 12], borderWidth: 1, borderColor: gq })), Xp._15Q = function(X) {
            X._29I = Xo, X._59I = 0, X._91I = 0, X._5o = function(k) {
                var O = this;
                O._30I = new En, O._rows = new En, O._rowMap = {}, O._31I = 0, O._14I = 0, O._view = oq(1, O), O._canvas = Sg(O._view), Ml(O._view, O._79O = sf()), O.dm(k ? k : new Fq)
            }, X.getCheckIcon = function(I) {
                var j = this.sm(),
                    a = j.co(I);
                return j.sg() ? Jc(a ? Hk : nr) : Jc(a ? dk : Cr)
            }, X.checkData = function(i) {
                var N = this.sm(),
                    r = N.co(i);
                N.sg() && r || (this._32o = 1, r ? N.rs(i) : N.as(i), delete this._32o)
            }, X.getDataAt = function(d) {
                d.target && (d = this.lp(d));
                var n = w(d.y / this._rowHeight),
                    s = this._rows;
                return 0 > n || n >= s.size() ? A : s.get(n)
            }, X.onDataDoubleClicked = function() {}, X.onDataClicked = function() {}, X.adjustTranslateX = function() { return 0 }, X.adjustTranslateY = function(z) { var P = this.getHeight() - this._59I; return P > z && (z = P), z > 0 ? 0 : j(z) }, X.onPropertyChanged = function(z) {
                var n = this,
                    Q = z.property;
                $s[Q] ? n.ivm() : Zs[Q] || n.redraw(), Q === Wb ? n._42o() : Q === So && n._43o()
            }, X.getLabel = function(z) { return z.toLabel() }, X.getLabelFont = function() { return this._labelFont }, X.getLabelColor = function(o) { var A = this; if (A.isCheckMode()) { if (A._focusData === o) return A._labelSelectColor } else if (A.isSelected(o)) return A._labelSelectColor; return A._labelColor }, X.getStartRowIndex = function() { return this._31I }, X.getEndRowIndex = function() { return this._14I }, X.getRowDatas = function() { return this._rows }, X.getRowIndex = function(Z) { return this._rowMap[Z._id] }, X.getRowSize = function() { return this._rows.size() }, X.getViewRect = function() { return tf(this._29I) }, X.isVisible = function(o) { return this._visibleFunc ? this._visibleFunc(o) : !0 }, X.getCurrentSortFunc = function() { return this._sortFunc }, X.setDataModel = function(n) {
                var h = this,
                    X = h._dataModel,
                    L = h._selectionModel;
                X !== n && (X && (X.umm(h.handleDataModelChange, h), X.umd(h.handleDataPropertyChange, h), X.umh(h.handleHierarchyChange, h), L || X.sm().ums(h.handleSelectionChange, h)), h._dataModel = n, n.mm(h.handleDataModelChange, h), n.md(h.handleDataPropertyChange, h), n.mh(h.handleHierarchyChange, h), L ? L._21I(n) : n.sm().ms(h.handleSelectionChange, h), h.fp("dataModel", X, n))
            }, X.validateModel = function() {
                var T = this;
                T._rows.clear(), T._rowMap = {}, T.buildChildren(T._dataModel._roots);
                var L = T._rows = T._rows.toList(T.isVisible, T),
                    M = 0,
                    y = T.getCurrentSortFunc(),
                    S = L.size();
                for (y && L.sort(y); S > M; M++) T._rowMap[L.get(M)._id] = M
            }, X.buildChildren = function(F) {
                var D = this;
                F.each(function(V) { D._rows.add(V), D.buildChildren(V._children) })
            }, X.handleDataModelChange = function() { this.ivm() }, X.handleDataPropertyChange = function(g) { "parent" === g.property ? this.ivm() : this.invalidateData(g.data) }, X.handleHierarchyChange = function() { this.ivm() }, X.handleSelectionChange = function(N) { N.datas.each(this.invalidateData, this), this.onSelectionChanged(N) }, X.onSelectionChanged = function(E) {
                var z = this,
                    f = z.sm();
                !z.isAutoMakeVisible() || 1 !== f.size() || "set" !== E.kind && "append" !== E.kind || z._32o || z.makeVisible(f.ld())
            }, X.handleBackgroundClick = function($) { pn($) && !this.isCheckMode() && this.sm().cs() }, X.makeVisible = function(M) { M && (this._23I = M, this.iv()) }, X.scrollToIndex = function(I) {
                var j = this,
                    u = j._29I,
                    U = u.height,
                    d = j._rowHeight,
                    L = d * I;
                I >= 0 && I < j._rows.size() && U > 0 && (L + d > u.y + U ? j.ty(-L + U - d) : L < u.y && j.ty(-L))
            }, X.autoScroll = function(o, x) {
                var y = this,
                    W = y._rowHeight,
                    n = W,
                    Z = W / 4,
                    b = y._29I,
                    u = y.lp(o),
                    M = { x: y.tx(), y: y.ty() };
                return W > 0 && b && (u.x - b.x < n ? y.translate(Z, 0) : b.x + b.width - u.x < n && y.translate(-Z, 0), u.y - b.y < n ? y.translate(0, Z) : b.y + b.height - u.y < n && y.translate(0, -Z)), M.x = y.tx() - M.x, M.y = y.ty() - M.y, x && (x.x += M.x, x.y += M.y), M
            }, X.getTopRowOrderSelection = function() {
                var O = this.sm().getTopSelection(),
                    M = {},
                    x = new En;
                return O.each(function(v) { M[v._id] = v }), this._rows.each(function(U) { M[U._id] && x.add(U) }), x
            }, X.getRowOrderSelection = function() { var g = new En; return this._rows.each(function(l) { this.isSelected(l) && g.add(l) }, this), g }, X.ivm = function() { this.invalidateModel() }, X.invalidateModel = function() {
                var v = this;
                v._96I || (v._96I = 1, v._32I = 1, delete v._24I), v.iv()
            }, X.redraw = function() {
                var k = this;
                k._32I || (k._32I = 1, delete k._24I, k.iv())
            }, X.invalidateData = function(r) {
                var p = this;
                Ch ? p.redraw() : p._32I || (p._24I || (p._24I = {}), p._24I[r._id] = r, p.iv())
            }, X.getFocusData = function() { return this._focusData }, X.setFocusDataById = function(u) { this.setFocusData(this.dm().getDataById(u)) }, X.setFocusData = function(y) {
                var L = this,
                    r = L._focusData;
                r !== y && (L._focusData = y, L.fp("focusData", r, y), r && L.invalidateData(r), y && (L.invalidateData(y), L.isAutoMakeVisible() && L.makeVisible(y)))
            }, X.drawRowBackground = function(B, C, v, Y, H, y, p) {
                var z = this,
                    V = z.isCheckMode();
                (C === z._focusData && V || v && !V) && re(B, Y, H, y, p, z.getSelectBackground(C))
            }, X.drawData = function(R, v, f) {
                var e = this,
                    S = e._rowHeight,
                    m = S * f,
                    I = e._29I,
                    a = I.x,
                    N = I.width;
                R.save(), R.beginPath(), R.rect(a, m, N, S), R.clip(), e._87o(e.drawRow(R, v, e.isSelected(v), a, m, N, S), f, a, m, N, S), R.restore(), e._rowLineVisible && re(R, a, m + S - 1, N, 1, e._rowLineColor)
            }, X._12I = function(n) {
                var s = this,
                    j = s._31I,
                    Z = s._29I,
                    x = Z.x,
                    O = Z.y,
                    K = Z.width,
                    J = Z.height;
                for (n.beginPath(), n.rect(x, O, K, J), n.clip(), n.clearRect(x, O, K, J), s._76o(), s._93db(n); j < s._14I; j++) s.drawData(n, s._rows.get(j), j);
                s._92db(n)
            }, X._13I = function(A) {
                for (var F, W = this, V = W._rowHeight, B = W._29I, O = B.x, h = B.width, v = W._31I, M = W._30I; v < W._14I; v++) F = W._rows.get(v), W._24I[F._id] && M.add({ data: F, index: v });
                M.isEmpty() || (A.beginPath(), M.each(function(c) { A.rect(O, c.index * V, h, V) }), A.clip(), M.each(function(Z) { A.clearRect(O, Z.index * V, h, V) }), M.each(function(n) { W._77o(n.index) }), W._93db(A), M.each(function(M) { W.drawData(A, M.data, M.index) }), W._92db(A), M.clear())
            }, X.preValidateModel = function() { this.endEditing && this.endEditing() }, X.validateImpl = function() {
                var B = this,
                    r = B._canvas,
                    K = B.getWidth(),
                    J = B.getHeight(),
                    F = B._rowHeight,
                    v = B._32I;
                (K !== r.clientWidth || J !== r.clientHeight) && (Cq(r, K, J), v = 1), B._96I && (B.preValidateModel(), B.validateModel());
                var O = B._29I,
                    S = { x: -B.tx(), y: -B.ty(), width: K, height: J },
                    q = B._rows.size(),
                    u = Bp(r),
                    c = B._23I;
                v || Me(S, O) || (v = 1), B._29I = S, B._59I = q * F, B._31I = w(S.y / F), B._14I = x((S.y + S.height) / F), B._31I < 0 && (B._31I = 0), B._14I > q && (B._14I = q), B._99I && v && B._99I();
                var Y = B.tx(),
                    z = B.ty();
                (B._40o() || B._41o()) && (B._59I += B.getScrollBarSize(), B._99I && v && (B._91I += B.getScrollBarSize())), Yj && !uo && (u.save(), Yk(u, K / yg.length, J / yg.length, 1)), Yk(u, Y, z, 1), v ? B._12I(u) : B._24I && B._13I(u), B._93I(), B._92I(), u.restore(), B._32I = B._24I = B._96I = A, c && (B.scrollToIndex(B.getRowIndex(c)), delete B._23I), B.tx(B.tx()), B.ty(B.ty())
            }, X.canHandleSelectMode = function() { return !0 }
        }, Xp._48o = function(F) {
            F._rootVisible = !0, F._rootData = A, F._35o = function() { this._expandMap = {}, this._levelMap = {} }, F.validateModel = function() {
                var V = this,
                    f = V._rootData;
                V._rows.clear(), V._levelMap = {}, V._rowMap = {}, V._currentLevel = 0, f ? V._rootVisible ? V.isVisible(f) && V.buildData(f) : V.buildChildren(f) : V.buildChildren(), delete V._currentLevel
            }, F.buildData = function(n) {
                var $ = this,
                    s = n._id,
                    T = $._rows;
                $._rowMap[s] = T.size(), T.add(n), $._levelMap[s] = $._currentLevel, $.isExpanded(n) && ($._currentLevel++, $.buildChildren(n), $._currentLevel--)
            }, F.buildChildren = function(q) {
                var _ = this,
                    h = q ? q._children : _._dataModel._roots,
                    G = _.getCurrentSortFunc();
                G && _.isChildrenSortable(q) ? h.toList(_.isVisible, _).sort(G).each(_.buildData, _) : h.each(function(Q) { _.isVisible(Q) && _.buildData(Q) })
            }, F.getLevel = function(c) { return this._levelMap[c._id] }, F.getToggleIcon = function(Q) {
                var N = this,
                    $ = N._loader,
                    y = N._collapseIcon;
                return $ && !$.isLoaded(Q) ? y : Q.hasChildren() ? N.isExpanded(Q) ? N._expandIcon : y : A
            }, F.isCheckMode = function() { return this._checkMode != A }, F.isChildrenSortable = function() { return !0 }, F.handleDataModelChange = function(y) {
                var R = this;
                y.kind === nd ? delete R._expandMap[y.data._id] : y.kind === Cl && (R._expandMap = {}), R.ivm()
            }, F.toggle = function(q) {
                var $ = this;
                $.isExpanded(q) ? $.collapse(q) : $.expand(q)
            }, F.isExpanded = function(R) { return 1 === this._expandMap[R._id] }, F.expand = function(r) {
                var a = this,
                    J = a._loader;
                a.isExpanded(r) || (J && !J.isLoaded(r) && J.load(r), a._expandMap[r._id] = 1, a.ivm(), a.onExpanded(r))
            }, F.onExpanded = function() {}, F.collapse = function($) {
                var I = this;
                I.isExpanded($) && (delete I._expandMap[$._id], I.ivm(), I.onCollapsed($))
            }, F.onCollapsed = function() {}, F.expandAll = function(E) {
                if (E) this.expand(E), E.eachChild(function(R) { this.expandAll(R) }, this);
                else {
                    var A = this;
                    A._dataModel.each(function(I) { I.hasChildren() && (A._expandMap[I._id] = 1) }), A.ivm()
                }
            }, F.collapseAll = function() { this._expandMap = {}, this.ivm() }, F.makeVisible = function(I) {
                if (I) {
                    var w = this;
                    if (!w._rootData || I.isDescendantOf(w._rootData)) {
                        for (var e = I._parent; e;) w.expand(e), e = e._parent;
                        w._23I = I, w.iv()
                    }
                }
            }, F.checkData = function(k) {
                var c, g = this,
                    v = g._checkMode,
                    i = g.sm(),
                    e = i.co(k);
                if (!i.sg() || !e) {
                    if (g._32o = 1, v === Tb) e ? i.rs(k) : i.as(k);
                    else if (v === _m) c = new En(k), c.addAll(k._children);
                    else if ("descendant" === v) c = new En, at(k, c);
                    else if ("all" === v && (c = new En, at(k, c), !e))
                        for (var l = k._parent; l;) c.add(l), l = l._parent;
                    c && (e ? i.rs(c) : i.as(c)), delete g._32o
                }
            }, F.drawTree = function(Z, N, c, H, R, E, s) {
                var Y = this,
                    e = Y._indent,
                    A = Y._levelMap[N._id],
                    W = Y.getIconWidth(N),
                    u = Jc(Y.getToggleIcon(N));
                u ? (H += e * A, Gj(Z, u, H + e / 2, R + s / 2, N, Y), H += e) : H += e * (A + 1), Y._checkMode && (Gj(Z, Y.getCheckIcon(N), H + e / 2, R + s / 2, N, Y), H += e), Y.drawIcon(Z, N, H, R, W, s), Y.drawLabel(Z, N, H + W, R, s)
            }
        }, Xp._14Q = function(c) {
            c.getIcon = function(l) { return l.getIcon() }, c.getIconWidth = function(L) { return this.getIcon(L) ? this._indent : 0 }, c.drawIcon = function(D, F, j, s, M, S) {
                if (M) {
                    var X = this,
                        n = X.getBodyColor(F),
                        R = Jc(X.getIcon(F), n);
                    R && (S -= X.isRowLineVisible() ? 1 : 0, Kq(D, R, lp, j, s, M, S, F, X, n), Qn(D, X.getBorderColor(F), j, s, M, S))
                }
            }, c.drawLabel = function(S, V, U, c, e) {
                var r = this;
                hg(S, r.getLabel(V), r.getLabelFont(V), r.getLabelColor(V), U, c, 0, e)
            }
        }, Xp._50o = function(t) {
            t._98I = function() {
                var S = this,
                    z = S._39o = new Fq;
                S._60I = new En, z.mm(S._17o, S), z.md(S._18o, S), z.mh(S._19o, S)
            }, t.setColumns = function(f) { this._39o.clear(), this.addColumns(f) }, t.addColumns = function(T) {
                var G = this._39o;
                T.forEach(function(Z) {
                    if (!(Z instanceof ht)) {
                        var c = pm(Z.className);
                        Z = cj(c ? c : ht, Z)
                    }
                    G.add(Z)
                })
            }, t.onColumnClicked = function() {}, t.onCheckColumnClicked = function() {}, t._3Q = function(N) {
                for (var E, T = 0, p = this._60I, C = p.size(); C > T; T++)
                    if (E = p.get(T), E.column === N) return E;
                return A
            }, t.getColumnAt = function(q) { var F = this._4Q(q); return F ? F.column : A }, t._4Q = function(Z) {
                for (var x = this, P = Z.target ? x.lp(Z).x : Z.x, C = x._60I, p = 0; p < C.size(); p++) {
                    var F = C.get(p),
                        h = F.startX;
                    if (P >= h && P < h + F.column.getWidth()) return F
                }
                return A
            }, t.getToolTip = function(k) {
                var r = this,
                    I = r.getDataAt(k),
                    K = r.getColumnAt(k);
                return I && K ? K.getToolTip(I, r) : A
            }, t.adjustTranslateX = function(w) { var R = this.getWidth() - this._91I; return R > w && (w = R), w > 0 ? 0 : j(w) }, t._99I = function() {
                var D = this,
                    N = D._29I,
                    F = D._60I;
                F.clear(), D._91I = 0, D._39o._roots.each(function(L) {
                    if (L.isVisible()) {
                        var B = D._91I + L.getWidth();
                        D._91I <= N.x + N.width && B >= N.x && F.add({ column: L, startX: D._91I }), D._91I = B
                    }
                })
            }, t.drawData = function(J, N, b) {
                var M = this,
                    Y = M._rowHeight,
                    s = Y * b,
                    F = M.isSelected(N),
                    K = M._29I,
                    B = K.x,
                    v = K.width;
                M.drawRowBackground(J, N, F, B, s, v, Y), M._60I.each(function(n) {
                    var O = n.column,
                        i = n.startX,
                        v = O.getWidth();
                    v > 0 && !M.isEditing(N, O) && (J.save(), J.beginPath(), J.rect(i, s, v, Y), J.clip(), M._87o(M.drawCell(J, N, F, O, i, s, v, Y), b, i, s, v, Y), M._columnLineVisible && re(J, i + v - 1, s, 1, Y, M._columnLineColor), J.restore())
                }), M._rowLineVisible && re(J, B, s + Y - 1, v, 1, M._rowLineColor)
            }, t.drawCell = function(T, c, t, w, W, G, H, E) {
                var r = this;
                if (w.drawCell) return w.drawCell(T, c, t, w, W, G, H, E, r);
                var o = r.getValue(c, w);
                bt(T, o, w, r.getLabelFont(c, w, o), r.getLabelColor(c, w, o), W, G, H, E, c, r)
            }, t.getColumnModel = function() { return this._39o }, t._17o = function() { this.redraw() }, t._18o = function(z) {
                var L = this;
                z.data === L._sortColumn && Ys[z.property] ? L.ivm() : (L._42o(), L.redraw())
            }, t._19o = function() { this.redraw() }, t.getCurrentSortFunc = function() {
                var T = this,
                    L = T._sortColumn;
                if (L && L.isSortable()) {
                    var s = L.getSortFunc(),
                        D = Kl === L.getSortOrder() ? 1 : -1;
                    return s || (s = Ob),
                        function(d, w) { return s.call(T, T.getValue(d, L), T.getValue(w, L), d, w) * D }
                }
                return T._sortFunc
            }, t.isCellEditable = function(k, S, i) { return S.isEditable() && this.isEditable() ? S.isCellEditable ? S.isCellEditable(k, S, i, this) : !0 : !1 }, t._37O = function(n, c) {
                if (pn(c))
                    for (var o = this, v = o.lp(c), g = o._60I, D = o._rowHeight, u = o._29I, j = u.x, V = u.y, x = u.width, e = u.height, U = 0; U < g.size(); U++) {
                        var C = g.get(U),
                            W = C.startX,
                            r = C.column,
                            h = r.getWidth();
                        if (r !== o._31o && r !== o._4o && v.x >= W && v.x < W + h && o.isCellEditable(n, r, c)) {
                            var m = { x: W, y: o.getRowIndex(n) * D, width: h, height: D },
                                E = { x: m.x + o.tx(), y: m.y + o.ty(), width: m.width, height: m.height },
                                M = 0,
                                $ = 0;
                            return m.x < j ? M = m.x - j : m.x + m.width > j + x && (M = m.x + m.width - j - x), M && (o.tx(o.tx() - M), E.x -= M), m.y < V ? $ = m.y - V : m.y + D > V + e && ($ = m.y + D - V - e), $ && (o.ty(o.ty() - $), E.y -= $), o.beginEditing({ data: n, column: r, value: o.getValue(n, r), event: c, rect: m, editorRect: E, view: o }), void 0
                        }
                    }
            }
        }, et.BaseItemEditor = function(P, U, r, n) { this._data = P, this._column = U, this._master = r, this._editInfo = n }, ft("BaseItemEditor", n, { ms_ac: ["data", "column", "master", "editInfo"], editBeginning: function() {}, getView: function() {}, getValue: function() {}, setValue: function() {} });
        var gt = k.Tab = function() { th(gt, this) };
        fi("Tab", Bq, { ms_ac: ["view", "closable", "disabled", "visible"], _icon: A, _closable: !1, _disabled: !1, _visible: !0, setParent: Vb });
        var ht = k.Column = function() { th(ht, this) };
        fi("Column", Bq, {
            _46o: 1,
            ms_ac: ["accessType", "valueType", fn, wi, wc, nn, "align", gd, "sortOrder", Ao, "sortable", "clickable", "nullable", "emptiable", "slider", "colorPicker", "itemEditor"],
            _visible: !0,
            _width: 80,
            _sortOrder: Kl,
            _sortFunc: A,
            _sortable: !0,
            _clickable: !0,
            setWidth: function(G) {
                16 > G && (G = 16);
                var w = this._width;
                this._width = G, this.fp(nn, w, G)
            },
            getToolTip: function(b, U) { return this.formatValue(U.getValue(b, this)) }
        });
        var it = k.Property = function() { th(it, this) };
        fi("Property", Bq, { _46o: 1, ms_ac: ["accessType", "valueType", wi, wc, "categoryName", gd, "align", "nullable", "emptiable", "slider", "itemEditor", "colorPicker"], _categoryName: A, getToolTip: function(S, X, P) { var l = this; return X ? l.formatValue(P.getValue(S, l)) : P.getPropertyName(l) } }), et.AccordionView = function() {
            var E = this;
            E._20o = {}, E._21o = new En, E._10o = A, E._9o = A, E._11o = A, E._view = oq(0, E), E.iv()
        }, ft("AccordionView", n, {
            ms_v: 1,
            ms_fire: 1,
            ms_ac: [Pd, xe, "titleHeight", oj, Vn, "titleBackground", "selectWidth", Kd, "orientation", "separatorColor"],
            _expandIcon: D.accordionViewExpandIcon,
            _collapseIcon: D.accordionViewCollapseIcon,
            _titleHeight: Bf,
            _labelColor: D.accordionViewLabelColor,
            _labelFont: D.accordionViewLabelFont,
            _titleBackground: D.accordionViewTitleBackground,
            _selectBackground: D.accordionViewSelectBackground,
            _selectWidth: D.accordionViewSelectWidth,
            _orientation: "v",
            _separatorColor: D.accordionViewSeparatorColor,
            onPropertyChanged: function() { this.iv() },
            getView: function() { return this._view },
            getTitles: function() { return this._21o },
            getCurrentTitle: function() { return this._10o },
            add: function(n, i, W, t) {
                var G = this,
                    k = sf(),
                    Z = { content: i, div: k, canvas: Sg(k), icon: t };
                if (G._20o[n]) throw n + " already exists";
                var u = Z.downEventFunc = function(m) { sh(m) },
                    C = Z.upEventFunc = function(x) { sh(x), pn(x) && (G._10o === n ? G.collapse() : G.expand(n)) };
                [li, Wk].forEach(function(G) { v(k, G, u) }), [Zb, Zc].forEach(function(q) { v(k, q, C) }), k.style.cursor = Kj, Ml(G._view, k), G._20o[n] = Z, G._21o.add(n), W && G.expand(n), G.iv()
            },
            remove: function(q) {
                var l = this,
                    Q = l._20o[q];
                if (Q) {
                    var w = Q.div;
                    tp(w), [li, Wk].forEach(function(c) { $(w, c, Q.downEventFunc) }), [Zb, Zc].forEach(function(B) { $(w, B, Q.upEventFunc) }), delete l._20o[q], l._21o.remove(q), l.iv()
                }
            },
            clear: function() {
                var H = this;
                H._21o.toArray().forEach(H.remove, H), H._20o = {}, H._21o.clear(), H.iv()
            },
            isExpanded: function(d) { return this._10o === d },
            expand: function(x) {
                var C = this;
                C._20o[x] && C._10o !== x && (C._10o = x, C.onExpanded(x), C.iv())
            },
            onExpanded: function() {},
            collapse: function() {
                var D = this;
                D._10o && (D.onCollapsed(D._10o), delete D._10o, D.iv())
            },
            onCollapsed: function() {},
            initCanvas: function(c, b, Z) { Cq(c, b, Z); var _ = Bp(c); return Yk(_, 0, 0, 1), _.clearRect(0, 0, b, Z), _ },
            drawTitle: function(A, B, G, d, p) {
                var $ = this,
                    T = Jc(p.icon),
                    D = $.isExpanded(B),
                    W = $._titleHeight,
                    x = $._titleBackground,
                    C = $._selectWidth,
                    U = $._separatorColor,
                    u = Jc(D ? $._expandIcon : $._collapseIcon),
                    Y = C + 4;
                re(A, 0, 0, G, d, x), D && C && re(A, 0, 0, C, d, $._selectBackground), (D || $._21o.get($._21o.size() - 1) !== B) && re(A, 0, d - 1, G, 1, U ? U : gr(x)), T && (Gj(A, T, Y + Hc(T) / 2, W / 2), Y += Hc(T) + 2), hg(A, B, $.getLabelFont(B), $.getLabelColor(B), Y, 0, 0, W), u && Gj(A, u, G - Hc(u) / 2 - 4, W / 2)
            },
            validateImpl: function() {
                var w = this,
                    c = w._view,
                    r = 0,
                    F = 0,
                    t = w.getWidth(),
                    Q = w.getHeight(),
                    U = w._titleHeight,
                    i = w._21o.size() * U,
                    $ = w._11o,
                    f = w._9o;
                delete w._11o, delete w._9o, w._21o.each(function(z) {
                    var g, _, $ = w._20o[z],
                        u = $.content,
                        A = w._10o === z;
                    po(w) ? (dq($.div, r, 0, U, Q), g = w.initCanvas($.canvas, U, Q), ts(g, 0, Q), nm(g, -Z), w.drawTitle(g, z, Q, U, $), g.restore(), A ? (_ = K(0, t - i), u && (w._11o = u, w._9o = rf(u), dq(u, r + U, 0, _, Q)), r += U + _) : r += U) : (dq($.div, 0, F, t, U), g = w.initCanvas($.canvas, t, U), w.drawTitle(g, z, t, U, $), g.restore(), A ? (_ = K(0, Q - i), u && (w._11o = u, w._9o = rf(u), dq(u, 0, F + U, t, _)), F += U + _) : F += U)
                });
                var j = w._9o;
                $ && $ !== w._11o && $.endEditing && $.endEditing(), j && j !== f && Ml(c, j), f && f !== j && tp(f)
            }
        }), et.SplitView = function(F, k, Y, i) {
            var K = this,
                v = K._dividerDiv = sf(),
                e = K._60O = Sg(),
                g = K._61O = Sg(),
                o = e.style,
                N = g.style;
            K._view = oq(1, K), Ml(K._view, v), o.msTouchAction = Kf, o.pointerEvents = Kf, o.cursor = Kj, N.msTouchAction = Kf, N.pointerEvents = Kf, N.cursor = Kj, F && K.setLeftView(F), k && K.setRightView(k), Y && K.setOrientation(Y), i != A && K.setPosition(i), K.setStatus(ul), new jt(K)
        }, ft("SplitView", n, {
            ms_v: 1,
            ms_fire: 1,
            ms_ac: ["continuousLayout", "dividerSize", "dividerBackground", "toggleIcon", "togglable", "dragOpacity", "orientation", "draggable", "status"],
            _continuousLayout: !1,
            _position: .5,
            _togglable: !0,
            _orientation: "h",
            _draggable: !0,
            _dividerSize: D.splitViewDividerSize,
            _dividerBackground: D.splitViewDividerBackground,
            _dragOpacity: D.splitViewDragOpacity,
            _toggleIcon: D.splitViewToggleIcon,
            onPropertyChanged: function() { this.iv() },
            getDividerDiv: function() { return this._dividerDiv },
            getPosition: function() { return this._position },
            setPosition: function(Y, X) {
                var d = this,
                    k = d._position;
                isNaN(Y) || (X || (d._82O = 0 > Y ? -1 : Y > 1 ? 1 : 0), d._position = Y, d.fp(Ne, k, Y))
            },
            getLeftView: function() { return this._leftView },
            setLeftView: function(r) {
                var U = this,
                    t = U._leftView,
                    $ = U._view;
                if (U._leftView !== r) {
                    if (t && t !== U._rightView) {
                        var R = rf(t);
                        R.parentNode === $ && tp(R)
                    }
                    if (U._leftView = r, r) {
                        var M = rf(r);
                        M.parentNode !== $ && $.insertBefore(M, U._dividerDiv)
                    }
                    U.fp("leftView", t, r)
                }
            },
            getRightView: function() { return this._rightView },
            setRightView: function(n) {
                var o = this,
                    H = o._rightView,
                    z = o._view;
                if (o._rightView !== n) {
                    if (H && H !== o._leftView) {
                        var Z = rf(H);
                        Z.parentNode === z && tp(Z)
                    }
                    if (o._rightView = n, n) {
                        var I = rf(n);
                        I.parentNode !== z && z.insertBefore(I, o._dividerDiv)
                    }
                    o.fp("rightView", H, n)
                }
            },
            validateImpl: function() {
                var L = this,
                    b = L._draggable,
                    C = L._position,
                    o = L.getWidth(),
                    p = L.getHeight(),
                    G = L._dividerSize,
                    l = L._dividerBackground,
                    A = Po ? 18 : 8,
                    Q = L._dividerDiv,
                    Y = L._82O,
                    S = L._60O,
                    F = L._61O,
                    J = L._toggleIcon,
                    n = L._status,
                    h = Q.style,
                    V = null,
                    g = Po ? 20 : 4,
                    c = J.comps[0];
                G >= A || 0 === G ? L._coverDiv && (tp(L._coverDiv), delete L._coverDiv) : L._coverDiv || (L._coverDiv = sf(), Jd && (L._coverDiv.style.background = rl), Ml(Q, L._coverDiv)), L._togglable ? S.parentNode || (Ml(Q, S), Ml(Q, F)) : (tp(S), tp(F));
                var R = L._coverDiv,
                    H = L._leftView,
                    E = L._rightView;
                if (po(L)) {
                    if (G > o && (G = o), n === ul)
                        if (1 === Y) var z = i(C, o),
                            e = K(0, o - G - z);
                        else -1 === Y ? (e = i(-C, o), z = K(0, o - G - e)) : (z = j((o - G) * C), e = K(0, o - G - z));
                    else "cl" === n ? (z = 0, e = K(0, o - G)) : "cr" === n && (e = 0, z = K(0, o - G));
                    H && dq(H, 0, 0, z, p), E && dq(E, z + G, 0, e, p), dq(Q, z, 0, G, p), L._22o = z, R && (dq(R, G / 2 - A / 2, 0, A, p), R.style.cursor = b ? Or : ""), Q.style.cursor = b ? Or : "";
                    var u = Q.clientHeight / 2,
                        P = Q.clientWidth;
                    Cq(S, P, P), dq(S, 0, u - P - g, P, P), V = Bp(S), Yk(V, 0, 0, 1), c.rotation = -Z, as(V, J, 0, 0, P, P), V.restore(), Cq(F, P, P), dq(F, 0, u + g, P, P), V = Bp(F), Yk(V, 0, 0, 1), c.rotation = Z, as(V, J, 0, 0, P, P), V.restore()
                } else {
                    if (G > p && (G = p), n === ul)
                        if (1 === Y) var B = i(C, p),
                            m = K(0, p - G - B);
                        else -1 === Y ? (m = i(-C, p), B = K(0, p - G - m)) : (B = j((p - G) * C), m = K(0, p - G - B));
                    else "cl" === n ? (B = 0, m = K(0, p - G)) : "cr" === n && (m = 0, B = K(0, p - G));
                    H && dq(H, 0, 0, o, B), E && dq(E, 0, B + G, o, m), dq(Q, 0, B, o, G), L._22o = B, R && (dq(R, 0, G / 2 - A / 2, o, A), R.style.cursor = b ? pd : ""), h.cursor = b ? pd : "";
                    var s = Q.clientWidth / 2,
                        P = Q.clientHeight;
                    Cq(S, P, P), dq(S, s - P - g, 0, P, P), V = Bp(S), Yk(V, 0, 0, 1), c.rotation = 0, as(V, J, 0, 0, P, P), V.restore(), Cq(F, P, P), dq(F, s + g, 0, P, P), V = Bp(F), Yk(V, 0, 0, 1), c.rotation = U, as(V, J, 0, 0, P, P), V.restore()
                }
                h.background = l
            }
        });
        var jt = function(h) { this.sv = h, this.addListeners() };
        eh(jt, n, {
            ms_listener: 1,
            getView: function() { return this.sv.getView() },
            handle_touchstart: function(D) {
                var K = this,
                    r = K.sv,
                    E = r._dividerDiv,
                    I = r._60O,
                    J = r._61O,
                    s = r._status,
                    h = D.target;
                if (h === I) s === ul ? r.setStatus("cl") : "cr" === s && r.setStatus(ul);
                else if (h === J) s === ul ? r.setStatus("cr") : "cl" === s && r.setStatus(ul);
                else if (Lp(D) && (h === E || h === r._coverDiv) && (sh(D), r.isDraggable())) {
                    r.getLeftView(), r.getRightView();
                    var k = K.maskDiv = sf();
                    if (k.style.left = 0, k.style.top = 0, k.style.width = r.getWidth() + "px", k.style.height = r.getHeight() + "px", r.getView().appendChild(k), !r.isContinuousLayout()) {
                        var O = K.resizeDiv = sf();
                        O.style.left = E.style.left, O.style.top = E.style.top, O.style.width = E.style.width, O.style.height = E.style.height, O.style.opacity = r.getDragOpacity(), O.style.background = r.getDividerBackground(), Ml(K.getView(), O)
                    }
                    K._lastAbsPosition = r._22o, K._86o = po(r) ? Sp(D).x : Sp(D).y, zi(K, D)
                }
            },
            handleWindowTouchMove: function(D) { Lp(D) && this.update(D, this.sv.isContinuousLayout()) },
            handleWindowTouchEnd: function(m) {
                var $ = this;
                $.update(m, !0), $.sv.setStatus(ul), $.maskDiv && tp($.maskDiv), $.resizeDiv && tp($.resizeDiv), $.maskDiv = $.resizeDiv = A
            },
            handle_mousedown: function(j) { pn(j) && this.handle_touchstart(j) },
            handleWindowMouseMove: function(X) { this.handleWindowTouchMove(X) },
            handleWindowMouseUp: function(e) { this.handleWindowTouchEnd(e) },
            update: function(n, L) {
                var i = this,
                    Q = i.sv,
                    V = po(Q) ? Q.getWidth() : Q.getHeight(),
                    g = Q._dividerSize,
                    Y = i._lastAbsPosition - i._86o;
                po(Q) ? (Y += Sp(n).x, Y > V - g && (Y = V - g), 0 > Y && (Y = 0), i.resizeDiv && (i.resizeDiv.style.left = Y + dd)) : (Y += Sp(n).y, Y > V - g && (Y = V - g), 0 > Y && (Y = 0), i.resizeDiv && (i.resizeDiv.style.top = Y + dd)), L && V !== g && (1 === Q._82O ? Q.setPosition(Y, 1) : -1 === Q._82O ? Q.setPosition(Y - V + g, 1) : Q.setPosition(Y / (V - g), 1))
            }
        }), et.TabView = function() {
            var U = this,
                k = U._view = oq(1, U),
                C = U._91O = sf(1),
                e = U._tabModel = new Fq,
                Q = e.sm(),
                W = U.invalidate;
            U._7o = new En, U._canvas = Sg(C), Ml(k, C), Ml(k, U._92O = sf(1)), Q.setSelectionMode(Gn), Q.ms(U.handleSelectionChange, U), e.mm(W, U), e.mh(W, U), e.md(W, U), U._interactor = new kt(U), U.iv()
        }, ft("TabView", n, {
            ms_v: 1,
            ms_fire: 1,
            ms_tx: 1,
            ms_ty: 1,
            ms_lp: 1,
            ms_ac: ["movable", "tabGap", "tabHeight", "tabPosition", oj, Vn, "tabHPadding", "tabBackground", "selectWidth", Kd, "moveBackground", "insertColor"],
            _tabHPadding: 0,
            _tabPosition: Gm,
            _tabHeight: Bf,
            _tabGap: D.tabViewTabGap,
            _labelColor: D.tabViewLabelColor,
            _labelFont: D.tabViewLabelFont,
            _tabBackground: D.tabViewTabBackground,
            _selectWidth: D.tabViewSelectWidth,
            _selectBackground: D.tabViewSelectBackground,
            _moveBackground: D.tabViewMoveBackground,
            _insertColor: D.tabViewInsertColor,
            _movable: !0,
            handleSelectionChange: function() { this._selectionChanged = !0, this.invalidate() },
            getContentDiv: function() { return this._92O },
            getTitleDiv: function() { return this._91O },
            getTabModel: function() { return this._tabModel },
            add: function(U, c, B) { var x, T = this._tabModel; return U instanceof gt ? (x = U, c && x.setView(c)) : (x = new gt, x.setName(U), x.setView(c)), T.add(x), B && T.sm().ss(x), x },
            getLabel: function(J) { return J.toLabel() },
            onPropertyChanged: function() { this.iv() },
            _7Q: function(s) { this._23o = s, this.iv() },
            get: function(T) {
                var k = this,
                    J = k._tabModel;
                if (lc(T)) return J._roots.get(T);
                if (Ok(T)) { var X; return J.each(function(G) { T === k.getLabel(G) && (X = G) }), X }
                return T instanceof gt ? T : A
            },
            select: function(e) { this._tabModel.sm().ss(this.get(e)) },
            remove: function(z) {
                var y = this;
                if (z = y.get(z)) {
                    var h = y._tabModel,
                        k = h._roots.indexOf(z);
                    y._tabModel.remove(z), y.selectByIndex(--k)
                }
            },
            getCurrentTab: function() { return this._8o },
            hideTabView: function(o, w) { w.parentNode === this._92O && (jd(w) ? (w.style.display = xo, w._tab_ = o) : tp(w), Hd()) },
            showTabView: function(R, q) { jd(q) && (q.style.display = "block", q._tab_ = R), q.parentNode !== this._92O && (Ml(this._92O, q), Hd()) },
            _24o: function() {
                var b, K = this,
                    z = K._8o,
                    A = K._9o,
                    U = K._tabModel.sm().ld();
                U && (b = rf(U.getView())), b !== A && (A && (z.getView() && z.getView().endEditing && z.getView().endEditing(), K.hideTabView(z, A)), b && K.showTabView(U, b)), K._8o = U, K._9o = b, z !== U && K.onTabChanged(z, U)
            },
            onTabClosing: function() { return !0 },
            onTabChanged: function() {},
            onTabClosed: function(l, d) { this.selectByIndex(--d) },
            selectByIndex: function(m) {
                var K = this,
                    q = K._tabModel,
                    B = q.size();
                if (B && !q.sm().ld()) {
                    m == A && (m = 0), m >= B && (m = B - 1), 0 > m && (m = 0);
                    for (var g = m; g >= 0; g--) { var j = K.get(g); if (!j.isDisabled()) return K.select(j), j }
                    for (g = m + 1; B > g; g++)
                        if (j = K.get(g), !j.isDisabled()) return K.select(j), j
                }
            },
            getTabWidth: function(c) {
                var s = this.getTabHPadding(),
                    u = 4 + 2 * s,
                    I = Jc(c.getIcon());
                I && (u += Hc(I, c) + 4);
                var D = this.getLabel(c);
                return D && (u += Pg(this.getLabelFont(c), D).width + 4), c.isClosable() && (u += 10), u
            },
            drawTab: function(h, k, M, A, d, Q, F) {
                var c, j = this,
                    x = j._tabPosition,
                    H = this.getTabHPadding(),
                    E = M + 4 + H,
                    V = j._selectWidth,
                    T = Jc(k.getIcon()),
                    B = k.isDisabled(),
                    X = j.getLabelColor(k),
                    r = j.getLabelFont(k),
                    n = j.getLabel(k),
                    z = j._selectBackground,
                    e = x === Ui + "-vertical",
                    K = x === Ul + "-vertical";
                (e || K) && (E = A + 4 + H), B && (h.globalAlpha = gl), re(h, M, A, d, Q, F), k === j._8o && V && (x === Gm ? re(h, M, A + Q - V, d, V, z) : x === Ui ? re(h, M + d - V, A, V, Q, z) : x === Ul ? re(h, M, A, V, Q, z) : e ? re(h, M + d - V, A, V, Q, z) : K ? re(h, M, A, V, Q, z) : re(h, M, A, d, V, z));
                var s = d / 2;
                if (e && (ts(h, s, A + Q / 2), nm(h, U), ts(h, -s, -A - Q / 2)), T) {
                    var i = Gp(T, k),
                        p = Hc(T, k);
                    if (e || K) {
                        var R = M + d / 2,
                            I = E + i / 2;
                        ts(h, R, I), nm(h, Z), ts(h, -R, -I), Gj(h, T, M + d / 2, E + i / 2, k, j), ts(h, R, I), nm(h, -Z), ts(h, -R, -I), E += i + 4
                    } else Gj(h, T, E + p / 2, A + Q / 2, k, j), E += p + 4
                }
                return e || K ? (ts(h, d / 2, E + d / 2), nm(h, Z), ts(h, -d / 2, -E - d / 2), hg(h, n, r, X, M, E, Q, d), ts(h, d / 2, E + d / 2), nm(h, -Z), ts(h, -d / 2, -E - d / 2)) : hg(h, n, r, X, E, A, d, Q), e && (ts(h, s, A + Q / 2), nm(h, -U), ts(h, -s, -A - Q / 2)), k.isClosable() && (c = K ? { x: M + d - 12, y: A + Q - 12, width: 12, height: 12 } : { x: M + d - 12, y: A + 2, width: 12, height: 12 }, this.drawCloseIcon(k, h, X, c)), B && (h.globalAlpha = 1), c
            },
            drawCloseIcon: function(A, $, m, n) {
                var Z = n.x,
                    a = n.y;
                $.strokeStyle = m, $.lineWidth = 1, $.beginPath(), $.moveTo(Z + 2, a + 8), $.lineTo(Z + 8, a + 2), $.moveTo(Z + 8, a + 8), $.lineTo(Z + 2, a + 2), $.stroke()
            },
            getTabAt: function(U) { var p = this._interactor._8Q(U); return p ? p.tab : null },
            validateImpl: function() {
                var z = this;
                z._24o();
                var M, E = z._canvas,
                    l = z._tabPosition,
                    q = z._91O,
                    a = z._92O,
                    t = z._tabModel,
                    o = z.getWidth(),
                    j = z.getHeight(),
                    m = z._tabHeight,
                    d = z._7o,
                    s = z._tabGap,
                    w = l === Gm,
                    U = l === Ui,
                    c = l === Ul,
                    Y = l === Ui + "-vertical",
                    J = l === Ul + "-vertical",
                    _ = z._23o,
                    F = 0;
                if ((U || c) && t._roots.each(function(q) { F = K(z.getTabWidth(q), F) }), w ? (dq(q, 0, 0, o, m), M = { x: 0, y: m, width: o, height: K(0, j - m) }) : U ? (dq(q, 0, 0, F, j), M = { x: F, y: 0, width: K(0, o - F), height: j }) : c ? (dq(q, o - F, 0, F, j), M = { x: 0, y: 0, width: K(0, o - F), height: j }) : Y ? (dq(q, 0, 0, m, j), M = { x: m, y: 0, width: K(0, o - m), height: j }) : J ? (dq(q, o - m, 0, m, j), M = { x: 0, y: 0, width: K(0, o - m), height: j }) : (dq(q, 0, j - m, o, m), M = { x: 0, y: 0, width: o, height: K(0, j - m) }), dq(a, M), Y || J) {
                    z._9o && (M.x = 0, dq(z._8o.getView(), M)), Cq(E, m, j);
                    var O = Bp(E),
                        C = 0;
                    if (Yk(O, 0, z.ty(), 1), O.clearRect(0, 0, m, j), d.clear(), t._roots.each(function(R) {
                            if (R.isVisible()) {
                                var w, S = z.getTabWidth(R);
                                if (!_ || _.tab !== R) {
                                    var f = z.getTabBackground(R);
                                    w = z.drawTab(O, R, 0, C, m, S, f)
                                }
                                d.add({ _75o: w, tab: R, startY: C, endY: C + S, height: S }), C += S + s
                            }
                        }), z._23Q = K(0, C - s), _) {
                        var Z = _.position;
                        z.drawTab(O, _.tab, 0, _.startY, m, _.height, z._moveBackground), re(O, 0, Z, m, 1, z._insertColor)
                    }
                    if (O.restore(), z._selectionChanged) { z._selectionChanged = !1; for (var V = z.ty(), n = 0; n < d.size(); n++) { var u = d.get(n); if (u.tab === z._8o) { if (u.endY + V < 0) { z.ty(-u.startY); break } if (u.startY + V > j) { z.ty(j - u.endY); break } } } }
                    z.ty(z.ty())
                } else if (U || c) {
                    z._9o && (M.x = 0, dq(z._8o.getView(), M)), Cq(E, F, j);
                    var O = Bp(E),
                        C = 0;
                    if (Yk(O, 0, z.ty(), 1), O.clearRect(0, 0, F, j), d.clear(), t._roots.each(function(k) {
                            if (k.isVisible()) {
                                var I;
                                if (!_ || _.tab !== k) {
                                    var v = z.getTabBackground(k);
                                    I = z.drawTab(O, k, 0, C, F, m, v)
                                }
                                d.add({ _75o: I, tab: k, startY: C, endY: C + m, height: m }), C += m + s
                            }
                        }), z._23Q = K(0, C - s), _) {
                        var Z = _.position;
                        z.drawTab(O, _.tab, 0, _.startY, F, _.height, z._moveBackground), re(O, 0, Z, F, 1, z._insertColor)
                    }
                    if (O.restore(), z._selectionChanged) { z._selectionChanged = !1; for (var V = z.ty(), n = 0; n < d.size(); n++) { var u = d.get(n); if (u.tab === z._8o) { if (u.endY + V < 0) { z.ty(-u.startY); break } if (u.startY + V > j) { z.ty(j - u.endY); break } } } }
                    z.ty(z.ty())
                } else {
                    z._9o && (M.y = 0, dq(z._8o.getView(), M)), Cq(E, o, m);
                    var O = Bp(E),
                        Q = 0;
                    if (Yk(O, z.tx(), 0, 1), O.clearRect(0, 0, o, m), d.clear(), t._roots.each(function(y) {
                            if (y.isVisible()) {
                                var P, w = z.getTabWidth(y);
                                if (!_ || _.tab !== y) {
                                    var Z = z.getTabBackground(y);
                                    P = z.drawTab(O, y, Q, 0, w, m, Z)
                                }
                                d.add({ _75o: P, tab: y, startX: Q, endX: Q + w, width: w }), Q += w + s
                            }
                        }), z._64I = K(0, Q - s), _) {
                        var Z = _.position;
                        z.drawTab(O, _.tab, _.startX, 0, _.width, m, z._moveBackground), pg(O, z._insertColor, Z, 0, m)
                    }
                    if (O.restore(), z._selectionChanged) { z._selectionChanged = !1; for (var f = z.tx(), n = 0; n < d.size(); n++) { var u = d.get(n); if (u.tab === z._8o) { if (u.endX + f < 0) { z.tx(-u.startX); break } if (u.startX + f > o) { z.tx(o - u.endX); break } } } }
                    z.tx(z.tx())
                }
                for (var $ = [], h = a.children, n = 0; n < h.length; n++) {
                    var D = h[n],
                        G = D._tab_;
                    G && !t.contains(G) && $.push(D)
                }
                $.forEach(function(t) { a.removeChild(t) })
            }
        });
        var kt = function(e) { this.tv = e, this.addListeners() };
        eh(kt, n, {
            ms_listener: 1,
            getView: function() { return this.tv._91O },
            handle_mousewheel: function(b) { this.handleScroll(b, 10 * (b.wheelDelta / 40)) },
            handle_DOMMouseScroll: function(d) { this.handleScroll(d, 10 * -d.detail) },
            handleScroll: function(e, W) {
                sh(e);
                var _ = this.tv,
                    B = _._tabPosition;
                !_._40o() || B !== Gm && B !== uq || _.tx(this.tv.tx() + W), !_._41o() || B !== Ui && B !== Ul && B !== Ui + "-vertical" && B !== Ul + "-vertical" || _.ty(this.tv.ty() + W)
            },
            _8Q: function(R) {
                var C, k, O = this.tv,
                    g = O._tabPosition,
                    e = O._7o;
                if (g === Gm || g === uq) {
                    var V = O.lp(R).x;
                    for (C = 0; C < e.size(); C++)
                        if (k = e.get(C), k.startX <= V && V <= k.endX) return k
                } else if (g === Ui || g === Ul || g === Ui + "-vertical" || g === Ul + "-vertical") {
                    var h = O.lp(R).y;
                    for (C = 0; C < e.size(); C++)
                        if (k = e.get(C), k.startY <= h && h <= k.endY) return k
                }
                return A
            },
            isClickable: function(w) {
                var U = this.tv,
                    $ = U._tabPosition,
                    D = this._73o = this._8Q(w);
                return !U._40o() || $ !== Gm && $ !== uq ? !U._41o() || $ !== Ui && $ !== Ul && $ !== Ui + "-vertical" && $ !== Ul + "-vertical" ? D && (!D.tab.isDisabled() || U.isMovable()) : !0 : !0
            },
            handle_mousemove: function(V) {
                var a = this;
                nj ? a._74o = a._8Q(V) : a.getView().style.cursor = a.isClickable(V) ? Kj : ""
            },
            handle_mousedown: function(t) { this.handle_mousemove(t), this.handle_touchstart(t) },
            handle_touchstart: function(C) {
                var z = this,
                    h = z.tv,
                    S = h._tabPosition;
                sh(C), pn(C) && z.isClickable(C) && (S === Gm || S === uq ? (z.x = Sp(C).x, z.lp = h.lp(C), z.tx = h.tx()) : (z.y = Sp(C).y, z.lp = h.lp(C), z.ty = h.ty()), zi(z, C))
            },
            handleWindowMouseMove: function(Y) { this.handleWindowTouchMove(Y) },
            handleWindowTouchMove: function(Q) {
                var t, A = this,
                    R = A.tv,
                    e = R._tabPosition,
                    n = A._73o;
                if (e === Gm || e === uq) {
                    if (t = Sp(Q).x - A.x, !A._25o && !A.moving && X(t) > 2 && (R._40o() && !Xn(Q) ? A._25o = 1 : n && R.isMovable() && (A.moving = 1)), A._25o) R.tx(A.tx + t);
                    else if (A.moving) {
                        var d = A.lp.x + t,
                            v = R._tabGap / 2;
                        R._7o.each(function(F) {
                            var r = F.endX,
                                S = d - F.startX < r - d;
                            d >= F.startX && r >= d && R._7Q({ tab: n.tab, startX: n.startX + t, width: n.width, front: S, insertTab: F.tab, position: S ? K(0, F.startX - v) : i(R._64I, r + v) })
                        })
                    }
                } else if (t = Sp(Q).y - A.y, !A._25o && !A.moving && X(t) > 2 && (R._41o() && !Xn(Q) ? A._25o = 1 : n && R.isMovable() && (A.moving = 1)), A._25o) R.ty(A.ty + t);
                else if (A.moving) {
                    var E = A.lp.y + t,
                        v = R._tabGap / 2;
                    R._7o.each(function(k) {
                        var e = k.endY,
                            V = E - k.startY < e - E;
                        E >= k.startY && e >= E && R._7Q({ tab: n.tab, startY: n.startY + t, height: n.height, front: V, insertTab: k.tab, position: V ? K(0, k.startY - v) : i(R._23Q, e + v) })
                    })
                }
            },
            handleWindowMouseUp: function(k) { this.handleWindowTouchEnd(k) },
            handleWindowTouchEnd: function() {
                var b = this,
                    R = b.tv,
                    t = R._tabPosition,
                    N = R.getTabModel(),
                    o = N._roots,
                    I = b._73o;
                if (b.moving) {
                    var c = R._23o;
                    if (c && c.insertTab !== c.tab) {
                        var f = c.tab,
                            K = o.remove(f),
                            x = o.indexOf(c.insertTab);
                        x >= 0 && (c.front || x++, x <= o.size() && (o.add(f, x), N._38I(f, K, x)))
                    }
                    R._7Q(A), delete b.moving
                } else if (!b._25o && I) {
                    f = I.tab;
                    var p = b._74o;
                    if (!p || p.tab === f)
                        if (!f.isDisabled() && Df(I._75o, b.lp)) {
                            var r = function() {
                                var I = o.indexOf(f);
                                N.remove(f), R.onTabClosed(f, I)
                            };
                            R.onTabClosing(f, r) && r()
                        } else f.isDisabled() || R._8o === f || N.sm().ss(f)
                }
                b._25o = b._73o = b._74o = t === Gm || t === uq ? b.x = b.lp = b.tx = A : b.y = b.lp = b.ty = A
            }
        }), et.PropertyView = function(G) {
            var c = this;
            c._view = oq(1, c), c._canvas = Sg(c._view), Ml(c._view, c._79O = sf()), c._rows = new En, c._28o = new En, c._26o = {}, c._26Q = {};
            var V = c._propertyModel = new Fq,
                j = c.ivm;
            V.mm(j, c), V.md(j, c), V.mh(j, c), c.dm(G ? G : new Fq), new lt(c)
        }, ft("PropertyView", n, {
            ms_ac: [oj, cc, Vn, wi, wc, "categorizable", hi, Ao, jl, Pd, xe, gc, ml, To, "selectRowIndex", Kd, "background", bh, ns, tg, Sh, br],
            ms_v: 1,
            ms_dm: 1,
            ms_fire: 1,
            ms_sm: 1,
            _49o: 1,
            ms_txy: 1,
            ms_lp: 1,
            ms_vs: 1,
            _45o: 1,
            _47o: 1,
            ms_tip: 1,
            _29I: Xo,
            _59I: 0,
            _9I: 0,
            _selectRowIndex: -1,
            _editable: !0,
            _batchEditable: !0,
            _categorizable: !0,
            _indent: Ef,
            _background: D.propertyViewBackground,
            _expandIcon: D.propertyViewExpandIcon,
            _collapseIcon: D.propertyViewCollapseIcon,
            _scrollBarColor: aq,
            _scrollBarSize: Oq,
            _autoHideScrollBar: Br,
            _selectBackground: D.propertyViewSelectBackground,
            _rowHeight: rk,
            _rowLineVisible: D.propertyViewRowLineVisible,
            _rowLineColor: D.propertyViewRowLineColor,
            _10I: .5,
            _columnLineVisible: D.propertyViewColumnLineVisible,
            _columnLineColor: D.propertyViewColumnLineColor,
            _labelColor: D.propertyViewLabelColor,
            _labelSelectColor: D.propertyViewLabelSelectColor,
            _labelFont: D.propertyViewLabelFont,
            getRows: function() { return this._rows },
            getColumnPosition: function() { return this._10I },
            setColumnPosition: function(j) {
                0 > j && (j = 0), j > 1 && (j = 1);
                var y = this,
                    m = y._10I;
                y._10I = j, y.fp("columnPosition", m, j)
            },
            getPropertyName: function(j) { return j.toLabel() },
            getLabelFont: function() { return this._labelFont },
            getLabelColor: function(h, C, i) { return i === this._selectRowIndex ? this._labelSelectColor : this._labelColor },
            getPropertyFont: function() { return this._labelFont },
            getPropertyColor: function(Y, q) { return q === this._selectRowIndex ? this._labelSelectColor : Y.getColor() || this._labelColor },
            getCategoryFont: function() { return this._labelFont },
            getCategoryColor: function() { return this._labelColor },
            adjustTranslateX: function() { return 0 },
            adjustTranslateY: function(R) { var d = this.getHeight() - this._59I; return d > R && (R = d), R > 0 ? 0 : j(R) },
            isExpanded: function(r) { if (!r) return !0; var f = this._26o[r]; return f ? f.isExpanded : !(this._26Q[r] === !1) },
            toggle: function(h) {
                var f = this;
                f.isExpanded(h) ? f.collapse(h) : f.expand(h)
            },
            expandAll: function() { this.validate(); for (var C in this._26o) this.expand(C) },
            expand: function(h) {
                if (h && h !== xo) {
                    var O = this,
                        $ = O._26o[h];
                    $ && !$.isExpanded && ($.isExpanded = !0, O.onExpanded(h), O.ivm())
                }
            },
            onExpanded: function() {},
            collapseAll: function() { this.validate(); for (var x in this._26o) this.collapse(x) },
            collapse: function(i) {
                if (i && i !== xo) {
                    var E = this,
                        s = E._26o[i];
                    s && s.isExpanded && (s.isExpanded = !1, E.onCollapsed(i), E.ivm())
                }
            },
            onCollapsed: function() {},
            getCategoryName: function(p) { if (!this.isCategorizable()) return xo; var e = p.getCategoryName(); return e ? e : xo },
            getPropertyModel: function() { return this._propertyModel },
            handleSelectionChange: function() { this.ivm() },
            setDataModel: function(q) {
                var G = this,
                    g = G._dataModel;
                g !== q && (g && (g.umd(G.handlePropertyChange, G), G._selectionModel || g.sm().ums(G.handleSelectionChange, G)), G._dataModel = q, q.md(G.handlePropertyChange, G), G._selectionModel ? G._selectionModel._21I(q) : q.sm().ms(G.handleSelectionChange, G), G.fp(ll, g, q))
            },
            isVisible: function(S) { return this._visibleFunc ? this._visibleFunc(S) : !0 },
            onPropertyChanged: function(R) {
                var S = this,
                    e = R.property;
                _s[e] ? S.ivm() : S.iv(), e === So && S._43o()
            },
            getCurrentData: function() { return this._27o },
            updateCurrentData: function() { this._27o = this.sm().ld() },
            getRawProperties: function() { return this._27o ? this._propertyModel._roots : xg },
            handlePropertyChange: function(I) { this._27o === I.data && this.iv() },
            ivm: function() { this.invalidateModel() },
            invalidateModel: function() {
                var S = this;
                S._96I || (S.setSelectRowIndex(-1), S._96I = 1, S.iv())
            },
            redraw: function() { this.iv() },
            validateModel: function() {
                var v = this,
                    w = v._rows,
                    y = v._28o,
                    q = {},
                    K = new En,
                    X = v._27o;
                v.updateCurrentData(), X !== v._27o && v.endEditing(), w.clear(), y.clear(), v.getRawProperties().each(function(z) {
                    if (v.isVisible(z)) {
                        K.add(z);
                        var i = v.getCategoryName(z);
                        q[i] || (y.add(i, i === xo ? 0 : O), q[i] = { isExpanded: v.isExpanded(i), properties: new En })
                    }
                }), v._sortFunc && K.sort(v._sortFunc);
                for (var p in v._26o) v._26Q[p] = v.isExpanded(p);
                v._26o = q, y.each(function(W) {
                    W !== xo && w.add(W);
                    var p = q[W];
                    p.isExpanded && K.each(function(g) { v.getCategoryName(g) === W && (p.properties.add(g), w.add({ property: g, data: v._27o })) }, v)
                })
            },
            validateImpl: function() {
                var b = this;
                b._76o(), b._96I && (b.validateModel(), delete b._96I);
                var m = b._canvas,
                    R = b.getWidth(),
                    f = b.getHeight(),
                    O = -b.ty(),
                    z = b._rowHeight,
                    v = b._indent,
                    P = R - v,
                    t = b._rows,
                    Q = t.size(),
                    l = b._9I = v + P * b._10I,
                    S = b._59I = Q * z;
                Cq(m, R, f), b._29I = { x: 0, y: O, width: R, height: f }, b._31I = w(O / z), b._14I = x((O + f) / z), b._31I < 0 && (b._31I = 0), b._14I > Q && (b._14I = Q);
                var Z, J = Bp(m),
                    i = b._background;
                Yk(J, 0, -O, 1), J.beginPath(), J.rect(0, O, R, f), J.clip(), J.clearRect(0, O, R, f), b._93db(J), i && re(J, 0, 0, v, S, i);
                for (var K = b._31I; K < b._14I; K++) {
                    var p = t.get(K),
                        O = z * K;
                    if (Ok(p)) i && re(J, v, O, P, z, i), Z = Jc(b.isExpanded(p) ? b._expandIcon : b._collapseIcon), Z && Kq(J, Z, lp, 0, O, v, z), J.save(), J.beginPath(), J.rect(v, O, P, z), J.clip(), b.drawCategoryName(J, p, K, v, O, P, z), J.restore();
                    else {
                        var N = p.property,
                            W = p.data,
                            Z = Jc(N.getIcon()),
                            G = b._selectRowIndex === K ? b.getSelectBackground() : A;
                        if (Z && Kq(J, Z, lp, 0, O, v, z), G && re(J, v, O, P, z, G), J.save(), J.beginPath(), J.rect(v, O, l - v, z), J.clip(), b.drawPropertyName(J, N, K, v, O, l - v, z), J.restore(), !b.isEditing(W, N)) {
                            var e = l + 1,
                                _ = R - l - 1;
                            J.save(), J.beginPath(), J.rect(e, O, _, z), J.clip(), b._87o(b.drawPropertyValue(J, N, b.getValue(W, N), K, e, O, _, z, W), K, e, O, _, z), J.restore()
                        }
                    }
                    b._rowLineVisible && re(J, v, O + z - 1, P, 1, b._rowLineColor)
                }
                b._columnLineVisible && (re(J, l, 0, 1, S, b._columnLineColor), re(J, R - 1, 0, 1, S)), b._92db(J), b._93I(), J.restore(), b.ty(b.ty())
            },
            drawCategoryName: function(q, g, M, P, d, V, r) { hg(q, g, this.getCategoryFont(g), this.getCategoryColor(g), P, d, V, r) },
            drawPropertyName: function(a, j, c, f, X, p, K) { return j.drawPropertyName ? (j.drawPropertyName(a, j, c, f, X, p, K, this), void 0) : (hg(a, this.getPropertyName(j), this.getPropertyFont(j, c), this.getPropertyColor(j, c), f, X, p, K), void 0) },
            drawPropertyValue: function(u, d, s, x, Z, b, Q, j, m) { return d.drawPropertyValue ? d.drawPropertyValue(u, d, s, x, Z, b, Q, j, m, this) : (bt(u, s, d, this.getLabelFont(d, s, x), this.getLabelColor(d, s, x), Z, b, Q, j, m, this), void 0) },
            isPropertyEditable: function(q) { return q.isEditable() && this.isEditable() },
            setProperties: function(e) { this._propertyModel.clear(), this.addProperties(e) },
            addProperties: function(E) {
                if (E) {
                    var y = this._propertyModel;
                    E.forEach(function(C) {
                        if (!(C instanceof it)) {
                            var l = pm(C.className);
                            C = cj(l ? l : it, C)
                        }
                        y.add(C)
                    })
                }
            },
            getRowIndexAt: function(p) {
                var H = this,
                    X = w(H.lp(p).y / H._rowHeight);
                return X >= 0 && X < H._rows.size() ? X : -1
            },
            getPropertyAt: function(e) {
                var b = this,
                    U = b.getRowIndexAt(e);
                return U >= 0 ? b._rows.get(U).property : A
            },
            getToolTip: function(r) {
                var U = this,
                    o = U.getPropertyAt(r),
                    X = U._27o;
                return o && X ? o.getToolTip(X, U._9I < U.lp(r).x, U) : A
            }
        });
        var lt = function(x) { this.pv = x, this.addListeners() };
        eh(lt, n, {
            ms_listener: 1,
            getView: function() { return this.pv._view },
            setCursor: function(x) { this.getView().style.cursor = x },
            clear: function() {
                var O = this;
                O._62O = O.cp = O.ty = O.p = A, O.setCursor(Tb)
            },
            handle_mousedown: function(K) { this.handle_touchstart(K) },
            handle_touchstart: function(F) {
                var g = this,
                    G = g.pv;
                sh(F), G.setFocus(F) && (pn(F) ? (g.cp = Sp(F), g.ty = G.ty(), g.p = G.getColumnPosition(), g.handle_touchmove(F)) : G.setSelectRowIndex(G.getRowIndexAt(F)))
            },
            handleWindowMouseUp: function() { this.clear() },
            handleWindowTouchEnd: function() { this.clear() },
            handle_mouseup: function(d) { this.handle_touchend(d) },
            handle_touchend: function(O) {
                var _ = this;
                if (_.cp && !_._62O) {
                    var K = _.pv,
                        h = K.lp(O),
                        I = h.x,
                        U = h.y,
                        t = K._indent,
                        c = K.getRowIndexAt(O),
                        G = K._9I;
                    if (c >= 0) {
                        var $ = K._rowHeight,
                            j = $ * c,
                            B = K._rows.get(c),
                            n = B.property;
                        if (Ok(B)) Jc(K.isExpanded(B) ? K._expandIcon : K._collapseIcon) && I >= 0 && t >= I && U >= j && j + $ >= U ? K.toggle(B) : Mp(O) && K.toggle(B);
                        else if (I > G && K.isPropertyEditable(n, O)) {
                            var r = { x: G + 1, y: j, width: K.getWidth() - G - 1, height: $ },
                                u = { x: r.x + K.tx(), y: r.y + K.ty(), width: r.width, height: r.height },
                                T = 0,
                                m = K._29I;
                            r.y < m.y ? T = r.y - m.y : r.y + $ > m.y + m.height && (T = r.y + $ - m.y - m.height), T && (K.ty(K.ty() - T), u.y -= T), K.beginEditing({ data: B.data, property: n, value: K.getValue(B.data, n), event: O, rect: r, editorRect: u, view: K })
                        }
                    }
                    K.setSelectRowIndex(c)
                }
                _.clear()
            },
            handleWindowMouseMove: function(i) { this.handleWindowTouchMove(i) },
            handleWindowTouchMove: function(Y) {
                var $ = this,
                    r = $.pv,
                    z = $.ty,
                    Q = $.cp,
                    c = Sp(Y),
                    d = $._62O;
                if ("p" === d) r.setTranslateY(z + c.y - Q.y);
                else if ("c" === d) {
                    var O = r.getWidth() - r._indent;
                    if (O > 16) {
                        var W = $.p - (Q.x - c.x) / O,
                            n = 16 / O;
                        n > W && (W = n), W > 1 - n && (W = 1 - n), r.setColumnPosition(W)
                    }
                } else "s" === d && r.setTranslateY(z + (Q.y - c.y) * r._59I / r._29I.height)
            },
            handle_mousemove: function(g) { this.handle_touchmove(g) },
            handle_touchmove: function(p) {
                if (!nj && pn(p)) {
                    var y = this,
                        q = y.pv,
                        s = X(q.lp(p).x - q._9I) <= (Po ? 8 : 3);
                    y.cp ? y._62O || (s ? (y._62O = "c", zi(y, p)) : X(Sp(p).y - y.cp.y) >= 2 && (y._62O = y.isV(p) ? "s" : "p", zi(y, p))) : (s ? y.setCursor(Or) : y.setCursor(Tb), y.isV(p) && q._43o())
                }
            },
            isV: function(j) {
                var n = this.pv,
                    $ = n._29I;
                return n._41o() && $.x + $.width - n.lp(j).x < Xb
            },
            handle_mousewheel: function(z) { this.handleScroll(z, z.wheelDelta / 40) },
            handle_DOMMouseScroll: function(L) { 2 === L.axis && this.handleScroll(L, -L.detail) },
            handleScroll: function(W, C) {
                var I = this.pv;
                sh(W), I.endEditing(), I.translate(0, C * I.getRowHeight())
            },
            handle_keydown: function(H) {
                var X = this.pv,
                    t = X._rows.size(),
                    r = X._selectRowIndex + (Yi(H) ? -1 : 1);
                (Yi(H) || gg(H)) && (0 > r && (r = 0), r >= t && (r = t - 1), X.setSelectRowIndex(r))
            }
        }), et.ListView = function(s) { this._5o(s), new mt(this) }, ft("ListView", n, {
            ms_ac: [oj, cc, Vn, bh, hi, ns, tg, Ao, jl, gc, ml, To, Ep, Kd],
            ms_v: 1,
            ms_bnb: 1,
            ms_tip: 1,
            ms_fire: 1,
            ms_sm: 1,
            _49o: 1,
            ms_txy: 1,
            ms_lp: 1,
            ms_vs: 1,
            ms_hs: 1,
            _15Q: 1,
            _14Q: 1,
            ms_dm: 1,
            _45o: 1,
            _checkMode: !1,
            _indent: Ef,
            _rowHeight: rk,
            _rowLineVisible: D.listViewRowLineVisible,
            _rowLineColor: D.listViewRowLineColor,
            _scrollBarColor: aq,
            _scrollBarSize: Oq,
            _autoMakeVisible: Yc,
            _autoHideScrollBar: Br,
            _selectBackground: D.listViewSelectBackground,
            _labelColor: D.listViewLabelColor,
            _labelSelectColor: D.listViewLabelSelectColor,
            _labelFont: D.listViewLabelFont,
            isCheckMode: function() { return this._checkMode },
            setCheckMode: function(n) {
                var T = this,
                    m = T._checkMode;
                T._checkMode = n, T.fp(Pm, m, n)
            },
            drawRow: function(O, U, $, n, u, h, c) {
                var S = this,
                    H = 0,
                    D = S._indent,
                    E = S.getIconWidth(U);
                S.drawRowBackground(O, U, $, n, u, h, c), S._checkMode && (Gj(O, Jc(S.getCheckIcon(U)), H + D / 2, u + c / 2, U, S), H += D), S.drawIcon(O, U, H, u, E, c), S.drawLabel(O, U, H + E, u, c)
            }
        });
        var mt = function(k) { this.list = k, this.addListeners() };
        eh(mt, n, {
            ms_listener: 1,
            getView: function() { return this.list._view },
            clear: function(s) {
                var x = this,
                    q = x.list;
                s && "d" === x._62O && !x.dragCancel && q.handleDragAndDrop(s, "end"), q.draggingData && (q.draggingData = null, q.redraw()), x.dragCancel = x._62O = x._isV = x._isH = x.cp = x.tx = x.ty = A
            },
            handle_mousedown: function(I) { this.handle_touchstart(I) },
            handle_touchstart: function(Z) {
                var q = this,
                    K = q.list;
                if (sh(Z), K.setFocus(Z)) {
                    var e = K.getDataAt(Z);
                    q.cp = Sp(Z), q.tx = K.tx(), q.ty = K.ty(), pn(Z) ? e && K.handleDragAndDrop && !q.isV(Z) && !q.isH(Z) && (K.draggingData = e, K.redraw(), K.handleDragAndDrop(Z, "prepare")) : (e ? q._33o(Z, e) : this._cancelDataDoubleSelect(), q.clear(Z))
                }
            },
            handleWindowMouseUp: function(t) { this.clear(t) },
            handleWindowTouchEnd: function(W) { this.clear(W) },
            handle_mouseup: function(j) { this.handle_touchend(j) },
            handle_touchend: function(H) {
                var U = this,
                    Z = U.list;
                if (!U._isV && !U._isH && U.cp && !U._62O) {
                    var v = Z.getDataAt(H);
                    v ? (Z.isCheckMode() ? U._34o(H, v) : U._33o(H, v), Mp(H) ? Z.onDataDoubleClicked(v, H) : Z.onDataClicked(v, H)) : (U._cancelDataDoubleSelect(), Z.handleBackgroundClick(H))
                }
                U.clear(H)
            },
            handleWindowMouseMove: function(W) { this.handleWindowTouchMove(W) },
            handleWindowTouchMove: function(o) {
                var J = this,
                    g = J.list,
                    c = J._62O,
                    _ = J.tx,
                    F = J.ty,
                    S = J.cp,
                    l = Sp(o),
                    X = g._29I;
                "p" === c ? g.setTranslate(_ + l.x - S.x, F + l.y - S.y) : "v" === c ? g.ty(F + (S.y - l.y) * g._59I / X.height) : "h" === c ? g.tx(_ + (S.x - l.x) * g._91I / X.width) : "d" === c && (J.dragCancel || g.handleDragAndDrop(o, "between"))
            },
            handle_mousemove: function(g) { this.handle_touchmove(g) },
            handle_touchmove: function(X) {
                if (!nj && pn(X)) {
                    var d = this,
                        e = d.list;
                    if (d._isV = d.isV(X), d._isH = d.isH(X), d.cp) {
                        if (!d._62O) {
                            if (_q(Sp(X), d.cp) < 2) return;
                            d._isV ? d._62O = "v" : d._isH ? d._62O = "h" : e.draggingData && !this.dragCancel ? (d._62O = "d", e.handleDragAndDrop(X, "begin")) : d._62O = "p", d._62O && "d" !== d._62O && e.draggingData && (e.draggingData = null, e.redraw()), zi(d, X)
                        }
                    } else d._isV && e._43o(), d._isH && e._42o()
                }
            },
            isV: function(A) {
                var y = this.list,
                    u = y._29I;
                return y._41o() && u.x + u.width - y.lp(A).x < Xb
            },
            isH: function(J) {
                var w = this.list,
                    V = w._29I;
                return w._40o() && V.y + V.height - w.lp(J).y < Xb
            },
            handle_mousewheel: function(Z) { this.handleScroll(Z, Z.wheelDelta / 40, Z.wheelDelta !== Z.wheelDeltaX) },
            handle_DOMMouseScroll: function(V) { this.handleScroll(V, -V.detail, 1) },
            handleScroll: function(t, K, X) {
                var d = this.list;
                sh(t), d.endEditing && d.endEditing(), X && d._41o() ? d.translate(0, K * d.getRowHeight()) : d._40o() && d.translate(10 * K, 0)
            },
            handle_keydown: function(q) {
                if (!D.isInput(q.target)) {
                    var c, t = this.list,
                        j = t.sm(),
                        o = t._rows,
                        r = o.size();
                    if (Bo(q)) t.selectAll();
                    else if (Tp(q)) t.handleDelete && t.handleDelete(q);
                    else if (nc(q)) "d" !== this._62O || this.dragCancel || (t.handleDragAndDrop(q, "cancel"), this.dragCancel = !0);
                    else if (wd(q)) t.isCheckMode() && (c = t.getFocusData(), c && t.checkData(c));
                    else if (Yi(q) || gg(q)) {
                        var T = t.isCheckMode();
                        if (c = T ? t.getFocusData() : j.ld()) {
                            var I = t.getRowIndex(c);
                            I >= 0 && (Yi(q) ? 0 !== I && (c = o.get(I - 1), T ? t.setFocusData(c) : j.ss(c)) : I !== r - 1 && (c = o.get(I + 1), T ? t.setFocusData(c) : j.ss(c)))
                        } else r > 0 && (c = o.get(0), T ? t.setFocusData(c) : j.ss(c))
                    }
                }
            },
            _34o: function(G, l) {
                var S = this.list,
                    b = S.lp(G).x;
                return b >= 0 && b <= S._indent ? (S.checkData(l), void 0) : (S.setFocusData(l), void 0)
            },
            _33o: function(N, R) {
                var v = this.list,
                    z = v.sm(),
                    e = z.ld();
                if (!v.canHandleSelectMode(N, R)) return this._cancelDataDoubleSelect(), void 0;
                if (Xn(N)) v.isSelected(R) ? z.rs(R) : z.as(R);
                else if (eq(N))
                    if (e)
                        for (var B = v.getRowIndex(e), r = v.getRowIndex(R); B !== r;) B += r > B ? 1 : -1, z.as(v._rows.get(B));
                    else z.ss(R);
                else pn(N) ? (z.contains(R) ? v.handleDataDoubleSelect && (this._handleDataDoubleSelect(N, R), Mp(N) && this._cancelDataDoubleSelect()) : this._cancelDataDoubleSelect(), z.ss(R)) : z.contains(R) || z.ss(R)
            },
            _handleDataDoubleSelect: function(J, G) { this._cancelDataDoubleSelect(), this._doubleSelectTimer = Ig(function() { this.list.handleDataDoubleSelect(J, G), this._doubleSelectTimer = O }.bind(this), D.doubleClickSpeed) },
            _cancelDataDoubleSelect: function() { this._doubleSelectTimer && (pe(this._doubleSelectTimer), this._doubleSelectTimer = O) }
        }), et.TreeView = function(q) {
            var k = this;
            k._35o(), k._5o(q), new nt(k)
        }, ft("TreeView", n, {
            ms_ac: [oj, cc, Vn, "rootVisible", Pm, "rootData", Ao, jl, gc, ml, To, hi, bh, ns, tg, Pd, xe, Ep, Kd, "loader", "doubleClickToToggle"],
            ms_v: 1,
            ms_bnb: 1,
            ms_tip: 1,
            ms_fire: 1,
            ms_sm: 1,
            _49o: 1,
            ms_txy: 1,
            ms_lp: 1,
            ms_vs: 1,
            ms_hs: 1,
            _15Q: 1,
            ms_dm: 1,
            _48o: 1,
            _14Q: 1,
            _45o: 1,
            _checkMode: A,
            _indent: Ef,
            _rowHeight: rk,
            _rowLineVisible: D.treeViewRowLineVisible,
            _rowLineColor: D.treeViewRowLineColor,
            _scrollBarColor: aq,
            _scrollBarSize: Oq,
            _autoHideScrollBar: Br,
            _expandIcon: D.treeViewExpandIcon,
            _collapseIcon: D.treeViewCollapseIcon,
            _autoMakeVisible: Yc,
            _selectBackground: D.treeViewSelectBackground,
            _labelColor: D.treeViewLabelColor,
            _labelSelectColor: D.treeViewLabelSelectColor,
            _labelFont: D.treeViewLabelFont,
            _doubleClickToToggle: D.treeViewDoubleClickToToggle,
            drawRow: function(n, O, s, _, R, D, c) {
                var o = this;
                o.drawRowBackground(n, O, s, _, R, D, c), o.drawTree(n, O, s, 0, R, D, c)
            },
            isOnToggleIcon: function(p) {
                var s = this.getDataAt(p);
                if (s) {
                    var x = this.getIndent(),
                        M = this.lp(p).x;
                    if (Jc(this.getToggleIcon(s))) { var w = x * this.getLevel(s); if (M >= w && w + x >= M) return !0 }
                }
                return !1
            }
        });
        var nt = function(N) { th(nt, this, [N]) };
        eh(nt, mt, {
            toggle: function(Q, o, z, q) {
                var $ = this.list,
                    r = $.lp(Q).x;
                if (Jc($.getToggleIcon(o))) { var H = z * q; if (r >= H && H + z >= r) return $.toggle(o), !0 }
                return $.isDoubleClickToToggle() && Mp(Q) ? ($.toggle(o), !0) : !1
            },
            _34o: function(b, K) {
                var $ = this.list,
                    I = $.lp(b).x,
                    W = $._levelMap[K._id],
                    U = $._indent,
                    e = U * (W + 1);
                return I >= e && e + U >= I ? ($.checkData(K), void 0) : (this.toggle(b, K, U, W) || $.setFocusData(K), void 0)
            },
            _33o: function(D, v) {
                var f = this,
                    l = f.list;
                if (!f.toggle(D, v, l._indent, l.getLevel(v)))
                    if (eq(D)) {
                        var x = l.sm();
                        if (x.size() > 0) {
                            for (var Q = l._rows, h = null, m = 0, N = Q.size(); N > m; m++)
                                if (l.isSelected(Q.get(m))) { h = m; break }
                            for (var E = null, m = Q.size() - 1; m >= 0; m--)
                                if (l.isSelected(Q.get(m))) { E = m; break }
                            var k, F, y = l.getRowIndex(v);
                            for (h > y ? (k = y - 1, F = h) : y > E ? (k = E, F = y) : (k = h, F = E); k !== F;) k++, x.as(l._rows.get(k))
                        } else x.ss(v)
                    } else nt.superClass._33o.call(f, D, v)
            },
            handle_keydown: function(B) {
                if (Dg(B) || Wg(B)) {
                    var j = this.list,
                        $ = j._rows,
                        r = j.isCheckMode(),
                        h = j.sm(),
                        O = r ? j.getFocusData() : h.ld();
                    O ? O.hasChildren() && (Dg(B) ? j.collapse(O) : j.expand(O)) : $.size() > 0 && (O = $.get(0), r ? j.setFocusData(O) : h.ss(O))
                } else nt.superClass.handle_keydown.call(this, B)
            }
        });
        var ot = et.TableView = function(B) { this._98I(), this._5o(B), new pt(this) };
        ft("TableView", n, {
            ms_ac: [oj, cc, Vn, "sortMode", wi, wc, bh, ns, tg, Sh, br, "sortColumn", Ao, jl, gc, ml, To, Ep, Kd],
            ms_v: 1,
            ms_fire: 1,
            ms_sm: 1,
            _49o: 1,
            ms_txy: 1,
            ms_lp: 1,
            ms_vs: 1,
            ms_hs: 1,
            _15Q: 1,
            ms_dm: 1,
            ms_tip: 1,
            _50o: 1,
            _45o: 1,
            _47o: 1,
            _sortMode: vh,
            _editable: !0,
            _batchEditable: !1,
            _rowHeight: rk,
            _rowLineVisible: D.tableViewRowLineVisible,
            _rowLineColor: D.tableViewRowLineColor,
            _columnLineVisible: D.tableViewColumnLineVisible,
            _columnLineColor: D.tableViewColumnLineColor,
            _scrollBarColor: aq,
            _scrollBarSize: Oq,
            _autoHideScrollBar: Br,
            _autoMakeVisible: Yc,
            _selectBackground: D.tableViewSelectBackground,
            _labelColor: D.tableViewLabelColor,
            _labelSelectColor: D.tableViewLabelSelectColor,
            _labelFont: D.tableViewLabelFont,
            getCheckColumn: function() {
                var G = this;
                if (!G._31o) {
                    var $ = G._31o = new ht;
                    $.setEditable(!0), $.setWidth(40), $.getValue = G.getCheckColumValue, $.drawCell = G.drawCheckColumnCell
                }
                return G._31o
            },
            isCheckMode: function() { return this._39o.contains(this._31o) },
            setCheckMode: function(R) {
                var u = this,
                    b = u._39o,
                    r = u.getCheckColumn();
                R !== u.isCheckMode() && (R ? b.add(r, 0) : b.remove(r), u.fp(Pm, !R, R))
            },
            getCheckColumValue: function(C, X, M) { return M.isSelected(C) },
            drawCheckColumnCell: function(P, K, $, p, Q, W, w, C, y) { Gj(P, y.getCheckIcon(K), Q + w / 2, W + C / 2, K, y) }
        });
        var pt = function(D) { th(pt, this, [D]) };
        eh(pt, mt, {
            _34o: function(t, n) {
                var p = this.list,
                    P = p._31o;
                if (p.isCellEditable(n, P, t)) {
                    var R = p._3Q(P),
                        y = p.lp(t).x;
                    if (R && y >= R.startX && y < R.startX + P.getWidth()) return p.checkData(n), void 0
                }
                p._37O(n, t), p.setFocusData(n)
            },
            _33o: function(b, a) { this.list._37O(a, b), pt.superClass._33o.apply(this, arguments) }
        });
        var qt = et.TreeTableView = function(w) {
                var N = this,
                    E = N._4o = new ht;
                N._35o(), N._98I(), N._5o(w), E.setDisplayName("Name"), E.setEditable(!0), E.setWidth(180), E.drawCell = rt, E.getValue = st, N._39o.add(E), new tt(N)
            },
            rt = function(k, g, z, N, b, j, r, K, l) { l.drawTree(k, g, z, b, j, r, K) },
            st = function(M, Z, v) { return v.getLabel(M) };
        ft("TreeTableView", n, { ms_ac: [oj, cc, Vn, "sortMode", wi, wc, hi, Pm, "rootData", "rootVisible", Ao, jl, "sortColumn", Pd, xe, gc, ml, To, Ep, tg, bh, ns, Sh, br, Kd, "loader"], ms_v: 1, ms_bnb: 1, ms_fire: 1, ms_sm: 1, _49o: 1, ms_txy: 1, ms_lp: 1, ms_vs: 1, ms_hs: 1, _15Q: 1, ms_dm: 1, ms_tip: 1, _50o: 1, _48o: 1, _14Q: 1, _45o: 1, _47o: 1, _sortMode: vh, _checkMode: A, _editable: !0, _batchEditable: !1, _indent: Ef, _rowHeight: rk, _rowLineVisible: D.treeTableViewRowLineVisible, _rowLineColor: D.treeTableViewRowLineColor, _columnLineVisible: D.treeTableViewColumnLineVisible, _columnLineColor: D.treeTableViewColumnLineColor, _expandIcon: D.treeTableViewExpandIcon, _collapseIcon: D.treeTableViewCollapseIcon, _scrollBarColor: aq, _scrollBarSize: Oq, _autoHideScrollBar: Br, _autoMakeVisible: Yc, _selectBackground: D.treeTableViewSelectBackground, _labelColor: D.treeTableViewLabelColor, _labelSelectColor: D.treeTableViewLabelSelectColor, _labelFont: D.treeTableViewLabelFont, getTreeColumn: function() { return this._4o } });
        var tt = function(N) { th(tt, this, [N]) };
        eh(tt, mt, {
            _34o: function(t, v) {
                var D = this.list,
                    A = D._4o,
                    d = D._3Q(A),
                    r = D.lp(t).x;
                if (d) {
                    var x = D._indent,
                        q = d.startX + x * D.getLevel(v);
                    if (Jc(D.getToggleIcon(v)) && r >= q && q + x >= r) return D.toggle(v), void 0;
                    if (D.isCellEditable(v, A) && (q += x, r >= q && q + x >= r)) return D.checkData(v), void 0
                }
                D._37O(v, t), D.setFocusData(v)
            },
            _33o: function(E, F) {
                var V = this.list,
                    o = V.lp(E).x;
                if (Jc(V.getToggleIcon(F))) {
                    var D = V._3Q(V._4o);
                    if (D) {
                        var m = V._indent,
                            P = D.startX + m * V.getLevel(F);
                        if (o >= P && P + m >= o) return V.toggle(F), void 0
                    }
                }
                V._37O(F, E), tt.superClass._33o.apply(this, arguments)
            }
        });
        var ut = et.TableHeader = function(x) {
            var $ = this,
                V = $._view = oq(1, $),
                U = $._39o = x.getColumnModel(),
                c = $.iv;
            $.tv = $._tableView = x, $._60I = new En, $._canvas = Sg(V), V.style.background = D.tableHeaderBackground || "", V.style.height = ks + dd, U.mm(c, $), U.md(c, $), U.mh(c, $), x.mp(function(E) {
                Xs[E.property] && $.iv()
            }, $), new vt($), $.iv()
        };
        ft("TableHeader", n, {
            ms_v: 1,
            ms_lp: 1,
            ms_fire: 1,
            ms_ac: ["checkIcon", "sortDescIcon", "sortAscIcon", oj, Vn, hi, "moveBackground", "insertColor", Sh, br, "resizable", "movable"],
            _checkIcon: Cr,
            _movable: !0,
            _resizable: !0,
            _labelColor: D.tableHeaderLabelColor,
            _labelFont: D.tableHeaderLabelFont,
            _columnLineColor: D.tableHeaderColumnLineColor,
            _columnLineVisible: D.tableHeaderColumnLineVisible,
            _sortDescIcon: D.tableHeaderSortDescIcon,
            _sortAscIcon: D.tableHeaderSortAscIcon,
            _moveBackground: D.tableHeaderMoveBackground,
            _insertColor: D.tableHeaderInsertColor,
            _indent: Ef,
            getCheckIcon: function() { return this._checkIcon },
            getTableView: function() { return this.tv },
            getLabel: function(u) { return u.toLabel() },
            getLabelFont: function() { return this._labelFont },
            getLabelColor: function(I) { return I.getColor() || this._labelColor },
            getLabelAlign: function(K) { return K._align },
            onPropertyChanged: function() { this.iv() },
            _5Q: function(V) { this._61I = V, this.iv() },
            getLogicalPoint: function(E) { return Mo(E, this._canvas, this.tv.tx()) },
            validateImpl: function() {
                var l = this,
                    B = l._canvas,
                    u = l.getWidth(),
                    T = l.getHeight(),
                    L = l.tv,
                    N = l._60I,
                    Q = l._61I,
                    I = -L.tx(),
                    x = 0;
                (u !== B.clientWidth || T !== B.clientHeight) && Cq(B, u, T), N.clear(), l._39o._roots.each(function(b) {
                    if (b.isVisible()) {
                        var J = x + b.getWidth();
                        I + u >= x && J >= I && N.add({ column: b, startX: x }), x = J
                    }
                });
                var C = Bp(B);
                if (Yk(C, -I, 0, 1), C.beginPath(), C.rect(I, 0, u, T), C.clip(), C.clearRect(I, 0, u, T), N.each(function(W) {
                        var Z = W.column,
                            x = W.startX,
                            s = Z.getWidth();
                        s > 0 && (C.save(), C.beginPath(), C.rect(x, 0, s, T), C.clip(), Q && Q.column === Z || l.drawColumn(C, Z, x, 0, s, T), l._columnLineVisible && re(C, x + s - 1, 0, 1, T, l._columnLineColor), C.restore())
                    }), Q) {
                    var v = Q.column,
                        x = Q.startX,
                        D = Q.position,
                        r = v.getWidth();
                    C.save(), C.beginPath(), C.rect(x, 0, r, T), C.clip(), C.fillStyle = l._moveBackground, C.fill(), l.drawColumn(C, v, x, 0, r, T), C.restore(), pg(C, l._insertColor, D, 0, T)
                }
                C.restore()
            },
            _6Q: function(K) { var Y = this.tv; return Y._31o === K && Y.sm().getSelectionMode() === Km },
            drawColumn: function(I, Y, C, F, v, H) {
                var R = this,
                    E = R.tv,
                    B = Jc(Y.getIcon()),
                    r = R.getLabelAlign(Y);
                if (R._6Q(Y)) {
                    var u = Jc(R._checkIcon);
                    Gj(I, u, C + v / 2, F + H / 2, Y, R)
                } else {
                    var f = R.getLabel(Y),
                        z = R.getLabelFont(Y),
                        t = R.getLabelColor(Y),
                        s = Pg(z, f).width,
                        T = B ? R._indent : 0;
                    r === Ui ? (B && Kq(I, B, lp, C, F, T, H), hg(I, f, z, t, C + T, F, v, H, Ui)) : r === Ul ? (B && Kq(I, B, lp, C + v - s - T, F, T, H), hg(I, f, z, t, C, F, v, H, Ul)) : (B && Kq(I, B, lp, C + (v - s - T) / 2, F, T, H), hg(I, f, z, t, C + (v - s + T) / 2, F, 0, H, Ui))
                }
                if (Y.isSortable() && E.getSortColumn() === Y && (B = Jc(Y.getSortOrder() === Kl ? R._sortAscIcon : R._sortDescIcon))) {
                    var x = Hc(B, Y) / 2 + 2;
                    Gj(I, B, r === Ul ? C + x : C + v - x, F + H / 2, Y, E)
                }
            }
        });
        var vt = function(K) {
            var n = this;
            n.th = K, n.tv = K._tableView, n.addListeners()
        };
        eh(vt, n, {
            ms_listener: 1,
            getView: function() { return this.th.getView() },
            setCursor: function(M) { this.getView().style.cursor = M },
            handle_mousemove: function(V) {
                if (!nj) {
                    var $ = this;
                    delete $._29o, $.setCursor(Tb);
                    for (var r = $.th, n = r._60I, S = r.lp(V).x, R = n.size() - 1; R >= 0; R--) {
                        var j = n.get(R),
                            Z = j.column,
                            g = j.startX + Z.getWidth();
                        if (r.isResizable() && X(g - S) <= (Po ? 10 : 3)) return $._29o = j, $.setCursor(Or), void 0;
                        S > j.startX && g > S && ($._29o = j), (Z.isClickable() || Z.isSortable() || r.isMovable() || $.tv.getCheckColumn && Z === $.tv.getCheckColumn()) && S > j.startX && g > S && $.setCursor(Kj)
                    }
                }
            },
            handle_mousedown: function(Z) { this.handle_touchstart(Z) },
            handle_touchstart: function(b) {
                var H = this;
                sh(b), H.tv.endEditing(), H.handle_mousemove(b), H._29o && (H.x = Sp(b).x, H.lx = H.th.lp(b).x, H.w = H._29o.column.getWidth(), zi(H, b))
            },
            handleWindowMouseMove: function(f) { this.handleWindowTouchMove(f) },
            handleWindowTouchMove: function(l) {
                var t = this,
                    Q = t.th,
                    s = t.getView().style.cursor,
                    U = t._29o,
                    h = Sp(l).x - t.x;
                if (t.resizing || t.moving || (s === Or ? t.resizing = 1 : Q.isMovable() && s === Kj && X(h) > 2 && (t.moving = 1)), t.resizing) U.column.setWidth(t.w + h);
                else if (t.moving) {
                    var n = t.lx + h;
                    Q._60I.each(function(K) {
                        var $ = K.startX,
                            x = $ + K.column.getWidth();
                        if (n >= $ && x >= n) {
                            var F = { column: U.column, startX: U.startX + h, front: x - n > n - $, insertColumn: K.column };
                            F.position = F.front ? $ : x, Q._5Q(F)
                        }
                    })
                }
            },
            _16Q: function(u, X) {
                var c = this,
                    g = c.tv,
                    r = c.th,
                    i = r._checkIcon;
                if (r._6Q(u)) {
                    var Q = Jc(i),
                        K = c.lx,
                        n = u.getWidth(),
                        e = Hc(Q, u);
                    if (K >= X + n / 2 - e && X + n / 2 + e >= K) {
                        r.setCheckIcon(i === dk ? Cr : dk);
                        var j = g.sm(),
                            h = g._rows;
                        return i === dk ? j.rs(h) : j.ss(h), g.onCheckColumnClicked(u), !0
                    }
                }
                return !1
            },
            handleWindowMouseUp: function($) { this.handleWindowTouchEnd($) },
            handleWindowTouchEnd: function(P) {
                var q = this,
                    b = q.tv,
                    V = q.th,
                    K = q._29o;
                if (q.moving) {
                    var R = V._61I;
                    if (R && R.insertColumn !== R.column) {
                        var L = R.column,
                            M = b.getColumnModel()._roots,
                            g = M.remove(L),
                            N = M.indexOf(R.insertColumn);
                        N >= 0 && (R.front || N++, N <= M.size() && (M.add(L, N), b.getColumnModel()._38I(L, g, N)))
                    }
                    V._5Q(A), delete q.moving
                } else if (!q.resizing && K) {
                    L = K.column;
                    var s = V.lp(P).x,
                        w = K.startX,
                        $ = !0;
                    if (V.onColumnClicked) {
                        var o = V.onColumnClicked(L, P, w);
                        o === !1 && ($ = !1)
                    }
                    if ($ && s >= w && s <= w + L.getWidth() && !q._16Q(L, w)) {
                        if (L.isSortable()) {
                            var x = b.getSortMode(),
                                O = L.getSortOrder();
                            x === vh ? b.getSortColumn() === L ? (O === Hi && b.setSortColumn(A), L.setSortOrder(O === Kl ? Hi : Kl)) : b.setSortColumn(L) : "bistate" === x && (b.getSortColumn() === L ? L.setSortOrder(O === Kl ? Hi : Kl) : b.setSortColumn(L))
                        }
                        b.onColumnClicked(L, P, w)
                    }
                }
                q._29o = q.resizing = q.x = q.lx = q.w = A
            }
        }), et.TablePane = function(y) { this.init(new ot(y)) }, ft("TablePane", n, { ms_v: 1, _44o: 1 }), et.TreeTablePane = function($) { this.init(new qt($)) }, ft("TreeTablePane", n, { ms_v: 1, _44o: 1 }), et.Toolbar = function(S) {
            var u = this,
                f = u._view = oq(1, u),
                F = f.style;
            F.background = D.toolbarBackground || "", F.height = Bf + dd, u._canvas = Sg(f), u._30o = new En, u._90I = new En, u.setItems(S || []), f.handleGroupSelectedChanged = function(E) {
                if (E.isSelected()) {
                    var n = E.getGroupId();
                    null != n && u._items.forEach(function(D) {
                        var W = D.element;
                        W && W !== E && W.setSelected && W.getGroupId && W.getGroupId() === n && W.setSelected(!1)
                    })
                }
            }, new wt(u)
        }, ft("Toolbar", n, {
            ms_v: 1,
            ms_fire: 1,
            ms_tx: 1,
            ms_lp: 1,
            ms_tip: 1,
            ms_value: 1,
            ms_ac: [kq, oj, Vn, cc, Kd, "itemGap", "separatorColor", "currentItem", "stickToRight"],
            _labelColor: D.toolbarLabelColor,
            _labelSelectColor: D.toolbarLabelSelectColor,
            _labelFont: D.toolbarLabelFont,
            _selectBackground: D.toolbarSelectBackground,
            _itemGap: D.toolbarItemGap,
            _separatorColor: D.toolbarSeparatorColor,
            _stickToRight: !1,
            getSumWidth: function() { return this._64I },
            getToolTip: function(L) { var S = this.getItemInfoAt(L); return S ? S.item.toolTip : A },
            getLabelColor: function(m) { return m && m.selected && m.type !== dk && m.type !== di ? this._labelSelectColor : this._labelColor },
            onPropertyChanged: function(l) { this.iv(), l.property === kq && this._items.forEach(function(k) { Nd(k) }) },
            redraw: function() { this.iv() },
            addItem: function(w, Y) {
                var h = this._items;
                Y == A ? h.push(w) : h.splice(Y, 0, w), this.fp(kq, A, h)
            },
            removeItem: function(q) {
                if (q)
                    for (var Y = this._items, h = 0; h < Y.length; h++) q === Y[h] && (Y.splice(h, 1), this.fp(kq, A, Y))
            },
            removeItemById: function(R) {
                if (R != A)
                    for (var n = this._items, c = 0; c < n.length; c++)
                        if (R === n[c].id) { var T = n.splice(c, 1)[0]; return this.fp(kq, A, n), T }
            },
            getItemById: function(p) {
                if (p != A)
                    for (var x = this._items, W = 0; W < x.length; W++) { var f = x[W]; if (p === f.id) return f }
            },
            setItemVisible: function(_, n) {
                var z = this.getItemById(_);
                z && (z.visible = n)
            },
            getItemInfos: function() { return this._30o },
            getItemInfoAt: function(O) {
                var W = this,
                    u = 0,
                    J = W._30o,
                    V = W.lp(O),
                    Z = V.x,
                    P = V.y;
                if (P >= 0 && P <= W.getHeight())
                    for (; u < J.size(); u++) { var t = J.get(u); if (t.startX <= Z && Z <= t.endX) return t }
                return A
            },
            drawItem: function(D, G, h, n, $) {
                if (G.visible === !1) return 0;
                if (Fe(G.visible) && !G.visible()) return 0;
                var c = this,
                    d = G.disabled;
                d && (D.globalAlpha = gl);
                var f = c.drawItemImpl(D, G, h, n, $),
                    i = c._itemGap;
                return d && (D.globalAlpha = 1), this._currentItem !== G || "separator" === G || G.separator === !0 || G.unfocusable || Qn(D, c._separatorColor, h - i / 2, 0, f + i, n), f
            },
            drawItemImpl: function(R, E, O, x, C) {
                var f = this,
                    H = f._view,
                    M = f._itemGap,
                    a = x / 2,
                    u = E.type,
                    b = E.element,
                    y = E.label;
                Ok(b) && (y = b, b = A);
                var B, K = f.getLabelFont(E),
                    g = f.getLabelColor(E),
                    G = E.selected,
                    s = Jc(E.icon),
                    L = Hc(s, E),
                    r = 0,
                    N = L + (y ? Pg(K, y).width : 0);
                if ("separator" === E || E.separator === !0) return pg(R, f._separatorColor, O, x / 4, a), 1;
                if (b) {
                    s && Gj(R, s, O + L / 2, a, E, f), hg(R, y, K, g, O + L, 0, 0, x);
                    var _ = rf(b);
                    C || f._90I.add(_), _.parentNode !== H && Ml(H, _), b.iv && b.iv(), b.validate && b.validate();
                    var F = _.getBoundingClientRect(),
                        z = F.width,
                        S = _.style;
                    return bg(_), S.left = f.tx() + O + N + dd, S.top = (x - F.height) / 2 + dd, N + z
                }
                return u === di ? B = Jc(G ? Hk : nr) : u === dk && (B = Jc(G ? dk : Cr)), B ? (r = Hc(B, E), Gj(R, B, O + r / 2, a, E, f), O += r, N += r) : G && re(R, O - M / 2, 0, N + M, x, f.getSelectBackground(E)), s && Gj(R, s, O + L / 2, a, E, f), hg(R, y, K, g, O + L, 0, 0, x), N
            },
            validateImpl: function() {
                var I = this,
                    l = I._canvas,
                    G = I.getWidth(),
                    z = I.getHeight(),
                    X = I._30o,
                    W = I._items;
                Cq(l, G, z);
                var b = Bp(l),
                    F = I._itemGap,
                    g = F / 2;
                Yk(b, I.tx(), 0, 1), b.clearRect(0, 0, G, z);
                var R = I._90I;
                I._90I = new En, X.clear(), W.forEach(function(V) {
                    var m = I.drawItem(b, V, g, z);
                    X.add({ item: V, startX: g, endX: g + m, width: m }), m && (g += m + F)
                }), R.each(function(p) { I._90I.contains(p) || tp(p) });
                var Q = I._64I;
                I._64I = K(0, g), b.restore(), I._stickToRight ? (I._65O = 0, b = Bp(l), g = G - I._64I + F, Yk(b, 0, 0, 1), b.clearRect(0, 0, G, z), X.clear(), W.forEach(function(r) {
                    var m = I.drawItem(b, r, g, z, !0);
                    X.add({ item: r, startX: g, endX: g + m, width: m }), m && (g += m + F)
                }), b.restore()) : I.tx(I.tx()), Q !== I._64I && I.onSumWidthChanged(Q, I._64I)
            },
            onSumWidthChanged: function() {},
            handleClick: function(w, H) {
                var K = this,
                    z = w.type,
                    E = w.action,
                    x = w.groupId,
                    t = w.selected;
                w.disabled || (x != A ? t || (w.selected = !0, this._items.forEach(function(U) { U.groupId === x && w !== U && (U.selected = !1) }), E && w.action(w, K, H)) : z === dk || "toggle" === z ? (w.selected = !t, E && w.action(w, K, H)) : E && w.action(w, K, H)), Hd(), K.iv()
            }
        });
        var wt = function(_) { this.tb = _, this.addListeners() };
        eh(wt, n, {
            ms_listener: 1,
            getView: function() { return this.tb._view },
            handle_mousewheel: function(u) { this.handleScroll(u, 10 * (u.wheelDelta / 40)) },
            handle_DOMMouseScroll: function(c) { this.handleScroll(c, 10 * -c.detail) },
            handleScroll: function(r, Y) {
                sh(r);
                var Q = this.tb;
                Q.isScrollable() && !Q._stickToRight && (Q.tx(Q.tx() + Y), In())
            },
            handle_mousemove: function(g) {
                var Z = this;
                nj || Z.setItem(g)
            },
            handle_mouseout: function(d) {
                var q = this;
                d.target === q.getView() ? q.tb.setCurrentItem(A) : q.handle_mousemove(d)
            },
            handle_mousedown: function(n) { this.handle_mousemove(n), this.handle_touchstart(n) },
            handle_touchstart: function(N) {
                var M = this,
                    z = M.tb,
                    B = N.target;
                pn(N) && (B === M.getView() || B === z._canvas) && (sh(N), z.setFocus(N) && (this.setItem(N, !0), (z.isScrollable() || M.info && !M.info.item.disabled) && (M.x = Sp(N).x, M.tx = z.tx(), zi(M, N))))
            },
            handleWindowMouseMove: function(i) { this.handleWindowTouchMove(i) },
            handleWindowTouchMove: function(P) {
                var Q = this,
                    J = Q.tb;
                if (!J._stickToRight) { var e = Sp(P).x - Q.x;!Q._25o && X(e) > 2 && J.isScrollable() && (Q._25o = 1), Q._25o && J.tx(Q.tx + e) }
            },
            handleWindowMouseUp: function(U) { this.handleWindowTouchEnd(U) },
            handleWindowTouchEnd: function(_) {
                var s = this,
                    y = s.tb,
                    M = s.info,
                    v = s.tb.getItemInfoAt(_);
                if (!s._25o && M) {
                    var e = M.item;
                    v && v.item === e && y.handleClick(e, _)
                }
                s._25o = s.x = s.tx = A, s.setItem()
            },
            setItem: function(t, S) {
                var u = this,
                    X = u.tb,
                    v = u.info = t ? X.getItemInfoAt(t) : A,
                    K = v ? v.item : A;
                X.setCurrentItem(K), S && K && Fe(K.onDown) && K.onDown(t)
            }
        }), et.BorderPane = function() { this._view = oq(1, this), this.iv() }, ft("BorderPane", n, {
            ms_v: 1,
            ms_ac: ["topHeight", "bottomHeight", "leftWidth", "rightWidth"],
            ms_fire: 1,
            getLeftView: function() { return this._leftView },
            setLeftView: function(x, H) { this._12o("leftView", x), H != A && this.setLeftWidth(H) },
            getRightView: function() { return this._rightView },
            setRightView: function(k, x) { this._12o("rightView", k), x != A && this.setRightWidth(x) },
            getTopView: function() { return this._topView },
            setTopView: function(p, s) { this._12o("topView", p), s != A && this.setTopHeight(s) },
            getBottomView: function() { return this._bottomView },
            setBottomView: function(T, w) { this._12o("bottomView", T), w != A && this.setBottomHeight(w) },
            getCenterView: function() { return this._centerView },
            setCenterView: function(L) { this._12o("centerView", L) },
            _12o: function(B, o) {
                var _ = this,
                    Q = "_" + B,
                    l = _._view,
                    q = _[Q];
                q !== o && (q && (q.getView ? tp(q.getView()) : tp(q)), _[Q] = o, o && (o.getView ? Ml(l, o.getView(), 1) : Ml(l, o, 1)), _.fp(B, q, o))
            },
            onPropertyChanged: function() { this.iv() },
            validateImpl: function() {
                var N = this,
                    r = N._topView,
                    g = N._bottomView,
                    S = N._leftView,
                    b = N._rightView,
                    M = N._centerView,
                    B = N.getWidth(),
                    j = N.getHeight(),
                    i = 0,
                    U = 0,
                    O = B,
                    C = j,
                    R = 0,
                    s = 0,
                    h = 0,
                    E = 0;
                r && (R = N._topHeight == A ? rj(r) : N._topHeight, U = R), g && (s = N._bottomHeight == A ? rj(g) : N._bottomHeight, C = j - s), S && (h = N._leftWidth == A ? qo(S) : N._leftWidth, i = h), b && (E = N._rightWidth == A ? qo(b) : N._rightWidth, O = B - E);
                var I = K(0, O - i),
                    z = K(0, C - U);
                r && dq(r, 0, 0, B, R), g && dq(g, 0, C, B, s), S && dq(S, 0, U, h, z), b && dq(b, O, U, E, z), M && dq(M, i, U, I, z)
            }
        })
    }
}("undefined" != typeof global ? global : "undefined" != typeof self ? self : "undefined" != typeof window ? window : (0, eval)("this"), Object);